(()=>{var e,t,n,o,r,i={81485:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var o,r=n(67294),i=n(66239);function a(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class s extends r.Component{constructor(e){super(e),this.state={error:e.error,errorInfo:e.errorInfo}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){var e;return null!==(e=this.state.error)&&void 0!==e&&e.message?a(i.H,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}var l,c,d;d={error:{},errorInfo:"",children:""},(c="defaultProps")in(l=s)?Object.defineProperty(l,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[c]=d},66239:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});n(67294);var o,r=n(53641);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=e=>{var t,n;const o="500"===(null===(t=e.error.code)||void 0===t?void 0:t.toString())&&e.error.requestId,a=(null===(n=e.errorInfo)||void 0===n?void 0:n.componentStack)||e.error.message;return i("div",{className:"error-fallback-ui"},void 0,i("div",{className:"message"},void 0,i("p",{className:"error-message-xxl"},void 0,e.error.summary||i(r.vN,{},void 0,"Well, this is awkward...")),i("p",{className:"error-message-lg"},void 0,e.error.name||i(r.vN,{},void 0,"Something went wrong")),i("p",{},void 0,i(r.vN,{},void 0,"Please contact an admin for details.")),o&&i("p",{className:"error-message-sm"},void 0,i(r.vN,{},void 0,"Request id #"),e.error.requestId),a&&i("details",{className:"error-details"},void 0,a)),e.error.code&&i("span",{className:"error-code"},void 0,e.error.code))}},12006:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var o,r=n(67294),i=n(37974),a=n(53641),s=n(22222),l=n(15316);function c(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class d extends r.Component{render(){return c("footer",{},void 0,c("ul",{className:"footer-nav"},void 0,c("li",{className:"footer-nav_item"},void 0,c("div",{className:"footer-tooltip"},void 0,c("p",{},void 0,c(a.vN,{},void 0,"Uwazi is developed by")," ",c("a",{href:"https://huridocs.org/",target:"_blank"},void 0,c("img",{src:"/public/huridocs-logo.svg",title:"HURIDOCS",alt:"Human Rights Information and Documentation Systems"})))),c("a",{href:"https://www.uwazi.io/",target:"_blank",className:"footer-logo"},void 0,c("img",{src:"/public/logo.svg",title:"uwazi",alt:"uwazi"}))),c("li",{className:"footer-nav_separator"},void 0," "),c("li",{className:"footer-nav_item footer-collection_name"},void 0,c("span",{},void 0,this.props.siteName)),c("li",{className:"footer-nav_separator"},void 0," "),c("li",{className:"footer-nav_item"},void 0,c(a.l3,{to:(e=this.props.defaultLibraryView,l.M[e]?`/${l.M[e].url}`:"/library")},void 0,c(a.vN,{},void 0,"Library"))),(()=>this.props.user._id?c("li",{className:"footer-nav_item"},void 0,c(a.l3,{to:"/settings/account"},void 0,c(a.vN,{},void 0,"Settings"))):c("li",{className:"footer-nav_item"},void 0,c(a.l3,{to:"/login"},void 0,c(a.vN,{},void 0,"Login"))))()));var e}}d.defaultProps={defaultLibraryView:"cards"};const p=(0,s.P1)((e=>e.user),(e=>e.toJS()));const u=(0,i.connect)((function(e){return{user:p(e),siteName:e.settings.collection.get("site_name"),defaultLibraryView:e.settings.collection.get("defaultLibraryView")}}))(d)},13265:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o,r=n(67294),i=n(53641),a=n(587);function s(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class l extends r.Component{constructor(e){super(e),this.state={isOpen:!1}}render(){return r.createElement(r.Fragment,null,s("div",{className:"modal-tip-label",onClick:()=>this.setState({isOpen:!0})},void 0,this.props.label),s(a.Z,{isOpen:this.state.isOpen,type:this.props.type,className:"modal-tip-dim"},void 0,s(a.Z.Body,{},void 0,s("h4",{},void 0,this.props.title),this.props.children),s(a.Z.Footer,{},void 0,s("button",{type:"button",className:"btn confirm-button btn-info",onClick:()=>this.setState({isOpen:!1})},void 0,(0,i.t)("System","Accept")))))}}l.defaultProps={type:"info"}},4271:(e,t,n)=>{"use strict";n.d(t,{o:()=>a});n(67294);var o,r=n(53641);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=()=>i("ul",{},void 0,i("li",{},void 0,(0,r.t)("System","Search Tips: wildcard",'Use an * for wildcard search. Ie: "juris*" will match words  such as jurisdiction, jurisdictional, jurists, jurisprudence, etc.',!1)),i("li",{},void 0,(0,r.t)("System","Search Tips: one char wildcard",'? for one character wildcard. Ie: "198?" will match 1980 to 1989 and also 198a, 198b, etc.',!1)),i("li",{},void 0,(0,r.t)("System","Search Tips: exact term",'Exact term match by enclosing your search string with quotes. Ie. "Costa Rica" will toss different results compared to Costa Rica without quotes.',!1)),i("li",{},void 0,(0,r.t)("System","Search Tips: proximity",'~ for proximity searches. Ie: "the status"~5 will find anything having "the" and"status" within a distance of 5 words, such as "the procedural status", "the specific legal status".',!1)),i("li",{},void 0,(0,r.t)("System","Search Tips: boolean",'AND, OR and NOT for boolean searches. Ie. "status AND women NOT Nicaragua" will match anything containing both the words status and women, and necessarily not containing the word Nicaragua.',!1)))},55316:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(67294);class r extends o.Component{render(){return!!this.props.if&&this.props.children}}const i=r},15316:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});const o={cards:{url:"library",icon:"th"},table:{url:"library/table",icon:"align-justify"},map:{url:"library/map",icon:"map-marker"}}},96384:(e,t,n)=>{"use strict";n.d(t,{Qn:()=>a,ZW:()=>l,lC:()=>o,pD:()=>s,s0:()=>r,wS:()=>i});const o="START_UPLOAD_ATTACHMENT",r="ATTACHMENT_PROGRESS",i="ATTACHMENT_COMPLETE",a="ATTACHMENT_LOCAL_COMPLETE",s="ATTACHMENT_DELETED",l="ATTACHMENT_RENAMED"},61230:(e,t,n)=>{"use strict";n.d(t,{Dd:()=>m,Fx:()=>w,OW:()=>b,R2:()=>S,Sn:()=>g,_I:()=>f,iY:()=>y,pD:()=>h,qU:()=>v});var o=n(79223),r=n(80569),i=n.n(r),a=n(8772),s=n(38540),l=n(93673),c=n(38562),d=n(98373),p=n(59511),u=n(96384);function m(e,t){return async n=>{await c.Z.post("files",new d.K(e));const o=t.documents.map((t=>t._id===e._id?e:t)),r=Object.assign(t,{documents:o});n(p.N.set("viewer/doc",r)),n((0,l.i8)(r)),await n((0,l.qC)(r)),n((0,s.h)("File updated","success"))}}function f(e,t){return async n=>{await c.Z.delete("files",new d.K({_id:e._id}));const o=t.documents.filter((t=>t._id!==e._id)),r=Object.assign(t,{documents:o});n(p.N.set("viewer/doc",r)),n((0,l.i8)(r)),await n((0,l.qC)(r)),n((0,s.h)("File deleted","success"))}}function h(e,t,n){return async o=>{o({type:u.lC,entity:e}),i().post(`${a.z}files/upload/attachment`).set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").field("entity",e).field("originalname",t.name).attach("file",t).on("progress",(t=>{o({type:u.s0,entity:e,progress:Math.floor(t.percent)})})).on("response",(t=>{o({type:u.s0,entity:e,progress:100}),o({type:u.wS,entity:e,file:JSON.parse(t.text),__reducerKey:n.__reducerKey}),o((0,s.h)("Attachment uploaded","success"))})).end()}}function v(e,t,n){const{name:o,url:r}=t;return t=>{t({type:u.lC,entity:e}),c.Z.post("files",new d.K({originalname:o,url:r,entity:e,type:"attachment"})).then((o=>{t({type:u.s0,entity:e,progress:100}),t({type:u.wS,entity:e,file:o.json,__reducerKey:n.__reducerKey}),t((0,s.h)("Attachment uploaded","success"))}))}}function y(e,t,n,r){return i=>c.Z.post("files",new d.K({_id:r._id,originalname:r.originalname})).then((r=>{i({type:u.ZW,entity:e,file:r.json,__reducerKey:n}),i(o.Nw.reset(t)),i((0,s.h)("Attachment renamed","success"))}))}function b(e,t,n){return async o=>{await c.Z.delete("files",new d.K({_id:t._id})),o({type:u.pD,entity:e,file:t,__reducerKey:n}),o((0,s.h)("Attachment deleted","success"))}}function g(e,t){return n=>{n(o.Nw.reset(e)),n(o.Nw.load(e,t))}}function S(e){return t=>{t(o.Nw.submit(e))}}function w(e){return t=>{t(o.Nw.reset(e))}}},83214:(e,t,n)=>{"use strict";n.d(t,{f:()=>v});var o,r=n(67294),i=n(37974),a=n(83253),s=n.n(a),l=n(28151),c=n(88601),d=n(74127),p=n(79223),u=n(53641),m=n(72027),f=n(77140);function h(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const v=(0,i.connect)(null,((e,t)=>(0,d.bindActionCreators)({uploadAttachment:t.uploadAttachment,uploadAttachmentFromUrl:t.uploadAttachmentFromUrl},e)))((({isOpen:e,entitySharedId:t,storeKey:n,model:o,onClose:i,uploadAttachment:a,uploadAttachmentFromUrl:d,getPercentage:v})=>{const y=(0,r.useRef)(null);let b=()=>{};return h(s(),{isOpen:e,className:"attachments-modal",overlayClassName:"attachments-modal__overlay",ariaHideApp:!1},void 0,h("div",{className:"attachments-modal__header"},void 0,h("h4",{},void 0,h(u.vN,{},void 0,"Supporting files")),h("button",{type:"button",onClick:i,className:"attachments-modal__close",disabled:void 0!==v},void 0,h(m.JO,{icon:"times"}),h("span",{},void 0,h(u.vN,{},void 0,"Cancel")))),h("div",{className:"attachments-modal__content"},void 0,h(l.mQ,{renderActiveTabContentOnly:!0},void 0,h("div",{className:"attachments-modal__tabs"},void 0,h(l.fK,{to:"uploadComputer",className:"tab-link modal-tab-1",component:"div"},void 0,h(u.vN,{},void 0,"Upload from computer")),h(l.fK,{to:"uploadWeb",className:"tab-link modal-tab-2",component:"div"},void 0,h(u.vN,{},void 0,"Add from web"))),h("div",{className:"attachments-modal__tabs-content"},void 0,h(l.I5,{for:"uploadComputer",className:"tab-content centered"},void 0,h(c.Z,{disableClick:!0,onDrop:async e=>{await Promise.all(e.map((e=>a(t,e,{__reducerKey:n,model:o}))))},className:"attachments-modal__dropzone",multiple:!1},void 0,void 0===v?r.createElement(r.Fragment,null,h("button",{type:"button",onClick:()=>{y.current&&y.current.click()},className:"btn"},void 0,h(m.JO,{icon:"link"}),"  ",h(u.vN,{},void 0,"Upload and select file")),r.createElement("input",{"aria-label":"fileInput",type:"file",onChange:async e=>{e.target.files&&await Promise.all([...e.target.files].map((e=>a(t,e,{__reducerKey:n,model:o}))))},style:{display:"none"},ref:y}),h("h4",{className:"attachments-modal__dropzone-title"},void 0,h(u.vN,{},void 0,"Drag and drop file in this window to upload "))):h("div",{className:"progress attachments-modal-progress"},void 0,h("div",{className:"progress-bar progress-bar-success attachments-modal-progress-bar",role:"progressbar",style:{width:`${v}%`}})))),h(l.I5,{for:"uploadWeb",className:"tab-content centered"},void 0,h("div",{className:"wrapper-web"},void 0,h(f.n,{handleSubmit:e=>{d(t,e,{__reducerKey:n,model:o}),b(p.Nw.reset("urlForm"))},dispatch:e=>{b=e},hasName:!0})))))))}))},99052:(e,t,n)=>{"use strict";n.d(t,{m:()=>V});var o,r=n(67294),i=n(45398),a=n(53641),s=n(45697),l=n.n(s),c=n(37974),d=n(74127),p=n(43393),u=n.n(p),m=n(96486),f=n(72027),h=n(11992),v=n(49935),y=n(82135);function b(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends r.Component{constructor(e,t){super(e,t),this.state={processing:!1,failed:!1,completed:!1},this.conversionStart=this.conversionStart.bind(this),this.conversionFailed=this.conversionFailed.bind(this),this.documentProcessed=this.documentProcessed.bind(this),y.W.on("conversionStart",this.conversionStart),y.W.on("conversionFailed",this.conversionFailed),y.W.on("documentProcessed",this.documentProcessed),this.onChange=this.onChange.bind(this)}componentWillUnmount(){y.W.removeListener("conversionStart",this.conversionStart),y.W.removeListener("conversionFailed",this.conversionFailed),y.W.removeListener("documentProcessed",this.documentProcessed),clearTimeout(this.timeout)}onChange(e){const t=e.target.files[0];this.props.uploadDocument(this.props.entitySharedId,t)}documentProcessed(e){e===this.props.entitySharedId&&this.setState({processing:!1,failed:!1,completed:!0},(()=>{this.timeout=setTimeout((()=>{this.setState({processing:!1,failed:!1,completed:!1})}),2e3)}))}conversionStart(e){e===this.props.entitySharedId&&this.setState({processing:!0,failed:!1,completed:!1})}conversionFailed(e){e===this.props.entitySharedId&&this.setState({processing:!1,failed:!0,completed:!1})}renderButton(e="",t="plus",n="Add PDF"){return b("label",{htmlFor:"upload-button-input",className:`upload-button btn upload-${e}`},void 0,b(f.JO,{icon:t})," ",b("input",{onChange:this.onChange,type:"file",accept:"application/pdf",id:"upload-button-input"})," ",b(a.vN,{},void 0,n))}render(){const e=this.props.progress.get(this.props.entitySharedId);switch(!0){case this.state.failed:return this.renderButton("failed","exclamation-triangle","An error occured");case this.state.processing||0===e:return b("div",{className:"upload-button btn btn-default"},void 0,b(f.JO,{icon:"cog",spin:!0})," ",b(a.vN,{},void 0,"Processing"));case e>0&&e<100:return(e=>b("div",{className:"upload-button btn btn-default btn-disabled"},void 0,b("span",{},void 0,e,"%")," ",b(a.vN,{},void 0,"Uploading")))(e);case this.state.completed||100===e:return this.renderButton("success","check","Success, Upload another?");default:return this.renderButton()}}}g.defaultProps={progress:u().fromJS({}),storeKey:"",entitySharedId:"",uploadDocument:()=>{}},g.contextTypes={confirm:l().func};const S=(0,c.connect)((({metadata:e,progress:t})=>({progress:(0,m.isEmpty)(t)?e.progress:t})),(function(e,t){return(0,d.bindActionCreators)({uploadDocument:h.iG},(0,v.Qd)(e,t.storeKey))}))(g);var w=n(65879),N=n(40922);const O={get:N.dK,data:Object.keys(N.GP).map((e=>N.GP[e])),getAll:(e="elastic")=>Object.keys(N.GP).map((t=>N.GP[t][e])).filter(((e,t,n)=>n.indexOf(e)===t)).filter((e=>Boolean(e)))};var P,C=n(35940),k=n(8772),_=n(79223),j=n(61230),I=n(17565),D=n(52786),T=n(74371);function E(e,t,n,o){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class x extends r.Component{render(){const{filename:e,location:t,children:n,entity:o}=this.props;return t.pathname.match(/entity/)?E(T.Xq,{className:"btn btn-default",location:t,queryParams:{file:e,page:1},type:"button"},void 0,n):E(D.rU,{className:"btn btn-default",to:`/entity/${o.sharedId}?file=${e}`,type:"button"},void 0,n)}}const A=(0,D.EN)(x);var $;function R(e,t,n,o){$||($="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class L extends r.Component{constructor(e){super(e),this.state={editing:!1},this.edit=this.edit.bind(this),this.cancel=this.cancel.bind(this),this.delete=this.delete.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}edit(){this.setState({editing:!0})}cancel(){this.setState({editing:!1})}delete(){this.context.confirm({accept:()=>{this.props.deleteFile(this.props.file,this.props.entity),this.setState({editing:!1})},title:"Confirm delete file",message:"Are you sure you want to delete this file?"})}handleSubmit(e){this.props.updateFile(e,this.props.entity),this.setState({editing:!1})}renderDeleteButton(){return R("button",{type:"button",className:"btn btn-outline-danger",value:"Delete",onClick:this.delete},void 0,R(f.JO,{icon:"trash-alt"})," ",R(a.vN,{},void 0,"Delete"))}renderFailed(){return R("div",{className:"file-failed"},void 0,R(f.JO,{icon:"times"})," ",R(a.vN,{},void 0,"Conversion failed"),R(w.W,{roles:["admin","editor"],orWriteAccessTo:[this.props.entity]},void 0,this.renderDeleteButton()))}renderReady(){const{language:e,filename:t=""}=this.props.file;return R("div",{},void 0,R("div",{},void 0,R("span",{className:"badge"},void 0,R(a.vN,{},void 0,e&&(0,N.dK)(e)||"")),R(I.Ot,{file:this.props.file},void 0,R(a.vN,{},void 0,"ML TOC"))),R("div",{},void 0,R("a",{href:`${k.z}files/${t}`,target:"_blank",rel:"noopener noreferrer",className:"file-download btn btn-outline-secondary"},void 0,R(f.JO,{icon:"cloud-download-alt"})," ",R(a.vN,{},void 0,"Download")),R(w.W,{roles:["admin","editor"],orWriteAccessTo:[this.props.entity]},void 0,R("button",{type:"button",className:"file-edit btn btn-outline-success",onClick:this.edit},void 0,R(f.JO,{icon:"pencil-alt"})," ",R(a.vN,{},void 0,"Edit"))),R(A,{filename:t,entity:this.props.entity},void 0,R(a.vN,{},void 0,"View"))))}renderView(){const{originalname:e,status:t}=(0,C.nW)(this.props.file)?{originalname:this.props.file.originalFile.name,status:"ready"}:this.props.file;return R("div",{className:"file"},void 0,R("div",{className:"file-originalname"},void 0,e),"ready"===t&&this.renderReady(),"failed"===t&&this.renderFailed(),"processing"===t&&R("div",{},void 0,R(f.JO,{icon:"clock"})," ",R(a.vN,{},void 0,"Processing")))}renderEditing(){return R(_.hD,{onSubmit:this.handleSubmit,initialState:this.props.file,className:"file-form"},void 0,R("div",{className:"form-group row"},void 0,R("div",{className:"col-sm-12"},void 0,R("label",{htmlFor:"originalname"},void 0,R(a.vN,{},void 0,"Document Title")," *"),R(_.oT.text,{validators:{required:e=>Boolean(e&&e.length)},className:"form-control",model:".originalname",id:"originalname",mapProps:{className:({fieldValue:e})=>e.submitFailed&&!e.valid?"form-control has-error":"form-control"}})),R("div",{className:"col-sm-3"},void 0,R("label",{htmlFor:"language"},void 0,R(a.vN,{},void 0,"Language"))),R("div",{className:"col-sm-9"},void 0,R(_.oT.select,{className:"form-control",model:".language",id:"language"},void 0,N.mT.map((e=>R("option",{value:e.ISO639_3},e.ISO639_3,e.localized_label," (",e.label,")"))),R("option",{value:"other"},void 0,(0,a.t)("System","other","other",!1)))),R("div",{className:"col-sm-4"},void 0,R("button",{type:"submit",className:"btn btn-outline-success"},void 0,R(f.JO,{icon:"save"})," ",R(a.vN,{},void 0,"Save"))),R("div",{className:"col-sm-4"},void 0,R("button",{type:"button",className:"btn btn-outline-secondary",value:"Cancel",onClick:this.cancel},void 0,R(f.JO,{icon:"times"})," ",R(a.vN,{},void 0,"Cancel"))),R("div",{className:"col-sm-4"},void 0,this.renderDeleteButton())))}render(){return this.state.editing?this.renderEditing():this.renderView()}}F(L,"defaultProps",{updateFile:()=>{},deleteFile:()=>{}}),F(L,"contextTypes",{confirm:l().func});const J=(0,c.connect)(null,((e,t)=>(0,d.bindActionCreators)({updateFile:j.Dd,deleteFile:j._I},(0,v.Qd)(e,t.storeKey))))(L);var Z;function M(e,t,n,o){Z||(Z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class V extends r.Component{static arrangeFiles(e=[]){return(0,i.Y)(e,{property:"originalname"})}renderFile(e,t){const{storeKey:n,entity:o}=this.props;return M("li",{},t,M(J,{file:e,storeKey:n,entity:o}))}orderFilesByLanguage(e,t){const n=[...e],o=n.findIndex((e=>O.get(e.language,"ISO639_1")===t));if(o>-1){const e=n[o];n[o]=n[0],n[0]=e}return n}render(){const e=M("h2",{},void 0,M(a.vN,{},void 0,"Primary Documents")),{files:t,entity:n}=this.props,o=this.orderFilesByLanguage(t,n.language);return M("div",{className:"filelist"},void 0,M("div",{className:"filelist-header"},void 0,0===o.length?M(w.W,{roles:["admin","editor"],orWriteAccessTo:[n]},void 0,e):r.createElement(r.Fragment,null,e),M("div",{},void 0,M(w.W,{roles:["admin","editor"],orWriteAccessTo:[n]},void 0,M(S,{entitySharedId:this.props.entity.sharedId,storeKey:this.props.storeKey})))),M("ul",{},void 0,o.map(((e,t)=>this.renderFile(e,t)))))}}var U,z,K;K={files:[],entity:null,storeKey:""},(z="defaultProps")in(U=V)?Object.defineProperty(U,z,{value:K,enumerable:!0,configurable:!0,writable:!0}):U[z]=K},26159:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m});var o,r=n(67294),i=n(37974),a=n(74127),s=n(53641),l=n(72027),c=n(90392),d=n(61230),p=n(83214);function u(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const m=(0,i.connect)((function({attachments:e}){return{progress:e.progress}}),(e=>(0,a.bindActionCreators)({attachmentCompleted:c.MG},e)))((e=>{const{entitySharedId:t,storeKey:n,progress:o,model:i=""}=e,[a,c]=(0,r.useState)(!1),m=()=>{c(!1),e.attachmentCompleted(t)},f=o.get(t);return(0,r.useEffect)((()=>{100===f&&m()}),[o]),r.createElement(r.Fragment,null,u("button",{type:"button",onClick:()=>c(!0),className:"btn attachments-modal-trigger"},void 0,u(l.JO,{icon:"plus"})," ",u(s.vN,{},void 0,"Add file")),u(p.f,{isOpen:a,onClose:m,entitySharedId:t,storeKey:n,getPercentage:f,model:i,uploadAttachment:e.uploadAttachment||d.pD,uploadAttachmentFromUrl:e.uploadAttachmentFromUrl||d.qU}))}))},77140:(e,t,n)=>{"use strict";n.d(t,{n:()=>u});var o,r=n(79223),i=n(53641),a=n(72027),s=(n(67294),n(66139));function l(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=({handleSubmit:e,url:t,dispatch:n,hasName:o=!1})=>{const c=d(d({},o&&{name:{required:e=>!!e&&""!==e.trim()}}),{},{url:{required:e=>!!e&&""!==e.trim()}});return l(r.hD,{onSubmit:e,getDispatch:n,model:"urlForm",validators:c,initialState:{url:t},className:o?"":"select-from-link"},void 0,l(s.cw,{className:"has-feedback",model:".url"},void 0,l(r.gN,{model:".url"},void 0,l("input",{type:"text",className:"form-control web-attachment-url",placeholder:"Paste URL here"}))),o&&l(s.cw,{className:"form-group",model:".name"},void 0,l(r.gN,{model:".name",className:"field"},void 0,l("input",{type:"text",className:"form-control web-attachment-name",placeholder:"Title"}))),l("button",{type:"submit",className:"btn"},void 0,l(a.JO,{icon:"link"}),"  ",l(i.vN,{},void 0,"Add from URL")))}},52949:(e,t,n)=>{"use strict";n.d(t,{Fy:()=>Y,JX:()=>k,ay:()=>y,I6:()=>S});var o,r=n(67294),i=n(37974),a=n(74127),s=n(60502),l=n(72027),c=n(61230);function d(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class p extends r.Component{onChangeSingle(e){const t=e.target.files[0];this.props.uploadAttachment(this.props.entity,t,{__reducerKey:this.props.storeKey})}onChangeAll(e){const t=e.target.files[0];this.props.uploadAttachment(this.props.entity,t,{__reducerKey:this.props.storeKey},{allLanguages:!0})}renderUploadButton(){let e=null;return this.props.languages.size>1&&(e=d("label",{htmlFor:"upload-attachment-all-input",className:"btn btn-success btn-xs add"},void 0,d("span",{className:"btn-label"},void 0,d(l.JO,{icon:"link"})," ",(0,s.Z)("System","Add to all languages")),d("input",{onChange:this.onChangeAll.bind(this),type:"file",id:"upload-attachment-all-input"}))),d("div",{},void 0,d("label",{htmlFor:"upload-attachment-input",className:"btn btn-success btn-xs add"},void 0,d("span",{className:"btn-label"},void 0,d(l.JO,{icon:"paperclip"})," ",(0,s.Z)("System","Add file")),d("input",{onChange:this.onChangeSingle.bind(this),type:"file",id:"upload-attachment-input"})),e)}renderProgress(e){return d("div",{className:"btn btn-default btn-disabled"},void 0,d("span",{className:"btn-label"},void 0,(0,s.Z)("System","Uploading")),d("span",{},void 0,"  ",e,"%"))}render(){const e=this.props.progress.get(this.props.entity);return e?this.renderProgress(e):this.renderUploadButton()}}(0,i.connect)((function({attachments:e,settings:t}){return{progress:e.progress,languages:t.collection.get("languages")}}),(function(e){return(0,a.bindActionCreators)({uploadAttachment:c.pD},e)}))(p);var u=n(43393),m=n(96384),f=n(37501);const h=(e,t)=>e.getIn(t.concat(["sharedId"])),v=(e,t)=>e.getIn(t.concat(["attachments"]))||(0,u.fromJS)([]),y=(e,{useDefaults:t=!0,setInArray:n=[]}={})=>(o,r)=>{let i=o;const a=r||{};if(t&&(i=o||{}),a.type===f.Yy&&h(i,n)===a.doc){const e=((e,t)=>e.getIn(t.concat(["documents"]))||(0,u.fromJS)([]))(i,n);return i.setIn(n.concat(["documents"]),e.push((0,u.fromJS)(a.file)))}if(a.type===m.wS&&h(i,n)===a.entity){const e=v(i,n);return i.setIn(n.concat(["attachments"]),e.push((0,u.fromJS)(a.file)))}if(a.type===m.pD&&h(i,n)===a.entity){const e=v(i,n);return i.setIn(n.concat(["attachments"]),e.filterNot((e=>e.get("_id")===a.file._id)))}if(a.type===m.ZW&&h(i,n)===a.entity){if(((e,t)=>e.getIn(t.concat(["_id"])))(i,n)===a.file._id)return i.setIn(n.concat(["file"]),(0,u.fromJS)(a.file));const e=v(i,n);return i.setIn(n.concat(["attachments"]),e.map((e=>e.get("_id")===a.file._id?e.set("originalname",a.file.originalname):e)))}return e(i,a)};var b=n(79223);const g={};const S=(0,a.combineReducers)({progress:function(e=g,t={}){return t.type===m.lC?e.set(t.entity,0):t.type===m.s0?e.set(t.entity,t.progress):t.type===m.wS||t.type===m.Qn?e.delete(t.entity):(0,u.fromJS)(e)},edit:(0,a.combineReducers)({attachment:(0,b.sZ)("attachments.edit.attachment"),form:(0,b.aB)("attachments.edit.attachment")})});var w,N=n(22004),O=n(63977),P=n(85212);function C(e,t,n,o){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const k=({attachment:e})=>{const{mimetype:t=""}=e,n=(0,P.Vo)(e)?(0,P.JH)(e):e.url;if(t.includes("image"))return C("img",n?{src:n,alt:e.originalname}:{src:`/api/files/${e.filename}`,alt:e.originalname});const o=t.includes("video")||t.includes("audio"),r=e.url&&N.Z.canPlay(e.url);return o||r?C(O.Z,n?{config:`(${n})`}:{config:`(/api/files/${e.filename})`}):null};var _,j=n(45697),I=n.n(j),D=n(53641),T=n(45398),E=n(65879),x=n(56755),A=n.n(x),$=n(55316),R=n(83668),F=n(40922);function L(e,t,n,o){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class J extends r.Component{render(){const{model:e}=this.props,t=Object.keys(F.GP).map((e=>({value:F.GP[e].franc,label:F.GP[e].elastic})));return t.push({value:"other",label:"other"}),L(b.l0,{id:"attachmentForm",model:e,onSubmit:this.props.onSubmit,validators:{originalname:{required:e=>!!e&&""!==e.trim()}}},void 0,L(R.cw,{model:e,field:"originalname"},void 0,L(b.gN,{model:".originalname"},void 0,L("input",{className:"form-control"}))),L($.Z,{if:this.props.isSourceDocument},void 0,L(R.cw,{className:"set-language"},void 0,L("label",{},void 0,(0,s.Z)("System","Language")),L(R.Ph,{model:".language",className:"form-control",options:t}))))}}const Z=(0,i.connect)()(J);var M,V=n(49935),U=n(38540),z=n(69899),K=n(32820);function B(e,t,n,o){M||(M="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:M,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class H extends r.Component{static conformThumbnail(e,t){let n=null;return e.filename&&"pdf"===(0,K.m)(e.filename)&&(n=B("span",{"no-translate":!0},void 0,B(l.JO,{icon:"file-pdf"})," pdf")),e.url&&(n=B("span",{},void 0,B(l.JO,{icon:"link"}))),e.filename&&-1!==["png","gif","jpg","jpeg"].indexOf((0,K.m)(e.filename.toLowerCase()))&&(n=B("img",{src:t.downloadHref,alt:e.filename})),B("div",{className:"attachment-thumbnail"},void 0,n)}constructor(e){super(e),this.state={dropdownMenuOpen:!1},this.toggleDropdown=this.toggleDropdown.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this),this.copyToClipboard=this.copyToClipboard.bind(this),this.attachmentActionsRef=r.createRef(),this.onRenameSubmit=this.onRenameSubmit.bind(this),this.toggleRename=this.toggleRename.bind(this)}componentDidMount(){"undefined"!=typeof document&&document.addEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){"undefined"!=typeof document&&document.removeEventListener("mousedown",this.handleClickOutside)}onRenameSubmit(e){const{parentSharedId:t,model:n,storeKey:o}=this.props;this.props.renameAttachment(t,n,o,e)}toggleDropdown(){this.setState((e=>({dropdownMenuOpen:!e.dropdownMenuOpen})))}deleteAttachment(e){this.context.confirm({accept:()=>{this.props.deleteAttachment(this.props.parentSharedId,e,this.props.storeKey)},title:"Confirm delete",message:this.props.deleteMessage})}toggleRename(){const{file:e,model:t}=this.props;this.props.loadForm.bind(this,t,e)(),this.toggleDropdown()}copyToClipboard(e){const t=document.createElement("textarea");document.body.appendChild(t),t.value=e.url||window.location.origin+e.downloadHref,t.select(),document.execCommand("copy"),document.body.removeChild(t),z.h.dispatch((0,U.h)("Copied to clipboard","success")),this.toggleDropdown()}handleClickOutside(e){this.attachmentActionsRef.current&&!this.attachmentActionsRef.current.contains(e.target)&&this.setState({dropdownMenuOpen:!1})}render(){const{file:e,model:t,storeKey:n,entity:o}=this.props,i=e.size?A()(e.size):"",a=((e,t)=>{const n={itemClassName:"",typeClassName:"empty",icon:"paperclip",deletable:!0,replaceable:!1};return n.downloadHref=`/api/files/${e}`,n.url=t,n})(e.filename,e.url);let s=B("a",{className:"attachment-link",href:a.url||a.downloadHref},void 0,H.conformThumbnail(e,a),B("span",{className:"attachment-name"},void 0,B("span",{},void 0,e.originalname),B($.Z,{if:Boolean(i)},void 0,B("span",{className:"attachment-size"},void 0,i)))),c=null;return this.props.beingEdited&&!this.props.readOnly&&(s=B("div",{className:"attachment-link"},void 0,H.conformThumbnail(e,a),B("span",{className:"attachment-name"},void 0,B(Z,{model:this.props.model,onSubmit:this.onRenameSubmit}))),c=B("div",{className:"attachment-buttons"},void 0,B("div",{className:"item-shortcut-group"},void 0,B(E.W,{roles:["admin","editor"],orWriteAccessTo:[o]},void 0,B("button",{type:"button",className:"item-shortcut btn btn-primary",onClick:this.props.resetForm.bind(this,t)},void 0,B(l.JO,{icon:"times"}))),B(E.W,{roles:["admin","editor"],orWriteAccessTo:[o]},void 0,B("button",{type:"button",className:"item-shortcut btn btn-success",onClick:this.props.submitForm.bind(this,t,n)},void 0,B(l.JO,{icon:"save"})))))),B("div",{className:"attachment"},void 0,s,B(E.W,{roles:["admin","editor"],orWriteAccessTo:[o]},void 0,c,B("div",{className:"dropdown attachments-dropdown"},void 0,B("button",{className:"btn btn-default dropdown-toggle attachments-dropdown-toggle",type:"button",id:"attachment-dropdown-actions","data-toggle":"dropdown","aria-haspopup":"true",onClick:this.toggleDropdown},void 0,B(l.JO,{icon:"pencil-alt"})),r.createElement("ul",{className:"dropdown-menu dropdown-menu-right","aria-labelledby":"attachment-dropdown-actions",style:{display:this.state.dropdownMenuOpen?"block":"none"},ref:this.attachmentActionsRef},B("li",{},void 0,B("button",{type:"button",onClick:()=>this.copyToClipboard(a)},void 0,B(l.JO,{icon:"link"})," ",B(D.vN,{},void 0,"Copy link"))),B("li",{},void 0,B("a",{href:a.url||a.downloadHref,target:"_blank",rel:"noopener noreferrer"},void 0,B(l.JO,{icon:"link"})," ",B(D.vN,{},void 0,"Download"))),B("li",{},void 0,B("button",{type:"button",onClick:this.toggleRename},void 0,B(l.JO,{icon:"pencil-alt"})," ",B(D.vN,{},void 0,"Rename"))),B("li",{},void 0,B("button",{type:"button",onClick:this.deleteAttachment.bind(this,e),className:"is--delete"},void 0,B(l.JO,{icon:"trash-alt"})," ",B(D.vN,{},void 0,"Delete")))))))}}H.defaultProps={deleteMessage:"Are you sure you want to delete this attachment?",entity:null},H.contextTypes={confirm:I().func};const q=(0,i.connect)((function({attachments:e},t){return{model:"attachments.edit.attachment",beingEdited:t.file._id&&e.edit.attachment._id===t.file._id}}),(function(e,t){return(0,a.bindActionCreators)({deleteAttachment:c.OW,renameAttachment:c.iY,loadForm:c.Sn,submitForm:c.R2,resetForm:c.Fx},(0,V.Qd)(e,t.storeKey))}))(H);var W,G=n(26159);function Q(e,t,n,o){W||(W="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:W,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Y extends r.Component{static arrangeFiles(e=[]){return(0,T.Y)(e,{property:"originalname"})}render(){const e=Q("h2",{},void 0,Q(D.vN,{},void 0,"Supporting files")),{parentId:t,parentSharedId:n,readOnly:o,storeKey:i,entity:a}=this.props,s=o||Boolean(this.props.isTargetDoc);let l=null;this.props.isTargetDoc||(l=Q(E.W,{roles:["admin","editor"],orWriteAccessTo:[a]},void 0,Q("div",{className:"attachment-add"},void 0,Q(G.ZP,{entitySharedId:this.props.parentSharedId,storeKey:i}))));const c=Y.arrangeFiles(this.props.attachments);return Q("div",{className:"attachments-list-parent"},void 0,Q("div",{className:"attachments-list-header"},void 0,0===c.length?Q(E.W,{roles:["admin","editor"],orWriteAccessTo:[a]},void 0,e):r.createElement(r.Fragment,null,e),l),Q("div",{className:"attachments-list"},void 0,c.map(((e,o)=>Q(q,{file:e,parentId:t,readOnly:s,storeKey:i,parentSharedId:n,isSourceDocument:!1,entity:a},o)))))}}Y.defaultProps={attachments:[],readOnly:!1,isTargetDoc:!1,parentId:null,parentSharedId:null,storeKey:"",entity:null},Y.contextTypes={confirm:I().func};n(83214)},11470:(e,t,n)=>{"use strict";n.r(t),n.d(t,{login:()=>s,recoverPassword:()=>l,resetPassword:()=>c,unlockAccount:()=>d});var o=n(38562),r=n(59511),i=n(38540),a=n(98373);function s(e){const t=new a.K(e);return async e=>{await o.Z.post("login",t);const n=await o.Z.get("user");e(r.N.set("auth/user",n.json))}}function l(e,t){const n=new a.K({email:e});return e=>o.Z.post("recoverpassword",n).then((()=>{e((0,i.h)(t||"Instructions to reset your password have been sent, please check your email","success"))}))}function c(e,t){const n=new a.K({password:e,key:t});return e=>o.Z.post("resetpassword",n).then((()=>{e((0,i.h)("Password changed success","success"))}))}function d(e){const t=new a.K(e);return e=>o.Z.post("unlockaccount",t).then((()=>{e((0,i.h)("Account unlocked successfully","success"))}))}},65879:(e,t,n)=>{"use strict";n.d(t,{W:()=>a,Z:()=>s});var o=n(11470),r=n(67294),i=n(37974);const a=(0,i.connect)((({user:e})=>({user:e})))((({children:e,roles:t,orWriteAccessTo:n,user:o})=>{const i=(0,r.useMemo)((()=>((e,t=["admin"])=>!(!e.get("_id")||!t.includes(e.get("role"))))(o,t)||((e=[],t)=>{let n=void 0!==t&&t.has("role")&&e.length>0,o=0;for(;n&&o<e.length;){const r=e[o];o+=1,n=!(!r||!r.permissions)&&void 0!==r.permissions.filter((e=>"write"===e.level)).map((e=>e.refId)).find((e=>{var n;return e===t.get("_id")||(null===(n=t.get("groups"))||void 0===n?void 0:n.find((t=>t.get("_id")===e)))}))}return n})(n,o)),[o,t,n]);return i?r.createElement(r.Fragment,null,e):null})),s={actions:o}},59511:(e,t,n)=>{"use strict";n.d(t,{N:()=>o.Nw,Z:()=>r});var o=n(56900);const r=o.ZP},56900:(e,t,n)=>{"use strict";n.d(t,{Nw:()=>a,ZP:()=>i});var o=n(43393),r=n.n(o);function i(e,t){return(n=t,o={})=>{let i;switch(o.type){case`${e}/SET`:return r().fromJS(o.value);case`${e}/SET_IN`:return n.set(o.key,r().fromJS(o.value));case`${e}/UNSET`:return r().fromJS(t);case`${e}/PUSH`:return n.push(r().fromJS(o.value));case`${e}/CONCAT`:return n.concat(r().fromJS(o.value));case`${e}/CONCAT_IN`:return n.updateIn(o.key,(e=>e.concat(r().fromJS(o.value))));case`${e}/REMOVE`:return r().fromJS(n).filter((e=>e.get("_id")!==o.value._id));case`${e}/UPDATE`:return n instanceof r().Map?n.merge(o.value):(i=n.findIndex((e=>e.get("_id")===o.value._id)),-1===i?n.push(r().fromJS(o.value)):n.set(i,r().fromJS(o.value)));case`${e}/UPDATE_IN`:return i=n.getIn(o.key).findIndex((e=>e.get(o.customIndex||"_id")===(o.customIndex?o.value[o.customIndex]:o.value._id))),-1===i?n.updateIn(o.key,(e=>e.push(r().fromJS(o.value)))):n.setIn([...o.key,i],r().fromJS(o.value));default:return r().fromJS(n)}}}const a={update:function(e,t){return{type:`${e}/UPDATE`,value:t}},updateIn:function(e,t,n,o=""){return{type:`${e}/UPDATE_IN`,key:t,value:n,customIndex:o}},set:function(e,t){return{type:`${e}/SET`,value:t}},setIn:function(e,t,n){return{type:`${e}/SET_IN`,key:t,value:n}},unset:function(e){return{type:`${e}/UNSET`}},push:function(e,t){return{type:`${e}/PUSH`,value:t}},concat:function(e,t){return{type:`${e}/CONCAT`,value:t}},concatIn:function(e,t,n){return{type:`${e}/CONCAT_IN`,key:t,value:n}},remove:function(e,t){return{type:`${e}/REMOVE`,value:t}}}},96954:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o;n(67294);function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const i=e=>{if(e.active){const t=e.payload[0],n=e.payload[1];return r("div",{style:{backgroundColor:"#fff",border:"1px solid #ccc"}},void 0,r("div",{style:{backgroundColor:"#eee",borderBottom:"1px dashed #ccc",padding:"5px"}},void 0,t.payload.name,":  ",r("b",{style:{color:"#600"}},void 0,t.value+n.value)),r("div",{style:{padding:"5px"}},void 0,t.payload.setALabel,":  ",r("b",{style:{color:"#600"}},void 0,t.value),r("br",{}),n.payload.setBLabel,":  ",r("b",{style:{color:"#600"}},void 0,n.value)))}return null};i.defaultProps={payload:[],active:!1};const a=i},78677:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>f});var o,r=n(67294),i=n(37974),a=n(53641),s=n(96185),l=n(50530),c=n(51637);function d(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function p(e){const t=e;return t.options=t.options.map((e=>{const n=e;return n.label=(0,a.t)(t.content,n.label,null,!1),n})),t}function u(e){const t=e;return t.options=c.Z.sortValues(t.options),t}class m extends r.Component{itemResults(e){const{aggregations:t}=this,n=(t.all&&t.all.types?t.all.types.buckets:[]).find((t=>t.key===e.id));return n?n.filtered.doc_count:e.items?e.items.reduce(((e,t)=>e+this.itemResults(t)),0):0}conformDocumentTypesToFields(){let e=this.props.collection.toJS().filters||[];e.length&&"uploads"!==this.props.storeKey||(e=this.props.templates.toJS().map((e=>({id:e._id,name:e.name})))),"uploads"===this.props.storeKey&&e.unshift({id:"missing",name:(0,a.t)("System","No type")});return[{options:e.map((e=>({label:(0,a.t)(e.id,e.name),results:this.itemResults(e)}))),label:(0,a.t)("System","Document and entity types")}]}render(){let e=[];return this.props.aggregations&&(this.aggregations=this.props.aggregations.toJS(),this.props.fields.size&&(e=(0,s.e0)(this.props.fields.toJS(),this.aggregations).filter((e=>("select"===e.type||"multiselect"===e.type)&&e.options&&e.options.length)).map(p).map(u)),e=e.length?e:this.conformDocumentTypesToFields()),d("div",{className:"documents-list"},void 0,d("div",{className:"main-wrapper"},void 0,d("div",{className:"item-group item-group-charts"},void 0,e.map(((e,t)=>d(l.GO,{options:e.options,label:(0,a.t)(this.props.translationContext,e.label)},t))))))}}const f=(0,i.connect)((function(e,t){const n=t.storeKey&&e[t.storeKey].filters.get("documentTypes");return{aggregations:t.storeKey?e[t.storeKey].aggregations:null,fields:t.storeKey?e[t.storeKey].filters.get("properties"):null,collection:e.settings.collection,templates:e.templates,translationContext:n?e[t.storeKey].filters.getIn(["documentTypes",0]):null}}))(m)},50530:(e,t,n)=>{"use strict";n.d(t,{$Q:()=>u,GO:()=>p,by:()=>m,LM:()=>f,sq:()=>i.Z});var o,r=n(98014),i=n(51637),a=n(67294),s=n(37974),l=n(53641);function c(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class d extends a.Component{constructor(e){super(e),this.state={type:"pie"},this.maxPieItems=14,this.assignType=this.assignType.bind(this),this.typeButton=this.typeButton.bind(this)}assignType(e){return()=>{this.setState({type:e})}}clusterResults(e){return e.reduce(((e,t,n)=>{const o=e;return n<this.maxPieItems&&o.push(t),n===this.maxPieItems&&o.push({label:(0,l.t)("System","Other"),results:t.results}),n>this.maxPieItems&&(o[o.length-1].results+=t.results),o}),[])}typeButton(e){return c("button",{className:"btn btn-sm "+(this.state.type===e?"btn-success":"btn-default"),onClick:this.assignType(e)},void 0,c("i",{className:`fa fa-${e}-chart`}))}render(){if(!this.props.options)return null;const e="pie"===this.state.type?c(m,{data:this.clusterResults(this.props.options)}):c(u,{data:this.props.options,chartLabel:this.props.label});return c("div",{className:"item item-chart"},void 0,c("div",{},void 0,c("div",{className:"item-chart-type"},void 0,this.typeButton("pie"),this.typeButton("bar")),c("p",{},void 0,this.props.label),e))}}d.defaultProps={options:[],label:null};const p=(0,s.connect)()(d);n(78677),n(96954);const u=(0,r.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(157),n.e(644)]).then(n.bind(n,94415)))),m=((0,r.ZP)((async()=>Promise.all([n.e(481),n.e(317)]).then(n.bind(n,71107)))),(0,r.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(931),n.e(555)]).then(n.bind(n,58942))))),f=(0,r.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(157),n.e(221)]).then(n.bind(n,51749))))},51637:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});n(67294);var o,r=n(53641),i=n(6936);function a(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const s=(e,t)=>e.label.toLowerCase().localeCompare(t.label.toLowerCase()),l=(e,t)=>t.filtered.doc_count-e.filtered.doc_count,c=(e,t,n,o)=>(e.sort(t),n===o?e.reverse():e),d={sortValues:e=>(e.sort(((e,t)=>!e.others&&!t.others&&(e.results===t.results?s(e,t):t.results-e.results))),e),formatPayload:e=>e.map(((e,t)=>({value:e.name,type:"rect",color:i.Z[t%i.Z.length],formatter:()=>a("span",{style:{color:"#333"}},void 0,e.name)}))),formatDataForChart:(e,t,n)=>{const{maxCategories:o,aggregateOthers:i=!1,labelsMap:a={},sort:d,context:p}=n,u=((e,t)=>{const{excludeZero:n,pluckCategories:o=[]}=t;let r=e.filter((e=>"missing"!==e.key&&"any"!==e.key));return n&&(r=r.filter((e=>0!==e.filtered.doc_count))),o.length&&(r=o.reduce(((e,t)=>{const n=r.find((e=>e.label===t));return n&&e.push(n),e}),[])),r})(e.toJS(),n),m=((e,{by:t="result",order:n}={})=>"result"===t?c(e,l,n,"asc"):"label"===t?c(e,s,n,"desc"):e)(u,d);let f=m;return Number(o)&&(f=((e,t,n)=>{const o=e.slice(0,Number(t));return n&&(o[o.length]=e.slice(Number(t)).reduce(((e,t)=>(e.filtered.doc_count+=t.filtered.doc_count,e)),{others:!0,key:"others",filtered:{doc_count:0}})),o})(m,o,i)),[].concat(...f.map((e=>e.others&&e.filtered.doc_count?{others:!0,id:e.key,label:"others",results:e.filtered.doc_count}:e.label?e.values&&n.scatter?((e,t)=>{const{labelsMap:n={},excludeZero:o,context:i}=t,a=e.values.map((t=>({id:t.key,label:n[t.label]||(0,r.t)(i,t.label,null,!1),results:t.filtered.doc_count,parent:n[e.label]||(0,r.t)(i,e.label,null,!1)})));return o?a.filter((e=>0!==e.results)):a})(e,n):{id:e.key,label:a[e.label]||(0,r.t)(p,e.label,null,!1),results:e.filtered.doc_count}:null)).filter((e=>!!e)))}}},6936:(e,t,n)=>{"use strict";n.d(t,{R:()=>r,Z:()=>o});const o=["#0088FE","#00ABC4","#00C49F","#A8C400","#FFBB28","#FF8042","#D24040","#A250B3"],r=["#7fc3fe","#7fd4e1","#7fe1ce","#d3e17f","#ffdc93","#ffbfa0","#e89f9f","#d0a7d8"]},65014:(e,t,n)=>{"use strict";n.d(t,{F1:()=>c,Iy:()=>i,QQ:()=>r,g5:()=>s,m7:()=>l,p3:()=>p,qD:()=>o,sV:()=>d,zO:()=>a});const o="SET_RELATION_TYPE",r="SET_TARGET_DOCUMENT",i="CONNECTION_CREATED",a="OPEN_CONNECTION_PANEL",s="CLOSE_CONNECTION_PANEL",l="SEARCHING_CONNECTIONS",c="CREATING_CONNECTION",d="CREATING_RANGED_CONNECTION",p="CANCEL_RANGED_CONNECTION"},18719:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o,r=n(67294),i=n(74371),a=n(76395);function s(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class l extends r.Component{render(){const e=s("div",{className:"cs-loader-container"},void 0," ",s(a.Z,{})),t=this.props.results.toJS().map(((e,t)=>s("div",{className:"item "+(this.props.selected===e.sharedId?"is-selected":""),onClick:()=>this.props.onClick(e.sharedId,e)},t,s("div",{className:"item-info"},void 0,s("div",{className:"item-name"},void 0,s(i.JO,{className:"item-icon item-icon-center",data:e.icon}),e.title)),s("div",{className:"item-actions"},void 0,s(i.L2,{template:e.template})))));return s("div",{},void 0,this.props.searching?e:"",s("div",{className:"item-group"},void 0,t))}}const c=l},11062:(e,t,n)=>{"use strict";n.d(t,{CJ:()=>U,Nw:()=>r,Aw:()=>o});var o={};n.r(o),n.d(o,{sR:()=>m,Yp:()=>u,w2:()=>f});var r={};n.r(r),n.d(r,{immediateSearch:()=>N,saveConnection:()=>j,search:()=>P,selectRangedTarget:()=>I,setRelationType:()=>k,setTargetDocument:()=>_,startNewConnection:()=>C});var i=n(74127),a=n(37974),s=n(67294),l=n(72027),c=n(92348),d=n(53641),p=n(65014);function u(e,t){return{type:p.zO,sourceDocument:t,connectionType:e}}function m(){return{type:p.g5}}function f(){return{type:p.m7}}var h=n(80129),v=n.n(h),y=n(59511),b=n(39263),g=n(38562),S=n(37265),w=n(98373);function N(e,t,n){e(f());const o=new w.K(v().stringify({filter:{searchString:t?`title:(${t})`:void 0},fields:["title","template","sharedId","documents._id"]}));return g.Z.get("v2/entities",o).then((({json:{data:t}})=>{let o=t;"targetRanged"===n&&(o=o.filter((e=>e.documents&&e.documents.length))),e(y.N.set("connections/searchResults",o))}))}const O=(0,S.Z)(N,400);function P(e,t){return n=>(n(y.N.set("connections/searchTerm",e)),O(n,e,t))}function C(e,t){return n=>N(n,"",e).then((()=>{n(y.N.set("connections/searchTerm","")),n(u(e,t))}))}function k(e){return{type:p.qD,template:e}}function _(e){return{type:p.QQ,id:e}}function j(e,t=(()=>{})){return(n,o)=>{n({type:p.F1}),"basic"!==e.type&&(e.language=o().locale),delete e.type;const r={entity:e.sourceDocument,template:null,reference:e.sourceRange,file:e.sourceFile},i={entity:e.targetDocument,template:e.template};e.targetRange&&Object.assign(i,{reference:e.targetRange,file:e.targetFile});const a={delete:[],save:[[r,i]]};return g.Z.post("relationships/bulk",new w.K(a)).then((e=>{n({type:p.Iy}),t(e.json),n(b.J.notify("saved successfully !","success"))}))}}function I(e,t){return n=>{n({type:p.sV}),t(e.targetDocument)}}var D;n(43393);function T(e,t,n,o){D||(D="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:D,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class E extends s.Component{onClick(e,t){e&&("save"===this.props.action&&this.props.saveConnection(t,this.props.onCreate),"connect"===this.props.action&&this.props.selectRangedTarget(t,this.props.onRangedConnect))}renderContent(){let e="arrow-right";return this.props.busy&&(e="spinner"),"save"===this.props.action?(e="save",T(d.vN,{},void 0,"Save")):T(l.JO,{icon:e,spin:!!this.props.busy})}render(){const e=this.props.connection.toJS();let t=e.sourceDocument&&e.targetDocument&&e.template;"basic"===this.props.type&&delete e.sourceRange,"basic"!==this.props.type&&(t=t&&e.sourceRange);const n=t&&!this.props.busy;return T("button",{className:"save"===this.props.action?"btn btn-success":"edit-metadata btn btn-success",disabled:!n,type:"button",onClick:this.onClick.bind(this,n,e)},void 0,this.renderContent())}}E.defaultProps={onCreate:()=>{},onRangedConnect:()=>{},type:"",busy:!1};const x=(0,a.connect)((function({connections:e}){return{type:e.connection.get("type"),connection:e.connection,busy:e.uiState.get("creating")||e.uiState.get("connecting")}}),(function(e){return(0,i.bindActionCreators)({saveConnection:j,selectRangedTarget:I},e)}))(E);var A,$=n(69474);function R(e,t,n,o){A||(A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class F extends s.Component{render(){return R($.Z,{value:this.props.searchTerm,onChange:e=>this.props.search(e.target.value,this.props.connectionType)})}}const L=(0,a.connect)((function({connections:e}){return{searchTerm:e.searchTerm}}),(function(e){return(0,i.bindActionCreators)({search:P},e)}))(F);var J,Z=n(18719);function M(e,t,n,o){J||(J="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:J,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class V extends s.Component{renderCheckType(e){return this.props.connection.get("template")===e.get("_id")?M(l.JO,{icon:"check"}):M(l.JO,{icon:["far","square"]})}render(){const{uiState:e,searchResults:t}=this.props,n=this.props.connection.toJS(),o="basic"===n.type?"Connection":"Reference",r=Boolean(this.props.uiState.get("open")&&this.props.containerId===n.sourceDocument),i=`${this.props.className} create-reference`;return M(c.Z,{open:r,className:i},void 0,M("div",{className:"sidepanel-header"},void 0,M("h1",{},void 0,M(d.vN,{},void 0,"Create")," ",o),M("button",{className:"closeSidepanel close-modal",onClick:this.props.closePanel,"aria-label":"Close side panel",type:"button"},void 0,M(l.JO,{icon:"times"})),M("div",{className:"connections-list-title"},void 0,M(d.vN,{},void 0,"Select relationship type")),M("ul",{className:"connections-list multiselect"},void 0,this.props.relationTypes.map((e=>M("li",{onClick:()=>this.props.setRelationType(e.get("_id")),className:"multiselectItem"},e.get("_id"),M("label",{className:"multiselectItem-label",htmlFor:e.get("_id")},void 0,M("span",{className:"multiselectItem-icon"},void 0,this.renderCheckType(e)),M("span",{className:"multiselectItem-name"},void 0,e.get("name")))))))),M("div",{className:"sidepanel-footer"},void 0,M("div",{className:"btn-cluster content-right"},void 0,M("button",{className:"btn btn-default",onClick:this.props.closePanel,"aria-label":"Close side panel",type:"button"},void 0,M(d.vN,{},void 0,"Cancel")),"targetRanged"!==n.type&&M(x,{action:"save",onCreate:e=>{this.props.onCreate(e)}}),"targetRanged"===n.type&&M(x,{action:"connect",onRangedConnect:this.props.onRangedConnect}))),M("div",{className:"sidepanel-body"},void 0,M("div",{className:"search-box"},void 0,M(L,{connectionType:n.type})),M(Z.Z,{results:t,searching:e.get("searching"),selected:n.targetDocument,onClick:this.props.setTargetDocument})))}}const U=(0,a.connect)((({connections:e,relationTypes:t})=>({uiState:e.uiState,connection:e.connection,searchResults:e.searchResults,relationTypes:t})),(function(e){return(0,i.bindActionCreators)({setRelationType:k,setTargetDocument:_,closePanel:m},e)}))(V)},96739:(e,t,n)=>{"use strict";n.r(t),n.d(t,{connectionsChanged:()=>v,deleteConnection:()=>y,loadAllReferences:()=>b,loadMoreReferences:()=>g,resetSearch:()=>w,search:()=>f,searchReferences:()=>h,setFilter:()=>S,switchView:()=>N});var o=n(59511),r=n(79223),i=n(39263),a=n(65969),s=n(43393),l=n(71182),c=n(98373),d=n(11954);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){const{sharedId:t,sort:n,filters:o}=e.data,r=e.data.search&&e.data.search.searchTerm?e.data.search.searchTerm.value:"";let i=u({sharedId:t},n);return o&&(i=u(u(u({sharedId:t},n),o.toJS()),{},{searchTerm:r})),a.Z.search(e.onlyHeaders().add(i))}function h(){return async(e,t)=>{const n=t().relationships.list,r=await f(new c.K(n));e(o.N.set("relationships/list/searchResults",r)),e(d.$1("connections"))}}function v(){return(e,t)=>{const n=t().relationships.list,{sharedId:i}=n;return a.Z.getGroupedByConnection(new c.K({sharedId:i})).then((e=>{const o=e.reduce(((e,t)=>e.concat(t.templates.map((e=>e._id.toString())))),[]),r=l.Z.get({currentCriteria:n.sort,filteredTemplates:o,templates:t().templates});return Promise.all([e,r])})).then((([n,i])=>(e(o.N.set("relationships/list/connectionsGroups",n)),e(r.Nw.merge("relationships/list.sort",i)),h()(e,t))))}}function y(e){return async(t,n)=>(await a.Z.delete(new c.K({_id:e._id})),t(i.J.notify("Connection deleted","success")),v()(t,n))}function b(){return async(e,t)=>{const n=t().relationships.list;return e(o.N.set("relationships/list/filters",n.filters.set("limit",9999))),h()(e,t)}}function g(e){return function(t,n){const r=n().relationships.list;return t(o.N.set("relationships/list/filters",r.filters.set("limit",e))),h()(t,n)}}function S(e){return function(t,n){const r=n().relationships.list,i=(r.filters.get("filter")||(0,s.fromJS)({})).merge(e);return t(o.N.set("relationships/list/filters",r.filters.set("filter",i))),h()(t,n)}}function w(){return function(e,t){return e(r.Nw.change("relationships/list/search.searchTerm","")),e(o.N.set("relationships/list/filters",(0,s.fromJS)({}))),h()(e,t)}}function N(e){return function(t,n){if(t(o.N.set("relationships/list/view",e)),"graph"===e)return b()(t,n)}}},32211:(e,t,n)=>{"use strict";n.d(t,{Bc:()=>ne,Z8:()=>q,wQ:()=>m,Nw:()=>d});n(69558);var o,r=n(67294),i=n(37974),a=n(74127),s=n(55316),l=n(53641),c=n(72027),d=n(96739);function p(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class u extends r.Component{render(){const{connectionsGroups:e}=this.props;return p(s.Z,{if:Boolean(e.size)},void 0,p("button",{type:"button",onClick:this.props.resetSearch,className:"btn btn-default"},void 0,p(c.JO,{icon:"times"}),p("span",{className:"btn-label"},void 0,p(l.vN,{},void 0,"Clear Filters"))))}}const m=(0,i.connect)((function({relationships:e}){return{connectionsGroups:e.list.connectionsGroups}}),(function(e){return(0,a.bindActionCreators)({resetSearch:d.resetSearch},e)}))(u);var f,h=n(43393),v=n(79223),y=n(37265);function b(e,t,n,o){f||(f="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:f,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends r.Component{constructor(e){super(e),this.changeSearchTerm=(0,y.Z)(this.props.searchReferences,400)}componentDidUpdate(e){this.props.entityId!==e.entityId&&this.resetSearchTerm()}componentWillUnmount(){this.resetSearchTerm()}resetSearchTerm(){this.props.change("relationships/list/search.searchTerm","")}resetSearch(){this.resetSearchTerm(),this.props.searchReferences()}render(){const{search:e}=this.props,t=e.searchTerm&&e.searchTerm.value?e.searchTerm.value:"";return b("div",{className:"search-box"},void 0,b(v.l0,{model:"relationships/list/search",onSubmit:this.props.searchReferences,autoComplete:"off"},void 0,b("div",{className:"input-group"+(t?" is-active":"")},void 0,b(v.gN,{model:"relationships/list/search.searchTerm"},void 0,b(c.JO,{icon:"search"}),b("input",{type:"text",placeholder:(0,l.t)("System","Search related entities or documents",null,!1),className:"form-control",onChange:this.changeSearchTerm.bind(this),autoComplete:"off",value:t}),b(c.JO,{icon:"times",onClick:this.resetSearch.bind(this)})))))}}const S=(0,i.connect)((function({relationships:e}){const{entityId:t,search:n}=e.list;return{entityId:t,search:n}}),(function(e){return(0,a.bindActionCreators)({searchReferences:d.searchReferences,change:v.Nw.change},e)}))(g);var w,N=n(52173),O=n(30743),P=n(1194),C=n(38904);function k(e,t,n,o){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _=e=>k("div",{className:"relationship-quote"},void 0,k("span",{className:"quoteIconStart"},void 0,k(c.JO,{icon:"quote-left"})),e,k("span",{className:"quoteIconEnd"},void 0,k(c.JO,{icon:"quote-right"}))),j=({label:e,name:t,value:n})=>k("dl",{className:"item-property-default"},t,k("dt",{},void 0,e),k("dd",{},void 0,Array.isArray(n)?n.map((e=>e.value)).join(", "):n)),I=e=>{const{relationship:t,relationTypes:n,thesauris:o}=e,r=t.getIn(["reference","text"]),i=t.get("metadata");return i&&i.size?((e,t,n,o)=>k("div",{className:"relationship-metadata"},void 0,k("div",{className:"item-metadata"},void 0,C.Z.prepareMetadata(e.toJS(),n,o).metadata.map(j),t&&j({label:(0,l.t)("System","Text"),name:"text",value:_(t)}))))(t,r,n,o):r?(e=>k("div",{className:"relationship-metadata"},void 0,_(e)))(r):null};I.defaultProps={relationship:(0,h.Map)({})};const D=(0,i.connect)((function({relationTypes:e,thesauris:t}){return{relationTypes:e,thesauris:t}}))(I);var T;function E(e,t,n,o){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class x extends r.Component{static renderFigure(){return E("div",{className:"hubRelationship"},"figure",E("figure",{}))}constructor(e){super(e),this.toggelRemoveLeftRelationship=this.props.toggelRemoveLeftRelationship.bind(null,e.index),this.onClick=this.onClick.bind(this)}onClick(e,t){this.props.selectConnection(t)}renderTrashButton(e){return this.props.editing&&E("div",{className:"removeHub"},"toggelRemoveLeftRelationship",E("button",{onClick:this.toggelRemoveLeftRelationship,className:"relationships-icon"},void 0,E(c.JO,{icon:e.get("deleted")?"undo":"trash-alt"})))}renderRelationship(){const{parentEntity:e,hub:t,search:n,editing:o,relationTypes:r,index:i}=this.props,a=t.get("leftRelationship"),s=a.get("range")?a:null;return E("div",{className:"leftRelationshipType "+(t.get("deleted")?"deleted":"")},"leftRelationshipType",!o&&t.getIn(["leftRelationship","template"])&&E("div",{className:"rw-dropdown-list rw-widget"},void 0,E("div",{className:"rw-widget-input rw-widget-picker rw-widget-container no-edit"},void 0,E("div",{className:"rw-input rw-dropdown-list-input no-edit"},void 0,r.find((e=>e._id===t.getIn(["leftRelationship","template"]))).name))),o&&E(P.Z,{valueField:"_id",textField:"name",data:r,value:t.getIn(["leftRelationship","template"]),filter:"contains",onChange:this.props.updateLeftRelationshipType.bind(null,i)}),E("div",{className:"leftDocument "+(t.getIn(["leftRelationship","template"])||o?"":"docWithoutRelationshipType")},void 0,E(O.ZP,{className:"item-collapsed",doc:e,searchParams:n,onClick:this.onClick,targetReference:s})),E(D,{relationship:t.get("leftRelationship")}))}render(){const{hub:e,index:t,parentEntity:n}=this.props;return!!n.get("sharedId")&&r.createElement(r.Fragment,null,this.renderTrashButton(e,t),this.renderRelationship(),x.renderFigure())}}const A=(0,i.connect)((function(e){const{relationships:t}=e;return{parentEntity:t.list.entity,search:t.list.sort,editing:t.hubActions.get("editing"),relationTypes:N.selectRelationTypes(e)}}),(function(e){return(0,a.bindActionCreators)({selectConnection:N.selectConnection,updateLeftRelationshipType:N.updateLeftRelationshipType,toggelRemoveLeftRelationship:N.toggelRemoveLeftRelationship},e)}))(x);var $,R=n(99486);function F(e,t,n,o){$||($="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class L extends r.Component{constructor(e){super(e),this.updateRightRelationshipType=this.updateRightRelationshipType.bind(this),this.toggleRemoveRightRelationshipGroup=this.toggleRemoveRightRelationshipGroup.bind(this),this.toggleRemoveEntity=this.toggleRemoveEntity.bind(this),this.setAddToData=this.setAddToData.bind(this),this.onClick=this.onClick.bind(this)}onClick(e,t){this.props.selectConnection(t)}setAddToData(e,t){return()=>{this.props.setAddToData(e,t),this.props.openAddEntitiesPanel()}}updateRightRelationshipType(e,t){return n=>{this.props.updateRightRelationshipType(e,t,n._id)}}toggleRemoveRightRelationshipGroup(e,t){return()=>{this.props.toggleRemoveRightRelationshipGroup(e,t)}}toggleRemoveEntity(e,t,n){return()=>{this.props.toggleRemoveEntity(e,t,n)}}render(){const{hub:e,index:t,search:n,hubActions:o,relationTypes:r}=this.props,i=o.get("editing");return F("div",{className:"rightRelationships"},void 0,e.get("rightRelationships").map(((a,s)=>F("div",{className:"rightRelationshipsTypeGroup "+(a.get("deleted")?"deleted":"")},s,F("div",{className:"rightRelationshipType\n                             "+(s===e.get("rightRelationships").size-1?"last-of-type":"")},void 0,!i&&F("div",{className:"rw-dropdown-list rw-widget no-edit"},void 0,F("div",{className:"rw-widget-input rw-widget-picker rw-widget-container no-edit"},void 0,F("div",{className:"rw-input rw-dropdown-list-input no-edit"},void 0,r.find((e=>e._id===a.get("template")))?a.get("template")?r.find((e=>e._id===a.get("template"))).name:F(c.JO,{icon:"link"}):null))),i&&F(P.Z,{valueField:"_id",textField:"name",data:r,value:a.get("template"),placeholder:"New connection type",filter:"contains",onChange:this.updateRightRelationshipType(t,s)})),i&&F("div",{className:"removeRightRelationshipGroup"},void 0,(()=>a.has("template")?F("button",{type:"button",onClick:this.toggleRemoveRightRelationshipGroup(t,s),className:"relationships-icon"},void 0,F(c.JO,{icon:a.get("deleted")?"undo":"trash-alt"})):F("span",{},void 0," "))()),a.get("relationships").map(((e,o)=>{if(e.get("moved"))return!1;const r=a.get("deleted"),l=e.get("deleted"),d=e.get("move");return F("div",{className:`rightRelationship ${!r&&l?"deleted":""} ${d?"move":""}`},o,F("div",{className:"rightRelationshipType"},void 0,F(O.ZP,{className:"item-collapsed",doc:e.get("entityData"),searchParams:n,onClick:this.onClick,targetReference:e.get("reference")?e:null}),F(D,{relationship:e})),i&&F("div",{className:"removeEntity"},void 0,F("button",{type:"button",onClick:this.toggleRemoveEntity(t,s,o),className:"relationships-icon"},void 0,F(c.JO,{icon:l?"undo":"trash-alt"}))),i&&F("div",{className:"moveEntity"},void 0,F("button",{type:"button",onClick:this.props.toggleMoveEntity.bind(this,t,s,o),className:"relationships-icon "+(d?"moving":"")},void 0,F(c.JO,{icon:"check"}))))})),(()=>{if(i&&a.has("template")){return F("div",{className:"rightRelationshipAdd"},void 0,F("button",{type:"button",className:"relationships-new "+(o.getIn(["addTo","hubIndex"])===t&&o.getIn(["addTo","rightRelationshipIndex"])===s?"is-active":""),onClick:this.setAddToData(t,s)},void 0,F("span",{},void 0,F(l.vN,{},void 0,"Add entities / documents")),F(c.JO,{icon:"plus"})),F("div",{className:"insertEntities"},void 0,F("button",{type:"button",onClick:this.props.moveEntities.bind(this,t,s),className:"relationships-icon"},void 0,F(c.JO,{icon:"arrow-left"}))))}return null})()))))}}const J=(0,i.connect)((function(e){const{relationships:t}=e;return{search:t.list.sort,hubs:t.hubs,hubActions:t.hubActions,relationTypes:N.selectRelationTypes(e)}}),(function(e){return(0,a.bindActionCreators)({selectConnection:N.selectConnection,updateRightRelationshipType:N.updateRightRelationshipType,toggleRemoveRightRelationshipGroup:N.toggleRemoveRightRelationshipGroup,setAddToData:N.setAddToData,toggleRemoveEntity:N.toggleRemoveEntity,moveEntities:N.moveEntities,toggleMoveEntity:N.toggleMoveEntity,openAddEntitiesPanel:R.Yp},e)}))(L);var Z;function M(e,t,n,o){Z||(Z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class V extends r.Component{componentDidMount(){this.props.parseResults(this.props.searchResults,this.props.parentEntity,this.props.editing)}componentDidUpdate(e){this.props.searchResults!==e.searchResults&&this.props.parseResults(this.props.searchResults,this.props.parentEntity,this.props.editing)}render(){const{hubs:e,addHub:t}=this.props;return M("div",{className:"relationships-graph"},void 0,M("div",{},void 0,e.map(((e,t)=>M("div",{className:"relationshipsHub"},t,M(A,{index:t,hub:e}),M(J,{index:t,hub:e})))),this.props.editing&&M("div",{className:"relationshipsHub"},void 0,M("div",{className:"leftRelationshipType "},void 0,M("button",{type:"button",className:"relationships-new",onClick:t},void 0,M("span",{},void 0,M(l.vN,{},void 0,"New relationships group")),M(c.JO,{icon:"plus"}))))))}}const U=(0,i.connect)((function(e){const{relationships:t}=e;return{parentEntity:t.list.entity,searchResults:t.list.searchResults,search:t.list.sort,hubs:t.hubs,editing:t.hubActions.get("editing")}}),(function(e){return(0,a.bindActionCreators)({parseResults:N.parseResults,addHub:N.addHub},e)}))(V);var z;function K(e,t,n,o){z||(z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const B=(0,i.connect)((({relationships:e})=>({totalHubs:e.list.searchResults.get("totalHubs"),requestedHubs:e.list.searchResults.get("requestedHubs"),loadMoreAmmount:10})),(function(e){return(0,a.bindActionCreators)({action:d.loadMoreReferences},e)}))((({totalHubs:e,requestedHubs:t,action:n,loadMoreAmmount:o})=>{if(t<e){const r=()=>{n(t+o)};return K("div",{className:"text-center"},void 0,K("p",{className:"col-sm-12 text-center documents-counter"},void 0,K("b",{},void 0,t)," ",(0,l.t)("System","of")," ",K("b",{},void 0,e)," ",(0,l.t)("System","hubs")),K("button",{onClick:r,className:"btn btn-default btn-load-more"},void 0,`${o}`," ",(0,l.t)("System","x more")))}return null}));var H=n(48802);const q=(0,i.connect)((function({relationships:e}){const t=e.list.searchResults;return{documents:t,connections:{totalRows:(t.get("rows")||(0,h.fromJS)([])).filter((t=>t.get("sharedId")!==e.list.sharedId)).reduce(((e,t)=>e+t.get("connections").size),0)},filters:(0,h.fromJS)({documentTypes:[]}),search:e.list.sort,sortButtonsStateProperty:"relationships/list.sort",SearchBar:S,GraphView:U,view:"graph",LoadMoreButton:B,connectionsGroups:e.list.connectionsGroups}}),(function(e){return(0,a.bindActionCreators)({searchDocuments:d.searchReferences},e)}))(H.Z);var W;function G(e,t,n,o){W||(W="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:W,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Q extends r.Component{static getDerivedStateFromProps(e,t){return e.group.get("templates").size>t.groupTemplates.size?{selected:!1,groupTemplates:e.group.get("templates")}:{groupTemplates:e.group.get("templates")}}constructor(e){super(e),this.state={expanded:!0,selected:!1,selectedItems:(0,h.fromJS)([]),groupTemplates:(0,h.fromJS)([])}}shouldComponentUpdate(e,t){return!(0,h.is)(this.props.group,e.group)||this.state.expanded!==t.expanded||this.state.selected!==t.selected||this.state.selectedItems.size!==t.selectedItems.size}setGroupFilter(e){const t={};t[this.props.group.get("key")]=e,this.props.setFilter(t)}toggleSelectItem(e){let t,n;this.state.selectedItems.includes(e)&&(n=!1,t=this.state.selectedItems.splice(this.state.selectedItems.indexOf(e),1)),this.state.selectedItems.includes(e)||(t=this.state.selectedItems.push(e),n=t.size===this.props.group.get("templates").size),this.setGroupFilter(t),this.setState({selectedItems:t,selected:n})}toggleSelectGroup(){const{group:e}=this.props,t=this.state.selected?(0,h.fromJS)([]):e.get("templates").map((t=>e.get("key")+t.get("_id")));this.setGroupFilter(t),this.setState((e=>({selected:!e.selected,selectedItems:t})))}toggleExpandGroup(){this.setState((e=>({expanded:!e.expanded})))}render(){const e=this.props.group.toJS(),{connectionLabel:t,templates:n}=e;return G("li",{className:"relationshipFilters"},void 0,G("div",{className:"multiselectItem"},void 0,G("input",{type:"checkbox",className:"form-control multiselectItem-input",id:`group${e.key}`,onChange:this.toggleSelectGroup.bind(this),checked:this.state.selected}),G("label",{htmlFor:`group${e.key}`,className:"multiselectItem-label"},void 0,G("span",{className:"multiselectItem-icon"},void 0,G(c.JO,{icon:["far","square"],className:"checkbox-empty"}),G(c.JO,{icon:"check",className:"checkbox-checked"})),G("span",{className:"multiselectItem-name"},void 0,G("b",{},void 0,e.key?(0,l.t)(e.context,t):(0,l.t)("System","No Label")))),G("span",{className:"multiselectItem-results"},void 0,G("span",{},void 0,e.templates.reduce(((e,t)=>e+t.count),0)),G("span",{className:"multiselectItem-action",onClick:this.toggleExpandGroup.bind(this)},void 0,G(c.JO,{icon:this.state.expanded?"caret-up":"caret-down"})))),G(s.Z,{if:this.state.expanded},void 0,G("ul",{className:"multiselectChild is-active"},void 0,n.map(((t,n)=>G("li",{className:"multiselectItem",title:t.label},n,G("input",{type:"checkbox",className:"multiselectItem-input",id:e.key+t._id,onChange:this.toggleSelectItem.bind(this,e.key+t._id),checked:this.state.selectedItems.includes(e.key+t._id)}),G("label",{className:"multiselectItem-label",htmlFor:e.key+t._id},void 0,G("span",{className:"multiselectItem-icon"},void 0,G(c.JO,{icon:["far","square"],className:"checkbox-empty"}),G(c.JO,{icon:"check",className:"checkbox-checked"})),G("span",{className:"multiselectItem-name"},void 0,(0,l.t)(t._id,t.label))),G("span",{className:"multiselectItem-results"},void 0,t.count)))))))}}const Y=(0,i.connect)(null,(e=>(0,a.bindActionCreators)({setFilter:d.setFilter},e)))(Q);var X;function ee(e,t,n,o){X||(X="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:X,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class te extends r.Component{render(){const{connectionsGroups:e}=this.props;let t=ee("div",{className:"blank-state"},void 0,ee(c.JO,{icon:"exchange-alt"}),ee("h4",{},void 0,(0,l.t)("System","No Relationships")),ee("p",{},void 0,(0,l.t)("System","No Relationships description")));return e.size&&(t=ee("div",{},void 0,ee("div",{className:"nested-selector"},void 0,ee("ul",{className:"multiselect is-active"},void 0,e.map((e=>ee(Y,{group:e},e.get("key")))))))),t}}const ne=(0,i.connect)((function({relationships:e}){return{connectionsGroups:e.list.connectionsGroups}}))(te)},69558:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(74127),r=n(79223),i=n(59511),a=n(71182);const s=(0,o.combineReducers)({entityId:(0,i.Z)("connectionsList/entityId",""),entity:(0,i.Z)("connectionsList/entity",{}),connectionsGroups:(0,i.Z)("connectionsList/connectionsGroups",[]),searchResults:(0,i.Z)("connectionsList/searchResults",{totalRows:0,rows:[]}),sort:(0,r.sZ)("connectionsList.sort",a.Z.get()),filters:(0,i.Z)("connectionsList/filters",{}),search:(0,r.aB)("connectionsList/search"),view:(0,i.Z)("connectionsList/view","graph")})},14003:(e,t,n)=>{"use strict";n.d(t,{m:()=>r,v:()=>o});const o="OPEN_MENU",r="CLOSE_MENU"},58010:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o;n(67294);function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const i=e=>{let t=`${e.className} form-group`;return e.pristine&&!e.submitFailed||!1!==e.valid||(t+=" has-error"),r("div",{className:t},void 0,e.children)};i.defaultProps={className:""};const a=i},19914:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(38562),r=n(2080);const i={get:e=>r.Z.get(e),countByTemplate:e=>o.Z.get("documents/count_by_template",e).then((e=>e.json)),uploads:()=>o.Z.get("documents/uploads").then((e=>e.json.rows)),search:e=>o.Z.get("documents/search",e).then((e=>e.json)),list:e=>o.Z.get("documents/list",e).then((e=>e.json.rows)),save:e=>o.Z.post("documents",e).then((e=>e.json)),delete:e=>o.Z.delete("documents",e).then((e=>e.json))}},17676:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(30381),r=n.n(o);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l={performantDocToJSWithoutRelations:e=>e.delete("relations").toJS(),prepareMetadata(e,t,n){const o=t.find((t=>t._id===e.template));if(!o||!n.length)return a(a({},e),{},{metadata:[],documentType:""});const i=o.properties.map((t=>{let o=null;if(e.metadata[t.name]&&e.metadata[t.name][0]&&([{value:o}]=e.metadata[t.name]),"select"===t.type&&o){const e=n.find((e=>e._id===t.content)).values.find((e=>e.id.toString()===o.toString()));o="",e&&(o=e.label)}return"date"===t.type&&o&&(o=r()(o,"X").format("MMM DD, YYYY")),{label:t.label,value:o}}));return a(a({},e),{},{metadata:i,documentType:o.name})}}},3827:(e,t,n)=>{"use strict";n.d(t,{GV:()=>ke,ct:()=>d,Tg:()=>r.Z});var o,r=n(19914),i=n(67294),a=n(79223),s=n(72027);function l(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class c extends i.Component{constructor(e){super(e),this.submit=this.submit.bind(this)}indentButton(e,t){const{indent:n}=this.props;return l("button",{type:"button",onClick:n.bind(null,t,t.indentation+("more"===e?1:-1)),className:`toc-indent-${e} btn btn-default`},void 0,l(s.JO,{icon:"more"===e?"arrow-right":"arrow-left",directionAware:!0}))}submit(e){this.props.onSubmit(e,this.props.file._id)}render(){const{toc:e,model:t,removeEntry:n}=this.props;return l(a.l0,{className:"toc",id:"tocForm",model:t,onSubmit:this.submit},void 0,e.map(((e,o)=>l("div",{className:`toc-indent-${e.indentation}`},o,l("div",{className:"toc-edit"},void 0,this.indentButton("less",e),this.indentButton("more",e),l(a.gN,{model:`${t}[${o}].label`},void 0,l("input",{className:"form-control"})),l("button",{type:"button",onClick:n.bind(this,e),className:"btn btn-danger"},void 0,l(s.JO,{icon:"trash-alt"})))))))}}c.defaultProps={toc:[],removeEntry:()=>{},indent:()=>{},onSubmit:()=>{}};const d=c;var p,u=n(37974),m=n(87496),f=n(43393),h=n.n(f),v=n(55316),y=n(53641);function b(e,t,n,o){p||(p="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:p,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends i.Component{scrollTo(e,t){t.preventDefault(),this.props.scrollToToc(e.toJS())}render(){const e=h().fromJS(this.props.toc);return e.size?b("div",{className:"toc"},void 0,b("ul",{className:"toc-view"},void 0,e.map(((e,t)=>b("li",{className:`toc-indent-${e.get("indentation")}`},t,b(v.Z,{if:!this.props.readOnly},void 0,b("a",{className:"toc-view-link",href:"#",onClick:this.scrollTo.bind(this,e)},void 0,e.get("label"),b("span",{className:"page-number"},void 0,e.getIn(["selectionRectangles",0]).get("page")))),b(v.Z,{if:this.props.readOnly},void 0,b("span",{className:"toc-view-link"},void 0,e.get("label")))))))):b("div",{className:"blank-state"},void 0,b(s.JO,{icon:"font"}),b("h4",{},void 0,(0,y.t)("System","No Table of Contents")),b("p",{},void 0,(0,y.t)("System","No Table of Contents description")))}}g.defaultProps={toc:[]};const S=(0,u.connect)(null,(function(){return{scrollToToc:m.G8}}))(g);var w,N=n(28151),O=n(52786),P=n(45697),C=n.n(P),k=n(55505),_=n(65879),j=n(52949),I=n(99052),D=n(74127),T=n(74371),E=n(32368),x=n(22222),A=n(17676);function $(e,t,n,o){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const R=(0,x.P1)((e=>e.documentViewer.targetDoc),(e=>e.documentViewer.doc),((e,t)=>e.get("_id")?A.Z.performantDocToJSWithoutRelations(e):A.Z.performantDocToJSWithoutRelations(t)));class F extends i.Component{clickReference(e){this.props.readOnly||(this.props.targetDoc||this.props.activateReference(e,this.props.referencesSection),this.props.targetDoc&&void 0!==e.reference&&this.props.selectReference(e))}deleteReference(e){this.context.confirm({accept:()=>{this.props.deleteReference(e)},title:"Confirm delete connection",message:"Are you sure you want to delete this connection?"})}relationType(e){const t=this.props.relationTypes.find((t=>t.get("_id")===e));if(t)return t.name}render(){const{reference:e}=this.props;let t="";const n=this.props.targetDoc&&void 0===e.reference;this.props.highlighted&&(t="relationship-hover"),this.props.active&&(t="relationship-active"),this.props.active&&this.props.targetDoc&&this.props.targetRange&&(t="relationship-selected"),this.props.readOnly&&(t="");const o=(0,f.fromJS)(e.associatedRelationship.entityData);return $(T.ck,{onMouseEnter:this.props.highlightReference.bind(null,e._id),onMouseLeave:this.props.highlightReference.bind(null,null),onClick:this.clickReference.bind(this,e),doc:o,noMetadata:!0,className:`${t} item-${e._id} ${n?"disabled":""} ${this.props.readOnly?"readOnly":""}`,"data-id":e._id,additionalText:e.associatedRelationship.reference?e.associatedRelationship.reference.text:null,additionalMetadata:[{label:"Connection type",value:this.relationType(e.template)}],evalPublished:!0,buttons:$("div",{className:"item-shortcut-group"},void 0,$(v.Z,{if:!this.props.targetDoc&&!this.props.readOnly},void 0,$(_.W,{roles:["admin","editor"]},void 0,$("a",{className:"item-shortcut btn btn-default btn-hover-danger delete",onClick:this.deleteReference.bind(this,e)},void 0,$(s.JO,{icon:"trash-alt"})))),$(v.Z,{if:!this.props.targetDoc},void 0,$(y.l3,{to:`/entity/${o.get("sharedId")}`,onClick:e=>e.stopPropagation(),className:"item-shortcut btn btn-default"},void 0,$(s.JO,{icon:"file"}))))})}}F.contextTypes={confirm:C().func},F.defaultProps={targetDoc:!1};const L=(0,u.connect)(((e,t)=>{const{documentViewer:n}=e;return{highlighted:n.uiState.get("highlightedReference")===t.reference._id,active:n.uiState.get("activeReference")===t.reference._id,targetRange:n.uiState.get("reference").get("targetRange"),targetDoc:!!n.targetDoc.get("_id"),relationTypes:n.relationTypes,doc:R(e)}}),(function(e){return(0,D.bindActionCreators)({highlightReference:m.D$,activateReference:m._V,selectReference:m.hy,deleteReference:E.deleteReference},e)}))(F);var J,Z=n(37667);function M(e,t,n,o){J||(J="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:J,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class V extends i.Component{static blankStateMessage(e,t){return M("div",{className:"blank-state"},void 0,M(s.JO,{icon:"sitemap"}),M("h4",{},void 0,(0,y.t)("System",e)),M("p",{},void 0,(0,y.t)("System",t)))}close(){this.props.closePanel(),this.props.deactivateReference()}render(){const e=this.props.references.toJS().sort(((e,t)=>(0,Z.O)(e.reference,t.reference)));return!this.props.loading&&(this.props.references.size||"references"!==this.props.referencesSection?this.props.references.size?M("div",{className:"item-group"},void 0,e.length>299&&M(T.v3,{inline:!0},void 0,M(y.vN,{translationKey:"Text references limit warning"},void 0,"Text references are temporarily limited to a maximum of 300. We are currently working on a fix for this issue.")),(()=>e.map((e=>M(L,{readOnly:this.props.readOnly,reference:e},e._id))))()):V.blankStateMessage("No Connections","No Connections description"):V.blankStateMessage("No References","No References description"))}}const U=(0,u.connect)(null,(function(e){return(0,D.bindActionCreators)({closePanel:m.sR,deactivateReference:m.QB},e)}))(V);var z,K=n(32211),B=n(92348),H=n(9067),q=n(88020);function W(e,t,n,o){z||(z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const G=({fieldSnippets:e,documentViewUrl:t,template:n,searchTerm:o})=>i.createElement(i.Fragment,null,W("li",{className:"snippet-list-item-header metadata-snippet-header"},void 0,W(y.l3,{to:`${t}?searchTerm=${o}`},void 0,(0,q.Z)(e.get("field"),n))),e.get("texts").map(((e,t)=>W("li",{className:"snippet-list-item metadata-snippet"},t,W("span",{},void 0,W(H.Z,{},void 0,e))))));G.defaultProps={searchTerm:""},G.defaultProps={template:void 0};const Q=({selectSnippet:e,documentSnippets:t,documentViewUrl:n,searchTerm:o,selectedSnippet:r})=>i.createElement(i.Fragment,null,W("li",{className:"snippet-list-item-header fulltext-snippet-header"},void 0,(0,y.t)("System","Document contents")),t.map(((t,i)=>W("li",{className:`snippet-list-item fulltext-snippet ${t.get("text")===r.get("text")?"selected":""}`},i,W(y.l3,{onClick:()=>e(t.get("page"),t),to:`${n}?page=${t.get("page")}&searchTerm=${o||""}`},void 0,W("span",{className:"page-number"},void 0,t.get("page")),W("span",{className:"snippet-text"},void 0,W(H.Z,{},void 0,t.get("text")))))))),Y=({snippets:e,documentViewUrl:t,searchTerm:n,selectSnippet:o,template:r,selectedSnippet:i})=>W("ul",{className:"snippet-list"},void 0,e.get("metadata").map((e=>W(G,{fieldSnippets:e,template:r,documentViewUrl:t,searchTerm:n},e.get("field")))),e.get("fullText").size?W(Q,{documentSnippets:e.get("fullText"),documentViewUrl:t,selectSnippet:o,selectedSnippet:i,searchTerm:n}):"");Y.defaultProps={template:void 0};const X=(0,u.connect)(((e,t)=>({template:e.templates.find((e=>e.get("_id")===t.doc.get("template"))),selectedSnippet:e.documentViewer.uiState.get("snippet")})))(Y);var ee,te=n(83668),ne=n(62863);function oe(e,t,n,o){ee||(ee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class re extends i.Component{renderSnippetsList(e,t,n){return oe(X,{doc:h().fromJS(e),documentViewUrl:n,snippets:t,searchTerm:"",selectSnippet:(...e)=>{this.props.selectSnippet(...e)}})}renderFilter(){const{threshold:e}=this.props;return oe("dl",{className:"metadata-type-text"},void 0,oe("dt",{className:"item-header"},void 0,oe(y.vN,{},void 0,"Threshold")," ",(100*e).toFixed(2)," %"),oe("dd",{},void 0,oe(a.l0,{model:"semanticSearch.resultsFilters"},void 0,oe(te.Bc,{model:".threshold",min:.3,max:1,step:.01,delay:200,minLabel:(0,y.t)("System","Exploration"),maxLabel:(0,y.t)("System","Precision")}))))}render(){const{doc:e,threshold:t,template:n}=this.props;if(!e.semanticSearch)return!1;const o=((e,t)=>{const n=e.findIndex((({score:e})=>e<t));return n>=0?e.slice(0,n):e})(e.semanticSearch.results,t),r=h().fromJS(((e,t)=>{const n=e.reduce(((e,n)=>{const o=e,r=`${n.text} (${(100*n.score).toFixed(2)}%)`;if(o.count+=1,isNaN(Number(n.page))){const e=t.get("properties").find((e=>e.get("name")===n.page)).get("label");return o.metadata[e]=(o.metadata[e]||[]).concat([r]),o}return o.fullText.push({page:Number(n.page),text:r}),o}),{count:0,metadata:{},fullText:[]});return n.metadata=Object.keys(n.metadata).map((e=>({field:e,texts:n.metadata[e]}))),n})(o,n)),a=e.file?`/document/${e.sharedId}`:`/entity/${e.sharedId}`;return i.createElement(i.Fragment,null,oe("div",{className:"view"},void 0,oe("div",{className:"item-info"},void 0,oe("div",{},void 0,oe(ne.J,{className:"item-icon item-icon-center",data:e.icon}),oe("h1",{className:"item-name"},void 0,e.title,oe(T.lH,{doc:h().fromJS(e)}))),oe(T.L2,{template:e.template})),this.renderFilter(),oe("dl",{className:"metadata-type-numeric"},void 0,oe("dt",{},void 0,oe(y.vN,{},void 0,"Number of sentences above threshold")),oe("dd",{},void 0,o.length)),oe("dl",{className:"metadata-type-numeric"},void 0,oe("dt",{},void 0,oe(y.vN,{},void 0,"% of sentences above threshold")),oe("dd",{},void 0,(o.length/e.semanticSearch.totalResults*100).toFixed(2),"%"))),this.renderSnippetsList(e,r,a))}}re.defaultProps={template:void 0};const ie=(0,u.connect)((({semanticSearch:e,templates:t})=>({threshold:e.resultsFilters.threshold,template:t.find((t=>t.get("_id")===e.selectedDocument.get("template")))})),(function(e){return(0,D.bindActionCreators)({selectSnippet:m.Nt},e)}))(re);var ae,se=n(21667),le=n(17565),ce=n(91285),de=n(41865),pe=n(93673),ue=n(13265),me=n(62787),fe=n(4271);function he(e,t,n,o){ae||(ae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ve extends i.Component{constructor(e){super(e),this.submit=this.submit.bind(this),this.resetSearch=this.resetSearch.bind(this)}componentDidMount(){"documentViewer"===this.props.storeKey&&this.searchSnippets(this.props.searchTerm,this.props.doc.get("sharedId"))}componentDidUpdate(e){e.searchTerm===this.props.searchTerm&&e.doc.get("sharedId")===this.props.doc.get("sharedId")||this.searchSnippets(this.props.searchTerm,this.props.doc.get("sharedId"))}attachDispatch(e){this.formDispatch=e}resetSearch(){}searchSnippets(e,t){t&&(this.props.searchSnippets(e,t,this.props.storeKey),this.formDispatch&&this.formDispatch(a.Nw.change("searchText.searchTerm",e)))}submit(e){const t=O.mW.getCurrentLocation().pathname,{query:n}=O.mW.getCurrentLocation();return n.searchTerm=e.searchTerm,O.mW.push(t+(0,me._k)(n)),this.props.searchSnippets(e.searchTerm,this.props.doc.get("sharedId"),this.props.storeKey)}render(){const{doc:e,snippets:t}=this.props,n=e.get("file")?`/document/${e.get("sharedId")}`:`/entity/${e.get("sharedId")}`;return he("div",{},void 0,he(a.hD,{model:"searchText",onSubmit:this.submit,getDispatch:e=>this.attachDispatch(e),autoComplete:"off"},void 0,"documentViewer"===this.props.storeKey&&he("div",{className:"search-box"},void 0,he("div",{className:"input-group"},void 0,he(a.gN,{model:".searchTerm"},void 0,he(s.JO,{icon:"search"}),he("input",{type:"text",placeholder:(0,y.t)("System","Search related entities or documents",null,!1),className:"form-control",autoComplete:"off","aria-label":(0,y.t)("System","Search text description",null,!1)}),he(s.JO,{icon:"times",onClick:this.resetSearch}))),he(ue.Z,{label:(0,y.t)("System","Search Tips",null,!1),title:(0,y.t)("System","Narrow down your searches",null,!1)},void 0,he(fe.o,{})))),!t.get("count")&&he("div",{className:"blank-state"},void 0,he(s.JO,{icon:"search"}),he("h4",{},void 0,(0,y.t)("System",this.props.searchTerm?"No text match":"Search text")),he("p",{},void 0,(0,y.t)("System",this.props.searchTerm?"No text match description":"Search text description"))),e.size?he(X,{doc:this.props.doc,snippets:t,selectSnippet:this.props.selectSnippet,searchTerm:this.props.searchTerm,documentViewUrl:n}):"")}}ve.defaultProps={searchTerm:"",snippets:{count:0,metadata:[],fullText:[]}};const ye=(0,u.connect)((function(e,t){return{snippets:e[t.storeKey].sidepanel.snippets}}),(function(e){return(0,D.bindActionCreators)({searchSnippets:pe.uO,selectSnippet:m.Nt},e)}))(ve);var be;function ge(e,t,n,o){be||(be="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:be,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Se=(0,u.connect)((function(e,t){return{snippets:e[t.storeKey].sidepanel.snippets}}))((({snippets:e})=>ge("div",{},void 0,ge(s.JO,{icon:"search"}),ge("span",{className:"connectionsNumber"},void 0,e.get("count")?e.get("count"):""),ge("span",{className:"tab-link-tooltip"},void 0,(0,y.t)("System","Search text")))));var we;function Ne(e,t,n,o){we||(we="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:we,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ce extends i.Component{constructor(e){super(e),this.selectTab=this.selectTab.bind(this),this.state={copyFrom:!1,copyFromProps:[]},this.toggleCopyFrom=this.toggleCopyFrom.bind(this),this.onCopyFromSelect=this.onCopyFromSelect.bind(this),this.deleteDocument=this.deleteDocument.bind(this),this.toggleSharing=this.toggleSharing.bind(this)}componentDidUpdate(e){this.props.doc.get("_id")&&e.doc.get("_id")!==this.props.doc.get("_id")&&this.props.getDocumentReferences&&this.props.getDocumentReferences(this.props.doc.get("sharedId"),this.props.file._id,this.props.storeKey)}onCopyFromSelect(e){this.setState({copyFromProps:e})}getDefaultDocumentToC(e,t,n,o){let r=this.props.file.toc;if(!e){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},(0,de.K)(t,n,o));e&&(r=e.toc)}return r}deleteDocument(){this.context.confirm({accept:()=>{this.props.deleteDocument(this.props.doc.toJS()).then((()=>{O.mW.getCurrentLocation().pathname.match(/library|uploads|^\/$|^\/..\/$/)||O.mW.goBack()}))},title:"Confirm",message:"Are you sure you want to delete this item?"})}selectTab(e){this.props.showTab(e)}_close(){this.props.resetForm(this.props.formPath),this.props.closePanel(),this.setState({copyFrom:!1})}close(){this.props.formDirty?this.context.confirm({accept:()=>{this._close()},title:"Confirm",message:"All changes will be lost, are you sure you want to proceed?"}):this._close()}toggleCopyFrom(){this.setState((e=>({copyFrom:!e.copyFrom})))}toggleSharing(){this.setState((e=>({sharing:!e.sharing})))}renderHeader(e,t,n){if(this.state.copyFrom)return Ne("div",{className:"sidepanel-header"},void 0,Ne(y.vN,{},void 0,"Copy properties to this entity from"),":");const{excludeConnectionsTab:o,connectionsGroups:r,isTargetDoc:i,references:a}=this.props,l=r.reduce(((e,t)=>(t.get("templates").forEach((t=>{e.totalConnections+=t.get("count")})),e)),{totalConnections:0});return Ne("div",{className:"sidepanel-header"},void 0,Ne("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.close.bind(this),"aria-label":"Close side panel"},void 0,Ne(s.JO,{icon:"times"})),Ne(N.mQ,{selectedTab:e,renderActiveTabContentOnly:!0,handleSelect:this.selectTab},void 0,Ne("ul",{className:"nav nav-tabs"},void 0,(()=>{if(!this.props.raw&&t.get("semanticSearch"))return Ne("li",{},void 0,Ne(N.fK,{to:"semantic-search-results",role:"button",tabIndex:"0","aria-label":(0,y.t)("System","Semantic search results",null,!1),component:"div"},void 0,Ne(s.JO,{icon:"flask"}),Ne("span",{className:"tab-link-tooltip"},void 0,Ne(y.vN,{},void 0,"Semantic search results"))))})(),(()=>{if(!this.props.raw)return Ne("li",{},void 0,Ne(N.fK,{to:"text-search",role:"button",tabIndex:"0","aria-label":(0,y.t)("System","Search text",null,!1),component:"div"},void 0,Ne(Se,{storeKey:this.props.storeKey})))})(),(()=>n||this.props.raw?Ne("span",{}):Ne("li",{},void 0,Ne(N.fK,{to:"toc",role:"button",tabIndex:"0","aria-label":(0,y.t)("System","Table of Contents",null,!1),component:"div"},void 0,Ne(s.JO,{icon:"font"}),Ne("span",{className:"tab-link-tooltip"},void 0,(0,y.t)("System","Table of Contents")))))(),(()=>n||this.props.raw?Ne("span",{}):Ne("li",{},void 0,Ne(N.fK,{to:"references",role:"button",tabIndex:"0","aria-label":(0,y.t)("System","References",null,!1),component:"div"},void 0,Ne(s.JO,{icon:"sitemap"}),Ne("span",{className:"connectionsNumber"},void 0,a.size),Ne("span",{className:"tab-link-tooltip"},void 0,(0,y.t)("System","References")))))(),(()=>this.props.raw?Ne("span",{}):Ne("li",{className:"tab-separator"}))(),Ne("li",{},void 0,Ne(N.fK,{to:"metadata",default:!0,role:"button",tabIndex:"0","aria-label":(0,y.t)("System","Info",null,!1),component:"div"},void 0,Ne(s.JO,{icon:"info-circle"}),Ne("span",{className:"tab-link-tooltip"},void 0,(0,y.t)("System","Info")))),(()=>{if(!i&&!o)return Ne("li",{},void 0,Ne(N.fK,{to:"connections",role:"button",tabIndex:"0","aria-label":(0,y.t)("System","Connections",null,!1),component:"div"},void 0,Ne(s.JO,{icon:"exchange-alt"}),Ne("span",{className:"connectionsNumber"},void 0,l.totalConnections),Ne("span",{className:"tab-link-tooltip"},void 0,(0,y.t)("System","Connections"))))})())))}render(){const{doc:e,docBeingEdited:t,readOnly:n,references:o,EntityForm:r,isTargetDoc:i,relationships:a,defaultLanguage:l}=this.props,c=this.props.tocFormComponent,d=A.Z.performantDocToJSWithoutRelations(e),{attachments:p,documents:u,language:m,defaultDoc:f}=d,h=!u||!u.length,b=h||!f?this.getDefaultDocumentToC(h,u,m,l):f.toc;this.initialTemplateId=e.get("template");const g=h&&("references"===this.props.tab||"toc"===this.props.tab)||!this.props.tab?"metadata":this.props.tab,w=this.state.copyFrom&&t&&"metadata"===g?"metadata-sidepanel two-columns":"metadata-sidepanel";return Ne(B.Z,{open:this.props.open,className:w},void 0,this.renderHeader(g,e,h),Ne(v.Z,{if:!("metadata"!==this.props.tab&&this.props.tab||this.state.copyFrom)},void 0,Ne("div",{className:"sidepanel-footer"},void 0,Ne(k.rJ,{delete:this.deleteDocument,data:this.props.doc,formStatePath:this.props.formPath,entityBeingEdited:t,includeViewButton:!t&&n,storeKey:this.props.storeKey,copyFrom:this.toggleCopyFrom}))),Ne(_.W,{roles:["admin","editor"],orWriteAccessTo:[d]},void 0,"toc"===this.props.tab&&this.props.tocBeingEdited&&Ne("div",{className:"sidepanel-footer"},void 0,Ne("div",{className:"btn-cluster content-right"},void 0,Ne("button",{type:"button",className:"edit-toc btn btn-default",onClick:this.props.leaveEditMode},void 0,Ne("span",{className:"btn-label"},void 0,Ne(y.vN,{},void 0,"Cancel"))),Ne("button",{type:"submit",form:"tocForm",className:"edit-toc btn btn-success"},void 0,Ne("span",{className:"btn-label"},void 0,Ne(y.vN,{},void 0,"Save")))))),Ne(_.W,{roles:["admin","editor"],orWriteAccessTo:[d]},void 0,"toc"===this.props.tab&&!this.props.tocBeingEdited&&!n&&Ne("div",{className:"sidepanel-footer"},void 0,Ne("div",{className:"btn-cluster"},void 0,Ne("button",{type:"button",onClick:()=>this.props.editToc(this.props.file.toc||[]),className:"edit-toc btn btn-default"},void 0,Ne(s.JO,{icon:"pencil-alt"}),Ne("span",{className:"btn-label"},void 0,Ne(y.vN,{},void 0,"Edit"))),Ne(le.BO,{file:this.props.file},void 0,Ne(y.vN,{},void 0,"Mark as Reviewed"))))),Ne("div",{className:"sidepanel-body"},void 0,Ne(N.mQ,{selectedTab:this.props.tab||"metadata"},void 0,Ne(N.I5,{for:"text-search",className:"text-search"},void 0,Ne(ye,{doc:e,storeKey:this.props.storeKey,searchTerm:this.props.searchTerm})),Ne(N.I5,{for:"toc",className:"toc"},void 0,Ne("div",{className:"tocHeader"},void 0,Ne("h1",{},void 0,Ne(y.vN,{},void 0,"Table of contents"))," ",Ne(le.Ot,{file:this.props.file},void 0,Ne(y.vN,{},void 0,"auto-created")," ⓘ")),Ne(v.Z,{if:!this.props.tocBeingEdited},void 0,Ne(S,{toc:b,readOnly:n})),Ne(v.Z,{if:this.props.tocBeingEdited},void 0,Ne(c,{removeEntry:this.props.removeFromToc,indent:this.props.indentTocElement,onSubmit:this.props.saveToc,model:"documentViewer.tocForm",state:this.props.tocFormState,toc:this.props.tocForm,file:this.props.file}))),Ne(N.I5,{for:"metadata",className:"metadata"},void 0,(()=>t&&this.state.copyFrom?Ne("div",{className:"side-panel-container"},void 0,Ne(r,{storeKey:this.props.storeKey,initialTemplateId:this.initialTemplateId,highlightedProps:this.state.copyFromProps}),Ne(se.O,{originalEntity:this.props.formData,templates:this.props.templates,onSelect:this.onCopyFromSelect,formModel:this.props.formPath,onCancel:this.toggleCopyFrom})):t?Ne(r,{storeKey:this.props.storeKey,initialTemplateId:this.initialTemplateId}):Ne("div",{},void 0,Ne(k.$o,{relationships:a,entity:d,showTitle:!0,showType:!0,groupGeolocations:!0}),Ne(I.m,{files:u,storeKey:this.props.storeKey,entity:d}),Ne(j.Fy,{attachments:p,isTargetDoc:i,isDocumentAttachments:Boolean(e.get("file")),parentId:e.get("_id"),parentSharedId:e.get("sharedId"),storeKey:this.props.storeKey,entity:d})))()),Ne(N.I5,{for:"references",className:"references"},void 0,Ne(U,{referencesSection:"references",references:o,readOnly:n})),Ne(N.I5,{for:"connections",className:"connections"},void 0,Ne(K.Bc,{})),Ne(N.I5,{for:"semantic-search-results"},void 0,Ne(ie,{doc:d})))))}}Ce.defaultProps={tab:"metadata",open:!1,tocBeingEdited:!1,docBeingEdited:!1,searchTerm:"",references:h().fromJS([]),relationships:h().fromJS([]),tocFormState:{},formDirty:!1,isTargetDoc:!1,readOnly:!1,getDocumentReferences:void 0,tocFormComponent:()=>!1,EntityForm:()=>!1,raw:!1,file:{},leaveEditMode:()=>{}},Ce.contextTypes={confirm:C().func};const ke=(0,u.connect)(((e,t)=>{const n=e.documentViewer.targetDoc.get("_id")?ce.w.selectTargetReferences(e):ce.w.selectReferences(e),o=t.references?ce.w.parseReferences(t.doc,t.references):n,r=e.settings.collection.get("languages").find((e=>e.get("default"))).get("key");return{references:o,excludeConnectionsTab:Boolean(t.references),connectionsGroups:e.relationships.list.connectionsGroups,relationships:t.references,defaultLanguage:r,templates:e.templates,formData:e[t.storeKey].sidepanel.metadata}}))(Ce)},2080:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(38562),r=n(98373);const i={coerceValue:e=>o.Z.post("entities/coerce_value",e).then((e=>e.json)),get(e=new r.K,t=""){const n=e.add({include:e.data&&e.data.include?e.data.include.concat(["permissions"]):["permissions"]});return t&&o.Z.locale(t),o.Z.get("entities",n).then((e=>e.json.rows))},countByTemplate:e=>o.Z.get("entities/count_by_template",e).then((e=>e.json)),getRawPage:async e=>(await o.Z.get("documents/page",e.add({page:e.data.page||1}))).json.data,uploads:()=>o.Z.get("entities/uploads").then((e=>e.json.rows)),search:e=>o.Z.get("entities/search",e).then((e=>e.json)),save:e=>o.Z.post("entities",e).then((e=>e.json)),denormalize:e=>o.Z.post("entity_denormalize",e).then((e=>e.json)),multipleUpdate:e=>o.Z.post("entities/multipleupdate",e).then((e=>e.json)),delete:e=>o.Z.delete("entities",e).then((e=>e.json)),deleteMultiple:e=>o.Z.post("entities/bulkdelete",e).then((e=>e.json))}},88877:(e,t,n)=>{"use strict";n.d(t,{BA:()=>o,V2:()=>r,j6:()=>a,y9:()=>i});const o="SHOW_TAB",r="RESET_USER_SELECTED_TAB",i="SHOW_FILTERS",a="HIDE_FILTERS"},61903:(e,t,n)=>{"use strict";n.d(t,{FU:()=>p,Fx:()=>u,Ks:()=>m,_L:()=>f});var o=n(59511),r=n(2080),i=n(93673),a=n(63978),s=n(39263),l=n(18010),c=n(98373),d=n(79223);function p(e){return async t=>{const{entity:n,errors:r}=await(0,a.o)(e,t);r.length?t(s.J.notify(`Entity saved with the following errors: ${JSON.stringify(r,null,2)}`,"warning")):t(s.J.notify("Entity saved","success")),t(d.Nw.reset("entityView.entityForm")),t(o.N.set("entityView/entity",n)),t(l.Nw.reloadRelationships(n.sharedId))}}function u(){return e=>e(d.Nw.reset("entityView.entityForm"))}function m(e){return async t=>{await r.Z.delete(new c.K({sharedId:e.sharedId})),t(s.J.notify("Entity deleted","success")),t((0,i.Cf)(e)),await t((0,i.HU)(e._id))}}function f(e){return async t=>{await r.Z.deleteMultiple(new c.K({sharedIds:e.map((e=>e.sharedId))})),t(s.J.notify("Deletion success","success")),await t((0,i.jh)()),t((0,i.u$)(e))}}},11954:(e,t,n)=>{"use strict";n.d(t,{$1:()=>r,BP:()=>a,rR:()=>s,tR:()=>i});var o=n(88877);function r(e){return{type:o.BA,tab:e}}function i(){return{type:o.V2}}function a(){return{type:o.j6}}function s(){return{type:o.y9}}},59276:(e,t,n)=>{"use strict";n.d(t,{h:()=>o.Z});var o=n(2080)},82673:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={filterBaseProperties:e=>Object.assign({},...["_id","language","metadata","suggestedMetadata","sharedId","template","title","icon","type","attachments","documents"].map((t=>({[t]:e[t]}))))}},1194:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(72976),r=n.n(o);class i extends(r()){shouldComponentUpdate(e){return this.props.value!==e.value}}},27446:(e,t,n)=>{"use strict";n.d(t,{NU:()=>g,n8:()=>S,lG:()=>y});var o=n(55316),r=n(5804);function i(e,t){return(0,r.Od)(e.toLowerCase()).includes((0,r.Od)(t.toLowerCase()))}function a(e,t,n="label"){return t.filter((t=>i(t[n],e)||t.options&&t.options.some((t=>i(t[n],e)))))}var s,l,c=n(53641),d=n(62863),p=n(67294),u=n(72027);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n,o){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),l=0;l<i;l++)a[l]=arguments[l+3];t.children=a}if(t&&r)for(var c in r)void 0===t[c]&&(t[c]=r[c]);else t||(t=r||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.OFF=0]="OFF",e[e.PARTIAL=1]="PARTIAL",e[e.ON=2]="ON",e[e.GROUP=3]="GROUP"}(l||(l={}));const y={optionsLabel:"label",optionsValue:"value",prefix:"",options:[],filter:"",optionsToShow:5,showAll:!1,hideSearch:!1,showSearch:!1,sort:!1,sortbyLabel:!1,forceHoist:!1,placeholder:"",onChange:e=>{},onFilter:async e=>{},totalPossibleOptions:0,allowSelectGroup:!1};class b extends p.Component{constructor(e){super(e),v(this,"searchInputRef",void 0),this.state={showAll:e.showAll,ui:{},filter:""},this.filter=this.filter.bind(this),this.resetFilter=this.resetFilter.bind(this),this.showAll=this.showAll.bind(this),this.focusSearch=this.focusSearch.bind(this),this.searchInputRef=(0,p.createRef)()}static getDerivedStateFromProps(e){return e.filter?{filter:e.filter}:null}getPartialList(){return[]}getPinnedList(){return[]}getStateValue(e,t,{markGroup:n,conditionValue:o,markOptions:r}){let i=n(e,t);return t.options.forEach((e=>{this.checked(e)!==o&&(i=r(i,e))})),i}getGroupStateValue(e,t){return this.getStateValue(e,t,{markGroup:this.markChecked.bind(this),conditionValue:l.OFF,markOptions:this.markUnchecked.bind(this)})}getOnStateValue(e,t){return this.getStateValue(e,t,{markGroup:this.markUnchecked.bind(this),conditionValue:l.ON,markOptions:this.markChecked.bind(this)})}getOffStateValue(e,t){return this.getStateValue(e,t,{markGroup:this.markUnchecked.bind(this),conditionValue:l.OFF,markOptions:this.markUnchecked.bind(this)})}changeGroup(e,t){const{value:n,allowSelectGroup:o}=this.props,r=parseInt(t.target.dataset.state,10),i={[l.OFF]:this.getOnStateValue,[l.GROUP]:this.getOffStateValue,[l.PARTIAL]:this.getOffStateValue,[l.ON]:o?this.getGroupStateValue:this.getOffStateValue};this.props.onChange(i[r].call(this,n,e))}checked(e){if(!this.props.value)return l.OFF;const t=this.getCheckedList(),n=this.getPartialList();if(e.options){if(t.includes(e[this.props.optionsValue]))return l.GROUP;const o=e.options.reduce(((e,n)=>e+(t.includes(n[this.props.optionsValue])?1:0)),0),r=e.options.reduce(((e,t)=>e+(n.includes(t[this.props.optionsValue])?1:0)),0);return o===e.options.length?l.ON:o+r>0?l.PARTIAL:l.OFF}return t.includes(e[this.props.optionsValue])?l.ON:n.includes(e[this.props.optionsValue])?l.PARTIAL:l.OFF}change(e){let{value:t}=this.props;t=this.checked(e)===l.ON?this.markUnchecked(t,e):this.markChecked(t,e),this.props.onChange(t)}async filter(e){this.setState({filter:e.target.value}),await this.props.onFilter(e.target.value)}async resetFilter(){this.setState({filter:""}),await this.props.onFilter("")}showAll(e){e.preventDefault(),this.setState((e=>({showAll:!e.showAll})))}sort(e,t=!1){const{optionsValue:n,optionsLabel:o}=this.props,r=this.getPinnedList(),i=e.sort(((i,a)=>{const s=this.checked(i)!==l.OFF||r.includes(i[n]),c=this.checked(a)!==l.OFF||r.includes(a[n]);let d=0;this.state.showAll||(d=(c?1:0)-(s?1:0)),0===d&&void 0!==e[0].results&&i.results!==a.results&&(d=(i.results||0)>(a.results||0)?-1:1);const p=this.state.showAll||e.length<this.props.optionsToShow;return(0===d||p||this.props.sortbyLabel||t)&&(d=i[o]<a[o]?-1:1),d}));return this.moveNoValueOptionToBottom(i)}sortOnlyAggregates(e){const{optionsLabel:t}=this.props;if(!e.length||void 0===e[0].results)return e;const n=e.sort(((e,n)=>{let o=(n.results||0)-(e.results||0);return 0===o&&(o=e[t]<n[t]?-1:1),o}));return this.moveNoValueOptionToBottom(n)}moveNoValueOptionToBottom(e){let t=[...e];return["any","missing"].forEach((e=>{const n=t.find((t=>t.id===e));n&&this.checked(n)===l.OFF&&(t=t.filter((t=>t.id!==e)),t.push(n))})),t}hoistCheckedOptions(e){const[t,n]=e.reduce((([e,t],n)=>this.checked(n)!==l.OFF?[e.concat([n]),t]:[e,t.concat([n])]),[[],[]]),o=t.concat(n);return this.moveNoValueOptionToBottom(o)}moreLessLabel(e){const{totalPossibleOptions:t}=this.props,n=t||e.length;return this.state.showAll?h(c.vN,{},void 0,"x less"):h("span",{},void 0,n-this.props.optionsToShow," ",h(c.vN,{},void 0,"x more"))}toggleOptions(e,t){t.preventDefault();const n=e[this.props.optionsValue],{ui:o}=this.state;o[n]=!o[n],this.setState({ui:o})}showSubOptions(e){return this.state.ui[e.id]||this.checked(e)!==l.OFF}label(e){const{optionsValue:t,optionsLabel:n,prefix:o}=this.props;return h("label",{className:"multiselectItem-label",htmlFor:o+e[t]},void 0,h("span",{className:"multiselectItem-icon"},void 0,h(u.JO,{icon:["far","square"],className:"checkbox-empty"}),h(u.JO,{icon:"check",className:"checkbox-checked"}),h(u.JO,{icon:"minus",className:"checkbox-partial"}),h(u.JO,{icon:["fas","square"],className:"checkbox-group"})),h("span",{className:"multiselectItem-name"},void 0,h(d.J,{className:"item-icon",data:e.icon}),e[n]),h("span",{className:"multiselectItem-results"},void 0,e.results&&h("span",{},void 0,e.results),e.options&&h("span",{className:"multiselectItem-action",onClick:this.toggleOptions.bind(this,e)},void 0,h(u.JO,{icon:this.state.ui[e.id]?"caret-up":"caret-down"}))))}focusSearch(){this.searchInputRef.current.focus()}renderGroup(e,t){const{prefix:n}=this.props,r=this.checked(e);return h("li",{className:"multiselect-group"},t,h("div",{className:"multiselectItem"},void 0,h("input",{type:"checkbox",className:"group-checkbox multiselectItem-input",id:n+e.id,onChange:this.changeGroup.bind(this,e),checked:r!==l.OFF,"data-state":r}),this.label(f(f({},e),{},{results:e.results}))),h(o.Z,{if:this.showSubOptions(e)},void 0,h("ul",{className:"multiselectChild is-active"},void 0,e.options.map(((e,n)=>this.renderOption(e,n,t.toString(),r===l.GROUP))))))}renderOption(e,t,n="",o=!1){const{optionsValue:r,optionsLabel:i,prefix:a}=this.props,s=`${n}${t}`;return h("li",{className:"multiselectItem",title:e.title?e.title:e[i]},s,h("input",{type:"checkbox",className:"multiselectItem-input",value:e[r],id:a+e[r],onChange:this.change.bind(this,e),checked:this.checked(e)!==l.OFF,"data-state":this.checked(e),disabled:o}),this.label(e))}renderSearch(){const{placeholder:e,options:t,optionsToShow:n,hideSearch:r,showSearch:i}=this.props;return h("li",{className:"multiselectActions"},void 0,h(o.Z,{if:t.length>n&&!r||i},void 0,h("div",{className:"form-group"},void 0,h(u.JO,{icon:this.state.filter?"times-circle":"search",onClick:this.resetFilter}),p.createElement("input",{ref:this.searchInputRef,className:"form-control",type:"text",placeholder:e||(0,c.t)("System","Search item",null,!1),value:this.state.filter,onChange:this.filter}))))}renderOptionsCount(e,t){const{totalPossibleOptions:n}=this.props;let r=""+(n-t.length);return n>1e3&&(r=`${r}+`),h("li",{className:"multiselectActions"},void 0,h(o.Z,{if:e.length>this.props.optionsToShow},void 0,h("button",{onClick:this.showAll,className:"btn btn-xs btn-default",type:"button"},void 0,h(u.JO,{icon:this.state.showAll?"caret-up":"caret-down"})," ",this.moreLessLabel(e))),n>e.length&&this.state.showAll&&h("div",{className:"total-options"},void 0,r," ",h(c.vN,{},void 0,"more options.")," ",h("button",{onClick:this.focusSearch,type:"button"},void 0,h(c.vN,{},void 0,"Narrow your search"))))}render(){const{optionsLabel:e}=this.props;let t=this.props.options.filter((e=>(e=>!e.options||e.options.length)(e)&&(undefined===e.results||e.results>0||e.options&&e.options.length||this.checked(e))));t=t.map((e=>e.options?f(f({},e),{},{options:e.options.filter((e=>undefined===e.results||e.results>0||this.checked(e)))}):e)),this.state.filter&&(t=a(this.state.filter,t,e));let n=t.slice();const o=!this.state.showAll&&n.length>this.props.optionsToShow;n=this.props.sort?this.sort(n):this.sortOnlyAggregates(n),(this.props.forceHoist||!this.props.sort&&!this.state.showAll)&&(n=this.hoistCheckedOptions(n));let r=n;if(o){const e=n.filter((e=>this.checked(e))).length,t=this.props.optionsToShow>e?this.props.optionsToShow:e;r=n.slice(0,t)}return r=r.map((e=>e.options?f(f({},e),{},{options:this.sort(e.options,!0)}):e)),h("ul",{className:"multiselect is-active"},void 0,this.renderSearch(),!r.length&&h("span",{className:"no-options-message"},void 0,(0,c.t)("System","No options found")),r.map(((e,t)=>e.options?this.renderGroup(e,t):this.renderOption(e,t))),this.renderOptionsCount(n,r))}}v(b,"defaultProps",y);class g extends b{markChecked(e,t){const n=e.slice(0);return n.push(t[this.props.optionsValue]),n}markUnchecked(e,t){const n=t[this.props.optionsValue];return e.includes(n)?e.filter((e=>e!==n)):e}getCheckedList(){return this.props.value||[]}}v(g,"defaultProps",f(f({},y),{},{value:[]}));class S extends b{markChecked(e,t){const n=t[this.props.optionsValue],o=f(f({},e),{},{added:e.added.slice(0),removed:e.removed.slice(0)});return o.removed=e.removed.filter((e=>e!==n)),e.originalFull.includes(n)||e.originalPartial.includes(n)&&e.removed.includes(n)||o.added.push(n),o}markUnchecked(e,t){const n=t[this.props.optionsValue],o=f(f({},e),{},{added:e.added.slice(0),removed:e.removed.slice(0)});return(e.originalFull.includes(n)||e.originalPartial.includes(n))&&o.removed.push(t[this.props.optionsValue]),o.added=e.added.filter((e=>e!==t[this.props.optionsValue])),o}getCheckedList(){const{value:e}=this.props;return e.originalFull.filter((t=>!e.removed.includes(t))).concat(e.added)}getPartialList(){const{value:e}=this.props;return e.originalPartial.filter((t=>!e.removed.includes(t)))}getPinnedList(){const{value:e}=this.props;return e.originalPartial.concat(e.originalFull)}}v(S,"defaultProps",f(f({},y),{},{value:{}}))},66139:(e,t,n)=>{"use strict";n.d(t,{UG:()=>P,Mt:()=>g,C0:()=>T,sV:()=>Ce.Z,cw:()=>Z,Ks:()=>pt,bT:()=>rt,wB:()=>Te,Ai:()=>dt,Lu:()=>G,sd:()=>ne,uh:()=>Nt,gq:()=>be,f0:()=>Oe,NU:()=>M.NU,n8:()=>M.n8,mT:()=>Tt,d_:()=>re,eL:()=>ve,DX:()=>Le,mD:()=>Ue,Bc:()=>Ke,Ph:()=>l,T5:()=>We});var o,r=n(45398),i=n(67294),a=n(53641);function s(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class l extends i.Component{render(){const{options:e,optionsValue:t,optionsLabel:n,placeholder:o,sort:i}=this.props;let l=e;if(i){l=e.reduce(((e,t)=>e&&!t.options),!0)?(0,r.Y)(e,{property:n}):e}const{value:c}=this.props;return s("select",{className:"form-control",onChange:this.props.onChange,value:c},void 0,"`",s("option",{value:""},void 0,(0,a.t)("System",o,null,!1)),"`;",l.map(((e,o)=>{const a=e._id||e.id||o;if(e.options){const o=i?(0,r.Y)(e.options,{property:n}):e.options;return s("optgroup",{label:e.label},a,o.map(((e,o)=>{const r=e._id||e.id||o;return s("option",{value:e[t]},r,e[n])})))}return s("option",{value:e[t]},a,e[n])})))}}l.defaultProps={value:"",optionsValue:"value",optionsLabel:"label",placeholder:"Select...",sort:!1};var c,d=n(37974),p=(n(46804),n(9198)),u=n.n(p),m=n(34530),f=n(76292),h=n(80008),v=n.n(h);function y(e,t,n,o){c||(c="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:c,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class b extends i.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this),(0,p.registerLocale)(e.locale||"en",m[e.locale]||f.Z)}handleChange(e){const{endOfDay:t,useTimezone:n,onChange:o}=this.props;if(e){const r=((e,t,n)=>{const o=v().utc(n);e||o.add(v()(n).utcOffset(),"minutes"),t&&(e?o.local():o.utc()).endOf("day");return o})(n,t,e);o(parseInt(r.locale("en").format("X"),10))}else o(null)}render(){const{locale:e,format:t,useTimezone:n,value:o}=this.props,r="dd/MM/yyyy",i=((e,t)=>{let n=null;const o=1e3*t;if(t){const t=v().utc(o);e||t.subtract(v()(v()(o)).utcOffset(),"minutes"),n=parseInt(t.locale("en").format("x"),10)}return n})(n,o);return y(u(),{dateFormat:t||r,className:"form-control",onChange:this.handleChange,selected:i,locale:e,placeholderText:t||r,isClearable:!0,fixedHeight:!0,showYearDropdown:!0})}}b.defaultProps={value:void 0,endOfDay:!1,locale:"en",format:"dd/MM/yyyy",useTimezone:!1};const g=(0,d.connect)()(b);var S,w=n(38562);function N(e,t,n,o){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class O extends i.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this);const{refresh:t}=this.props;t(this.refresh.bind(this)),this.state={svg:"",id:""}}componentDidMount(){this.refresh()}onChange(e){const{onChange:t}=this.props;t({text:e.target.value,id:this.state.id})}async refresh(){const{remote:e}=this.props,t=e?"remotecaptcha":"captcha",n=await w.Z.get(t);this.setState(n.json)}render(){const{value:e}=this.props,{svg:t}=this.state;return N("div",{className:"captcha"},void 0,N("div",{dangerouslySetInnerHTML:{__html:t}}),N("input",{className:"form-control",onChange:this.onChange,value:e.text}))}}O.defaultProps={value:{text:"",id:""},refresh:()=>{},remote:!1};const P=O;var C;function k(e,t,n,o){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class D extends i.Component{onChange(e,t){const{value:n,onChange:o}=this.props;o(j(j({},n),{},{[e]:t}))}render(){const{useTimezone:e,locale:t,format:n}=this.props,{value:o}=this.props,{from:r,to:i}=o||{from:null,to:null};return k("div",{},void 0,k("div",{className:"DatePicker__From"},void 0,k(a.vN,{translationKey:'Label date "From"'},void 0,"From:"),k(g,{locale:t,format:n,useTimezone:e,value:r,onChange:e=>this.onChange("from",e)})),k("div",{className:"DatePicker__To"},void 0,k(a.vN,{translationKey:'Label date "to"'},void 0,"To:"),k(g,{locale:t,format:n,useTimezone:e,value:i,endOfDay:!0,onChange:e=>this.onChange("to",e)})))}}D.defaultProps={value:{from:null,to:null},onChange:()=>{},locale:void 0,format:void 0,useTimezone:!1};const T=D;var E,x=n(45697),A=n.n(x),$=n(79223);function R(e,t,n,o){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const F={className:({fieldValue:e})=>{const t=e.$form||e;return t.submitFailed&&!t.valid?"has-error":""}};function L(e){return t=>R("div",{className:`${e} ${t.className}`},void 0,t.children)}class J extends i.Component{render(){if(this.props.model){const e=`form-group ${this.props.className||""}`;return R($.oT.custom,{model:this.props.model,component:L(e),mapProps:F},void 0,this.props.children)}return R("div",{className:`form-group ${this.props.className}`},void 0,this.props.children)}}J.defaultProps={hasError:!1,className:"",model:"",children:A().any};const Z=(0,d.connect)()(J);var M=n(27446),V=n(37265);const U=["lookup","onChange","totalPossibleOptions"];function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},z.apply(this,arguments)}function K(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e){return null!=e}class G extends i.Component{static getDerivedStateFromProps(e){return{totalPossibleOptions:e.totalPossibleOptions}}constructor(e){super(e),this.state={lookupOptions:[],selectedOptions:[],totalPossibleOptions:e.totalPossibleOptions},this.onChange=this.onChange.bind(this),this.onFilter=(0,V.Z)(this.onFilter.bind(this),200)}onChange(e){this.props.onChange(e);const t=this.combineOptions(),n=e.map((e=>t.find((t=>t[this.props.optionsValue]===e)))).filter(W);this.setState({selectedOptions:n})}async onFilter(e){if(e.length){const{options:t,count:n}=await this.props.lookup(e),o=t.map((e=>H(H({},e),{},{[this.props.optionsValue]:e.value,[this.props.optionsLabel]:e.label})));this.setState({lookupOptions:o,totalPossibleOptions:n})}e.length||this.setState({lookupOptions:[],totalPossibleOptions:this.props.totalPossibleOptions})}combineOptions(){return[...this.props.options,...this.state.lookupOptions,...this.state.selectedOptions].filter((e=this.props.optionsValue,(t,n,o)=>o.findIndex((n=>n[e]===t[e]))===n));var e}render(){const e=this.props,{lookup:t,onChange:n,totalPossibleOptions:o}=e,r=K(e,U),a=this.state.totalPossibleOptions;return i.createElement(M.NU,z({},r,{onChange:this.onChange,onFilter:this.onFilter,totalPossibleOptions:a,options:this.combineOptions()}))}}q(G,"defaultProps",H(H({},M.lG),{},{value:[]}));var Q,Y,X=n(94534),ee=n(28151);function te(e,t,n,o){Q||(Q="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Q,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ne extends i.Component{render(){const{rows:e=6,value:t="",onChange:n,showPreview:o=!0}=this.props;return te("div",{className:"markdownEditor"},void 0,te(ee.mQ,{renderActiveTabContentOnly:!0},void 0,te("div",{className:"tab-nav"},void 0,te(ee.fK,{to:"edit",default:!0},void 0,te(a.vN,{},void 0,"Edit")),o&&te(ee.fK,{to:"preview",component:"div"},void 0,te(a.vN,{},void 0,"Preview")),te("a",{className:"tab-link tab-link--help",href:"https://guides.github.com/features/mastering-markdown/",target:"_blank",rel:"noopener noreferrer"},void 0,te(a.vN,{},void 0,"help"))),te(ee.I5,{for:"edit"},void 0,te("textarea",{className:"form-control",rows:e,onChange:n,value:t})),o&&te(ee.I5,{for:"preview",className:"markdownViewer"},void 0,te(X.Z,{html:this.props.htmlOnViewer,markdown:t}))))}}function oe(e,t,n,o){Y||(Y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class re extends i.Component{constructor(e){super(e),this.state={value:this.parseValue(this.props.value)}}parseValue(e=[]){if(!e[0])return"";const t=Object.keys(e[0]).sort();let n=`| ${t.join(" | ")} |\n`;return n+=`| ${t.map((()=>"-")).join(" | ")} |\n`,n+=`${e.map((e=>`| ${t.map((t=>(e[t]||[]).join(","))).join(" | ")}`)).join(" |\n")} |`,n}onChange(e){const t=e.target.value||"";let n=[];if(this.setState({value:t}),t){const e=t.split("\n").filter((e=>e)),o=e[0].split("|").map((e=>e.trim())).filter((e=>e));n=e.splice(2).map((e=>e.split("|").splice(1).reduce(((e,t,n)=>{if(!o[n])return e;const r=t.split(",").map((e=>e.trim())).filter((e=>e));return e[o[n]]=r,e}),{})))}this.props.onChange(n)}render(){return oe(ne,{onChange:this.onChange.bind(this),value:this.state.value})}}var ie,ae,se,le=n(55316),ce=n(8229),de=n(69899),pe=n(72027);function ue(e,t,n,o){ie||(ie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ve extends i.Component{constructor(e){super(e);const t=this.props.value||{};this.state={values:t,filter:""},Object.keys(this.state.values).length||(this.state.values=e.property.nestedProperties.reduce(((e,t)=>(e[t.key]=[],e)),{}))}onChange(e,t){const n=fe(fe({},this.state.values),{},{[e]:t});this.setState({values:n}),this.props.onChange(n)}getOptions(e,t){if(this.props.options)return this.props.options;if(!t.all[this.props.property.name][e])return[];let n=t.all[this.props.property.name][e].buckets;return 1===n.length&&"missing"===n[0].key?[]:(n=n.map((e=>({label:e.key,value:e.key,results:e.filtered.total.filtered.doc_count}))).filter((e=>e.results)),(0,r.Y)(n,{property:"value",treatAs:"dottedList",listTypes:[Number,Number,String]}))}resetFilter(){this.setState({filter:""})}filter(e){this.setState({filter:e.target.value})}selectAnyChange(e,t){const n=fe(fe({},this.state.values),{},{[e]:[],[`${e}any`]:t.target.checked});this.setState({values:n}),this.props.onChange(n)}toggleOptions(e,t){t.preventDefault();const n={};n[e]=!this.state[e],this.setState(n)}render(){const{property:e}=this.props,{locale:t}=de.h.getState(),n=this.props.aggregations?this.props.aggregations.toJS():{};return ue("ul",{className:"multiselect is-active"},void 0,ue("li",{className:"multiselectActions"},void 0,ue("div",{className:"form-group"},void 0,ue(pe.JO,{icon:this.state.filter?"times-circle":"search",onClick:this.resetFilter.bind(this)}),ue("input",{className:"form-control",type:"text",placeholder:(0,a.t)("System","Search item",null,!1),value:this.state.filter,onChange:this.filter.bind(this)}))),(()=>e.nestedProperties.map(((o,r)=>{const i=this.getOptions(o,n);if(!i.length)return!1;const a=ce.Z[o.toLowerCase()]?ce.Z[o.toLowerCase()][`label_${t}`]:o;return ue("li",{},r,ue($.gN,{model:`.filters.${e.name}.properties.${o}.any`},void 0,ue("div",{className:"multiselectItem"},void 0,ue("input",{type:"checkbox",className:"form-control multiselectItem-input",id:o.key,onChange:this.selectAnyChange.bind(this,o)}),ue("label",{htmlFor:o,className:"multiselectItem-label"},void 0,ue("span",{className:"multiselectItem-icon"}),ue("span",{className:"multiselectItem-name",title:a},void 0,ue("b",{},void 0,a))),ue("span",{className:"multiselectItem-results"},void 0,ue("span",{className:"multiselectItem-action",onClick:this.toggleOptions.bind(this,o)},void 0,ue(pe.JO,{icon:this.state[o]?"caret-up":"caret-down"}))))),ue(le.Z,{if:this.state[o]},void 0,ue($.oT,{component:M.NU,model:`.filters.${e.name}.properties.${o}.values`,prefix:e.name+o,options:i,onChange:this.onChange.bind(this,o),showAll:!0,hideSearch:!0,sortbyLabel:!0,filter:this.state.filter})))})))())}}function ye(e,t,n,o){ae||(ae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}ve.defaultProps={value:{},options:void 0};class be extends i.Component{constructor(e){super(e);const t=this.props.value&&this.props.value.length?this.props.value:[null];this.state={values:t}}onChange(e,t){const n=this.state.values.slice();n[e]=t,this.setState({values:n}),this.props.onChange(n)}add(e){e.preventDefault();const t=this.state.values.slice();t.push(null),this.setState({values:t})}remove(e,t){t.preventDefault();const n=this.state.values.slice();n.splice(e,1),this.setState({values:n}),this.props.onChange(n)}render(){return ye("div",{className:"multidate"},void 0,(()=>this.state.values.map(((e,t)=>ye("div",{className:"multidate-item"},t,ye(g,{locale:this.props.locale,format:this.props.format,onChange:this.onChange.bind(this,t),value:e}),ye("button",{type:"button",className:"react-datepicker__delete-icon",onClick:this.remove.bind(this,t)})))))(),ye("button",{type:"button",className:"btn btn-success add",onClick:this.add.bind(this)},void 0,ye(pe.JO,{icon:"plus"})," ",ye(a.vN,{},void 0,"Add date")))}}function ge(e,t,n,o){se||(se="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:se,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Oe extends i.Component{constructor(e){super(e);const t=this.props.value&&this.props.value.length?this.props.value:[{from:null,to:null}];this.state={values:t}}fromChange(e,t){const n=this.state.values.slice();n[e]=we({},n[e]),n[e].from=t,this.setState({values:n}),this.props.onChange(n)}toChange(e,t){const n=this.state.values.slice();n[e]=we({},n[e]),n[e].to=t,this.setState({values:n}),this.props.onChange(n)}add(e){e.preventDefault();const t=this.state.values.slice();t.push({from:null,to:null}),this.setState({values:t})}remove(e,t){t.preventDefault();const n=this.state.values.slice();n.splice(e,1),this.setState({values:n}),this.props.onChange(n)}render(){return ge("div",{className:"multidate"},void 0,(()=>this.state.values.map(((e,t)=>ge("div",{className:"multidate-item"},t,ge("div",{className:"multidate-range"},void 0,ge("div",{className:"DatePicker__From"},void 0,ge(a.vN,{translationKey:'Label date "From"'},void 0,"From:"),ge(g,{format:this.props.format,value:e.from,onChange:this.fromChange.bind(this,t)})),ge("div",{className:"DatePicker__To"},void 0,ge(a.vN,{translationKey:'Label date "to"'},void 0,"To:"),ge(g,{format:this.props.format,value:e.to,endOfDay:!0,onChange:this.toChange.bind(this,t)})),ge("button",{className:"react-datepicker__delete-icon",onClick:this.remove.bind(this,t)}),ge("div",{className:"multidate-range-clear-float"}))))))(),ge("button",{className:"btn btn-success add",onClick:this.add.bind(this)},void 0,ge(pe.JO,{icon:"plus"})," ",ge(a.vN,{},void 0,"Add date")))}}var Pe,Ce=n(1194),ke=n(76386);function _e(e,t,n,o){Pe||(Pe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Pe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const je={display:"inline-block",width:"25px"};class Ie extends i.Component{shouldComponentUpdate(e){return this.props.item._id!==e.item._id}render(){const{item:e}=this.props;let t=_e(a.vN,{},void 0,"No icon / flag");if("Icons"===e.type&&(t=_e("span",{style:je},void 0,_e(pe.JO,{icon:`${e._id}`}))),"Flags"===e.type){const n=`flag-icon flag-icon-${pe.TZ.get(e._id).cca2}`.toLowerCase();t=_e("span",{style:je},void 0,_e("span",{className:n}))}return _e("span",{},void 0,t,e.label)}}function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},De.apply(this,arguments)}Ie.defaultProps={item:void 0};class Te extends i.Component{constructor(e){super(e);const t=[{_id:null,type:"Empty"}].concat(ke.W.map((e=>({_id:e,type:"Icons",label:e})))).concat(Array.from(pe.TZ).map((e=>({_id:e[1].cca3,type:"Flags",label:e[1].label}))));this.state={listOptions:t}}render(){return i.createElement(Ce.Z,De({valueField:"_id",textField:"label",data:this.state.listOptions,valueComponent:Ie,itemComponent:Ie,defaultValue:this.state.listOptions[0],filter:"contains",groupBy:"type"},this.props))}}var Ee,xe,Ae,$e,Re;function Fe(e,t,n,o){Ee||(Ee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Le extends i.Component{onChange(e){const{value:t}=e.target,{onChange:n}=this.props;return n(""!==t?parseFloat(t):"")}render(){const{value:e=""}=this.props,t=null!==e?e:"";return Fe("input",{type:"number",step:"any",className:"form-control",onChange:this.onChange.bind(this),value:t})}}function Je(e,t,n,o){xe||(xe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:xe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Le.defaultProps={value:""};class Ue extends i.Component{constructor(e){super(e);const t=e.value||{};this.state={from:t.from,to:t.to}}onChange(e,t){const n=Me(Me({},this.state),{},{[e]:t});this.setState(n);const{from:o,to:r}=n;this.props.onChange(Me(Me({},""!==o?{from:o}:{}),""!==r?{to:r}:{}))}render(){return Je("div",{},void 0,Je("div",{className:"Numeric__From"},void 0,Je(a.vN,{translationKey:'Label date "From"'},void 0,"From:"),Je(Le,{value:this.state.from,onChange:e=>this.onChange("from",e)})),Je("div",{className:"Numeric__To"},void 0,Je(a.vN,{translationKey:'Label date "to"'},void 0,"To:"),Je(Le,{value:this.state.to,onChange:e=>this.onChange("to",e)})))}}function ze(e,t,n,o){Ae||(Ae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ke extends i.Component{static getDerivedStateFromProps({value:e}){return e?{value:e}:null}constructor(e){super(e),this.state={value:e.value},this.onChange=this.onChange.bind(this)}onChange(e){const{value:t}=e.target;this.setState({value:t});const{delay:n,onChange:o}=this.props;if(n)return clearTimeout(this.timeOut),void(this.timeOut=setTimeout((()=>{o(t?parseFloat(t):null)}),n));o(t?parseFloat(t):null)}renderTickMarksDatalist(){const{min:e,max:t,step:n,prefix:o}=this.props;return ze("datalist",{id:`${o}-tickmarks`},void 0,ze("option",{value:e}),(()=>{const o=[];for(let r=e;r<t;r+=n)o.push(ze("option",{value:r.toFixed(2)},r));return o})(),ze("option",{value:t}))}render(){const{min:e,max:t,step:n,prefix:o,minLabel:r,maxLabel:a}=this.props,{value:s}=this.state;return i.createElement(i.Fragment,null,ze("div",{className:"NumericRangeSlide"},void 0,ze("input",{type:"range",list:`${o}-tickmarks`,min:e,max:t,step:n,onChange:this.onChange,value:s}),ze("div",{className:"NumericRangeSlide-range-labels"},void 0,ze("span",{},void 0,r),ze("span",{},void 0,a))),this.renderTickMarksDatalist())}}function Be(e,t,n,o){$e||($e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$e,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}Ke.defaultProps={onChange:()=>{},value:50,step:5,min:0,max:100,prefix:"",delay:0,minLabel:"",maxLabel:""};class He extends i.Component{change(e){this.props.onChange(e)}checked(e){return e===this.props.value}renderLabel(e){if(this.props.renderLabel)return this.props.renderLabel(e);const{optionsLabel:t}=this.props;return e[t]}render(){const{optionsValue:e,prefix:t,options:n}=this.props;return Be("div",{},void 0,n.map((n=>Be("div",{className:"radio"},n[e],Be("label",{htmlFor:t+n[e]},void 0,Be("input",{type:"radio",value:n[e],id:t+n[e],onChange:this.change.bind(this,n[e]),checked:this.checked(n[e])}),Be("span",{className:"multiselectItem-name"},void 0,this.renderLabel(n)))))))}}function qe(e,t,n,o){Re||(Re="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Re,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}He.defaultProps={optionsLabel:"label",optionsValue:"value",prefix:"",renderLabel:void 0,value:null};const We=({onChange:e,value:t,prefix:n,leftLabel:o=qe(a.vN,{translationKey:"Filters AND operator"},void 0,"AND"),rightLabel:r=qe(a.vN,{translationKey:"Filters OR operator"},void 0,"OR")})=>qe("div",{className:"switcher-wrapper"},void 0,qe("span",{className:t?"is-active":""},void 0,o),qe("input",{id:`${n}switcher`,type:"checkbox",checked:t||!1,onChange:t=>{e(t.target.checked)}}),qe("label",{htmlFor:`${n}switcher`,className:"switcher"}),qe("span",{className:t?"":"is-active"},void 0,r));var Ge,Qe=n(33530);function Ye(e,t,n,o){Ge||(Ge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const nt={lat:"",lon:"",label:""};function ot(e){return"number"==typeof e&&!Number.isNaN(e)}class rt extends i.Component{constructor(e){super(e),this.latChange=this.latChange.bind(this),this.lonChange=this.lonChange.bind(this),this.mapClick=this.mapClick.bind(this),this.clearCoordinates=this.clearCoordinates.bind(this),this.emptyValue=[];const{lat:t,lon:n}=this.getInputValues();this.state={currentLatitude:t,currentLongitude:n}}onChange(e){this.setState({currentLatitude:e.lat,currentLongitude:e.lon});const{onChange:t,value:n}=this.props;if(!ot(e.lat)||!ot(e.lon))return void t(this.emptyValue);const o=n.slice(1);o.unshift(e),t(o)}getInputValues(){const{value:e}=this.props,{lat:t,lon:n,label:o}=e&&e[0]?e[0]:et({},nt);return{lat:t,lon:n,label:o}}latChange(e){let t=e.target.value?parseFloat(e.target.value):"";t=t&&t<-89.99999?-89.99999:t,t=t&&t>90?90:t;const{label:n}=this.getInputValues(),{currentLongitude:o}=this.state;this.onChange({lat:t,lon:o,label:n})}lonChange(e){const t=e.target.value?parseFloat(e.target.value):"",{label:n}=this.getInputValues(),{currentLatitude:o}=this.state;this.onChange({lat:o,lon:t,label:n})}mapClick(e){const{label:t}=this.getInputValues();this.onChange({lat:parseFloat(e.lngLat[1]),lon:parseFloat(e.lngLat[0]),label:t})}clearCoordinates(){this.setState({currentLatitude:"",currentLongitude:""});const{onChange:e}=this.props;e(this.emptyValue)}render(){const{currentLatitude:e,currentLongitude:t}=this.state,n=[];return ot(e)&&ot(t)&&n.push({latitude:parseFloat(e),longitude:parseFloat(t)}),Ye("div",{className:"geolocation form-inline"},void 0,Ye(Qe.D5,{markers:n,onClick:this.mapClick,height:370,autoCenter:!1,mapStyleSwitcher:!0,showControls:!0}),Ye("div",{className:"form-row"},void 0,Ye("div",{className:"form-group half-width"},void 0,Ye("label",{},void 0,Ye(a.vN,{},void 0,"Latitude")),Ye("input",{onChange:this.latChange,className:"form-control",type:"number",id:"lat",value:e,step:"any"})),Ye("div",{className:"form-group half-width"},void 0,Ye("label",{},void 0,Ye(a.vN,{},void 0,"Longitude")),Ye("input",{onChange:this.lonChange,className:"form-control",type:"number",id:"lon",value:t,step:"any"}))),(e||t)&&Ye("div",{className:"clear-field-button"},void 0,Ye("button",{type:"button",onClick:this.clearCoordinates},void 0,Ye(a.vN,{},void 0,"Clear coordinates"))))}}var it;function at(e,t,n,o){it||(it="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:it,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rt.defaultProps={value:[et({},nt)]};class dt extends i.Component{constructor(e){super(e),this.urlChange=this.urlChange.bind(this),this.labelChange=this.labelChange.bind(this)}onChange(e){const{value:t,onChange:n}=this.props,o=lt(lt({},t),e);o.label||o.url?n(o):n(null)}urlChange(e){const t=e.target.value;this.onChange({label:t})}labelChange(e){const t=e.target.value;this.onChange({url:t})}render(){const{value:e}=this.props,{label:t,url:n}=e||{};return at("div",{className:"link form-inline"},void 0,at("div",{className:"form-row"},void 0,at("div",{className:"form-group"},void 0,at("label",{},void 0,at(a.vN,{},void 0,"Label")),at("input",{onChange:this.urlChange,className:"form-control",id:"label",value:t||"",step:"any"})),at("div",{className:"form-group"},void 0,at("label",{},void 0,at(a.vN,{},void 0,"URL")),at("input",{onChange:this.labelChange,className:"form-control",id:"url",value:n||"",step:"any"}))))}}dt.defaultProps={value:{label:"",url:""}};const pt=(0,d.connect)(((e,{model:t})=>({value:(0,$.PD)(e,t)})))((({value:e,children:t})=>t(e)));var ut,mt=n(96486),ft=n(85212),ht=n(46029),vt=n(63977);function yt(e,t,n,o){ut||(ut="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ut,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const wt=(e,t)=>{const n=(e=>(0,mt.isObject)(e)&&e.data?e.data:e)(e),o={originalValue:n,fileURL:n,type:""};/^[a-zA-Z\d_]*$/.test(o.originalValue)&&(o.type="uploadId"),/^https?:\/\//.test(o.originalValue)&&(o.type="webUrl");const r=t.find((e=>o.originalValue===(e.url||e.fileLocalID||`/api/files/${e.filename}`)));return"uploadId"===o.type&&r&&(o.fileURL=(0,ft.JH)(r)),gt(gt({},o),{},{supportingFile:r})},Nt=e=>{const{value:t,onChange:n,type:o,localAttachments:r=[],formModel:s,name:l,multipleEdition:c}=e,[d,p]=(0,i.useState)(!1),u=()=>{n(null)},m=wt(t,r);return(0,i.useEffect)((()=>{m.originalValue&&!m.supportingFile&&"uploadId"===m.type&&u()}),[r]),(0,i.useEffect)((()=>()=>{var e;null!==(e=m.supportingFile)&&void 0!==e&&e.serializedFile&&m.fileURL&&URL.revokeObjectURL(m.fileURL)}),[]),yt("div",{className:"search__filter--selected__media"},void 0,m.fileURL&&(o===ht.v.Image?yt("img",{src:m.fileURL,alt:""}):yt(vt.Z,{config:m.fileURL})),yt("div",{className:"search__filter--selected__media-toolbar"},void 0,yt("button",{type:"button",onClick:()=>p(!0),className:"btn"},void 0,yt(pe.JO,{icon:"plus"})," ",yt(a.vN,{},void 0,t?"Update":"Add file")),m.originalValue&&yt("button",{type:"button",onClick:u,className:"btn"},void 0,yt(pe.JO,{icon:"unlink"}),"  ",yt(a.vN,{},void 0,"Unlink"))),yt(ht.p,{isOpen:d,onClose:()=>{p(!1)},onChange:n,selectedUrl:m.originalValue,attachments:r,type:o,formModel:s,formField:l,multipleEdition:c}))};var Ot,Pt=n(38540),Ct=n(43358);function kt(e,t,n,o){Ot||(Ot="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ot,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _t extends i.Component{static confidenceBlob(e){let t="low";return(null!=e?e:0)>=.75?t="high":(null!=e?e:0)>=.5&&(t="medium"),kt("span",{className:`confidence-bubble ${t}`},void 0,t)}acceptSuggestion(e){const{propertyType:t,selectModel:n,selectValue:o}=this.props;this.props.acceptSuggestion(e,t,n,o)}rejectSuggestion(e,t){t.stopPropagation(),t.preventDefault();const n=(this.props.value||[]).slice(),o=n.findIndex((t=>t.value===e));o<0||(n.splice(o,1),this.props.onChange(n),this.props.notify("The suggestion has been rejected","success",1e3))}render(){const{selectValue:e,value:t}=this.props,n=t.filter((t=>t.value&&!e.includes(t.value)));return n.length?kt("div",{className:"suggestions multiselect"},void 0,kt("b",{className:"suggestions-title"},void 0,kt(a.vN,{},void 0,"Suggestions")," ",kt("span",{},void 0,"(",n.length,")")),n.map((e=>kt("div",{className:"multiselectItem"},e.value,kt("label",{className:"multiselectItem-label",onClick:this.acceptSuggestion.bind(this,e.value)},void 0,kt("span",{className:"multiselectItem-icon"},void 0,kt(pe.JO,{icon:["far","square"],className:"checkbox-empty"})),kt("span",{className:"multiselectItem-name"},void 0,e.label),_t.confidenceBlob(e.suggestion_confidence),kt("div",{className:"multiselectItem-button",onClick:this.rejectSuggestion.bind(this,e.value)},void 0,kt("div",{className:"property-help no-margin"},void 0,kt(a.vN,{},void 0,"Reject"),kt("div",{className:"property-description-top-left"},void 0,kt(a.vN,{},void 0,"Is the suggestion incorrect? Click on 'Reject' and Uwazi will improve on the suggestions it makes"))))))))):null}}var jt,It,Dt;Dt={value:[],selectValue:[]},(It="defaultProps")in(jt=_t)?Object.defineProperty(jt,It,{value:Dt,enumerable:!0,configurable:!0,writable:!0}):jt[It]=Dt;const Tt=(0,d.connect)((function(e,t){let{selectModel:n}=t;n&&"."===n[0]&&(n=`entityView.entityForm${n}`);const o=(0,$.PD)(e,n)||[];return{selectModel:n,selectValue:Array.isArray(o)?o:[o]}}),{acceptSuggestion:function(e,t,n,o){return r=>{switch(t){case Ct.D.multiselect:o.includes(e)||r($.Nw.change(n,[...o,e]));break;case Ct.D.select:o.length&&o[0]===e||r($.Nw.change(n,e))}}},notify:Pt.h})(_t)},234:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>f});var o=n(45697),r=n.n(o),i=n(67294),a=n(37974),s=n(52786);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t=[]){const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return t.forEach((e=>{delete n[e]})),n}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},p.apply(this,arguments)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends i.Component{static navigate(e){s.mW.push(e)}constructor(e){super(e),this.onClick=this.onClick.bind(this)}onClick(e){const{to:t,disabled:n,onClick:o,confirmTitle:r,confirmMessage:i}=this.props;e.preventDefault(),n||o&&(r?this.context.confirm({accept:()=>{o(e),m.navigate(t)},title:r,message:i}):(o(e),m.navigate(t)))}render(){const e=d(this.props,["dispatch","onClick","confirmTitle","confirmMessage"]);return i.createElement(s.rU,p({onClick:this.onClick},e))}}u(m,"defaultProps",{disabled:!1,onClick:e=>{},confirmTitle:"",confirmMessage:""}),u(m,"contextTypes",{confirm:r().func});const f=(0,a.connect)((function({locale:e},t){return{to:`/${e||""}/${t.to}`.replace(/\/+/g,"/")}}))(m)},53641:(e,t,n)=>{"use strict";n.d(t,{K5:()=>$,l3:()=>v.ZP,ju:()=>f,ee:()=>x,vN:()=>N,Vk:()=>j,Nw:()=>o,t:()=>I.Z});var o={};n.r(o),n.d(o,{addLanguage:()=>H,closeInlineEditTranslation:()=>M,deleteLanguage:()=>q,editTranslations:()=>K,importTranslations:()=>z,inlineEditTranslation:()=>Z,resetForm:()=>B,saveTranslations:()=>U,setDefaultLanguage:()=>W,toggleInlineEdit:()=>V});var r,i=n(74127),a=n(37974),s=n(52786),l=n(67294),c=n(72027),d=n(66139);function p(e,t,n,o){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=o;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u=(e,t)=>e.type?p("div",{className:"live-translate"},void 0,p(c.JO,{icon:"circle",className:t?"live-on":"live-off"}),p(N,{},void 0,e.label)):p("span",{},void 0,e.localized_label||e.label);class m extends l.Component{static reload(e){window.location.href=e}render(){const{languages:e,locale:t,location:n,i18nmode:o,toggleInlineEdit:r,user:i}=this.props,{languages:a,selectedLanguage:s,loggedUser:l}=((e,t,n)=>{const o=e.toJS(),r=o.find((e=>e.key===t))||o.find((e=>e.default)),i=n.get("_id")&&"collaborator"!==n.get("role");return i&&o.push({label:"Live translate",key:"livetranslate",type:"livetranslate"}),{languages:o,selectedLanguage:r,loggedUser:i}})(e,t,i);if(n.search.match(/page=/)){const e=n.search.split(/page=\d+|&page=\d+/).join("");n.search="?"===e?"":e}const f=new RegExp(`^/?${t}/|^/?${t}$`),h=n.pathname.replace(f,"/");return 0===e.size?null:e.count()>1||i.size?p("div",{className:`menuNav-I18NMenu ${!1==!l?" only-language":" "} ${1===e.count()?" one-language":" "} `,role:"navigation","aria-label":"Languages"},void 0,!o&&p(d.sV,{data:a,id:"key",defaultValue:s,textField:"localized_label",className:"menuNav-language",itemComponent:({item:e})=>u(e),valueField:"key",valueComponent:({item:e})=>u(e),onSelect:e=>{if("livetranslate"===e.type)r();else{const t=`/${e.key}${h}${h.match("document")?"":n.search}`;m.reload(t)}}}),o&&p("div",{className:"menuNav-language"},void 0,p("button",{className:"singleItem",type:"button",onClick:r,"aria-label":(0,I.Z)("System","Turn off inline translation",null,!1)},void 0,p("div",{className:"live-translate"},void 0,p(c.JO,{icon:"circle",className:o?"live-on":"live-off"}))),p("span",{className:"singleItem"},void 0,p(N,{},void 0,"Live translate")))):p("div",{className:"no-i18nmenu"})}}m.defaultProps={locale:null};const f=(0,s.EN)((0,a.connect)((function(e){return{languages:e.settings.collection.get("languages"),i18nmode:e.inlineEdit.get("inlineEdit"),locale:e.locale,user:e.user}}),(function(e){return(0,i.bindActionCreators)({toggleInlineEdit:V},e)}))(m));var h,v=n(234);function y(e,t,n,o){h||(h="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:h,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class b extends l.Component{render(){const e=this.props.dictionaries.toJS().find((e=>e.locale===this.props.locale))||{values:{}};let t=this.props.children;return t=e.values[t]||t,y("span",{},void 0,t)}}(0,a.connect)((({locale:e,dictionaries:t})=>({locale:e,dictionaries:t})))(b);var g;function S(e,t,n,o){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class w extends l.Component{static resetCachedTranslation(){w.translation=null}constructor(e){super(e),this.onClick=this.onClick.bind(this)}onClick(e){this.props.i18nmode&&(e.stopPropagation(),e.preventDefault(),this.props.edit(this.props.context,this.props.translationKey))}render(){return S("span",{onClick:this.onClick,className:this.props.i18nmode?"translation active":"translation"},void 0,this.props.children)}}w.defaultProps={i18nmode:!1,context:"System",edit:!1,translationKey:""};const N=(0,a.connect)(((e,t)=>{if(!w.translation||w.translation.locale!==e.locale){const t=e.translations.toJS();w.translation=t.find((t=>t.locale===e.locale))||{contexts:[]}}const n=t.context||"System",o=t.translationKey||t.children,r=w.translation.contexts.find((e=>e.id===n))||{values:{}},i="System"===n||!!r.values[t.children];return{translationKey:o,children:r.values[o]||t.children,i18nmode:e.inlineEdit.get("inlineEdit")&&i}}),(function(e){return(0,i.bindActionCreators)({edit:Z},e)}))(w);var O,P=n(79223),C=n(587);function k(e,t,n,o){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _ extends l.Component{constructor(e){super(e),this.submit=this.submit.bind(this),this.cancel=this.cancel.bind(this)}submit(e){let t=this.props.translations.toJS();t=t.map((t=>{const{locale:n}=t,o=t.contexts.find((e=>e.id===this.props.context));return o.values[this.props.value]=e[n],t.contexts=[o],t})),this.props.saveTranslations(t),this.props.close()}cancel(){this.props.close()}render(){const e=this.props.translations.toJS().map((e=>e.locale));return k(C.Z,{isOpen:this.props.isOpen,type:"info"},void 0,k(C.Z.Body,{},void 0,k("h4",{},void 0,k(N,{},void 0,"Translate")),k(P.l0,{model:"inlineEditModel",onSubmit:this.submit,id:"inlineEdit"},void 0,e.map((e=>k(d.cw,{model:`.${e}`},e,k(P.gN,{model:`.${e}`},void 0,k("label",{className:"form-group-label",htmlFor:e},void 0,e,k("input",{id:e,className:"form-control"})))))))),k(C.Z.Footer,{},void 0,k("button",{type:"button",className:"btn btn-default cancel-button",onClick:this.cancel},void 0,(0,I.Z)("System","Cancel",null,!1)),k("button",{type:"submit",form:"inlineEdit",className:"btn confirm-button btn-primary"},void 0,(0,I.Z)("System","Submit",null,!1))))}}_.defaultProps={isOpen:!1};const j=(0,a.connect)((function(e){return{translations:e.translations,isOpen:e.inlineEdit.get("showInlineEditForm"),context:e.inlineEdit.get("context"),value:e.inlineEdit.get("key")}}),(function(e){return(0,i.bindActionCreators)({saveTranslations:U,close:M},e)}))(_);var I=n(60502),D=n(12209),T=n(36651);const E=(e,t)=>Boolean(e.find((e=>e.key===t))),x={getLocale:(e,t,n={})=>((e,t=[])=>E(t,e)?e:null)(e,t)||((e,t)=>e.locale&&E(t,e.locale)?e.locale:null)(n,t)||(e=>(e.find((e=>e.default))||{}).key)(t),saveLocale:e=>{T.C5&&D.t8("locale",e,{expires:3650})}};var A=n(38562);const $={get:e=>A.Z.get("translations",e).then((e=>e.json.rows)),save:e=>A.Z.post("translations",e).then((e=>e.json)),addEntry:e=>A.Z.post("translations/addentry",e).then((e=>e.json)),addLanguage:e=>A.Z.post("translations/languages",e).then((e=>e.json)),deleteLanguage:e=>A.Z.delete("translations/languages",e).then((e=>e.json)),setDefaultLanguage:e=>A.Z.post("translations/setasdeafult",e).then((e=>e.json))};var R=n(38540),F=n(69899),L=n(98373),J=n(13996);function Z(e,t){return n=>{const o=F.h.getState().translations.toJS(),r=o.map((e=>e.locale)).reduce(((n,r)=>{const i=o.find((e=>e.locale===r)).contexts.find((t=>t.id===e));return n[r]=i.values[t]||t,n}),{});n({type:"OPEN_INLINE_EDIT_FORM",context:e,key:t}),n(P.Nw.load("inlineEditModel",r))}}function M(){return e=>{e({type:"CLOSE_INLINE_EDIT_FORM"}),e(P.Nw.reset("inlineEditModel"))}}function V(){return{type:"TOGGLE_INLINE_EDIT"}}function U(e){return t=>{Promise.all(e.map((e=>$.save(new L.K(e))))).then((()=>{R.h((0,I.Z)("System","Translations saved",null,!1),"success")(t)}))}}function z(e,t){return async n=>{try{const o={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},r={context:e},i=await(0,J.c)("translations/import",r,o,t);await n(P.Nw.load("translationsForm",i)),R.h((0,I.Z)(e,"Translations imported.",null,!1),"success")(n)}catch(t){R.h((0,I.Z)(e,t.error,null,!1),"danger")(n)}}}function K(e){return t=>{t(P.Nw.load("translationsForm",e))}}function B(){return e=>{e(P.Nw.reset("translationsForm"))}}function H(e){return t=>$.addLanguage(new L.K(e)).then((()=>{R.h((0,I.Z)("System","New language added",null,!1),"success")(t)}))}function q(e){return t=>$.deleteLanguage(new L.K({key:e})).then((()=>{R.h((0,I.Z)("System","Language deleted",null,!1),"success")(t)}))}function W(e){return t=>$.setDefaultLanguage(new L.K({key:e})).then((()=>{R.h((0,I.Z)("System","Default language change success",null,!1),"success")(t)}))}},60502:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(69899);n(67294);var r,i=n(53641);function a(e,t,n,o){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=o;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const s=(e,t,n,r=!0)=>{if(e||console.warn(`You cannot translate "${t}", because context id is "${e}"`),r)return a(i.vN,{context:e},void 0,t);const l=n||t;if(!s.translation){const e=o.h.getState(),t=e.translations.toJS();s.translation=function(e,t){return e.find((e=>e.locale===t))||{contexts:[]}}(t,e.locale)}const c=function(e,t=""){return e.contexts.find((e=>e.id.toString()===t.toString()))||{values:{}}}(s.translation,e);return function(e,t,n){return e.values[t]||n}(c,t,l)};s.resetCachedTranslation=()=>{s.translation=null};const l=s},48802:(e,t,n)=>{"use strict";n.d(t,{Z:()=>B});var o,r=n(67294),i=n(52786),a=n(62787),s=n(73581),l=n.n(s),c=n(89628),d=n(37974),p=n(74127),u=n(49935),m=n(79223),f=n(53641),h=n(72027),v=n(66139),y=n(43358);function b(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const N=e=>[y.D.text,y.D.date,y.D.numeric,y.D.select].includes(e);class O extends r.Component{constructor(e){super(e),this.changeOrder=this.changeOrder.bind(this)}changeOrder(){const{sort:e,treatAs:t}=this.props.search;this.sort(e,t,"asc"===this.props.search.order?"desc":"asc")}sort(e,t,n){let o=n;t&&!n&&(o="string"===t?"asc":"desc");const r={sort:e,order:o,treatAs:t};this.props.merge(this.props.stateProperty,r);const i=S(S(S({},this.props.search),r),{},{userSelectedSorting:!0});delete i.treatAs,this.props.sortCallback&&this.props.sortCallback({search:i},this.props.storeKey)}validateSearch(){const{search:e}=this.props,t=S({},e);return"_score"!==t.sort||t.searchTerm||(t.sort="creationDate",t.order="desc"),t}render(){const{templates:e}=this.props,t=this.validateSearch(),n=(e=>e.toJS().reduce(((e,t)=>(t.properties.forEach((n=>{if(n.filter&&(N(n.type)||n.inherit&&N(n.inherit.type))&&!e.find((e=>e.name===n.name))){const o=`metadata.${n.name}${n.inherit?".inheritedValue":""}`;e.push({label:n.label,name:n.name,value:o,type:n.type,context:t._id})}})),e)),[]))(e),o=[{label:"Title",value:"title",type:"text",context:"System"},{label:"Date added",value:"creationDate",type:"number",context:"System"},{label:"Date modified",value:"editDate",type:"number",context:"System"}];t.searchTerm&&o.push({label:"Search relevance",value:"_score",type:"number",context:"System"});const r=[...o,...n].map((e=>S(S({},e),{},{label:(0,f.t)(e.context,e.label,void 0,!1)})));return b("div",{className:"sort-buttons"},void 0,b(v.sV,{className:"sort-dropdown",value:t.sort,data:r,valueField:"value",textField:"label",onChange:e=>this.sort(e.value,"text"===e.type||"select"===e.type?"string":"number")}),b("button",{type:"button",disabled:"_score"===t.sort,className:`sorting-toggle ${"_score"===t.sort&&"disabled"}`,onClick:this.changeOrder},void 0,b(h.JO,{icon:"asc"===t.order&&"_score"!==t.sort?"arrow-up":"arrow-down"})))}}const P=(0,d.connect)((function(e,t){let{templates:n}=e;const o=t.stateProperty?t.stateProperty:`${t.storeKey}.search`;t.selectedTemplates&&t.selectedTemplates.count()&&(n=n.filter((e=>t.selectedTemplates.includes(e.get("_id")))));const r=o.split(/[.,/]/).reduce(((e,t)=>-1!==Object.keys(e).indexOf(t)?e[t]:null),e);return{stateProperty:o,search:r,templates:n}}),(function(e,t){return(0,p.bindActionCreators)({merge:m.Nw.merge},(0,u.Qd)(e,t.storeKey))}))(O);var C,k=n(76395),_=n(12006),j=n(65879);function I(e,t,n,o){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const D=e=>{const{totalConnectionsCount:t,selectedEntitiesCount:n,entityListCount:o,entityTotal:i,hitsTotalRelation:a}=e,s=I("b",{},void 0," ",`${i}${"gte"===a?"+":""}`," "),l=r.createElement(r.Fragment,null,n>0&&r.createElement(r.Fragment,null,I("b",{},void 0," ",n," ")," ",I(f.vN,{},void 0,"selected of")),I("b",{},void 0," ",o," ")," ",I(f.vN,{},void 0,"shown of"),s,I(f.vN,{},void 0,"entities")),c=r.createElement(r.Fragment,null,I("b",{},void 0,t," "),I(f.vN,{},void 0,"connections"),", ",I("b",{},void 0,s," "),I(f.vN,{},void 0,"entities"));return I("span",{},void 0,void 0===t?l:c)};var T;function E(e,t,n,o){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class x extends r.Component{render(){return E("div",{className:"blank-state"},void 0,E(h.JO,{icon:"cog"}),E("h4",{},void 0,E(f.vN,{},void 0,"Welcome to Uwazi")),E("a",{href:"https://uwazi.readthedocs.io/en/latest/",target:"_blank",rel:"noreferrer"},void 0,E(f.vN,{},void 0,"Learn more")))}}var A,$=n(30743),R=n(43857);function F(e,t,n,o){A||(A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class L extends r.Component{render(){return F(R.aO,{zoomLevel:this.props.rowListZoomLevel},void 0,this.props.documents.get("rows").map(((e,t)=>F($.ZP,{doc:e,storeKey:this.props.storeKey,onClick:this.props.clickOnDocument,onSnippetClick:this.props.onSnippetClick,deleteConnection:this.props.deleteConnection,searchParams:this.props.search},t))))}}const J=(0,d.connect)(((e,t)=>({documents:e[t.storeKey].documents,search:e[t.storeKey].search})))(L);var Z,M=n(6858);function V(e,t,n,o){Z||(Z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K extends r.Component{constructor(e,t){super(e,t),this.state={loading:!1},this.clickOnDocument=this.clickOnDocument.bind(this),this.selectAllDocuments=this.selectAllDocuments.bind(this),this.loadNextGroupOfEntities=this.loadNextGroupOfEntities.bind(this)}componentWillReceiveProps(){this.setState({loading:!1})}loadMoreDocuments(e,t){this.setState({loading:!0}),this.props.loadMoreDocuments(this.props.storeKey,e,t)}selectAllDocuments(){this.props.selectAllDocuments&&this.props.selectAllDocuments.apply(this)}clickOnDocument(...e){this.props.clickOnDocument&&this.props.clickOnDocument.apply(this,e)}loadNextGroupOfEntities(){const e=this.props.documents.get("rows").size;e&&this.loadMoreDocuments(30,e)}loadMoreButton(e){const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.props.location.query),n=t.q?l().decode(t.q):{},o=this.props.documents.get("rows").size;n.from=o,n.limit=e,t.q=l().encode(n);const r=`${this.props.location.pathname}${(0,a._k)(t)}`;return V(i.rU,{to:r,className:"btn btn-default btn-load-more",onClick:t=>{t.preventDefault(),this.loadMoreDocuments(e,o)}},void 0,e," ",(0,f.t)("System","x more"))}render(){const{documents:e,connections:t,GraphView:n,view:o,searchCentered:i,hideFooter:a,connectionsGroups:s,LoadMoreButton:l,rowListZoomLevel:c,CollectionViewer:d}=this.props,p=t?s.reduce(((e,t)=>e+t.get("templates").reduce(((e,t)=>e+t.get("count")),0)),0):void 0,u=V(D,{selectedEntitiesCount:this.props.selectedDocuments.size,entityListCount:this.props.documents.get("rows").size,entityTotal:e.get("totalRows"),hitsTotalRelation:e.get("relation"),totalConnectionsCount:p}),m=this.props.SearchBar,v=this.props.ActionButtons?V("div",{className:"search-list-actions"},void 0,V(this.props.ActionButtons,{})):null,y=a?null:V(_.Z,{});return V("div",{className:"documents-list"},void 0,V("div",{className:"main-wrapper"},void 0,V("div",{className:"search-list "+(i?"centered":"")},void 0,v," ",m&&V(m,{storeKey:this.props.storeKey})),V("div",{className:"sort-by "+(i?"centered":"")},void 0,V("span",{className:"documents-counter-sort"},void 0,V(f.vN,{},void 0,"sorted by")),V(P,{sortCallback:this.props.searchDocuments,selectedTemplates:this.props.filters.get("documentTypes"),stateProperty:this.props.sortButtonsStateProperty,storeKey:this.props.storeKey}),V(j.W,{},void 0,V("div",{className:"select-all-documents"},void 0,V("button",{type:"button",className:"btn btn-default btn-xs",onClick:this.selectAllDocuments},void 0,V(f.vN,{},void 0,"Select all")))),V("div",{className:"documents-counter"},void 0,V("span",{className:"documents-counter-label"},void 0,u))),(0,M.Z)()&&V(x,{}),(()=>"graph"!==o?r.createElement(d,{rowListZoomLevel:c,storeKey:this.props.storeKey,clickOnDocument:this.clickOnDocument,onSnippetClick:this.props.onSnippetClick,deleteConnection:this.props.deleteConnection,loadNextGroupOfEntities:this.loadNextGroupOfEntities}):"graph"===o?V(n,{clickOnDocument:this.clickOnDocument}):null)(),V("div",{className:"row"},void 0,"graph"!==o?V("p",{className:"col-sm-12 text-center documents-counter"},void 0,u):null,(()=>l?V(l,{}):e.get("rows").size<e.get("totalRows")&&!this.state.loading?V("div",{className:"col-sm-12 text-center"},void 0,this.loadMoreButton(30)," ",this.loadMoreButton(300)):this.state.loading?V(k.Z,{}):null)(),V(j.W,{},void 0,V("div",{className:"col-sm-12 force-ltr text-center protip"},void 0,V(h.JO,{icon:"lightbulb"})," ",V("b",{},void 0,V(f.vN,{},void 0,"ProTip!")),V("span",{},void 0,V(f.vN,{},void 0,"Use")," ",V("span",{className:"protip-key","no-translate":!0},void 0,"cmd"),"  ",V(f.vN,{},void 0,"or")," ",V("span",{className:"protip-key","no-translate":!0},void 0,"shift"),"  ",V(f.vN,{},void 0,"+ click to select multiple cards."))))),y))}}K.defaultProps={SearchBar:c.ZP,rowListZoomLevel:0,CollectionViewer:J,selectedDocuments:{}};const B=(0,i.EN)(K)},62863:(e,t,n)=>{"use strict";n.d(t,{J:()=>c,Z:()=>d});var o,r=n(67294),i=n(37974),a=n(72027);function s(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function l(e){switch(e){case"xs":default:return"sm";case"sm":return"lg";case"md":case"lg":case"xlg":return"2x"}}class c extends r.Component{getJSData(){const{data:e}=this.props;let t=e;return e&&t.toJS&&(t=t.toJS()),t}getIcon(e){const{className:t,size:n}=this.props;let o;if("Icons"===e.type&&(o=s(a.JO,{icon:`${e._id}`,size:`${l(n)}`})),"Flags"===e.type){o=s("span",{className:`${t} ${`flag-icon flag-icon-${a.TZ.get(e._id).cca2}`.toLowerCase()}`})}return o}render(){const{className:e}=this.props;let t=null;const n=this.getJSData();if(n&&n._id){t=s("span",{className:e},void 0,this.getIcon(n))}return t}}c.defaultProps={data:void 0,className:void 0,size:void 0};const d=(0,i.connect)()(c)},43857:(e,t,n)=>{"use strict";n.d(t,{aO:()=>s,ak:()=>a});n(67294);var o,r=n(72027);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=({children:e,onClick:t})=>i("div",{className:"item-actions",onClick:t},void 0,e);a.Label=({children:e,status:t})=>{let n="";return"success"===t&&(n=i(r.JO,{icon:"check"})),"danger"===t&&(n=i(r.JO,{icon:"times"})),"warning"===t&&(n=i(r.JO,{icon:"exclamation-triangle"})),i("span",{className:`label label-${t||"default"}`},void 0,n," ",i("span",{},void 0,e))},a.ProgressBar=({progress:e})=>{let t=`${e} % Completed`,n="upload";return 0!==e&&100!==e||(t="Processing...",n="clock"),i("div",{className:"label-progress"},void 0,i("span",{className:"label label-info"},void 0,i(r.JO,{icon:n})," ",i("span",{},void 0,t)),i("div",{className:"progress"},void 0,i("div",{className:"progress-bar progress-bar-striped active",style:{width:`${e}%`}})))};const s=({children:e,zoomLevel:t})=>i("div",{className:`item-group item-group-zoom-${t}`},void 0,e);s.Item=({children:e,status:t,onClick:n,onMouseEnter:o,onMouseLeave:r,active:a,className:s})=>{let l="";return!0===a&&(l="is-active"),!1===a&&(l="is-disabled"),i("div",{className:`${s} item item-status item-${t||"default"} ${l}`,onClick:n,onMouseEnter:o,onMouseLeave:r},void 0,e)},s.defaultProps={children:"",zoomLevel:0}},587:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o,r=n(67294),i=n(83253),a=n.n(i),s=n(53641);function l(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class c extends r.Component{render(){const e={overlay:{zIndex:this.props.zIndex,backgroundColor:"rgba(0, 0, 0, 0.75)"}},{type:t,className:n,children:o,isOpen:r}=this.props;return l(a(),{style:e,className:`modal-dialog modal-${t} ${n}`,isOpen:r,contentLabel:"",ariaHideApp:!1},void 0,l("div",{className:"modal-content"},void 0,o))}}c.defaultProps={isOpen:!1,type:"success",className:"",zIndex:100};c.Body=({children:e})=>l("div",{className:"modal-body"},void 0,e),c.Header=({children:e})=>l("div",{className:"modal-header"},void 0,e),c.Footer=({children:e})=>l("div",{className:"modal-footer"},void 0,e),c.Title=({children:e})=>l("h4",{className:"modal-title"},void 0,e),c.Close=({onClick:e})=>l("button",{type:"button",className:"close",onClick:e},void 0,l("span",{"aria-hidden":"true"},void 0,"×"),l("span",{className:"sr-only"},void 0,l(s.vN,{},void 0,"Close")))},69474:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var o,r=n(67294),i=n(72027),a=n(53641),s=n(13265),l=n(4271);function c(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},d.apply(this,arguments)}class p extends r.Component{render(){return c("div",{className:"input-group"},void 0,r.createElement("input",d({type:"text",className:"form-control",placeholder:"Search"},this.props)),c(i.JO,{icon:"search"}),c(s.Z,{label:(0,a.t)("System","Search Tips",null,!1),title:(0,a.t)("System","Narrow down your searches",null,!1)},void 0,c(l.o,{})))}}const u=p},92348:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o,r=n(67294);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class a extends r.Component{render(){return i("aside",{className:`side-panel ${this.props.className||""} ${this.props.open?"is-active":"is-hidden"} ${this.props.mode} `},void 0,this.props.children)}}a.defaultProps={mode:""};const s=a},75677:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var o,r=n(67294),i=n(37974),a=n(22222),s=n(29573),l=n(60502);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u=(0,a.P1)((e=>e.templates),((e,t)=>t.template),((e,t)=>{let n;return{name:e.reduce(((e,o,r)=>o.get("_id")===t?(n=o.get("color")?{className:"btn-color",style:{backgroundColor:o.get("color")}}:{className:"btn-color btn-color-"+r%s.D.length},o.get("name")):e),""),styleProps:n}}));class m extends r.Component{render(){const{name:e,template:t,className:n,style:o}=this.props;return p("span",{className:n,style:o},void 0,t&&(0,l.Z)(t,e))}}m.defaultProps={className:"btn-color",style:void 0};const f=(0,i.connect)(((e,t)=>{const n=u(e,t);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:n.name,template:t.template},n.styleProps)}))(m)},96959:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});n(67294);var o,r=n(72027);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=({children:e,icon:t,position:n})=>{const o=n?`property-description-${n}`:"property-description";return i("span",{className:"property-help"},void 0,i(r.JO,{icon:t}),i("div",{className:o},void 0,e))};a.defaultProps={icon:"question-circle",position:""};const s=a},45259:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});n(67294);var o,r=n(72027);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=({children:e,inline:t})=>t?i("div",{className:"alert alert-warning fade in"},void 0,i(r.JO,{icon:"exclamation-triangle"}),e):i("span",{className:"property-help"},void 0,i(r.JO,{icon:"exclamation-triangle"}),i("div",{className:"property-description"},void 0,e));a.defaultProps={inline:!1};const s=a},74371:(e,t,n)=>{"use strict";n.d(t,{xE:()=>ue,pu:()=>W,Xq:()=>se,lH:()=>S,JO:()=>N.Z,ck:()=>x,hs:()=>$.Z,L2:()=>D.Z,pl:()=>Z,Ch:()=>O.Z,v3:()=>ce.Z});var o,r=n(37974),i=n(67294),a=n(55505),s=n(71182),l=n(81478),c=n(53641);function d(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p=()=>localStorage.getItem("uwaziFavorites")?localStorage.getItem("uwaziFavorites").split(","):[];class u extends i.Component{constructor(e){super(e),this.state={selected:!1},this.toggleClick=this.toggleClick.bind(this)}componentDidMount(){const{sharedId:e}=this.props,t=p().includes(e);t&&this.setState({selected:t})}toggleClick(e){const{sharedId:t}=this.props,n=p();if(e.stopPropagation(),e.preventDefault(),n.includes(t)){const e=n.indexOf(t);n.splice(e,1)}else n.push(t);localStorage.setItem("uwaziFavorites",n.join(",")),this.setState({selected:p().includes(t)})}render(){const{selected:e}=this.state;return d("button",{className:"btn favoriteBanner "+(e?"selected":""),onClick:this.toggleClick,type:"button",suppressHydrationWarning:!0},void 0,d("span",{className:"tab-link-tooltip"},void 0,d(c.vN,{},void 0,"Add / remove favorite")))}}var m,f=n(17676),h=n(43857),v=n(40922),y=n(60502);function b(e,t,n,o){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends i.Component{render(){const{doc:e}=this.props;if(!e.get("file"))return null;if(e.get("file")){const t=e.getIn(["file","language"]);return t&&"other"!==t?this.props.locale===(0,v.dK)(t,"ISO639_1")?null:b("span",{className:"item-type__documentLanguage"},void 0,b("span",{},void 0,(0,v.dK)(t,"ISO639_1")||t)):b("span",{className:"item-type__documentLanguage"},void 0,b("span",{},void 0,(0,y.Z)("System","Other")))}}}const S=(0,r.connect)((({locale:e})=>({locale:e})))(g);var w,N=n(62863),O=n(96959),P=n(9067),C=n(88020);function k(e,t,n,o){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _=({snippets:e,onSnippetClick:t,template:n})=>{let o,r;e.metadata.length?(r=(0,C.Z)(e.metadata[0].field,n),[o]=e.metadata[0].texts):(r=(0,y.Z)("System","Document contents"),o=e.fullText[0].text);const a=i.createElement(i.Fragment,null,k("div",{className:"item-snippet-source"},void 0,r),k("div",{onClick:t,className:"item-snippet"},void 0,k(P.Z,{},void 0,o)));return 1===e.count?k("div",{className:"item-snippet-wrapper"},void 0,a):k("div",{className:"item-snippet-wrapper"},void 0,a,k("div",{},void 0,k("a",{onClick:t},void 0,(0,y.Z)("System","Show more"))))};_.defaultProps={onSnippetClick:void 0};const j=(0,r.connect)(((e,t)=>({template:e.templates.find((e=>e.get("_id")===t.doc.template))})))(_);var I,D=n(75677);function T(e,t,n,o){I||(I="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:I,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class E extends i.Component{getSearchSnipett(e){return!(!e.snippets||!e.snippets.count)&&T(j,{onSnippetClick:this.props.onSnippetClick,snippets:e.snippets,doc:e})}render(){const{onClick:e,onMouseEnter:t,onMouseLeave:n,active:o,additionalIcon:r,additionalText:s,buttons:d}=this.props,p=f.Z.performantDocToJSWithoutRelations(this.props.doc),m=s?T("div",{className:"item-snippet-wrapper"},void 0,T("div",{className:"item-snippet"},void 0,s)):null,v={className:`${`item-document template-${p.template}`} ${this.props.className||""}`,onClick:e,onMouseEnter:t,onMouseLeave:n,active:o,tabIndex:"1"};return i.createElement(h.aO.Item,v,this.props.itemHeader,T("div",{className:"item-info"},void 0,T("div",{className:"item-name"},void 0,r||"",T(N.Z,{className:"item-icon item-icon-center",data:p.icon}),T("span",{},void 0,p[this.props.titleProperty]),T(S,{doc:this.props.doc})),m,this.getSearchSnipett(p)),T("div",{className:"item-metadata"},void 0,T(a.ZG,{entity:this.props.noMetadata?{}:p,sortedProperty:this.props.search.sort,additionalMetadata:this.props.additionalMetadata,renderLabel:(e,t)=>!e.noLabel&&t})),T(h.ak,{},void 0,i.createElement(i.Fragment,null,!!p.template&&T(D.Z,{template:p.template}),p.published?"":T(O.Z,{icon:"lock"},void 0,T(c.vN,{},void 0,"This entity is restricted from public view."))),this.props.labels,d),T(l.e,{feature:"favorites"},void 0,T("div",{className:"item-favorite"},void 0,T(u,{sharedId:p.sharedId}))))}}E.defaultProps={onClick:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},noMetadata:!1},E.defaultProps={search:s.Z.get(),titleProperty:"title"};const x=(0,r.connect)((({templates:e,thesauris:t},n)=>{const o=n.searchParams;return{templates:n.templates||e,thesauris:t,search:o}}))(E);var A,$=n(92348),R=n(72027);function F(e,t,n,o){A||(A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const L=["png","gif","jpg"];class J extends i.Component{render(){const{file:e,alt:t}=this.props,n=(o=e).substr(o.lastIndexOf(".")+1);var o;let r;return L.includes(n)&&(r=F("img",{src:e,alt:t})),"pdf"===n&&(r=F("span",{"no-translate":!0},void 0,F(R.JO,{icon:"file-pdf"})," pdf")),F("div",{className:"thumbnail"},void 0,r)}}J.defaultProps={alt:""};const Z=J;var M,V=n(587);function U(e,t,n,o){M||(M="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:M,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class z extends i.Component{render(){return U(V.Z,{isOpen:this.props.isOpen,type:this.props.type},void 0,U(V.Z.Body,{},void 0,U("h4",{},void 0,this.props.title),U("p",{},void 0,this.props.message)),U(V.Z.Footer,{},void 0,U("button",{type:"button",className:"btn btn-default cancel-button",onClick:this.props.onCancel},void 0,U(c.vN,{},void 0,"Cancel")),U("button",{type:"button",className:`btn confirm-button btn-${this.props.type}`,onClick:this.props.onAccept},void 0,U(c.vN,{},void 0,"Accept"))))}}z.defaultProps={isOpen:!0,message:"Are you sure you want to continue?",title:"Confirm action",type:"danger"};const K=z;var B;function H(e,t,n,o){B||(B="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:B,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class q extends i.Component{constructor(e){super(e),this.state={showModal:!1},this.openModal=this.openModal.bind(this),this.onAccept=this.onAccept.bind(this),this.closeModal=this.closeModal.bind(this)}onAccept(){this.closeModal(),this.props.action()}closeModal(){this.setState({showModal:!1})}openModal(){this.setState({showModal:!0})}render(){return i.createElement(i.Fragment,null,H("button",{type:"button",className:this.props.className,onClick:this.openModal},void 0,this.props.children),this.state.showModal&&H(K,{message:this.props.message,title:this.props.title,onAccept:this.onAccept,onCancel:this.closeModal}))}}q.defaultProps={children:"",message:"Are you sure you want to continue?",title:"Confirm action",className:"",action:()=>!1};const W=q;var G=n(52786),Q=n(62787);const Y=["to"],X=["children","location","queryParams"];function ee(){return ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ee.apply(this,arguments)}function te(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ie=(e,t)=>{const n=oe(oe({},e),t);return Object.keys(n).reduce(((e,t)=>""!==n[t]?Object.assign(e,{[t]:n[t]}):e),{})},ae=e=>{let{children:t,location:n,queryParams:o}=e,r=te(e,X);return i.createElement(G.rU,ee({to:`${n.pathname}${(0,Q._k)(ie(n.query,o))}`},(e=>{const{to:t}=e;return te(e,Y)})(r)),t)};ae.defaultProps={children:"",queryParams:{}};const se=(0,G.EN)(ae);var le,ce=n(45259);function de(e,t,n,o){le||(le="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:le,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pe=({to:e,className:t})=>de(c.l3,{to:e,className:`btn btn-default ${t}`},void 0,de(R.JO,{icon:"arrow-left",directionAware:!0}),de("span",{className:"btn-label"},void 0,(0,c.t)("System","Back")));pe.defaultProps={to:"",className:""};const ue=pe},33983:(e,t,n)=>{"use strict";n.d(t,{$W:()=>A,AJ:()=>r,Am:()=>i,Br:()=>S,F:()=>w,GL:()=>x,JY:()=>P,L5:()=>c,LD:()=>$,Mt:()=>d,OD:()=>h,Om:()=>v,RC:()=>E,SX:()=>s,So:()=>_,St:()=>O,Tr:()=>o,UF:()=>T,Wv:()=>m,XL:()=>u,Zo:()=>D,bj:()=>b,dx:()=>N,dy:()=>l,fv:()=>y,j6:()=>I,oZ:()=>C,pP:()=>k,rd:()=>p,sZ:()=>f,u0:()=>g,wO:()=>a,y9:()=>j});const o="SET_DOCUMENTS",r="ADD_DOCUMENTS",i="UNSET_DOCUMENTS",a="LIBRARY/UPDATE_DOCUMENT",s="LIBRARY/UPDATE_DOCUMENTS",l="UPDATE_DOCUMENTS_PUBLISHED",c="ELEMENT_CREATED",d="REMOVE_DOCUMENT",p="REMOVE_DOCUMENTS",u="REMOVE_DOCUMENTS_SHAREDIDS",m="UPDATE_SELECTED_ENTITIES",f="SET_SEARCHTERM",h="SET_PREVIEW_DOC",v="SET_SUGGESTIONS",y="SHOW_SUGGESTIONS",b="HIDE_SUGGESTIONS",g="OVER_SUGGESTIONS",S="SET_LIBRARY_FILTERS",w="UPDATE_LIBRARY_FILTERS",N="INITIALIZE_FILTERS_FORM",O="SELECT_DOCUMENT",P="SELECT_SINGLE_DOCUMENT",C="SELECT_DOCUMENTS",k="UNSELECT_DOCUMENT",_="UNSELECT_ALL_DOCUMENTS",j="SHOW_FILTERS",I="HIDE_FILTERS",D="ENTER_LIBRARY",T="ZOOM_IN",E="ZOOM_OUT",x="SET_TABLE_VIEW_COLUMNS",A="SET_TABLE_VIEW_COLUMN_HIDDEN",$="SET_TABLE_VIEW_ALL_COLUMNS_HIDDEN"},93673:(e,t,n)=>{"use strict";n.d(t,{BP:()=>$,Cf:()=>G,Cs:()=>F,FU:()=>W,Gj:()=>j,HU:()=>D,Jq:()=>re,MI:()=>C,P7:()=>_,Qk:()=>V,SQ:()=>oe,W7:()=>z,_K:()=>U,aE:()=>I,gv:()=>q,hN:()=>ee,i8:()=>K,iH:()=>Y,jB:()=>B,jh:()=>E,kr:()=>J,ku:()=>R,lo:()=>k,mQ:()=>ne,qC:()=>T,rR:()=>A,rh:()=>X,tt:()=>x,u$:()=>Q,uO:()=>H,uz:()=>L,vG:()=>Z,wx:()=>te});var o=n(80129),r=n.n(o),i=n(73581),a=n.n(i),s=n(79223),l=n(52786),c=n(69899),d=n(33983),p=n(59511),u=n(3827),m=n(59276),f=n(39263),h=n(98373),v=n(47794),y=n(65969),b=n(62787),g=n(8482),S=n(31323),w=n(63978);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(){return{type:d.Zo}}function k(e={}){return Object.assign(e,{type:d.dx})}function _(e){return async(t,n)=>{const o=e.toJS?e.toJS():e;"semantic-search-results"===n().library.sidepanel.tab&&!o.semanticSearch&&t(p.N.set("library.sidepanel.tab","")),await t((0,g.al)()),t({type:d.St,doc:o}),t((0,g.AQ)())}}function j(e){return t=>{m.h.get(new h.K({sharedId:e})).then((e=>{t({type:d.JY,doc:e[0]})}))}}function I(e){return async t=>{await t((0,g.al)()),t({type:d.oZ,docs:e}),t((0,g.AQ)())}}function D(e){return async t=>{await t((0,g.al)()),t({type:d.pP,docId:e}),t((0,g.AQ)())}}function T(e){return async t=>{await t((0,g.al)()),t({type:d.JY,doc:e}),t((0,g.AQ)())}}function E(){return async e=>{await e((0,g.al)()),e({type:d.So}),e((0,g.AQ)())}}function x(e){return{type:d.Wv,entities:e}}function A(){return{type:d.y9}}function $(){return{type:d.j6}}function R(e){return{type:d.Tr,documents:e}}function F(e){return{type:d.AJ,documents:e}}function L(){return{type:d.Am}}function J(){return{type:d.UF}}function Z(){return{type:d.RC}}function M(e){if(e&&e.values&&!e.values.length)return!0;if(Array.isArray(e)&&!e.length)return!0;if("string"==typeof e&&!e)return!0;if("object"==typeof e){return!Object.keys(e).reduce(((t,n)=>t||Boolean(e[n])),!1)}return!1}function V(e,t,n,o){let r=O({filters:{}},e);return r.publishedStatus&&(r=(0,S.u)(r)),r.filters={},t.properties.forEach((t=>{if(M(e.filters[t.name])||t.filters||(r.filters[t.name]=e.filters[t.name]),t.filters){const n=O({},e.filters[t.name]);t.filters.forEach((e=>{M(n[e.name])&&delete n[e.name]})),Object.keys(n).length&&(r.filters[t.name]=n)}})),r.types=t.documentTypes,r.limit=n,r.from=o,r}function U(e,t=!0){const n=O({},e);Object.keys(n).forEach((e=>{n[e]&&0===n[e].length&&delete n[e],"object"==typeof n[e]&&0===Object.keys(n[e]).length&&delete n[e],""===n[e]&&delete n[e]})),n.searchTerm&&(n.searchTerm=`${encodeURIComponent(n.searchTerm).replace(/%20/g," ")}:`);const o=a().encode(n).replace(/searchTerm:'([^:]+):'/,"searchTerm:'$1'");return t?`?q=${o}`:o}function z({search:e,filters:t},n,o=30,r=0){return(i,s)=>{const c=s()[n],d=e||c.search;let u=t||c.filters;u=u.toJS?u.toJS():u;const m=V(d,u,o,r);m.searchTerm=c.search.searchTerm;const{query:f}=l.mW.getCurrentLocation(),h=a().decode(decodeURIComponent(f.q||"()"));m.searchTerm&&m.searchTerm!==h.searchTerm&&(m.sort="_score"),d.userSelectedSorting&&i(p.N.set(`${n}.selectedSorting`,d)),m.customFilters=d.customFilters,function(e){const{pathname:t}=l.mW.getCurrentLocation(),n=`${t}/`.replace(/\/\//g,"/"),o=l.mW.getCurrentLocation().query||{};o.q=U(e,!1),l.mW.push(n+(0,b._k)(o))}(m)}}function K(e){return{type:d.wO,doc:e}}function B(e){return{type:d.SX,docs:e}}function H(e,t,n){const o=new h.K(r().stringify({filter:{sharedId:t,searchString:e},fields:["snippets"]}));return e=>v.Z.searchSnippets(o).then((({data:t})=>{const o=t.length?t[0].snippets:{total:0,fullText:[],metadata:[]};return e(p.N.set(`${n}.sidepanel.snippets`,o)),o}))}function q(e,t){return async n=>{const o=await u.Tg.save(new h.K(e));n(f.J.notify("Document updated","success")),n(s.Nw.reset(t)),n(K(o)),n(p.N.updateIn("library.markers",["rows"],o)),await n(T(o))}}function W(e,t){return async n=>{const{entity:o,errors:r}=await(0,w.o)(e,n);let i="";var a;n(s.Nw.reset(t)),await n(E()),e._id?(i="Entity updated",n(K(o)),n(p.N.updateIn("library.markers",["rows"],o))):(i="Entity created",n((a=o,{type:d.L5,doc:a}))),r.length&&(i=`${i} with the following errors: ${JSON.stringify(r,null,2)}`),await n(f.J.notify(i,r.length?"warning":"success")),await n(T(o))}}function G(e){return{type:d.Mt,doc:e}}function Q(e){return{type:d.rd,docs:e}}function Y(e){return async t=>{await u.Tg.delete(new h.K({sharedId:e.sharedId})),t(f.J.notify("Document deleted","success")),await t(E()),t(G(e))}}function X(e,t,n){return(o,r)=>{const{search:i}=r()[e];z({search:i},e,t,n)(o,r)}}function ee(e,t,n){return o=>y.Z.get(new h.K({sharedId:e,file:t,onlyTextReferences:!0})).then((e=>{o(p.N.set(`${n}.sidepanel.references`,e))}))}function te(e,t,n){const o=c.h.getState()[e],{search:r,filters:i}=o,a=V(r,i.toJS(),0);return a.searchTerm=r.searchTerm,"uploads"===e&&(a.unpublished=!0),v.Z.getAggregationSuggestions(new h.K({query:a,property:t,searchTerm:n}))}function ne(e){return{type:d.GL,columns:e}}function oe(e,t){return{type:d.$W,name:e,hidden:t}}function re(e){return{type:d.LD,hidden:e}}},8482:(e,t,n)=>{"use strict";n.d(t,{AQ:()=>f,SD:()=>m,al:()=>h});var o=n(59511),r=n(2080),i=n(39263),a=n(98373),s=n(79223),l=n(9813),c=n(93673);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(){return(e,t)=>{const n=t().library.sidepanel.quickLabelState.toJS();e(o.N.set("library.sidepanel.quickLabelState",p(p({},n),{},{autoSave:!n.autoSave})))}}function f(){return(e,t)=>{var n,o,r;const i="library.sidepanel.quickLabelMetadata",a=t();if(null===(n=a.library)||void 0===n||null===(o=n.sidepanel)||void 0===o||null===(r=o.quickLabelState)||void 0===r||!r.get("thesaurus"))return;e(s.Nw.reset(i));const c=a.library.ui.get("selectedDocuments").map((e=>e.get("sharedId"))).toJS(),d=a.library.documents.get("rows").filter((e=>c.includes(e.get("sharedId")))).toJS();if(!d.length)return;const u=d.map((e=>e.template)).filter((e=>e)),m=a.templates.filter((e=>u.includes(e.get("_id")))).toJS(),f=function(e,t){const n=t.reduce(((e,t)=>p(p({},e),{},{[t]:{}})),{});return e.forEach((e=>t.forEach((t=>{e.metadata&&e.metadata[t]&&(n[t]||(n[t]={}),e.metadata[t].forEach((e=>{e.value&&(n[t][e.value]?n[t][e.value]+=1:n[t][e.value]=1)})))})))),t.reduce(((t,o)=>p(p({},t),{},{[o]:{added:[],removed:[],originalFull:Object.keys(n[o]).filter((t=>n[o][t]===e.length)),originalPartial:Object.keys(n[o]).filter((t=>n[o][t]<e.length))}})),{})}(d,(0,l.VQ)(a.library.sidepanel.quickLabelState.get("thesaurus"),m));e(s.Nw.load(i,f)),e(s.Nw.setPristine(i))}}function h(e){return async(t,n)=>{var o,s,l;const d=n();if(!(e||null!==(o=d.library)&&void 0!==o&&null!==(s=o.sidepanel)&&void 0!==s&&null!==(l=s.quickLabelState)&&void 0!==l&&l.get("autoSave")))return;const p=d.library.sidepanel.quickLabelMetadata,u={};if(Object.keys(p).forEach((e=>{p[e]&&p[e].added.length+p[e].removed.length>0&&(u[e]={added:p[e].added.map((e=>({value:e}))),removed:p[e].removed.map((e=>({value:e})))})})),!u||!Object.keys(u).length)return;const m=d.library.ui.get("selectedDocuments").map((e=>e.get("sharedId"))).toJS(),h=await r.Z.multipleUpdate(new a.K({ids:m,values:{diffMetadata:u}}));t(i.J.notify("Update success","success")),t((0,c.jB)(h)),t(f())}}},63978:(e,t,n)=>{"use strict";n.d(t,{f:()=>h,o:()=>v});var o=n(80569),r=n.n(o),i=n(96486),a=n(96384),s=n(37501),l=n(35940),c=n(85212);const d=["serializedFile"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const h=async(e,t)=>new Promise((n=>{const o=new FileReader;o.onload=e=>{const o=(0,l.zx)(e.target.result);t(o),n()},o.readAsDataURL(e)})),v=async(e,t)=>{const[n,o]=e.attachments?e.attachments.reduce(((e,t)=>{const{serializedFile:n}=t,o=f(t,d);return e[0].push(o),n&&e[1].push((0,c.KS)(t)),e}),[[],[]]):[[],[]],{oldDocuments:l=[],newDocuments:p=[]}=(0,i.groupBy)(e.documents||[],(e=>void 0!==e._id?"oldDocuments":"newDocuments")),m=u(u({},e),{},{documents:l}),h=await Promise.all(p.map((async e=>{const t=await fetch(e.data).then((async e=>e.blob())),n=new File([t],e.originalFile.name,{type:t.type});return URL.revokeObjectURL(e.data),n})));return new Promise(((i,l)=>{const c=r().post("/api/entities").set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").field("entity",JSON.stringify(u(u({},m),n.length>0&&{attachments:n})));t&&c.on("progress",(n=>{t({type:a.s0,entity:e.sharedId||"NEW_ENTITY",progress:n.percent?Math.floor(n.percent):n.percent})})),o.forEach(((e,t)=>{c.attach(`attachments[${t}]`,e),c.field(`attachments_originalname[${t}]`,e.name)})),h.forEach(((e,t)=>{c.attach(`documents[${t}]`,e),c.field(`documents_originalname[${t}]`,e.name)})),c.end(((e,n)=>{if(e)return l(e);t&&h.length&&t({type:s.T_,doc:n.body.entity.sharedId}),i(n.body)}))}))}},30743:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>D});var o=n(45697),r=n.n(o),i=n(67294),a=n(37974),s=n(65879),l=n(55316),c=n(53641),d=n(43857);const p=(0,n(22222).P1)(((e,t)=>e.progress.get(t.doc.get("sharedId"))),((e,t)=>t.doc.get("documents")&&t.doc.get("documents").size?t.doc.get("documents").reduce(((e,t)=>t.get("status")),"ready"):null),((e,t)=>t.doc.get("documents")&&!t.doc.get("documents").size),((e,t)=>t.doc.get("template")),((e,t,n,o)=>o||"ready"!==t&&!n?e>=0&&e<100?{progress:e,status:"processing",message:"Uploading..."}:"failed"!==t||n?"processing"!==t||n?{}:{progress:100,status:"processing",message:"Processing..."}:{status:"danger",message:"Conversion failed"}:{progress:e,status:"warning",message:"No type selected"}));var u;function m(e,t,n,o){u||(u="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:u,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class f extends i.Component{renderProgressBar(){if(this.props.progress||0===this.props.progress)return m(d.ak.ProgressBar,{progress:this.props.progress})}render(){if(!this.props.status)return null;return m("div",{},void 0,this.renderProgressBar(),m(d.ak.Label,{status:this.props.status},void 0,this.props.message))}}const h=(0,a.connect)((function(e,t){return p(e,t)}))(f);var v,y=n(74127),b=n(43393),g=n(72027),S=n(59511),w=n(8575);function N(e,t,n,o){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class O extends i.Component{constructor(e){super(e),this.onClick=this.onClick.bind(this)}onClick(e){e.stopPropagation();const{targetReference:t,openReferencesTab:n}=this.props;t&&n()}render(){const{sharedId:e,processed:t,searchTerm:n,file:o,targetReference:r}=this.props,i=!o,a=`/entity/${e}`,s=function(e,t){const n={};return e&&(n.searchTerm=e),t&&(n.ref=t.get("_id")),n}(n,r),l=w.format({pathname:a,query:s});return!(!t&&!i)&&N(c.l3,{to:l,className:"btn btn-default btn-xs view-doc",onClick:this.onClick},void 0,N(g.JO,{icon:"angle-right",directionAware:!0})," ",(0,c.t)("System","View"))}}O.defaultProps={searchTerm:"",processed:!1,targetReference:null};const P=(0,a.connect)((function(e,t){return{searchTerm:t.storeKey?e[t.storeKey].search.searchTerm:""}}),(function(e){return(0,y.bindActionCreators)({openReferencesTab:()=>e=>e(S.N.set("viewer.sidepanel.tab","references"))},e)}))(O);var C,k=n(74371),_=n(17676);function j(e,t,n,o){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class I extends i.Component{shouldComponentUpdate(e){return!(0,b.is)(this.props.doc,e.doc)||!(0,b.is)(this.props.targetReference,e.targetReference)||this.props.additionalText!==e.additionalText||this.props.active!==e.active||this.props.searchParams&&e.searchParams&&this.props.searchParams.sort!==e.searchParams.sort}onClick(e){this.props.onClick&&this.props.onClick(e,this.props.doc,this.props.active)}getConnections(e){return j("div",{},void 0,e.map(((e,t)=>j("div",{className:"item-connection"},t,j("div",{},void 0,j(g.JO,{icon:"exchange-alt"}),j("span",{},void 0,(0,c.t)(e.context,e.label),"metadata"===e.type?` ${(0,c.t)("System","in")}...`:"")),j(s.W,{roles:["admin","editor"]},void 0,j(l.Z,{if:"metadata"!==e.sourceType},void 0,j("button",{className:"btn btn-default btn-hover-danger btn-xs",onClick:t=>this.deleteConnection(t,e),type:"button"},void 0,j(g.JO,{icon:"trash-alt"}))))))))}deleteConnection(e,t){e.stopPropagation();const{_id:n,sourceType:o}=t;this.props.deleteConnection({_id:n,sourceType:o})}render(){const{className:e,additionalText:t,targetReference:n}=this.props,o=_.Z.performantDocToJSWithoutRelations(this.props.doc),{sharedId:r,file:i,processed:a}=o;let s=null;o.connections&&o.connections.length&&(s=this.getConnections(o.connections));const l=j("div",{},void 0,j(P,{file:i,sharedId:r,processed:a,storeKey:this.props.storeKey,targetReference:n}));return j(k.ck,{onClick:this.onClick.bind(this),onSnippetClick:this.props.onSnippetClick,active:this.props.active,doc:this.props.doc,additionalText:t,searchParams:this.props.searchParams,deleteConnection:this.props.deleteConnection,itemHeader:s,buttons:l,labels:j(h,{doc:this.props.doc}),className:e})}}I.defaultProps={targetReference:null},I.contextTypes={confirm:r().func};const D=(0,a.connect)((function(e,t){return{active:!!t.storeKey&&!!e[t.storeKey].ui.get("selectedDocuments").find((e=>e.get("_id")===t.doc.get("_id")))}}))(I)},89628:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>w});var o,r=n(79223),i=n(74127),a=n(37974),s=n(67294),l=n(72027),c=n(93673),d=n(53641),p=n(49935),u=n(13265),m=n(4271),f=n(691),h=n(37713);function v(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends s.Component{constructor(e){super(e),this.search=this.search.bind(this),this.resetSearch=this.resetSearch.bind(this),this.submitSearch=this.submitSearch.bind(this),this.submitSemanticSearch=this.submitSemanticSearch.bind(this)}resetSearch(){this.props.change(`${this.props.storeKey}.search.searchTerm`,"");const e=b({},this.props.search);e.searchTerm="",this.props.searchDocuments({search:e},this.props.storeKey)}submitSemanticSearch(){this.props.semanticSearch(this.props.search)}submitSearch(){const e=b({},this.props.search);this.props.searchDocuments({search:e},this.props.storeKey)}search(e){this.props.searchDocuments({search:e},this.props.storeKey)}render(){const{search:e,storeKey:t}=this.props,n=`${t}.search`;return v("div",{className:"search-box"},void 0,v(r.l0,{model:n,onSubmit:this.search,autoComplete:"off"},void 0,v("div",{className:"input-group"+(e.searchTerm?" is-active":"")},void 0,v(r.gN,{model:".searchTerm"},void 0,v("input",{type:"text",placeholder:(0,d.t)("System","Search",null,!1),"aria-label":(0,d.t)("System","Search text description",null,!1),className:"form-control",autoComplete:"off"}),v(l.JO,{icon:"times",onClick:this.resetSearch,"aria-label":"Reset Search input"})),v(l.JO,{icon:"search",onClick:this.submitSearch,"aria-label":"Search button"})),v(h.S,{},void 0,v("button",{disabled:e.searchTerm?"":"disabled",type:"button",onClick:this.submitSemanticSearch,className:"btn btn-success semantic-search-button"},void 0,v(l.JO,{icon:"flask"})," ",v(d.vN,{},void 0,"Semantic Search")))),v(u.Z,{label:(0,d.t)("System","Search Tips",null,!1),title:(0,d.t)("System","Narrow down your searches",null,!1)},void 0,v(m.o,{})))}}const w=(0,a.connect)((function(e,t){return{search:(0,c.Qk)(e[t.storeKey].search,e[t.storeKey].filters.toJS())}}),(function(e,t){return(0,i.bindActionCreators)({searchDocuments:c.W7,change:r.Nw.change,semanticSearch:f.submitNewSearch},(0,p.Qd)(e,t.storeKey))}))(S)},78526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});n(67294);var o,r=n(83668);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=({onChange:e,model:t,label:n,options:o,prefix:a,showBoolSwitch:s,sort:l,lookup:c,totalPossibleOptions:d,allowSelectGroup:p})=>i("ul",{className:"search__filter is-active"},void 0,i("li",{},void 0,n,s&&i(r.T5,{model:`${t}.and`,prefix:a,onChange:e})),i("li",{className:"wide"},void 0,i(r.Lu,{model:`${t}.values`,prefix:a,options:o,onChange:e,sort:l,lookup:c,totalPossibleOptions:d,allowSelectGroup:p})));a.defaultProps={onChange:()=>{},label:"",prefix:"",showBoolSwitch:!1,sort:!1,options:[],lookup:null,totalPossibleOptions:0,allowSelectGroup:!1};const s=a},6858:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(69899),r=n(36651);function i(){const e=o.h.getState();return!!r.C5&&!e.thesauris.reduce(((e,t)=>e||!!t.get("values").size),!1)}},96185:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>d,e0:()=>c});var o=n(9075),r=n(71182),i=n(31323);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}function s(e,t){const n=t.find((t=>t._id===e.content));return n?n.values:null}const l=e=>{const t={id:e.key,value:e.key,label:e.label,results:e.filtered.doc_count};return e.icon&&(t.icon=e.icon),e.values&&(t.options=e.values.map(l)),"missing"===e.key&&(t.noValueKey=!0),t};function c(e,t,n=!0){return e.map((e=>{let o=a({},e);const r=t.all[o.name];return r&&r.buckets&&(o.options=r.buckets.map(l).filter((e=>e.results||!n&&"missing"===e.value)),o.totalPossibleOptions=r.count),o}))}const d={URLQueryToState:function(e,t,n,a,s=[]){let l=o.Z.comonFilters(t,e.types,s);e.types&&e.types.length||(l=o.Z.defaultFilters(t,s));const{searchTerm:c="",filters:d={},sort:p=r.Z.get().sort,order:u=r.Z.get().order,userSelectedSorting:m,includeUnpublished:f=!1,unpublished:h=!1,allAggregations:v=!1}=e;return{properties:l,search:{searchTerm:c,filters:d,customFilters:e.customFilters,sort:p,order:u,userSelectedSorting:m,publishedStatus:(0,i.i)(h,f),allAggregations:v}}},populateOptions:function(e,t){return e.map((e=>e.content?Object.assign(e,{options:s(e,t)}):e.content||"relationship"!==e.type?e:Object.assign(e,{options:t.filter((e=>"template"===e.type)).reduce(((e,t)=>e.concat(t.values)),[])})))},parseWithAggregations:c}},31323:(e,t,n)=>{"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{i:()=>a,u:()=>i});const i=e=>{const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),n=t.publishedStatus.values.includes("published"),i=t.publishedStatus.values.includes("restricted");return t.includeUnpublished=n===i,t.unpublished=!n&&i,delete t.publishedStatus,t},a=(e,t)=>({values:[...e?[]:["published"],...!t&&e||t&&!e?["restricted"]:[]]})},33530:(e,t,n)=>{"use strict";n.d(t,{iA:()=>_,D5:()=>h,sR:()=>k});var o=n(98014),r=n(67294),i=n(37974),a=n(33311),s=n(81485);const l=["collectionSettings","templates"];var c;function d(e,t,n,o){c||(c="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:c,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const h=(0,i.connect)((({settings:e,templates:t})=>({collectionSettings:e.collection,templates:t})))((e=>{var t;let{collectionSettings:n,templates:o}=e,i=f(e,l);const c=null==n||null===(t=n.get("mapStartingPoint"))||void 0===t?void 0:t.toJS(),p=(null==n?void 0:n.get("tilesProvider"))||"mapbox",m=null==n?void 0:n.get("mapApiKey");if("google"===p&&m){new a.aN({apiKey:m,retries:0}).load().then((()=>{})).catch((()=>{}))}const h=o.reduce(((e,t)=>u(u({},e),t?{[t.get("_id")]:{color:t.get("color"),name:t.get("name")}}:{})),{}),v=u(u({},i),{},{startingPoint:c,tilesProvider:p,mapApiKey:m,templatesInfo:h});return d(s.S,{},void 0,r.createElement(_,v))}));var v=n(45697),y=n.n(v),b=n(43393),g=n.n(b),S=n(22222);const w=(e,t)=>{let n,o;return e.length>t.length?(n=e,o=t):(n=t,o=e),o.forEach((e=>n.push(e))),n},N=({entity:e,geolocationProps:t,metadata:n,color:o,type:r})=>{let i=[];const a=t.map((e=>e.get("name")));if(t.size&&n){const[...s]=n.keys();s.forEach((s=>{if(a.includes(s)&&n.has(s)){const a=t.find((e=>e.get("name")===s)),l=n.get(s);i=w(i,"PropertyBased"===r?((e,t,n,o)=>{const r=[];return n.filter((e=>e.get("value"))).forEach((n=>{r.push({properties:{entity:e.toJS(),color:o,info:n.getIn(["value","label"])},latitude:n.getIn(["value","lat"]),longitude:n.getIn(["value","lon"]),label:t.get("label")})})),r})(e,a,l,o):((e,t,n,o)=>{const r=[];return n.forEach((n=>{n.has("inherit_geolocation")&&n.get("inherit_geolocation").filter((e=>e.get("value"))).forEach((i=>{r.push({properties:{entity:e.toJS(),color:o,info:i.getIn(["value","label"]),inherited:!0,label:n.get("label"),context:t.get("content")},latitude:i.getIn(["value","lat"]),longitude:i.getIn(["value","lon"]),label:t.get("label")})}))})),r})(e,a,l,o))}}))}return i},O=(e,t)=>{const n=t.find((t=>t.get("_id")===e.get("template"))),o=((e,t)=>{const n=e.get("color"),o=e.get("properties"),r=t.get("metadata"),i=o.filter((e=>"geolocation"===e.get("type")));return N({entity:t,geolocationProps:i,metadata:r,color:n,type:"PropertyBased"})})(n,e),r=((e,t)=>{const n=e.get("properties"),o=e.get("color"),r=t.get("metadata"),i=n.filter((e=>"geolocation"===e.getIn(["inherit","type"])));return N({entity:t,geolocationProps:i,metadata:r,color:o,type:"Inherited"})})(n,e);return w(o,r)},P=(0,S.P1)((({entities:e})=>e),(({state:e})=>e.templates),((e,t)=>((e,t)=>e.reduce(((e,n)=>{const o=O(n,t);return w(e,o)}),[]))(e,t))),C=({children:e,markers:t})=>e(t);C.defaultProps={entities:g().List()},C.propTypes={children:y().func.isRequired,templates:y().instanceOf(g().List).isRequired,entities:y().instanceOf(g().List)};const k=(0,i.connect)(((e,t)=>({markers:P({state:e,entities:t.entities}),templates:e.templates})))(C),_=(0,o.ZP)((async()=>{const{LMap:e}=await Promise.all([n.e(843),n.e(593)]).then(n.bind(n,61126));return t=>r.createElement(e,t)}))},13572:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o,r=n(52786),i=n(36651);n(67294);function a(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const s=({url:e,classname:t,children:n})=>(i.C5&&console.warn('MarkdownLink is deprecated, use <Link to="url"></Link> instead'),a(r.rU,{to:e,className:t,href:e},void 0,n));s.defaultProps={children:"",classname:""};const l=s},63977:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var o,r=n(67294),i=n(22004),a=n(72027);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s.apply(this,arguments)}function l(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class c extends r.Component{timeLinks(e){const t=e||{};return Object.keys(t).map(((e,n)=>{const o=e.split(":").reverse().reduce(((e,t,n)=>e+parseInt(t,10)*60**n),0);return l("div",{className:"timelink",onClick:this.seekTo.bind(this,o)},n,l("b",{},void 0,l(a.JO,{icon:"play"})," ",e),l("span",{},void 0,t[e]))}))}seekTo(e){this.player.seekTo(e)}render(){const e=(e=>{const t={url:"",options:{}};let n=e.config.replace(/\(|\)/g,"").split(",");t.url=n.shift(),n=(n.join(",")||"{}").replace(/&quot;/g,'"');try{n=JSON.parse(n)}catch(e){n={}}return t.options=n,t})(this.props),{compact:t}=this.props,n={width:"100%"};return t&&(n.height="100%"),l("div",{className:"video-container "+(t?"compact":"")},void 0,l("div",{},void 0,r.createElement(i.Z,s({className:"react-player",ref:e=>{this.player=e},url:e.url},n,{controls:!0}))),l("div",{},void 0,this.timeLinks(e.options.timelinks)),l("p",{className:"print-view-alt"},void 0,e.url))}}c.defaultProps={compact:!1};const d=c},27199:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BarChart:()=>yt,Connect:()=>ke,ContactForm:()=>w,Context:()=>H,Counter:()=>p,EntityData:()=>R,EntityInfo:()=>vt,EntityLink:()=>G,EntitySection:()=>B,FreeBarChart:()=>bt,GaugeChart:()=>Nt,Icon:()=>i.JO,ItemList:()=>ue,Link:()=>r.rU,ListChart:()=>wt,Map:()=>Ae,MarkdownLink:()=>Re.Z,MarkdownMedia:()=>Fe.Z,PayPalDonateLink:()=>Ze,PieChart:()=>St,PublicForm:()=>tt,Repeat:()=>ve,SearchBox:()=>ft,Slideshow:()=>gt,Value:()=>it});var o=n(98014),r=n(52786),i=n(72027),a=n(37974),s=n(45697),l=n.n(s),c=n(56053);const d=({count:e})=>e;d.defaultProps={count:"-"},d.propTypes={count:l().oneOfType([l().number,l().string])};const p=(0,a.connect)(((e,t)=>({count:c.Z.getAggregation(e,t)})))(d);var u,m=n(67294),f=n(53641),h=n(38562),v=n(74127),y=n(38540),b=n(98373);function g(e,t,n,o){u||(u="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:u,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class S extends m.Component{constructor(e,t){super(e,t),this.state={name:"",email:"",message:""},this.submit=this.submit.bind(this)}onChange(e,t){const n={};n[e]=t.target.value,this.setState(n)}async submit(e){e.preventDefault(),await h.Z.post("contact",new b.K(this.state)),this.props.notify("Message sent","success"),this.setState({name:"",email:"",message:""})}render(){return g("form",{onSubmit:this.submit,className:"contact-form"},void 0,g("div",{className:"form-group"},void 0,g("label",{className:"form-group-label",htmlFor:"name"},void 0,g(f.vN,{},void 0,"Name")),g("input",{required:!0,name:"name",className:"form-control",onChange:this.onChange.bind(this,"name"),value:this.state.name})),g("div",{className:"form-group"},void 0,g("label",{className:"form-group-label",htmlFor:"email"},void 0,g(f.vN,{},void 0,"Email")),g("input",{required:!0,name:"email",className:"form-control",onChange:this.onChange.bind(this,"email"),value:this.state.email})),g("div",{className:"form-group"},void 0,g("label",{className:"form-group-label",htmlFor:"message"},void 0,g(f.vN,{},void 0,"Message")),g("textarea",{required:!0,name:"message",className:"form-control",onChange:this.onChange.bind(this,"message"),value:this.state.message})),g("button",{type:"submit",className:"btn btn-success"},void 0,g(i.JO,{icon:"paper-plane"})," ",g("span",{className:"btn-label"},void 0,g(f.vN,{},void 0,"Send"))))}}const w=(0,a.connect)(null,(function(e){return(0,v.bindActionCreators)({notify:y.h},e)}))(S);var N=n(38904);const O=(e,t=!1)=>t?(e=>e.trim().replace(/[#|\\|/|*|?|"|<|>|=|||\s|:|.|[|\]|%]/gi,"_").replace(/^[_|\-|+|$]/,"").toLowerCase())(e):e.trim().replace(/[^a-z0-9]/gi,"_").toLowerCase();var P=n(21292),C=n(35940);const k=(e,t)=>e.split(".").reduce(((e,t)=>e&&t?e.toJS?e.get(t):e[t]:e),t),_=(e,t,n)=>{console.error("Error on EntityData: "),console.error("value-of: ",t,"; label-of: ",n),console.error(e)};var j;function I(e,t,n,o){j||(j="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:j,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const D=(0,a.connect)((({entityView:e,templates:t,thesauris:n,settings:o})=>({entity:e.entity,templates:t,thesauri:n,newNameGeneration:o.collection.get("newNameGeneration")||!1}))),T=["title","creationDate","editDate"],E=({formattedEntity:e,propertyName:t})=>e[t],x=({formattedEntity:e,propertyName:t,newNameGeneration:n})=>{const o=e.metadata.find((e=>e.name===O(t,n)));return(0,P.q)(o,!1)},A=({propertyName:e,template:t})=>{var n;const o=(0,C.zx)(t),r=(null===(n=o.get("commonProperties"))||void 0===n?void 0:n.find((t=>(null==t?void 0:t.get("name"))===e)).get("label"))||"",i="title"===e?o.get("_id"):"System";return I(f.vN,{context:i},void 0,r)},$=({formattedEntity:e,propertyName:t,newNameGeneration:n})=>{const o=(({formattedEntity:e,propertyName:t,newNameGeneration:n})=>e.metadata.find((e=>e.name===O(t,n))))({formattedEntity:e,propertyName:t,newNameGeneration:n});return I(f.vN,{context:o.translateContext},void 0,o.label)},R=D((({entity:e,templates:t,thesauri:n,"value-of":o,"label-of":r,newNameGeneration:i})=>{const a=N.Z.prepareMetadata(e.toJS(),t,n),s=t.find((t=>(null==t?void 0:t.get("_id"))===e.get("template")));let l=m.createElement(m.Fragment,null);try{const e=((e,t)=>{if(e&&t)throw new Error('Can\'t provide both "value-of" and "label-of".');const n=e||t;if(!n)throw new Error('"value-of" or "label-of" must be provided.');return n})(o,r),t=((e,t)=>{const n=T.includes(t);return e?n?E:x:n?A:$})(o,e);l=m.createElement(m.Fragment,null,t({formattedEntity:a,propertyName:e,newNameGeneration:i,template:s}))}catch(e){_(e,o,r)}return l}));var F=n(2530);const L=({data:e,children:t,showIf:n})=>e.filter((0,F.ZP)(n)).length>0?t:null;var J;function Z(e,t,n,o){J||(J="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:J,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const z=(0,a.connect)((({templates:e,entityView:t})=>({entity:t.entity,templates:e}))),K=(e,t)=>{switch(e.type){case"multiselect":case"multidaterange":case"nested":case"multidate":case"geolocation":return t.map((e=>e.label||e.value));case"relationship":{let e=[];return t.forEach((t=>{if(t.inheritedType&&t.inheritedValue){const n=K({type:t.inheritedType},t.inheritedValue);e=Array.isArray(n)?[...e,...n]:[...e,n]}else e.push(t.label||t.value)})),Array.from(new Set(e))}case"generatedid":return"string"==typeof t?t:t[0].value;default:return t[0].label||t[0].value}},B=z((({entity:e,templates:t,children:n,"show-if":o})=>{const r=e.toJS(),i=t.find((e=>(null==e?void 0:e.get("_id"))===r.template)),a=(s=r.metadata,l=i.toJS(),Object.keys(s).reduce(((e,t)=>{if(!s[t].length)return e;const n=l.properties.find((e=>e.name===t)),o=K(n,s[t]);return V(V({},e),{},{[t]:o})}),{}));var s,l;r.metadata=a;try{const e=JSON.parse(o);return Z(L,{data:[r],showIf:e},void 0,n)}catch(e){return _(e,o),null}})),H=m.createContext("");var q;function W(e,t,n,o){q||(q="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:q,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class G extends m.Component{render(){const{children:e}=this.props;return W(H.Consumer,{},void 0,(t=>{const n=`/entity/${t.toJS?t.get("sharedId"):t.sharedId}`;return W(f.l3,{to:n},void 0,e)}))}}G.defaultProps={children:""};var Q,Y=n(43393),X=n(80129),ee=n.n(X),te=n(43857),ne=n(30743),oe=n(93673),re=n(49935);function ie(e,t,n,o){Q||(Q="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Q,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ae=(e,t)=>e>=0?e%t:t+e,se=(e,t,n)=>{if(!e.length)return[];let o=e.map(((e,t)=>t));e.length>n&&(o=((e,t,n)=>{const o=-Math.floor(t/2),r=[];for(let n=0;n<t;n+=1)r.push(e+o+n);return r.map((e=>ae(e,n)))})(t,n,e.length));return o.map((t=>e[t]))};class le extends m.Component{constructor(e){super(e),this.state={currentIndex:0}}componentDidMount(){const{initialIndex:e}=this.props;this.setState({currentIndex:e||0})}slide(e){let{currentIndex:t}=this.state;const{children:n}=this.props;t=ae(t+e,n.length),this.setState({currentIndex:t})}render(){const{children:e,visibleCount:t}=this.props,{currentIndex:n}=this.state,o=se(e,n,t);return ie("div",{className:"slider"},void 0,e.length>t&&ie("div",{className:"slider-buttons"},void 0,ie("button",{className:"slider-btn",onClick:()=>this.slide(-1)},void 0,ie(i.JO,{icon:"angle-left"})),ie("button",{className:"slider-btn",onClick:()=>this.slide(1)},void 0,ie(i.JO,{icon:"angle-right"}))),ie("div",{className:"slider-items"},void 0,o))}}var ce;function de(e,t,n,o){ce||(ce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pe extends m.Component{render(){const{items:e,link:t}=this.props,{sort:n}=ee().parse(t.substring(t.indexOf("?")),{ignoreQueryPrefix:!0}),o=n?{sort:n}:{sort:"title"},r=e=>(0,v.bindActionCreators)({onClick:(e,t)=>(0,oe.qC)(t)},(0,re.Qd)(e,"library")),i=e.map(((e,t)=>de((0,a.connect)(null,r)(ne.ZP),{doc:(0,Y.fromJS)(e),searchParams:o,storeKey:"library"},t)));let s=de(te.aO,{},void 0,i);return this.props.options.slider&&(s=de(te.aO,{},void 0,de(le,{visibleCount:3},void 0,i))),de("div",{},void 0,s,de("div",{className:"row"},void 0,de("div",{className:"col-sm-12 text-center"},void 0,de(f.l3,{to:`${t}`},void 0,de("button",{className:"btn btn-default"},void 0,(0,f.t)("System","View in library"))))))}}pe.defaultProps={items:[],options:{}};const ue=pe;var me;function fe(e,t,n,o){me||(me="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:me,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class he extends m.Component{render(){const{path:e,children:t}=this.props;return fe(H.Consumer,{},void 0,(n=>(k(e,n)||[]).map(((e,n)=>fe(H.Provider,{value:e},n,t)))))}}const ve=he,ye=["children"];var be;function ge(e,t,n,o){be||(be="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:be,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Se(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pe extends m.Component{static objectPath(e,t){return e.split(".").reduce(((e,t)=>e.toJS?e.get(t):e[t]),t)}static renderChildren(e,t){return Array.isArray(e)?e.map(((e,n)=>m.cloneElement(e,Ne(Ne({},t),{},{index:n})))):m.cloneElement(e,t)}render(){const e=this.props,{children:t}=e,n=Se(e,ye);return ge(H.Provider,{value:n},void 0,Pe.renderChildren(t,n))}}const Ce=(e,t)=>Object.keys(t).reduce(((n,o)=>{if("children"===o)return Object.assign(n,{children:t.children});const r=k(t[o],e);return Object.assign(n,{[o]:r})}),{}),ke=(0,a.connectAdvanced)((()=>Ce))(Pe);var _e,je=n(33530),Ie=n(74371),De=n(76395);function Te(e,t,n,o){_e||(_e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:_e,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ee=e=>Te("div",{},void 0,Te(Ie.L2,{template:e.properties.entity.template}),"  ",e.properties.entity.title),xe=e=>{const{data:t,classname:n,scrollZoom:o,showControls:r}=e,i=t=>e.getAndSelectDocument(t.properties.entity.sharedId),a=t=>{e.unselectAllDocuments(),e.selectDocuments(t.map((e=>e.properties.entity)))};return Te("div",{className:`Map ${n}`},void 0,t?Te(je.sR,{entities:t},void 0,(e=>Te(je.D5,{markers:e,zoom:1,clickOnMarker:i,clickOnCluster:a,renderPopupInfo:Ee,cluster:!0,scrollZoom:"true"===o,showControls:"true"===r}))):Te(De.Z,{}))};xe.defaultProps={classname:"",data:null,scrollZoom:null,showControls:null};const Ae=(0,a.connect)(((e,t)=>({data:c.Z.getRows(e,t)})),(e=>(0,v.bindActionCreators)({getAndSelectDocument:oe.Gj,selectDocuments:oe.aE,unselectAllDocuments:oe.jh},(0,re.Qd)(e,"library"))),null)(xe);var $e,Re=n(13572),Fe=n(63977);function Le(e,t,n,o){$e||($e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$e,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Je=({paypalid:e,classname:t,children:n,currency:o,amount:i})=>{const a=`https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=${e}&currency_code=${o}${i?`&amount=${i}`:""}&source=url`;return t+=" paypal-donate",Le(r.rU,{className:t,href:a,target:"_blank",rel:"noreferrer noopener"},void 0,n)};Je.defaultProps={children:"",classname:"",amount:null};const Ze=Je;var Me,Ve=n(55505),Ue=n(79223),ze=n(83668),Ke=n(11992),Be=n(66139),He=n(88601),qe=n(85518),We=n(24876);function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ge.apply(this,arguments)}function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t,n,o){Me||(Me="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Me,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class et extends m.Component{static renderTitle(e){const t=e.get("commonProperties").find((e=>"title"===e.get("name"))),n=Boolean(t.get("generatedId"));let o=Xe(Ue.oT.text,{id:"title",className:"form-control",model:".title"});return n&&(o=m.cloneElement(o,{defaultValue:(0,We.y)(3,4,4)})),Xe(Be.cw,{model:".title"},"title",Xe("ul",{className:"search__filter"},void 0,Xe("li",{},void 0,Xe("label",{htmlFor:"title"},void 0,Xe(f.vN,{context:e.get("_id")},void 0,t.get("label")),Xe("span",{className:"required"},void 0,"*"))),Xe("li",{className:"wide"},void 0,o)))}static renderSubmitState(){return Xe("div",{className:"public-form submiting"},void 0,Xe("h3",{},void 0,Xe(f.vN,{},void 0,"Submiting")),Xe(De.Z,{}))}constructor(e){super(e),this.removeAttachment=this.removeAttachment.bind(this),this.fileDropped=this.fileDropped.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.validators=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){Ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({captcha:{required:e=>e&&e.text.length}},Ve.sC.generate(e.template.toJS()));const t=e.template.get("commonProperties").find((e=>"title"===e.get("name")&&!0===e.get("generatedId")));this.state={submiting:!1,files:[],generatedIdTitle:t}}fileDropped(e){const t=e;this.state.files.forEach((e=>t.push(e))),this.setState({files:t})}async removeAttachment(e){if(await this.setState((t=>({files:t.files.filter((t=>t!==e))}))),!this.state.files.length){document.querySelector('input[name="publicform.file"]').value=""}}attachDispatch(e){this.formDispatch=e}resetForm(){this.formDispatch(Ue.Nw.reset("publicform")),this.state.generatedIdTitle&&this.formDispatch(Ue.Nw.load("publicform",{title:(0,We.y)(3,4,4)}))}async handleSubmit(e){const{submit:t,remote:n}=this.props,o=await(0,Ve.jn)(e,this.state.files,this.props.template.toJS());try{const e=await t(o,n);this.setState({submiting:!0}),await e.promise,this.resetForm(),this.setState({submiting:!1,files:[]})}catch(e){this.setState({submiting:!1})}this.refreshCaptcha()}renderFileField(e,t){const n={className:"form-control on-mobile",model:`.${e}`},o=Object.assign(n,t);return Xe("div",{className:"form-group"},void 0,Xe("ul",{className:"search__filter"},void 0,Xe("li",{className:"attachments-list"},void 0,Xe(f.vN,{},void 0,"file"===e?"Document":"Attachments"),Xe(qe.I3,{},void 0,Xe(He.Z,{onDrop:this.fileDropped,className:"dropzone",accept:"file"===e?".pdf":void 0},void 0,Xe("label",{},void 0,Xe("div",{className:"text-content"},void 0,Xe("div",{id:"icon"},void 0,Xe(i.JO,{icon:"cloud-upload-alt"})),Xe("div",{id:"upload-text"},void 0,Xe(f.vN,{},void 0,"Drop your files here to upload or")),Xe("div",{id:"upload-button"},void 0,Xe("div",{id:"button"},void 0,Xe(f.vN,{},void 0,"Select files on your device"))))))),Xe(qe.$,{},void 0,m.createElement(Ue.oT.file,Ge({id:e},o,{onChange:e=>this.fileDropped([...e.target.files])}))),Xe("div",{className:"preview-list"},void 0,Xe("ul",{},void 0,this.state.files.map((e=>Xe("li",{},e.preview,Xe("div",{className:"preview-title"},void 0,e.name),Xe("div",{},void 0,Xe("span",{onClick:()=>this.removeAttachment(e)},void 0,Xe(i.JO,{icon:"times"})," ",Xe(f.vN,{},void 0,"Remove")))))))))))}renderCaptcha(){return Xe(Be.cw,{model:".captcha"},"captcha",Xe("ul",{className:"search__filter"},void 0,Xe("li",{},void 0,Xe("label",{},void 0,Xe(f.vN,{},void 0,"Captcha"),Xe("span",{className:"required"},void 0,"*"))),Xe("li",{className:"wide"},void 0,Xe(ze.UG,{remote:this.props.remote,refresh:e=>{this.refreshCaptcha=e},model:".captcha"}))))}render(){const{template:e,thesauris:t,file:n,attachments:o}=this.props,{submiting:r}=this.state;return Xe(Ue.hD,{validators:this.validators,model:"publicform",getDispatch:e=>this.attachDispatch(e),onSubmit:this.handleSubmit},void 0,r&&et.renderSubmitState(),!r&&Xe("div",{className:"public-form"},void 0,et.renderTitle(e),Xe(Ve.S$,{thesauris:t,model:"publicform",template:e,boundChange:(e,t)=>this.formDispatch(Ue.Nw.change(e,t))}),!!n&&this.renderFileField("file",{accept:".pdf"}),!!o&&this.renderFileField("attachments",{multiple:"multiple"}),this.renderCaptcha(),Xe("button",{type:"submit",className:"btn btn-success"},void 0,Xe(f.vN,{},void 0,"Submit"))))}}const tt=(0,a.connect)(((e,t)=>({template:e.templates.find((e=>e.get("_id")===t.template)),thesauris:e.thesauris,file:void 0!==t.file,remote:void 0!==t.remote,attachments:void 0!==t.attachments})),(function(e){return(0,v.bindActionCreators)({submit:Ke.au},e)}))(et);var nt;function ot(e,t,n,o){nt||(nt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:nt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class rt extends m.Component{renderChildren(e){const{path:t}=this.props;return t?k(t,e):e}render(){const{property:e,value:t}=this.props;return e?this.renderChildren(t):ot(H.Consumer,{},void 0,(e=>this.renderChildren(e)))}}rt.defaultProps={value:"-",path:"",property:""};const it=(0,a.connect)(((e,t)=>t.property?{value:c.Z.getMetadataValue(e,t)}:{}))(rt);var at,st=n(73581),lt=n.n(st),ct=n(13265),dt=n(4271);function pt(e,t,n,o){at||(at="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:at,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ut=({searchTerm:e})=>{r.mW.push(`/library/?q=${lt().encode({searchTerm:e})}`)},mt=({placeholder:e,classname:t})=>pt("div",{className:`search-box ${t}`},void 0,pt(Ue.l0,{model:"library.search",onSubmit:ut},void 0,pt("div",{className:"input-group"},void 0,pt("button",{type:"submit",className:"btn btn-primary"},void 0,pt(i.JO,{icon:"search"})),pt(Ue.gN,{model:".searchTerm"},void 0,pt("input",{className:"form-control",type:"text",placeholder:e})))),pt(ct.Z,{label:(0,f.t)("System","Search Tips",null,!1),title:(0,f.t)("System","Narrow down your searches",null,!1)},void 0,pt(dt.o,{})));mt.defaultProps={placeholder:"",classname:""};const ft=mt;class ht extends m.Component{constructor(e){super(e),this.getAndSelect=this.getAndSelect.bind(this)}async getAndSelect(e){const{getAndSelectDocument:t}=this.props;t(e)}render(){const{entity:e,tag:t,classname:n,children:o}=this.props;return m.createElement(t,{className:n,onClick:()=>this.getAndSelect(e)},o)}}ht.defaultProps={entity:"",tag:"div",children:"",classname:""};const vt=(0,a.connect)((()=>({})),(e=>(0,v.bindActionCreators)({getAndSelectDocument:oe.Gj},(0,re.Qd)(e,"library"))))(ht),yt=(0,o.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(157),n.e(736)]).then(n.bind(n,2925)))),bt=(0,o.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(157),n.e(181)]).then(n.bind(n,76943)))),gt=(0,o.ZP)((async()=>n.e(809).then(n.bind(n,41096)))),St=(0,o.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(931),n.e(192)]).then(n.bind(n,58160)))),wt=(0,o.ZP)((async()=>n.e(155).then(n.bind(n,17105)))),Nt=(0,o.ZP)((async()=>Promise.all([n.e(481),n.e(29),n.e(931),n.e(418)]).then(n.bind(n,17645))))},94534:(e,t,n)=>{"use strict";n.d(t,{Z:()=>he,N:()=>fe.Z});var o,r=n(67294),i=n(73581),a=n.n(i),s=n(53641),l=n(27199),c=n(37974),d=n(98373),p=n(47794),u=(n(43393),n(50530)),m=n(76395);function f(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class h extends r.Component{componentDidMount(){this.props.getData.call(this).then((([e,t,n])=>{this.setState({groupedResults:e,setA:t,setB:n})}))}render(){let e=f(m.Z,{});if(this.state&&this.state.groupedResults){const{aggregations:t}=this.state.groupedResults,n=this.props.thesauris.find((e=>"58b2f3a35d59f31e1345b480"===e.get("_id")));let o=u.sq.sortValues(t.all.pa_s.buckets.filter((e=>e.filtered.doc_count&&"any"!==e.key)).map((e=>{const t=e,o=n.get("values").find((e=>e.get("id")===t.key));return t.label=o?o.get("label"):(0,s.t)("System","No Value",null,!1),t.results=t.filtered.doc_count,t})));o=this.props.prepareData.call(this,o,this.state.setA,this.state.setB),e=f("div",{className:"item item-chart"},void 0,f("p",{},void 0,this.props.label),f(u.LM,{data:o,chartLabel:this.props.label}))}return f("div",{className:"item-group-charts",style:{paddingTop:"15px",paddingRight:"15px"}},void 0,e)}}h.defaultProps={label:null};const v=h;const y={findBucketsByCountry:function(e,t,n){return e.aggregations.all[t].buckets.find((e=>e.key===n))}},b="58b2f3a35d59f31e1345b48a",g="58b2f3a35d59f31e1345b4a4",S="pa_s";function w(e){return p.Z.search(new d.K({types:e,limit:0}))}function N(){const e=[[b,g],[b],[g]];return Promise.all(e.map(w))}function O(e,t,n){const o=this.props.templates.find((e=>e.get("_id")===b)),r=(0,s.t)(b,o.get("name"),null,!1),i=this.props.templates.find((e=>e.get("_id")===g)),a=(0,s.t)(g,i.get("name"),null,!1);return e.map((e=>{const o=e,i=y.findBucketsByCountry(t,S,o.key),s=y.findBucketsByCountry(n,S,o.key);return o.name=o.label,o.setALabel=r,o.setAValue=i?i.filtered.doc_count:0,o.setBLabel=a,o.setBValue=s?s.filtered.doc_count:0,o}))}const P=(0,c.connect)((function({templates:e,thesauris:t}){return{templates:e,thesauris:t,getData:N,prepareData:O}}))(v);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const j="pa_s",I="58b2f3a35d59f31e1345b52d";function D(e,t){return k(k({},e),{},{sexo:{values:[t]}})}function T(e){return p.Z.search(new d.K({types:["58b2f3a35d59f31e1345b4b6"],filters:e,limit:0}))}function E(){const e={};e[this.props.filterProperty]={from:-2208988800};const t=D(e,"dedcc624-0e11-4d4e-90d5-d1c0ea4c7a18"),n=D(e,"f2457229-e142-4b74-b595-2ac2f9b5f64e");return Promise.all([e,t,n].map(T))}function x(e,t,n){return e.map((e=>{const o=e,r=y.findBucketsByCountry(t,j,o.key),i=y.findBucketsByCountry(n,j,o.key);return o.name=o.label,o.setALabel=(0,s.t)(I,"Hombre",null,!1),o.setAValue=r?r.filtered.doc_count:0,o.setBLabel=(0,s.t)(I,"Mujer",null,!1),o.setBValue=i?i.filtered.doc_count:0,o}))}const A=(0,c.connect)((function({thesauris:e},{filterProperty:t="mandatos_de_la_corte"}){return{thesauris:e,getData:E,prepareData:x,filterProperty:t}}))(v);var $,R=n(72027);function F(e,t,n,o){$||($="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const L=["58b2f3a35d59f31e1345b48a"],J=["58b2f3a35d59f31e1345b4a4"],Z=["58b2f3a35d59f31e1345b4ac","58b2f3a35d59f31e1345b471","58b2f3a35d59f31e1345b482","58b2f3a35d59f31e1345b479"];class M extends r.Component{getData(){p.Z.search({limit:0}).then((e=>{this.setState({data:e.aggregations.all})}))}conformLibraryLink(e,t){const n=e.map((e=>`%27${e}%27`));return t&&-1!==t.indexOf("/library/")?t.substring(t.indexOf("/library/"),t.length):`/library/?q=(order:desc,sort:creationDate,types:!(${n.join(",")}),userSelectedSorting:!t)`}getCount(e){return e.reduce(((e,t)=>{const n=this.state.data.types.buckets.find((e=>e.key===t));return e+(n?n.filtered.doc_count:0)}),0)}componentDidMount(){this.getData()}render(){const{title:e="",buttons:t=[],links:n=[]}=this.props,o=F(R.JO,{icon:"spinner",pulse:!0,fixedWidth:!0});let r=o,i=o,a=o;return this.state&&this.state.data&&(r=this.getCount(L),i=this.getCount(J),a=this.getCount(Z)),F("div",{className:"hero"},void 0,F("h1",{},void 0,e),F("div",{className:"hero-stats"},void 0,F(s.l3,{to:this.conformLibraryLink(L,n.length&&n[0]?n[0]:null)},void 0,F("h2",{},void 0,r),F("span",{},void 0,t[0])),F(s.l3,{to:this.conformLibraryLink(J,n.length&&n[1]?n[1]:null)},void 0,F("h2",{},void 0,i),F("span",{},void 0,t[1])),F(s.l3,{to:this.conformLibraryLink(Z,n.length&&n[2]?n[2]:null)},void 0,F("h2",{},void 0,a),F("span",{},void 0,t[2]))))}}const V={cejilChart001:P,CejilChart002:A,cejilHero:(0,c.connect)((function({templates:e,thesauris:t}){return{templates:e,thesauris:t}}))(M)};var U=n(38086),z=n.n(U),K=n(9980),B=n.n(K),H=n(40591),q=n.n(H);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Y=Object.keys(l).reduce(((e,t)=>G(G({},e),{},{[t.toLowerCase()]:l[t]})),{}),X=Object.keys(Y),ee=new U.Parser({xmlMode:!0}),te=new(z().ProcessNodeDefinitions)(r),ne="{\\w+}\\(.+\\)\\(.+\\)|{\\w+}\\(.+\\)",oe={validate:()=>!0,render(e,t){const n=e[t];return"container_dynamic_open"===n.type?`<div class="${n.info.trim()}">`:"</div>"}},re=B()({xhtmlOut:!0}).use(q(),"dynamic",oe),ie=B()({html:!0,xhtmlOut:!0}).use(q(),"dynamic",oe),ae=/{(.+)}\(/,se=e=>{let t;const n=/{\w+}(\(.+\)\(.+\))|{\w+}(\(.+\))/g.exec(e);return n&&(t=n[1]||n[2]),t},le=(e,t,n=!1)=>{let o=re;n&&(o=ie);const r=e.replace(new RegExp(`(${ne})`,"g"),"$1\n"),i=(e=>e.replace(/((\/)?(table|thead|tbody|tr|th|td)>)[\s\n]+(<(\/)?(table|thead|tbody|tr|th|td))/g,"$1$4").replace(/((\/)?(table|thead|tbody|tr|th|td)>)[\s\n]+(<(\/)?(table|thead|tbody|tr|th|td))/g,"$1$4"))(o.render(r).replace(new RegExp(`<p>(${ne})</p>`,"g"),"<placeholder>$1</placeholder>")),a=[{shouldProcessNode:()=>!0,processNode:(e,n,o)=>{if(e.name&&("dataset"===e.name.toLowerCase()||"query"===e.name.toLowerCase()))return!1;const r="placeholder"===e.name&&e.children&&e.children[0]&&e.children[0].data&&e.children[0].data.match(ne),i=e&&(!e.parent||e.parent&&"placeholder"!==e.parent.name)&&e.data&&e.data.match(ne),{type:a,config:s}=((e,t,n,o)=>{let r,i=e;return n&&([,r]=t.children[0].data.match(ae),i=se(t.children[0].data)),o&&([,r]=t.data.match(ae),i=se(t.data)),r=X.includes(t.name?t.name.toLowerCase():"")?Y[t.name.toLowerCase()]:r,{type:r,config:i}})(e.attribs,e,r,i);return t(a,s,o,n)||te.processDefaultNode(e,n,o)}}];return ee.parseWithInstructions(i,(e=>!("tag"===e.type&&e.name.match(/<|>/g))),a)};function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ce.apply(this,arguments)}var de;function pe(e,t,n,o){de||(de="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:de,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ue extends r.Component{static errorHtml(e,t){return pe("p",{className:"error"},e,pe("br",{}),pe("strong",{},void 0,pe("i",{},void 0,pe(s.vN,{translationKey:"Custom component error"},void 0,"Custom component markup error: unsuported values! Please check your configuration"))),pe("br",{}),t,pe("br",{}))}static customHook(e,t){const n=a().decode(e);if(!V[n.component])throw new Error("Invalid  component");const o=V[n.component];return r.createElement(o,ce({},n,{key:t}))}inlineComponent(e,t,n){const{compact:o}=this.props;let i;return"list"===e&&(i=this.list(t,n)),"link"===e&&(i=r.createElement(l.MarkdownLink,ce({},a().decode(t),{key:n}))),"searchbox"===e&&(i=r.createElement(l.SearchBox,ce({},a().decode(t),{key:n}))),["vimeo","youtube","media"].includes(e)&&(i=pe("div",{},n,pe(l.MarkdownMedia,{config:t,compact:o},n))),"customhook"===e&&(i=ue.customHook(t,n)),i}customComponent(e,t,n,o){try{if("function"==typeof e||"object"==typeof e){const i=e;return r.createElement(i,ce({},t,{key:n}),o)}if(e)return this.inlineComponent(e,t,n)}catch(e){return ue.errorHtml(n,e.message)}return!1}list(e,t){const n=this.props.lists[this.renderedLists]||{},o=pe(l.ItemList,{link:`/library/${n.params}`,items:n.items,options:n.options},t);return this.renderedLists+=1,o}render(){this.renderedLists=0;const e=le(this.props.markdown,this.customComponent.bind(this),this.props.html);return!!e&&pe("div",{className:"markdown-viewer"},void 0,e)}}ue.defaultProps={lists:[],markdown:"",html:!1,compact:!1};const me=ue;var fe=n(56053);const he=me},56053:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var o=n(50763),r=n.n(o),i=n(80129),a=n.n(i),s=n(73581),l=n.n(s),c=n(93302),d=n.n(c),p=n(47794),u=n(38562),m=n(2080);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y=e=>e.entity?e:(({url:e="",geolocation:t=!1})=>{const{q:n}=a().parse(e.substring(e.indexOf("?")),{ignoreQueryPrefix:!0});if(!n)return t?{allAggregations:!0,limit:0,geolocation:!0}:{allAggregations:!0,limit:0};const o=l().decode(n);return o.limit=0,t&&(o.geolocation=!0),o})(e),b=e=>e.reduce(((e,t)=>{const n=t.params.extractFirstRow?t.data.rows[0]:t.data;return h(h({},e),{},{[t.name]:n})}),{}),g=(e,{property:t,dataset:n="default"})=>{const o=e.page.datasets.get(n);return o?o.getIn(["aggregations","all",t,"buckets"]):void 0},S={async fetch(e,t,{additionalDatasets:n={}}={}){const o=(e=>{const t={};return new(r())({onopentag(e,n){"dataset"===e&&(t[n.name||"default"]=y(n)),"query"===e&&(t[n.name||"default"]={url:n.url,query:!0})}},{decodeEntities:!0}).parseComplete(e),t})(e);return((e,t)=>Promise.all(Object.keys(e).map((n=>{if(e[n].query)return u.Z.get(e[n].url,t).then((t=>({data:t.json,name:n,params:e[n]})));const o=e[n].entity?m.Z.get:p.Z.search,r=e[n].entity?{sharedId:e[n].entity}:e[n],i=e[n].entity?e=>e[0]:e=>e;return o(t.set(r)).then(i).then((t=>({data:t,name:n,params:e[n]})))}))))(h(h({},o),n),t).then(b)},getRows(e,{dataset:t="default"}){const n=e.page.datasets.get(t);if(n)return n.get("rows")},getAggregations:g,getAggregation(e,{uniqueValues:t,property:n,value:o,dataset:r="default"}){const i=g(e,{property:n,dataset:r});if(!i)return;if(t)return i.filter((e=>0!==e.getIn(["filtered","doc_count"]))).size;return((e,t)=>{let n=new(d())(0);return t.forEach((t=>{const o=e.find((e=>e.get("key")===t)),r=o?o.getIn(["filtered","doc_count"]):0;n=n.plus(r||0)})),Number(n)})(i,o?o.split(","):[""])},getMetadataValue(e,{property:t,dataset:n="default"}){const o=e.page.datasets.get(n),r=o&&o.hasIn(["metadata",t])?o.getIn(["metadata",t]).toJS():[];return r&&r.length&&r[0].value?Number(r[0].value):void 0}}},96220:(e,t,n)=>{"use strict";n.r(t),n.d(t,{UnwrapMetadataObject:()=>b,changeTemplate:()=>N,clearMetadataSelections:()=>_,getSuggestions:()=>k,loadFetchedInReduxForm:()=>S,loadInReduxForm:()=>w,loadTemplate:()=>O,multipleUpdate:()=>C,removeIcon:()=>P,resetMetadata:()=>y,resetReduxForm:()=>v});var o=n(79223),r=n(45398),i=n(59276),a=n(39263),s=n(93673),l=n(98373),c=n(47794),d=n(59511),p=n(24876),u=n(98562);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){return o.Nw.reset(e)}const y=(e,t,n,o)=>{const r={};return t.properties.forEach((t=>{const i=n.resetExisting||!((e,t)=>t&&Boolean(t.properties.find((t=>t.name===e.name&&t.type===e.type&&t.content===e.content))))(t,o)||!e[t.name],{type:a,name:s}=t;if(i||(r[t.name]=e[t.name]),i){const e=((e,t)=>{switch(e){case"daterange":return{from:null,to:null};case"generatedid":return t.resetExisting?void 0:(0,p.y)(3,4,4);case"multiselect":case"relationship":case"nested":case"multidate":case"multidaterange":return[];default:return["date","geolocation","link"].includes(e)?void 0:""}})(a,n);void 0!==e&&(r[s]=e)}})),r},b=(e,t)=>Object.keys(e).reduce(((n,o)=>{if(!e[o].length)return n;const r=((e,t)=>{switch(e.type){case"multiselect":case"multidaterange":case"nested":case"relationship":case"multidate":case"geolocation":return t.map((e=>e.value));case"generatedid":return"string"==typeof t?t:t[0].value;default:return t[0].value}})(t.properties.find((e=>e.name===o)),e[o]);return f(f({},n),{},{[o]:r})}),{});function g(e,t){return!e.title&&t.commonProperties.find((e=>"title"===e.name&&e.generatedId))?(0,p.y)(3,4,4):e.title}function S(e,t,n){const i=(0,r.Y)(n,{property:"name"}),a=i.find((e=>e.default)),s=t.template||a._id,l=i.find((e=>e._id===s))||u.Z,c=g(t,l),p={};l.properties.forEach((e=>{"relationship"===e.type&&(p[e.name]=t.metadata?t.metadata[e.name]:[])}));const m=b(y(f({},t.metadata),l,{resetExisting:!1},l),l);return[o.Nw.reset(e),o.Nw.load(e,f(f({},t),{},{metadata:m,template:s,title:c})),o.Nw.setPristine(e),d.N.set("entityThesauris",p)]}function w(e,t,n){return o=>{(t.sharedId?i.h.get(new l.K({sharedId:t.sharedId})):Promise.resolve([t])).then((([t])=>{const{attachments:i}=t,a=i?(0,r.Y)(i,{property:"originalname"}):i,s=f(f({},t),{},{attachments:a});S(e,s,n).forEach((e=>o(e)))}))}}function N(e,t){return(n,r)=>{const i=f({},(0,o.PD)(r(),e)),{templates:a}=r(),s=a.find((e=>e.get("_id")===t)),l=a.find((e=>e.get("_id")===i.template)),c=s.toJS(),d=g(i,c);i.metadata=y(i.metadata,c,{resetExisting:!1},l.toJS()),i.template=s.get("_id"),n(o.Nw.reset(e)),setTimeout((()=>{n(o.Nw.load(e,f(f({},i),{},{title:d})))}))}}function O(e,t){return n=>{const r={template:t._id,metadata:{}};r.metadata=y(r.metadata,t,{resetExisting:!0}),n(o.Nw.load(e,r)),n(o.Nw.setPristine(e))}}function P(e){return o.Nw.change(e,{_id:null,type:"Empty"})}function C(e,t){return async n=>{const o=e.map((e=>e.get("sharedId"))).toJS(),r=await i.h.multipleUpdate(new l.K({ids:o,values:t}));return n(a.J.notify("Update success","success")),void 0!==t.published&&(await n((0,s.jh)()),n((0,s.u$)(r))),r}}async function k(e,t=""){const n=new l.K({searchTerm:t,templates:e});return c.Z.getSuggestions(n)}const _=()=>d.N.unset("documentViewer.metadataExtraction",["selections"])},73842:(e,t,n)=>{"use strict";n.d(t,{NE:()=>m,e3:()=>u,kN:()=>f});var o=n(79223),r=n(2080),i=n(59511),a=n(39263),s=n(53641),l=n(98373);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=(e,t,n)=>{const o=d({},e),r=d(d({},n&&{propertyID:n}),{},{name:t,timestamp:Date(),selection:o});return i.N.updateIn("documentViewer.metadataExtraction",["selections"],r,"propertyID")},m=(e,t,n)=>o=>{var r;const a=null==e?void 0:e.toJS(),s=null==a||null===(r=a.extractedMetadata)||void 0===r?void 0:r.filter((e=>"title"===t&&"title"!==e.name||e.propertyID!==n)),l=d(d({},n&&{propertyID:n}),{},{name:t,selection:{text:"",selectionRectangles:[]},deleteSelection:!0});return[o(i.N.setIn("viewer/doc","defaultDoc",d(d({},a),{},{extractedMetadata:s}))),o(i.N.updateIn("documentViewer.metadataExtraction",["selections"],l,"propertyID"))]},f=async(e,t,n,i)=>{if("date"===n){const n=new l.K({locale:i,value:e,type:"date"}),{value:c,success:d}=await r.Z.coerceValue(n);return d?o.Nw.change(t,c):a.J.notify((0,s.t)("System","Value cannot be transformed to date",null,!1),"danger")}return"numeric"===n&&Number.isNaN(Number.parseInt(e,10))?o.Nw.change(t,"0"):o.Nw.change(t,e)}},90392:(e,t,n)=>{"use strict";n.d(t,{L5:()=>s,MG:()=>c,f:()=>l});var o=n(79223),r=n(63978),i=n(84545),a=n(96384);const s=(e,t,n,s)=>async l=>(0,r.f)(t,(r=>{const c={originalname:t.name,filename:t.name,serializedFile:r,type:"attachment",mimetype:t.type,entity:e,fileLocalID:s||(0,i.Z)()};l(o.Nw.push(`${n.model}.attachments`,c)),l({type:a.s0,entity:e,progress:100})})),l=(e,t,n)=>r=>{const{name:i,url:s}=t,l={originalname:i,url:s,entity:e};r(o.Nw.push(`${n.model}.attachments`,l)),r({type:a.s0,entity:e,progress:100})},c=e=>t=>{t({type:a.Qn,entity:e})}},21667:(e,t,n)=>{"use strict";n.d(t,{O:()=>P});var o,r,i=n(67294),a=n(9075),s=n(72027),l=n(53641),c=n(55505),d=n(69899),p=n(18719),u=n(69474),m=n(37265),f=n(98373),h=n(43393),v=n.n(h),y=n(47794);function b(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends i.Component{constructor(e){super(e),this.state={searchResults:v().fromJS([]),searching:!1,touched:!1},this.onSelect=this.onSelect.bind(this),this.onChange=this.onChange.bind(this),this.search=this.search.bind(this)}componentDidMount(){this.props.initialSearchTerm&&this.search(this.props.initialSearchTerm)}onSelect(e,t){this.props.onSelect(t)}search(e){this.setState({searching:!0});const t=new f.K({searchTerm:e,fields:["title"],includeUnpublished:!0});return y.Z.search(t).then((({rows:t})=>{this.setState({searchResults:v().fromJS(t),searching:!1}),this.props.onFinishSearch(e)}))}onChange(e){this.setState({touched:!0});const t=e.target.value;return(0,m.Z)(this.search,400)(t)}render(){const{searchResults:e,searching:t}=this.state;return i.createElement(i.Fragment,null,b("div",{className:"search-box"},void 0,b(u.Z,{onChange:this.onChange,value:this.state.touched?void 0:this.props.initialSearchTerm})),b(p.Z,{results:e,searching:t,onClick:this.onSelect}))}}function S(e,t,n,o){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=o;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class P extends i.Component{constructor(e){super(e),this.state={propsToCopy:[],selectedEntity:{},lastSearch:void 0},this.onSelect=this.onSelect.bind(this),this.cancel=this.cancel.bind(this),this.copy=this.copy.bind(this),this.backToSearch=this.backToSearch.bind(this),this.onFinishedSearch=this.onFinishedSearch.bind(this)}onSelect(e){const t=e.template,n=this.props.templates.toJS(),o=this.props.originalEntity.template,r=a.Z.comonProperties(n,[o,t],["generatedid"]).map((e=>e.name));this.setState({selectedEntity:e,propsToCopy:r}),this.props.onSelect(r,e)}copy(){if(!this.state.selectedEntity.metadata)return;const e=this.state.propsToCopy.reduce(((e,t)=>(e.metadata||(e.metadata={}),e.metadata[t]=this.state.selectedEntity.metadata[t],e)),N(N({},this.props.originalEntity),{},{metadata:N({},this.props.originalEntity.metadata)}));c.Nw.loadFetchedInReduxForm(this.props.formModel,e,this.props.templates.toJS()).forEach((e=>null===d.h||void 0===d.h?void 0:d.h.dispatch(e))),this.props.onSelect([]),this.props.onCancel()}backToSearch(){this.setState({propsToCopy:[],selectedEntity:{}}),this.props.onSelect([])}cancel(){this.props.onSelect([]),this.props.onCancel()}onFinishedSearch(e){this.setState({lastSearch:e})}renderPanel(){return this.state.selectedEntity._id?i.createElement(i.Fragment,null,S("div",{className:"view"},void 0,S(c.ZG,{entity:this.state.selectedEntity,highlight:this.state.propsToCopy,excludePreview:!0})),S("div",{className:"copy-from-buttons"},void 0,S("button",{className:"back-copy-from btn btn-light",onClick:this.backToSearch},void 0,S(s.JO,{icon:"arrow-left"}),S("span",{className:"btn-label"},void 0,S(l.vN,{},void 0,"Back to search"))),S("button",{className:"cancel-copy-from btn btn-primary",onClick:this.cancel},void 0,S(s.JO,{icon:"times"}),S("span",{className:"btn-label"},void 0,S(l.vN,{},void 0,"Cancel"))),S("button",{className:"copy-copy-from btn btn-success",onClick:this.copy},void 0,S(s.JO,{icon:"copy-from",transform:"left-0.075 up-0.1"}),S("span",{className:"btn-label"},void 0,S(l.vN,{},void 0,"Copy Highlighted"))))):i.createElement(i.Fragment,null,S(g,{onSelect:this.onSelect,onFinishSearch:this.onFinishedSearch,initialSearchTerm:this.state.lastSearch}),S("div",{className:"copy-from-buttons"},void 0,S("button",{className:"cancel-copy-from btn btn-primary",onClick:this.cancel},void 0,S(s.JO,{icon:"times"}),S("span",{className:"btn-label"},void 0,S(l.vN,{},void 0,"Cancel")))))}render(){return S("div",{className:"copy-from"},void 0,this.renderPanel())}}},91020:(e,t,n)=>{"use strict";n.d(t,{J:()=>d});n(67294);var o,r=n(74127),i=n(37974),a=n(96486),s=n(53641),l=n(73842);function c(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const d=(0,i.connect)((e=>({entityDocument:e.documentViewer.doc.get("defaultDoc"),newSelections:e.documentViewer.metadataExtraction.get("selections")})),(e=>(0,r.bindActionCreators)({deleteSelectionAction:l.NE},e)),((e,t,n)=>({onClickFunction:()=>t.deleteSelectionAction(e.entityDocument,n.propertyName,n.propertyID),ownProps:n,stateProps:e})))((({onClickFunction:e,ownProps:t,stateProps:n})=>{var o,r,i;const l="title"===t.propertyName?"title":t.propertyID,d=(0,a.uniqBy)([...(null===(o=n.newSelections)||void 0===o?void 0:o.toJS())||[],...(null===(r=n.entityDocument)||void 0===r||null===(i=r.get("extractedMetadata"))||void 0===i?void 0:i.toJS())||[]],"propertyID"),p=!!l&&((e,t)=>null==t?void 0:t.filter((t=>!t.deleteSelection&&("title"===e&&"title"===t.name||t.propertyID===e))))(l,d);return p&&p.length?c("button",{type:"button",className:"delete-selection",onClick:e},void 0,c(s.vN,{translationKey:"Clear PDF selection"},void 0,"Clear PDF selection")):null}))},46029:(e,t,n)=>{"use strict";n.d(t,{p:()=>$,v:()=>j});var o=n(67294),r=n(83253),i=n.n(r),a=n(22004),s=n(74127),l=n(37974),c=n(79223),d=n(96486),p=n(53641),u=n(72027),m=n(84545),f=n(77140),h=n(90392),v=n(80983);var y,b=n(56755),g=n.n(b),S=n(52949),w=n(85212);function N(e,t,n,o){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const O=({filteredAttachments:e,handleAttachmentClick:t,selectedUrl:n})=>e.length>0?N("div",{className:"media-grid container"},void 0,N("div",{className:"row"},void 0,e.map((e=>{const o=e.url||e.fileLocalID||`/api/files/${e.filename}`,r=(0,w.Vo)(e)&&e.serializedFile?e.serializedFile.length:e.size,i=r?g()(r):"_";return N("div",{className:"media-grid-item",onClick:t(o)},`attachment_${e._id}`,N("div",{className:"media-grid-card "+(o===n?"active":"")},void 0,N("div",{className:"media-grid-card-header"},void 0,N("h5",{},void 0,e.originalname),N("span",{style:r?{}:{color:"#FFFFFF"}},void 0,i)),N("div",{className:"media-grid-card-content"},void 0,N("div",{className:"media"},void 0,N(S.JX,{attachment:e})))))})))):N("h4",{className:"empty-attachments-message"},void 0,N(p.vN,{},void 0,"No attachments"));var P;function C(e,t,n,o){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const k=({formModel:e,acceptedFileTypes:t,inputFileRef:n,handleFileInPublicForm:r,handleUploadButtonClicked:i,handleInputFileChange:a})=>{const s=e=>C("div",{className:"upload-button"},void 0,C("button",{type:"button",onClick:i,className:"btn"},void 0,C(u.JO,{icon:"cloud-upload-alt"}),"  ",C(p.vN,{},void 0,"Select from computer")),o.createElement("input",{"aria-label":"fileInput",type:"file",onChange:e,style:{display:"none"},ref:n,accept:t}));return"publicform"===e?C(c.gN,{"aria-label":"fileInput",model:".file",component:()=>s(r),type:"file"}):s(a)};var _,j;function I(e,t,n,o){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.Image=0]="Image",e[e.Media=1]="Media"}(j||(j={}));const x=e=>e===j.Image?"image/*":"video/*";function A(e,t){const n=t.map((e=>{const t=e.url&&!e.mimetype?(e=>{var t;const n=["image","audio","text","video"],o=null==e||null===(t=e.split(/[#?]/)[0].split(".").pop())||void 0===t?void 0:t.trim();if(o){const e=v.lookup(o)||"text/html";if(n.includes(e.split("/")[0]))return e}return"text/html"})(e.url):e.mimetype;return T(T({},e),{},{mimetype:t})}));switch(e){case j.Image:return n.filter((e=>e.mimetype&&e.mimetype.includes("image")));case j.Media:return n.filter((e=>e.mimetype&&(e.mimetype.includes("video")||e.mimetype.includes("audio"))||e.url&&a.Z.canPlay(e.url)));default:return t}}const $=(0,l.connect)(((e,t)=>{const n=t.formModel;return{entity:(0,d.get)(e,n)}}),(e=>(0,s.bindActionCreators)({localAttachmentAction:h.L5,rrfChange:c.Nw.change},e)))((({isOpen:e,attachments:t=[],selectedUrl:n,entity:r,formModel:a,formField:s,type:l,multipleEdition:c,onClose:d,onChange:h,localAttachmentAction:v,rrfChange:y})=>{const b=(0,o.useMemo)((()=>A(l,t)),[t,l]),g=(0,o.useRef)(null);return I(i(),{isOpen:e,className:"attachments-modal",overlayClassName:"attachments-modal__overlay",ariaHideApp:!1},void 0,I("div",{className:"attachments-modal__header"},void 0,I("h4",{},void 0,I(p.vN,{},void 0,"Supporting files")),I("button",{type:"button",onClick:d,className:"attachments-modal__close"},void 0,I(u.JO,{icon:"times"}),I("span",{},void 0,I(p.vN,{},void 0,"Close")))),I("div",{className:"attachments-modal__content"},void 0,I("div",{className:"attachments-modal__tabs-content"},void 0,I("div",{className:"upload-options"},void 0,!c&&I(k,{formModel:a,acceptedFileTypes:x(l),inputFileRef:g,handleUploadButtonClicked:()=>{var e;null===(e=g.current)||void 0===e||e.click()},handleFileInPublicForm:e=>{const{files:t}=e.target;if(t&&t.length>0){const e={data:URL.createObjectURL(t[0]),originalFile:t[0]};h(e),d()}},handleInputFileChange:async e=>{const[t]=e.target.files||[];if(t){const e=(0,m.Z)();v(r.sharedId||"NEW_ENTITY",t,{__reducerKey:"library",model:a},e),y(s,e),d()}}}),!c&&I(p.vN,{},void 0,"or"),I("div",{className:"wrapper-web"},void 0,I(f.n,{handleSubmit:e=>{h(e.url),d()}}))),I("div",{className:"tab-content attachments-modal__tabs-content "+(b.length?"":"centered")},void 0,I(O,{filteredAttachments:b,handleAttachmentClick:e=>()=>{h(e),d()},selectedUrl:n||""})))))}))},21292:(e,t,n)=>{"use strict";n.d(t,{Z:()=>re,q:()=>ee});var o,r=n(67294),i=n(96486),a=n(53641),s=n(94534),l=n(11628),c=n.n(l),d=n(33530);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},p.apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const v=({points:e,onlyForCards:t})=>{if(t)return h("div",{},void 0,e.filter((e=>Boolean(e))).map(((e,t)=>{const n=c()(e.lat,e.lon);return h("div",{},t,e.label?`${e.label}: `:"",n.format("DD MM ss X",{latLonSeparator:", ",decimalPlaces:0}))})));const n=[];e.filter((e=>Boolean(e))).forEach((({lat:e,lon:t,label:o,color:r})=>{n.push({latitude:e,longitude:t,properties:m({info:o},r?{color:r}:{})})}));const o=n.length?{latitude:n[0].latitude,longitude:n[0].longitude}:{};return r.createElement(r.Fragment,null,r.createElement(d.D5,p({},o,{height:370,markers:n,mapStyleSwitcher:!0,showControls:!0})),h("div",{className:"print-view-alt"},void 0,h("p",{},void 0,h(a.vN,{},void 0,"Latitude"),": ",o.latitude),h("p",{},void 0,h(a.vN,{},void 0,"Longitude"),": ",o.longitude)))};v.defaultProps={points:[],onlyForCards:!0};const y=v;var b,g=n(37974),S=n(22222),w=n(74127),N=n(35940),O=n(49510),P=n(52173);function C(e,t,n,o){b||(b="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:b,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const I=(0,S.P1)((e=>e.templates),(e=>e.reduce(((e,t)=>_(_({},e),{},{[(0,N.zx)(null==t?void 0:t.get("_id"))]:{name:null==t?void 0:t.get("name"),color:null==t?void 0:t.get("color")}})),{})));const D=(0,g.connect)((e=>({templatesInfo:I(e)})),(function(e){return(0,w.bindActionCreators)({selectConnection:P.selectConnection},e)})),T=e=>1===e.value.length&&!e.value[0].label,E=(e,t,n)=>{var o;return(null===(o=t[e.translateContext])||void 0===o?void 0:o.color)||t[n].color},x=(e,t,n)=>C("dl",{className:"pills-container"},e.map((e=>`${e.translateContext}_${e.name}`)).join(","),C("dt",{}),C("dd",{},void 0,e.map((e=>C(O.D,{color:E(e,t,n)},`${e.value[0].lat}_${e.value[0].lon}`,C(a.vN,{context:n},void 0,e.label)))))),A=(e,t,n,o)=>{const i=[],s=[];return e.forEach((e=>{T(e)?i.push(e):s.push(e)})),[i.length?x(i,t,o):null].concat(s.map(((e,t,n)=>o=>{var i;return C("dl",{className:"pills-container"},`${o.translateContext}_${o.name}`,C("dt",{},void 0,C("span",{},void 0,C(a.vN,{context:n},void 0,o.label),(null===(i=e[o.translateContext])||void 0===i?void 0:i.name)&&r.createElement(r.Fragment,null," (",C(a.vN,{},void 0,"linked")," ",C(a.vN,{context:n},void 0,e[o.translateContext].name),") "))),C("dd",{},void 0,o.value.map((r=>C("div",{onClick:()=>r.relatedEntity&&t(r.relatedEntity),style:{cursor:r.relatedEntity?"pointer":"default"}},`${r.lat}_${r.lon}`,C(O.D,{color:E(o,e,n)},`${r.lat}_${r.lon}`,C(a.vN,{context:o.translateContext},void 0,r.label||"")))))))})(t,n,o)))},$=D((e=>{const t=e.members.reduce(((t,n)=>T(n)?t.concat([_(_({},n.value[0]),{},{label:n.label,color:E(n,e.templatesInfo,e.templateId)})]):t.concat(n.value.map((t=>_(_({},t),{},{color:E(n,e.templatesInfo,e.templateId)}))))),[]);return r.createElement(r.Fragment,null,C(y,{points:t,onlyForCards:!1}),A(e.members,e.templatesInfo,e.selectConnection,e.templateId))}));var R,F=n(74371);function L(e,t,n,o){R||(R="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:R,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const J=(0,g.connect)((({entityView:e})=>({uiState:e.uiState})),(function(e){return(0,w.bindActionCreators)({selectConnection:P.selectConnection},e)}))((({propValue:e,selectConnection:t})=>e.relatedEntity?L("button",{type:"button",className:"link-button",onClick:()=>t(e.relatedEntity)},e.url,e.icon&&L(F.JO,{className:"item-icon",data:e.icon}),e.value):L(a.l3,{to:e.url},e.url,e.icon&&L(F.JO,{className:"item-icon",data:e.icon}),e.value)));function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U;function z(e,t,n,o){U||(U="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:U,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const K=e=>"string"==typeof e.value&&void 0!==e.icon?r.createElement(r.Fragment,null,z(F.JO,{data:e.icon}),z("span",{},void 0," ")):null,B=(e,t,n)=>z("li",{className:"item-value"},t,((e,t)=>e.valueCount>1?z(r.Fragment,{},t,K(e),e.value," ",z("span",{className:"item-count"},void 0,e.valueCount)):r.createElement(r.Fragment,null,K(e),e.value))(e,`item-value-${n}`)),H=e=>e.value.reduce(((e,t)=>{const n=e.find((e=>e.value===t.value));return n?n.valueCount+=1:e.push(M(M({},t),{},{valueCount:1})),e}),[]),q=({property:e,compact:t})=>{const n=M(M({},e),{},{value:H(e)});return t?z("ul",{className:"compact comma-separated"},void 0,n.value.map(((e,t)=>B(e,t,t)))):(e=>z("ul",{className:"multiline"},void 0,e.value.map(((t,n)=>{const o=`${e.name}_${n}`;return B(t,o,n)}))))(n)};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y;function X(e,t,n,o){Y||(Y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ee=(e,t,n)=>{let o=e.value;switch(e.type){case null:o=(0,a.t)("System","No property");break;case"markdown":o=X(s.Z,{html:!0,markdown:e.value});break;case"link":o=X("a",{href:e.value.url,target:"_blank",rel:"noopener noreferrer"},void 0,e.value.label?e.value.label:e.value.url);break;case"image":o=e.value&&X("img",{className:`multimedia-img ${e.style}`,src:e.value,alt:e.label},e.value);break;case"media":o=e.value&&X(s.Z,{markdown:`{media}(${e.value})`,compact:!0});break;case"geolocation":o=X(y,{points:e.value,onlyForCards:Boolean(e.onlyForCards||t)});break;case"select":o=e.parent?`${e.parent}: ${e.value}`:o;break;case"geolocation_group":o=X($,{members:e.members,templateId:n});break;case"relationship":o=((e,t)=>{const n=(Array.isArray(e.value)?e.value:[e.value]).map((e=>({value:X(J,{propValue:e})}))),o=G(G({},e),{},{value:n});return X(q,{compact:t,property:o})})(e,t);break;default:if(e.value&&e.value.map){const r=(0,i.flattenDeep)(e.value.map((e=>e.parent&&Array.isArray(e.value)?(0,i.flattenDeep)(e.value.map((t=>G(G({},t),{},{value:`${e.parent}: ${t.value}`})))):e)));e.value=r.map((e=>{const o=ee(e,t,n);return o&&o.value?o:G({value:o},void 0!==e.icon?{icon:e.icon}:{})})),o=X(q,{compact:t,property:e})}}return o},te=(e,t)=>{const n=[];let o=t,r=e[o].indexInTemplate-1;for(;o<e.length&&"geolocation"===e[o].type&&e[o].indexInTemplate===r+1;)n.push(e[o]),r=e[o].indexInTemplate,o+=1;return[n,o]},ne=e=>1===e.length?{type:"geolocation_group",name:"geolocation_group",label:e[0].label,translateContext:e[0].translateContext,members:e}:{type:"geolocation_group",label:"Combined geolocations",members:e};const oe=({metadata:e,compact:t,renderLabel:n,showSubset:o,highlight:i,groupGeolocations:s,templateId:l})=>{const c=e.filter(function(e){return t=>!(e&&!e.includes(t.name))&&(Array.isArray(t.value)?t.value.length:t.value||null===t.type||"numeric"===t.type&&0===t.value)}(o)),d=(e=>e.map((e=>("inherit"===e.type&&"relationship"===e.inheritedType&&(e.value=e.value.reduce(((e,t)=>e.concat(t.value||[])),[])),e))))(c),p=s?(e=>{const t=[];let n=0;for(;n<e.length;)if("geolocation"!==e[n].type)t.push(e[n]),n+=1;else{const[o,r]=te(e,n);n=r,t.push(ne(o))}return t})(d):d;return r.createElement(r.Fragment,null,p.map(((e,o)=>{let r=e.type?e.type:"default";r="image"===r||"media"===r?"multimedia":r;const s=i.includes(e.name)?"highlight":"",c=e.fullWidth?"full-width":"";return X("dl",{className:`metadata-type-${r} metadata-name-${e.name} ${c} ${s}`},`${e.name}_${o}`,n(e,X("dt",{},void 0,(0,a.t)(e.translateContext||"System",e.label))),X("dd",{className:e.sortedBy?"item-current-sort":""},void 0,ee(e,t,l)))})))};oe.defaultProps={compact:!1,showSubset:void 0,renderLabel:(e,t)=>t,highlight:[],groupGeolocations:!1};const re=oe},30637:(e,t,n)=>{"use strict";n.d(t,{c:()=>p});n(67294);var o,r=n(74127),i=n(37974),a=n(72027),s=n(53641),l=n(39263),c=n(73842);function d(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p=(0,i.connect)((e=>({selection:e.documentViewer.uiState.get("reference").get("sourceRange")})),((e,t)=>{const{fieldName:n,fieldId:o,model:i,fieldType:a,locale:s}=t;return(0,r.bindActionCreators)({updateField:e=>async t=>{t(await(0,c.kN)(e,i,a,s))},setSelection:e=>(0,c.e3)(e,n,o),notify:l.J.notify},e)}))((({selection:e,setSelection:t,updateField:n,notify:o})=>e?d("button",{type:"button",onClick:async()=>{var r;null!==(r=e.selectionRectangles)&&void 0!==r&&r.length||o((0,s.t)("System","Could not detect the area for the selected text",null,!1),"warning"),t(e),n(e.text)},className:"extraction-button"},void 0,d("span",{},void 0,d(s.vN,{},void 0,"Click to fill")," ",d(a.JO,{icon:"bullseye"}))):null))},19796:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>G});var o,r=n(82673),i=n(66139),a=n(53641),s=n(39263),l=n(83668),c=n(43393),d=n.n(c),p=n(67294),u=n(37974),m=n(79223),f=n(74127),h=n(22222),v=n(72027),y=n(55505),b=n(98562),g=n(18408);function S(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class w extends p.Component{constructor(e){super(e),this.state={show:e.open},this.show=this.show.bind(this),this.hide=this.hide.bind(this)}show(){this.setState({show:!0})}hide(){this.setState({show:!1}),this.props.onHide()}render(){return p.createElement(p.Fragment,null,!this.state.show&&S("button",{onClick:this.show},void 0,this.props.showLabel),this.state.show&&S("button",{onClick:this.hide},void 0,this.props.hideLabel),this.state.show&&this.props.children)}}w.defaultProps={onHide:()=>{},showLabel:"show",hideLabel:"hide",open:!1};const N=w;var O;function P(e,t,n,o){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const C=(0,u.connect)(null,(function(e){return(0,f.bindActionCreators)({removeIcon:y.Nw.removeIcon},e)}))((({model:e,removeIcon:t})=>P(i.Ks,{model:`${e}.icon`},void 0,((n={})=>P("div",{className:"icon-selector"},void 0,P(N,{showLabel:P("span",{},void 0,P(a.vN,{},void 0,"add icon"),P(v.JO,{icon:"eye"})),hideLabel:P("span",{},void 0,P(a.vN,{},void 0,"remove icon"),P(v.JO,{icon:"eye-slash"})),onHide:()=>t(`${e}.icon`),open:!!n._id},void 0,P("ul",{className:"search__filter"},void 0,P("li",{},void 0,P("label",{},void 0,P(a.vN,{},void 0,"Icon")," / ",P(a.vN,{},void 0,"Flag"))),P("li",{className:"wide"},void 0,P(l.wB,{model:".icon"})))))))));var k,_=n(67941),j=n(30637),I=n(26159),D=n(90392),T=n(32820),E=n(84545);function x(e,t,n,o){k||(k="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:k,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const A=(e,t,n)=>"attachment"===t?`.attachments.${n}.originalname`:e._id?`.documents.${n}.originalname`:`.documents.${n}.originalFile.name`,$=(0,u.connect)(null,((e,t)=>{const{model:n,type:o}=t,r="attachment"===o?`${n}.attachments`:`${n}.documents`;return(0,f.bindActionCreators)({removeFile:e=>m.Nw.remove(r,e)},e)}))((({files:e=[],removeFile:t,type:n})=>x("div",{className:"attachments-list editor"},void 0,e.map(((e,o)=>x("div",{className:e._id?"attachment":"attachment new"},e._id||(0,E.Z)(),x("div",{className:"attachment-thumbnail"},void 0,(e=>{let t=x("span",{"no-translate":!0},void 0,x(v.JO,{icon:"file"})," file");return e.filename&&"pdf"===(0,T.m)(e.filename)&&(t=x("span",{"no-translate":!0},void 0,x(v.JO,{icon:"file-pdf"})," pdf")),e.url&&(t=x("span",{},void 0,x(v.JO,{icon:"link"}))),!e.serializedFile&&e.filename&&-1!==["png","gif","jpg","jpeg"].indexOf((0,T.m)(e.filename.toLowerCase()))&&(t=x("img",{src:`/api/files/${e.filename}`,alt:e.originalname})),t})(e)),x("div",{className:"attachment-name"},void 0,x(m.gN,{model:A(e,n,o),updateOn:"blur"},void 0,x("input",{className:"form-control"}))),x("button",{type:"button",className:"btn delete-supporting-file",onClick:()=>t(o)},void 0,x(v.JO,{icon:"trash-alt"}),"  ",x(a.vN,{},void 0,"Delete file"))))))));var R;function F(e,t,n,o){R||(R="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:R,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const L=({supportingFiles:e,entitySharedID:t,model:n})=>F("div",{className:"attachments-list-parent"},void 0,F("div",{className:"attachments-list-header editor"},void 0,F("h2",{},void 0,F(a.vN,{},void 0,"Supporting files")),F(I.ZP,{entitySharedId:t||"NEW_ENTITY",storeKey:"library",uploadAttachment:D.L5,uploadAttachmentFromUrl:D.f,model:n})),F($,{model:n,type:"attachment",files:e}));var J,Z=n(96486);function M(e,t,n,o){J||(J="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:J,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const V=(e,t)=>n=>{const{files:o}=e.target;o&&o.length>0&&Array.from(o).forEach((e=>{const o={data:URL.createObjectURL(e),originalFile:e};n(m.Nw.push(`${t}.documents`,o))}))},U=(0,u.connect)(((e,t)=>({entity:(0,Z.get)(e,t.model)})),(e=>(0,f.bindActionCreators)({handlePDFUploadAction:V},e)))((({model:e,entity:t,handlePDFUploadAction:n})=>{const o=(0,p.useRef)(null);return M("div",{className:"document-list-parent"},void 0,M("div",{className:"attachments-list-header editor"},void 0,M("h2",{},void 0,M(a.vN,{},void 0,"Primary Documents")),M("button",{type:"button",onClick:()=>{var e;null===(e=o.current)||void 0===e||e.click()},className:"btn"},void 0,M(v.JO,{icon:"plus"})," ",M(a.vN,{},void 0,"Add PDF"))),p.createElement("input",{"aria-label":"pdfInput",type:"file",onChange:t=>n(t,e),style:{display:"none"},ref:o,accept:"application/pdf",multiple:!0}),M($,{model:e,type:"document",files:t.documents}))}));var z,K=n(91020);function B(e,t,n,o){z||(z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const H=d().fromJS(b.Z),q=(0,h.P1)((e=>e.templates),(e=>e.map((e=>({label:e.get("name"),value:e.get("_id")})))));class W extends p.Component{constructor(e){super(e),this.onSubmit=this.onSubmit.bind(this),this.onSubmitFailed=this.onSubmitFailed.bind(this)}componentWillUnmount(){this.props.componentWillUnmount()}onSubmit(e){this.props.onSubmit((0,y.Q2)(r.Z.filterBaseProperties(e)),this.props.model)}onSubmitFailed(){this.props.notify((0,a.t)("System","Invalid form",null,!1),"danger")}renderTemplateSelect(e,t){if(e.size){const n=e.toJS().sort(((e,t)=>e.label>t.label?1:-1));return B(l.cw,{},void 0,B("ul",{className:"search__filter"},void 0,B("li",{},void 0,B("label",{},void 0,(0,a.t)("System","Type"))),B("li",{className:"wide"},void 0,void 0!==this.props.initialTemplateId&&this.props.initialTemplateId!==this.props.templateId&&B("span",{},void 0,B(v.JO,{icon:"exclamation-triangle"}),B(a.vN,{context:"System"},void 0,"Changing the type will erase all connections to this entity."))),B("li",{className:"wide"},void 0,B(i.Ph,{className:"form-control",value:t.get("_id"),options:n,onChange:e=>{this.props.changeTemplate(this.props.model,e.target.value)}}))))}return B("ul",{className:"search__filter"},void 0,B("div",{className:"text-center protip"},void 0,B(v.JO,{icon:"lightbulb"})," ",B("b",{},void 0,B(a.vN,{},void 0,"ProTip!")),B("span",{},void 0,B(a.vN,{},void 0,"You can create metadata templates in")," ",B(a.l3,{to:"/settings"},void 0,B(a.vN,{},void 0,"settings")),".")))}render(){const{model:e,template:t,templateOptions:n,id:o,multipleEdition:r,showSubset:i,version:s,storeKey:c,highlightedProps:d,attachments:u,sharedId:f,progress:h}=this.props;if(!t)return B("div",{});const v=t.get("commonProperties")?t.get("commonProperties").find((e=>"title"===e.get("name"))).get("label"):"Title";return B("fieldset",{disabled:void 0!==h},void 0,B(m.l0,{id:o,model:e,onSubmit:this.onSubmit,validators:g.ZP.generate(t.toJS(),r),onSubmitFailed:this.onSubmitFailed},void 0,!r&&(!i||i.includes("title"))&&B(l.cw,{model:".title"},void 0,B("ul",{className:"search__filter"},void 0,B("li",{},void 0,B("label",{},void 0,B(a.vN,{context:t.get("_id")},void 0,v)," ",B("span",{className:"required"},void 0,"*"))),B("li",{className:"wide"},void 0,B("div",{className:"metadata-extractor-container"},void 0,"documentViewer"===c&&B(j.c,{fieldName:"title",model:`${e}.title`}),B(m.gN,{model:".title"},void 0,B("textarea",{className:"form-control"})))),B("div",{className:"form-title-actions"},void 0,"documentViewer"===c&&B(K.J,{propertyName:"title"}),B(C,{model:e})))),(!i||i.includes("template"))&&this.renderTemplateSelect(n,t),B(_.ZP,{multipleEdition:r,thesauris:this.props.thesauris,model:e,template:t,showSubset:i,version:s,highlightedProps:d,storeKey:c}),!r&&!i&&p.createElement(p.Fragment,null,B(U,{entitySharedID:f,model:e}),B(L,{supportingFiles:u,entitySharedID:f,model:e}))))}}W.defaultProps={id:"metadataForm",multipleEdition:!1,showSubset:void 0,version:void 0,initialTemplateId:void 0,componentWillUnmount:()=>{},notify:()=>{},changeTemplate:()=>{},onSubmit:()=>{},highlightedProps:[],storeKey:"",attachments:[],sharedId:"",progress:void 0};const G=(0,u.connect)(((e,t)=>{const n=t.model.split(".").reduce(((e,t)=>e[t]),e),{attachments:o,sharedId:r}=n;return{thesauris:t.thesauris?t.thesauris:e.thesauris||d().fromJS([]),template:t.template?t.template:e.templates.find((e=>e.get("_id")===t.templateId))||H,templateOptions:q(e),attachments:o,sharedId:r,progress:r?e.attachments.progress.get(r):e.attachments.progress.get("NEW_ENTITY")}}),(function(e){return(0,f.bindActionCreators)({notify:s.J.notify},e)}))(W)},67941:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>T,uT:()=>I});var o=n(66139),r=n(53641);var i,a=n(43393),s=n.n(a),l=n(67294),c=n(37974),d=n(79223),p=n(43358),u=n(96220),m=n(24876),f=n(74127),h=n(96959),v=n(83668),y=n(72027);function b(e,t,n,o){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=o;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&r)for(var c in r)void 0===t[c]&&(t[c]=r[c]);else t||(t=r||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class g extends l.Component{render(){return!(!this.props.touched||!this.props.multipleEdition)&&b("span",{},void 0,b(y.JO,{icon:"exclamation-triangle"})," ")}}const S=(0,c.connect)(((e,t)=>{const n=(0,d.rz)(e,`${t.model}.${t.field}`)||{pristine:!0};let o=!n.pristine;return n.$form&&(o=!n.$form.pristine),{touched:o}}))(g);var w,N=n(46029),O=n(30637),P=n(91020);function C(e,t,n,o){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const I=e=>e.get("values").map((t=>{const n=t.toJS();return n.label=(0,r.t)(e.get("_id"),n.label,null,!1),n.values&&(n.options=n.values.map((t=>_(_({},t),{},{label:(0,r.t)(e.get("_id"),t.label,null,!1)})))),n})).toJS();class D extends l.Component{getField(e,t,n,o){let i,a=0;const{dateFormat:s,version:l,entityThesauris:c,attachments:p,localAttachments:f,multipleEdition:h,locale:y}=this.props,b=e.type,g=p.toJS(),S=f;switch(b){case"select":return i=n.find((t=>t.get("_id").toString()===e.content.toString())),C(v.Ph,{model:t,optionsValue:"id",options:I(i),placeholder:"Select..."});case"multiselect":return i=n.find((t=>t.get("_id").toString()===e.content.toString())),C(v.NU,{model:t,optionsValue:"id",options:I(i),prefix:t,forceHoist:"OneUp"===l,placeholder:"OneUp"===l?`${(0,r.t)("System","Search",null,!1)} '${i.get("name")}'`:null});case"relationship":if(e.content){const t=n.find((t=>t.get("_id").toString()===e.content.toString()));a=t.get("optionsCount"),i=I(t)}return e.content||(i=Array.prototype.concat(...n.filter((e=>"template"===e.get("type"))).map((e=>(a+=e.get("optionsCount"),I(e))))).slice(0,200)),c.get(e.name)&&c.get(e.name).toJS().forEach((e=>{i.push({id:e.value,label:e.label})})),C(v.Lu,{lookup:u.getSuggestions.bind(null,e.content?[e.content]:[]),model:t,optionsValue:"id",options:i,totalPossibleOptions:a,prefix:t,onChange:this.relationshipChange.bind(this,e),sort:!0});case"date":return C(v.Mt,{model:t,format:s,locale:y});case"daterange":return C(v.C0,{model:t,format:s,locale:y});case"numeric":return C(v.DX,{model:t});case"markdown":return C(v.sd,{model:t});case"nested":return C(v.d_,{model:t});case"multidate":return C(v.gq,{model:t,format:s,locale:y});case"multidaterange":return C(v.f0,{model:t,format:s,locale:y});case"geolocation":return C(v.bT,{model:t});case"link":return C(v.Ai,{model:t});case"media":return C(v.uh,{model:t,formModel:o,attachments:g,localAttachments:S,type:N.v.Media,multipleEdition:h});case"image":return C(v.uh,{model:t,formModel:o,attachments:g,localAttachments:S,type:N.v.Image,multipleEdition:h});case"preview":return C("div",{},void 0,C("em",{},void 0,C(r.vN,{},void 0,"This content is automatically generated")));case"generatedid":return C(d.gN,{model:t},void 0,C("input",{type:"text",className:"form-control",defaultValue:"publicform"===o?(0,m.y)(3,4,4):void 0}));case"text":return C(d.gN,{model:t},void 0,C("input",{type:"text",className:"form-control"}));default:return!1}}relationshipChange(e,t){var n;const{change:o,model:r}=this.props;null===(n=e.multiEditingRelationshipFields)||void 0===n||n.forEach((e=>{o(`${r}.metadata.${e.name}`,t)}))}renderLabel(e){const{template:t,multipleEdition:n,model:o}=this.props,i=t.get("_id");let a=i?C(r.vN,{context:i},void 0,e.label):e.label;return e.multiEditingRelationshipFields&&(a=l.createElement(l.Fragment,null,C(r.vN,{context:i},void 0,e.label)," (",C(r.vN,{},void 0,"affects")," ",e.multiEditingRelationshipFields.map((e=>C("span",{},e._id,'"',C(r.vN,{context:i},void 0,e.label),'" '))),")",C(h.Z,{icon:"info-circle",position:"right"},void 0,C("p",{},void 0,C(r.vN,{translationKey:"Multiple relationships edit description"},void 0,"Making changes to this property will affect other properties on this template because they all share relationships with the same configuration."))))),C("li",{className:"title"},void 0,C("label",{},void 0,C(S,{multipleEdition:n,model:o,field:`metadata.${e.name}`}),a,e.required?C("span",{className:"required"},void 0,"*"):""))}render(){const{thesauris:e,template:t,model:n,showSubset:r,storeKey:i,locale:a}=this.props,s=e.filter((e=>!!e.get("enable_classification"))).map((e=>e.get("_id"))).toJS();return C("div",{},void 0,(e=>e.map((t=>{if("relationship"!==t.type)return t;const n=e.filter((e=>e.content===t.content&&e.relationType===t.relationType&&e._id!==t._id));return n.length?_(_({},t),{},{multiEditingRelationshipFields:n}):t})).filter((e=>e)))(t.get("properties").toJS()).filter((e=>!r||r.includes(e.name))).map((t=>{const r="documentViewer"===i&&["text","date","numeric","markdown"].includes(t.type);return C(o.cw,{model:`.metadata.${t.name}`,className:"publicform"===n&&"generatedid"===t.type?" hidden ":t.type},t.name,C("ul",{className:"search__filter is-active "+(this.props.highlightedProps.includes(t.name)?"highlight":"")},void 0,this.renderLabel(t),s.includes(t.content)&&[p.D.multiselect,p.D.select].includes(t.type)?C("li",{className:"wide"},void 0,C(v.mT,{model:`.suggestedMetadata.${t.name}`,selectModel:`.metadata.${t.name}`,propertyType:t.type})):null,C("li",{className:"wide"},void 0,C("div",{className:"metadata-extractor-container"},void 0,r&&C(O.c,{fieldName:t.name,fieldId:t._id,fieldType:t.type,model:`${n}.metadata.${t.name}`,locale:a}),this.getField(t,`.metadata.${t.name}`,e,n))),r&&C(P.J,{propertyName:t.name,propertyID:t._id})))})))}}D.defaultProps={multipleEdition:!1,dateFormat:null,version:void 0,showSubset:void 0,entityThesauris:s().fromJS({}),attachments:s().fromJS([]),highlightedProps:[],localAttachments:[],storeKey:"",locale:""};const T=(0,c.connect)(((e,t)=>{const{storeKey:n}=t;let o,r=s().fromJS([]);if("library"===n){const t=e.library.ui.get("selectedDocuments");r=t.size?t.get(0).get("attachments"):void 0,o=e.library.sidepanel.metadata.attachments}if("documentViewer"===n){r=e[n].doc.get("attachments"),o=e[n].sidepanel.metadata.attachments}if(!n){const{entity:t}=e.entityView;r=t.get("attachments"),o=e.entityView.entityForm.attachments}const{locale:i}=e;return{dateFormat:e.settings.collection.get("dateFormat"),entityThesauris:e.entityThesauris,attachments:r,localAttachments:o,locale:i}}),((e,t)=>t.boundChange?{change:t.boundChange}:(0,f.bindActionCreators)({change:d.Nw.change},e)))(D)},49510:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});var o;n(67294);function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const i=e=>r("span",{className:"pill",style:{backgroundColor:e.color}},void 0,e.children)},85072:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(43393),r=n.n(o),i=n(9075);const a=(e,t)=>{const n=t.map((e=>e.get("template"))).filter(((e,t,n)=>n.indexOf(e)===t)),o=i.Z.comonProperties(e,n),a=1===n.size?n.first():"";return t.reduce(((e,t)=>e&&!t.get("template")),!0)?r().fromJS(e.find((e=>e.default))):r().fromJS({_id:a,properties:o})}},98562:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={comonProperties:[{label:"Title",name:"title",isComonProperty:!0,type:"text"}],properties:[]}},38904:(e,t,n)=>{"use strict";n.d(t,{V:()=>v,Z:()=>y});var o=n(80008),r=n.n(o),i=n(43393),a=n.n(i),s=n(45398),l=n(69899),c=n(8229);const d=["parent"];function p(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=(e,t,n,o)=>{if(!e.find((e=>o.includes(`metadata.${e.name}`)))&&!o.includes("creationDate")&&!o.includes("editDate"))return e.push(((e,t)=>e.reduce(((e,n)=>{if(!n.get("properties"))return e;let o=n.get("properties").find((e=>t.includes(`metadata.${e.get("name")}`)));return o&&(o=o.set("type",null).set("translateContext",n.get("_id"))),e||o}),!1))(t,o)).filter((e=>e));let i=((e,t)=>e.map((e=>{const n=m({},e);return n.sortedBy=!1,t.includes(`metadata.${e.name}`)&&(n.sortedBy=!0,e.value||0===e.value||(n.value="No value",n.translateContext="System")),n})))(e,o);return o.includes("creationDate")&&(i=((e,t)=>e.push({value:r()(t.creationDate).format("ll"),label:"Date added",name:"creationDate",translateContext:"System",sortedBy:!0}))(i,n)),o.includes("editDate")&&(i=((e,t)=>e.push({value:r()(t.editDate).format("ll"),label:"Date modified",name:"editDate",translateContext:"System",sortedBy:!0}))(i,n)),i},v={date:e=>r().utc(e,"X").format("ll")},y={formatDateRange(e={}){let t="",n="";return e.value.from&&(t=r().utc(e.value.from,"X").format("ll")),e.value.to&&(n=r().utc(e.value.to,"X").format("ll")),`${t} ~ ${n}`},getSelectOptions(e,t,n){let o,r,i="",a="";var s;e&&(i=e.label||e.value,a=e.value,o=e.icon,r=null===(s=e.parent)||void 0===s?void 0:s.label);let l,c;if(e&&t&&"template"===t.get("type")&&(l=`/entity/${e.value}`),n&&n.relations&&n.relations.length>0){const t=n.relations.find((t=>t.entity===e.value));c=null==t?void 0:t.entityData,c=c?m(m({},c),{},{inheritedProperty:"title"}):c}return{value:i,originalValue:a,url:l,icon:o,parent:r,relatedEntity:c}},multimedia:(e,[{value:t}],n)=>({type:n,label:e.get("label"),name:e.get("name"),style:e.get("style")||"contain",noLabel:Boolean(e.get("noLabel")),value:t}),date(e,t=[{}]){const n=t[0].value,o=v.date(n);return{label:e.get("label"),name:e.get("name"),value:o,timestamp:n}},daterange(e,t){return{label:e.get("label"),name:e.get("name"),value:this.formatDateRange(t[0]),originalValue:t[0].value}},multidate(e,t=[]){const n=t.map((e=>({timestamp:e.value,value:r().utc(e.value,"X").format("ll")})));return{label:e.get("label"),name:e.get("name"),value:n}},multidaterange(e,t=[]){const n=t.map((e=>({value:this.formatDateRange(e),originalValue:e.value})));return{label:e.get("label"),name:e.get("name"),value:n}},image(e,t){return this.multimedia(e,t,"image")},link:(e,[t])=>m(m({},t),{},{type:"link"}),preview(e,t,n,{doc:o}){const r=o.defaultDoc||{};return this.multimedia(e,[{value:r._id?`/api/files/${r._id}.jpg`:null}],"image")},media(e,t){return this.multimedia(e,t,"media")},default:(e,[t])=>t,geolocation:(e,t,n,{onlyForCards:o})=>({label:e.get("label"),name:e.get("name"),value:t.map((e=>e.value)),onlyForCards:Boolean(o),type:"geolocation"}),select(e,[t]){const{value:n,url:o,icon:r,parent:i}=this.getSelectOptions(t);return{label:e.get("label"),name:e.get("name"),originalValue:t.value,value:n,icon:r,url:o,parent:i}},multiselect(e,t){const n=this.getThesauriValues(t),o=n.reduce(((e,t)=>{let{parent:n}=t,o=p(t,d);if(!n)return e.push(o),e;const r=e.find((e=>e.parent===n));if(r)return r.value.push(o),e;const i={value:[o],parent:n};return e.push(i),e}),[]);return{label:e.get("label"),name:e.get("name"),value:o}},inherit(e,t,n,o,r){const i=a().fromJS({label:e.get("label"),name:e.get("name"),type:e.get("inherit").get("type"),noLabel:e.get("noLabel")}),s=i.get("type"),l=this[s]?s:"default";let c=(t||[]).map((t=>{if(t&&t.inheritedValue){if(!t.inheritedValue.length||t.inheritedValue.every((e=>!(e.value||null===s||"numeric"===s&&0===e.value))))return null;const a=((e,t,n,o)=>{const r=e.doc&&e.doc.relations?e.doc.relations.find((e=>e.entity===t.value)):void 0;if(r&&r.entityData){const e=n.find((e=>r.entityData.template===e.get("_id"))).get("properties").find((e=>e.get("_id")===o.get("inherit").get("property")));return m(m({},r.entityData),{},{inheritedProperty:e.get("name")})}})(o,t,r,e);return m(m({},this[l](i,t.inheritedValue,n,o,r)),a&&{relatedEntity:a})}return{}})).filter((e=>e)),d="inherit";return["multidate","multidaterange","multiselect","geolocation"].includes(s)&&(d=s,c=this.flattenInheritedMultiValue(c,s,t||[],void 0,{doc:o.doc})),c=c.filter((e=>e)),m(m({translateContext:e.get("content")},i.toJS()),{},{name:e.get("name"),value:c,label:e.get("label"),type:d,inheritedType:s,onlyForCards:Boolean(o.onlyForCards),indexInTemplate:e.get("indexInTemplate")})},flattenInheritedMultiValue(e,t,n,o,{doc:r}){return e.map(((e,i)=>{let{value:a}=e;if(!a)return[];if("geolocation"===t){const e=this.getSelectOptions(n[i],o,r),t=e.value;a=a.map((n=>m(m({},n),{},{relatedEntity:e.relatedEntity?e.relatedEntity:void 0,label:`${t}${n.label?` (${n.label})`:""}`})))}return a})).flat()},relationship(e,t,n,{doc:o}){const r=a().fromJS({type:"template"}),i=this.getThesauriValues(t,r,o);return{label:e.get("label"),name:e.get("name"),value:i}},markdown:(e,[{value:t}],n,{type:o})=>({label:e.get("label"),name:e.get("name"),value:t,type:o||"markdown"}),nested(e,t,n){if(!t[0])return{label:e.get("label"),name:e.get("name"),value:""};const{locale:o}=l.h.getState(),r=Object.keys(t[0].value).sort();let i=`| ${r.map((e=>c.Z[e.toLowerCase()]?c.Z[e.toLowerCase()][`key_${o}`]:e)).join(" | ")}|\n`;return i+=`| ${r.map((()=>"-")).join(" | ")}|\n`,i+=`${t.map((e=>`| ${r.map((t=>(e.value[t]||[]).join(", "))).join(" | ")}`)).join("|\n")}|`,this.markdown(e,[{value:i}],n,{type:"markdown"})},getThesauriValues(e,t,n){return(0,s.Y)(e.map((e=>this.getSelectOptions(e,t,n))).filter((e=>e.value)),{property:"value"})},prepareMetadataForCard(e,t,n,o){return this.prepareMetadata(e,t,n,null,{onlyForCards:!0,sortedProperties:[o]})},prepareMetadata(e,t,n,o,r={}){const i=m({metadata:{}},e),a=m({sortedProperties:[]},r),s=t.find((e=>e.get("_id")===i.template));if(!s||!n.size)return m(m({},i),{},{metadata:[],documentType:""});let l=s.get("properties").map(((e,t)=>e.set("indexInTemplate",t))).filter(this.filterProperties(a.onlyForCards,a.sortedProperties,{excludePreview:a.excludePreview})).map((e=>this.applyTransformation(e,{doc:i,thesauri:n,options:a,template:s,templates:t,relationships:o})));return l=h(l,t,i,a.sortedProperties),m(m({},i),{},{metadata:l.toJS(),documentType:s.get("name")})},applyTransformation(e,{doc:t,thesauri:n,options:o,template:r,templates:i}){const a=t.metadata[e.get("name")],s=e.get("showInCard");if(e.get("inherit"))return this.inherit(e,a,n,m(m({},o),{},{doc:t}),i);const l=this[e.get("type")]?e.get("type"):"default";return a&&a.length||"preview"===l?m(m({translateContext:r.get("_id")},e.toJS()),this[l](e,a,n,m(m({},o),{},{doc:t}))):{label:e.get("label"),name:e.get("name"),type:e.get("type"),value:a,showInCard:s,translateContext:r.get("_id")}},filterProperties:(e,t,n={})=>o=>(!n.excludePreview||"preview"!==o.get("type"))&&(!e||!(!o.get("showInCard")&&!t.includes(`metadata.${o.get("name")}`)))}},18408:(e,t,n)=>{"use strict";function o(e){return Array.isArray(e)?Boolean(e.length):"number"==typeof e||("object"==typeof e&&null!==e?Boolean(Object.keys(e).length):!!e&&""!==e.trim())}function r(e){return!o(e)||!o(e.label)||o(e.label)&&o(e.url)||o(e.url)}function i(e){return!o(e)||o(e[0].lat)&&o(e[0].lon)||!o(e[0].lat)&&!o(e[0].lon)}n.d(t,{Dw:()=>o,ZP:()=>a});const a={generate(e,t=!1){const n={title:{required:o}};return t&&delete n.title,e.properties.forEach((e=>{e.required&&(n[`metadata.${e.name}`]={required:o}),"link"===e.type&&Object.assign(n,(e=>{const t={};return e.required?(t[`metadata.${e.name}.label`]={required:o},t[`metadata.${e.name}.url`]={required:o},t):(t[`metadata.${e.name}`]={required:r},t)})(e)),"geolocation"===e.type&&Object.assign(n,(e=>{const t={};return e.required?(t[`metadata.${e.name}[0].lat`]={required:o},t[`metadata.${e.name}[0].lon`]={required:o},t):(t[`metadata.${e.name}`]={required:i},t)})(e))})),n}}},55505:(e,t,n)=>{"use strict";n.d(t,{ZG:()=>S,n0:()=>Q.ZP,rJ:()=>tt,S$:()=>ot.ZP,W3:()=>mt,$o:()=>W,Nw:()=>o,CN:()=>d.Z,jn:()=>gt,sC:()=>G.ZP,Q2:()=>bt});var o=n(96220),r=n(37974),i=n(67294),a=n(43393),s=n.n(a),l=n(22222),c=n(41865),d=n(38904);const p=e=>e.set("values",e.get("values").reduce(((e,t)=>t.get("values")?e.merge(p(t).get("values")):e.set(t.get("id"),t)),new(s().Map)({}))),u=(0,l.P1)((e=>e.thesauris),(e=>e.map((e=>p(e))))),m={formatMetadata:(0,l.P1)((e=>e.templates),u,(e=>e.settings),((e,t,n,o,r)=>({doc:t,sortProperty:n,references:o,options:r})),((e,t,n,{doc:o,sortProperty:r,references:i,options:a})=>{const s=(0,c.K)(o.documents,o.language,n.get("languages").find((e=>e.get("default"))).get("key"));return r?d.Z.prepareMetadataForCard(Object.assign(o,{defaultDoc:s}),e,t,r).metadata:d.Z.prepareMetadata(Object.assign(o,{defaultDoc:s}),e,t,i,a).metadata})),indexedThesaurus:u};var f=n(21292);const h=["templates","thesauris","settings","excludePreview"],v=["additionalMetadata","sortedProperty","entity","relationships"];function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},y.apply(this,arguments)}function b(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const g=e=>{let{additionalMetadata:t,sortedProperty:n,entity:o,relationships:r}=e,a=b(e,v);return i.createElement(f.Z,y({metadata:t.concat(m.formatMetadata(a,o,n,r,{excludePreview:a.excludePreview})),templateId:o.template,compact:!!n},(e=>{let{templates:t,thesauris:n,settings:o,excludePreview:r}=e;return b(e,h)})(a)))};g.defaultProps={sortedProperty:"",additionalMetadata:[],relationships:s().fromJS([]),excludePreview:!1};const S=(0,r.connect)((function(e,{entity:t,sortedProperty:n=""}){return{templates:e.templates,thesauris:e.thesauris,settings:e.settings.collection,entity:t,sortedProperty:n}}))(g);var w=n(55316),N=n(74371),O=n(62863),P=n(76395),C=n(53641),k=n(19914),_=n(2080),j=n(65969),I=n(98373),D=n(72027),T=n(30381),E=n.n(T);const x="58b2f3a35d59f31e1345b48a",A="58b2f3a35d59f31e1345b4a4",$={judgement:"58b2f3a35d59f31e1345b4ac",admissibilityReport:"58b2f3a35d59f31e1345b479",orderOfThePresident:"58b2f3a35d59f31e1345b482",orderOfTheCourt:"58b2f3a35d59f31e1345b471",letterOfSubmission:"59ee461f40f4a54920bd9b87",meritsReport:"5a4d294c79f3f44b101e2816",fondo:"59ee427f40f4a54920bd9b67",hearing:"5a68ba41e1525a0c66291e22"},R={};var F;function L(e,t,n,o){F||(F="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:F,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const J=Object.keys($).map((e=>$[e])),Z=Object.keys($).reduce(((e,t)=>Object.assign(e,{[$[t]]:R[t]||"fecha"})),{}),M=e=>j.Z.get(new I.K({sharedId:e})),V=e=>{const t=e.map((e=>("document"===e.entityData.type?k.Z.get:_.Z.get)(new I.K({sharedId:e.entityData.sharedId}))));return Promise.all(t)},U=(e,t,n)=>{const o=E().utc(1e3*t).format("YYYY");e[o]=e[o]||[],e[o].push(n)};class z extends i.Component{getTemplateType(e){return this.plainTemplates.reduce(((t,n,o)=>n._id===e?`timeline-item-type-${o}`:t),"")}getDates(e,t){const n=this.props.templates.reduce(((e,t)=>(t.get("properties").forEach((t=>{"multidate"!==t.get("type")&&"date"!==t.get("type")||e.push(t.get("name"))})),e)),[]);return e.metadata.reduce(((e,o)=>(-1!==n.indexOf(o.name)&&("date"===o.type&&e.push({label:o.label,timestamp:o.timestamp,origin:t}),"multidate"===o.type&&(o.value||[]).forEach((n=>{e.push({label:o.label,timestamp:n.timestamp,origin:t})}))),e)),[])}assignActiveYears(e){return Object.keys(e).forEach((t=>{e[t].active=Object.keys(e[t].years).reduce(((n,o)=>(e[t].years[o].length&&(n.start||(n.start=o),n.end=o),n)),{start:null,end:null})})),e}sortEvents(e){return Object.keys(e).reduce(((t,n)=>(e[n].sort(((e,t)=>Number(e.timestamp)>Number(t.timestamp))),!t&&e[n].length?(e[n][0].firstMilestone=!0,!0):t)),null),e}arrangeTracks(e,t,n){const o={};e.forEach((e=>{const t=J.indexOf(-1!==e.data.template),n=e.data.metadata[Z[e.data.template]],r=n[0]&&null!==n[0].value;t&&r&&(U(o,e.data.metadata[Z[e.data.template]][0].value,e),this.assignAdditionalData(e))})),t.forEach((e=>{U(o,e.timestamp,e)}));const r=this.assignActiveYears((e=>["main","related"].reduce(((t,n)=>(t[n]=Object.keys(e).reduce(((t,o)=>(t.years[o]=e[o].filter((e=>"main"===n?"related"!==e.origin:"related"===e.origin)),t)),{years:{},label:"",className:""}),t)),{main:{},related:{}}))((e=>{const t=Number(E()().format("YYYY")),{minYear:n,maxYear:o}=Object.keys(e).reduce(((e,t)=>(e.minYear=Math.min(e.minYear,Number(t)),e.maxYear=Math.max(e.maxYear,Number(t)),e)),{minYear:t,maxYear:0});for(let r=n-3;r<(o||t)+3;r+=1)e[r]=e[r]||[];return e})(this.sortEvents(o))));return n||delete r.related,r}assignTrackLabels(e,t){const n=this.plainTemplates.find((e=>e._id===(t?A:x)));if(e.main.label=(0,C.t)(n._id,n.name),e.main.className=this.getTemplateType(n._id),e.related){const t=this.plainTemplates.find((e=>e._id===A));e.related.label=(0,C.t)(t._id,t.name),e.related.className=this.getTemplateType(t._id)}return e}getRelatedEntity(e,t){let n=Promise.resolve(null);const o=e.find((e=>e.entityData.template===(t?A:x)));return o&&(n=_.Z.get(new I.K({sharedId:o.entityData.sharedId})).then((e=>d.Z.prepareMetadata(e[0],this.props.templates,this.props.thesauris)))),n}getTimelineInfo(e){let t;const n=e.template===x;this.plainTemplates=this.props.templates.toJS(),M(e.sharedId).then((e=>{const t=((e,t)=>{let n=Promise.resolve([]);const o=e.find((e=>e.entityData.template===t));return o&&(n=M(o.entityData.sharedId)),n})(e,n?A:x);return Promise.all([this.getRelatedEntity(e,n),e,t])})).then((([o,r,i])=>(t=this.filterUsefulReferences(e,r,i,n),Promise.all([o,V(t),i])))).then((([o,r,i])=>{const a=t.map(((e,t)=>{const{parentTemplate:n,origin:o}=e;return{reference:e,parentTemplate:n,origin:o,data:r[t][0]}}));let s=n?"main":"related";s=n||o?s:"main";const l=this.getDates(e,s),c=o?this.getDates(o,n?"related":"main"):[],d=l.concat(c),p=!n&&!o;this.setState({references:a,tracks:this.assignTrackLabels(this.arrangeTracks(a,d,i.length),p)})}))}assignAdditionalData(e){Object.keys($).forEach((t=>{e.data.template===$[t]&&(e.additionalData={type:t})})),e.additionalData.className=this.getTemplateType(e.data.template),e.additionalData.date=e.data.metadata[Z[e.data.template]][0].value,e.timestamp=e.data.metadata[Z[e.data.template]][0].value}filterUsefulReferences(e,t,n,o){const r=this.plainTemplates.find((t=>t._id===e.template)).name,i=this.getTemplateType(e.template),a=this.plainTemplates.find((e=>e._id===(o?A:x))).name,s=this.getTemplateType(o?A:x);return t.map((e=>(e.parentTemplate={label:r,className:i},e.origin=o||!n.length?"main":"related",e))).concat(n.map((e=>(e.parentTemplate={label:a,className:s},e.origin=o?"related":"main",e)))).filter((e=>-1!==J.indexOf(e.entityData.template)))}componentDidMount(){this.getTimelineInfo(this.props.entity)}componentWillReceiveProps(e){this.props.entity._id!==e.entity._id&&this.setState({tracks:null},(()=>{this.getTimelineInfo(e.entity)}))}render(){const e={keys:["main"],main:"",related:"",axis:""};return this.state&&this.state.tracks&&(-1!==Object.keys(this.state.tracks).indexOf("related")&&e.keys.push("related"),e.keys.forEach((t=>{const n=this.state.tracks[t];e[t]=Object.keys(n.years).map((e=>{const t=e%5==0?"nth5":"",o=`timeline-year-active ${n.className.replace("timeline-item-","")}`;return L("div",{className:`timeline-year ${t} ${e>=n.active.start&&e<=n.active.end?o:""}`},e,L(w.Z,{if:e===n.active.start},void 0,L("span",{className:`timeline-track-label item-type__name ${n.className}`},void 0,n.label)),n.years[e].map(((e,t)=>{if(e.reference){const n=e.reference.entityData.file?"document":"entity";return L(C.l3,{to:`/${n}/${e.data.sharedId}`,className:`timeline-item ${e.additionalData.className}`,"data-toggle":"tooltip","data-placement":"top","data-animation":"false",title:`${E().utc(1e3*e.additionalData.date).format("ll")}\n${e.data.title}`},t,L(w.Z,{if:e.firstMilestone},void 0,L("span",{className:"timeline-milestone "},void 0,L("span",{},void 0,`${E().utc(1e3*e.additionalData.date).format("MMM YYYY")}`))),L(w.Z,{if:"judgement"===e.additionalData.type},void 0,L(D.JO,{icon:"gavel"})))}if(!e.reference)return L("span",{className:"timeline-item","data-toggle":"tooltip","data-placement":"top","data-animation":"false",title:`${E().utc(1e3*e.timestamp).format("ll")}\n${e.label}`},t,L(w.Z,{if:e.firstMilestone},void 0,L("span",{className:"timeline-milestone "},void 0,L("span",{},void 0,`${E().utc(1e3*e.timestamp).format("MMM YYYY")}`))))})))}))})),e.axis=Object.keys(this.state.tracks.main.years).map((e=>L("div",{className:"timeline-year"},e,L("div",{className:"timeline-label "+(e%5==0?"timeline-label-text":"")},void 0,L("span",{},void 0,e)))))),L("div",{className:"timeline"},void 0,(()=>this.state&&this.state.tracks?null:L(P.Z,{}))(),L(w.Z,{if:Boolean(this.state&&this.state.tracks&&this.state.tracks.related)},void 0,L("div",{className:"timeline-track"},void 0,e.related)),L("div",{className:"timeline-track"},void 0,e.main),L("div",{className:"timeline-track"},void 0,e.axis))}}const K=(0,r.connect)((function({templates:e,thesauris:t},{entity:n}){return{templates:e,thesauris:t,entity:d.Z.prepareMetadata(n,e,t)}}))(z);var B;function H(e,t,n,o){B||(B="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:B,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class q extends i.Component{render(){const{entity:e,showTitle:t,showType:n,relationships:o,showSubset:r,groupGeolocations:i}=this.props;let a="";if(t||n){let o="";t&&(o=H("div",{},void 0,H(O.J,{className:"item-icon item-icon-center",data:e.icon}),H("h1",{className:"item-name"},void 0,e.title,H(N.lH,{doc:s().fromJS(e)}))));a=H("div",{className:"item-info"},void 0,o,n?H(N.L2,{template:e.template}):"")}return H("div",{className:"view"},void 0,a,H(w.Z,{if:e.template===x||e.template===A},void 0,H("dl",{className:"metadata-timeline-viewer"},void 0,H("dd",{},void 0,H(K,{entity:e})))),H(S,{entity:e,relationships:o,showSubset:r,groupGeolocations:i,renderLabel:(e,t)=>!e.noLabel&&t}))}}q.defaultProps={showSubset:void 0,groupGeolocations:!1};const W=(0,r.connect)((({templates:e})=>({templates:e})))(q);var G=n(18408),Q=n(19796),Y=n(45697),X=n.n(Y),ee=n(74127),te=n(49935),ne=n(65879),oe=n(587),re=n(1581),ie=n.n(re),ae=n(90648);const se=(e,t,n)=>n.indexOf(e)===t;var le=n(35940);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ue=new(ie())({allErrors:!0});ue.addVocabulary(["tsType"]);let me,fe,he;!function(e){e.READ="read",e.WRITE="write"}(me||(me={})),function(e){e.MIXED="mixed"}(fe||(fe={})),function(e){e.USER="user",e.GROUP="group",e.PUBLIC="public"}(he||(he={}));const ve={type:"string",enum:Object.values(he)},ye={type:"string",enum:Object.values(de(de({},me),fe))},be={type:"object",additionalProperties:!1,definitions:{objectIdSchema:ae.y6},properties:{refId:ae.y6,type:ve,level:ye},required:["refId","type","level"]};ue.addKeyword({keyword:"uniqueIds",type:"object",errors:!0,validate:(e,t)=>{const n=t.permissions.map((e=>e.refId)),o=n.filter(se);if(n.length!==o.length)throw new(ie().ValidationError)([{keyword:"duplicatedPermissions",schemaPath:"",params:{keyword:"duplicatedPermissions",fields:e},message:"Permissions should be unique by person/group",instancePath:".permissions"}]);return!0}});ae.y6,de({},be),(0,le.bl)(ue.compile({type:"object",uniqueIds:!0}));var ge=n(39263),Se=n(38562);var we=n(33983),Ne=n(93673);var Oe,Pe=n(37265);function Ce(e,t,n,o){Oe||(Oe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Oe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ke={[he.USER]:"user",[he.GROUP]:"users",[he.PUBLIC]:"globe-africa"},_e=({value:{type:e,label:t}})=>Ce("div",{className:"member-list-item"},void 0,Ce("div",{className:"round-icon"},void 0,Ce(D.JO,{icon:ke[e]})),Ce("span",{},void 0,t));var je;function Ie(e,t,n,o){je||(je="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:je,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const De=({onChange:e,onSelect:t,options:n})=>{const[o,r]=(0,i.useState)(null),[a,s]=(0,i.useState)(!1),[l,c]=(0,i.useState)(""),d=(0,i.useCallback)((0,Pe.Z)(e,500),[e]),p=(0,i.useRef)(null);return Ie("div",{className:"userGroupsLookupField"},void 0,Ie("input",{type:"text",placeholder:"Add people or groups",onChange:e=>{s(!0),c(e.target.value),d(e.target.value)},onKeyDown:e=>{switch(e.key){case"ArrowUp":e.preventDefault(),r(o?(o-1)%n.length:n.length-1);break;case"ArrowDown":e.preventDefault(),r(null===o?0:(o+1)%n.length);break;case"Enter":e.preventDefault(),null!==o&&(t(n[o]),s(!1));break;case"Escape":e.preventDefault(),s(!1)}},onBlur:e=>{e.relatedTarget!==p.current&&s(!1)},onFocus:()=>{s(!0)},value:l}),a&&n.length?i.createElement("ul",{tabIndex:-1,role:"listbox",ref:p},n.map(((e,n)=>{return Ie("li",{role:"option","aria-selected":n===o,onClick:(r=e,()=>{t(r),s(!1)}),className:n===o?"selected":""},`${e.type}-${e.refId}`,Ie(_e,{value:e}),Ie("div",{className:"press-enter-note"},void 0,Ie("span",{},void 0,Ie(C.vN,{},void 0,"Press enter to add")),Ie(D.JO,{icon:"level-down-alt",transform:{rotate:90}})));var r}))):null)};var Te;function Ee(e,t,n,o){Te||(Te="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Te,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Re=({value:e,onChange:t,onDelete:n,disabled:o})=>{const[r]=(0,i.useState)(e.level===fe.MIXED);return Ee("select",{value:e.level,onChange:o=>"delete"===o.target.value?n(e):t(Ae(Ae({},e),{},{level:o.target.value})),disabled:o},void 0,r?Ee("option",{value:fe.MIXED},void 0,(0,C.t)("System","Mixed access",null,!1)):null,Ee("option",{value:me.READ},void 0,(0,C.t)("System","Can see",null,!1)),e.type!==he.PUBLIC?Ee("option",{value:me.WRITE},void 0,(0,C.t)("System","Can edit",null,!1)):null,Ee("option",{disabled:!0},void 0,"───────"),Ee("option",{value:"delete"},void 0,(0,C.t)("System","Remove",null,!1)))};var Fe;function Le(e,t,n,o){Fe||(Fe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Fe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Je=({members:e,onChange:t})=>{const n=n=>o=>{const r=[...e];r[n]=o,t(r)},o=n=>{t(e.filter((e=>e!==n)))};return Le("table",{className:"members-list"},void 0,Le("tbody",{},void 0,e.map(((e,t)=>Le("tr",{},`${e.type}-${e.refId}`,Le("td",{},void 0,Le(_e,{value:e})),Le("td",{},void 0,((e,t)=>e.type===he.PUBLIC?Le(ne.W,{roles:["admin","editor"]},void 0,t):t)(e,Le(Re,{value:e,onChange:n(t),onDelete:o,disabled:!e.refId}))))))))};function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ue;function ze(e,t,n,o){Ue||(Ue="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ue,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ke=[{refId:"",type:"group",label:"Administrators and Editors",level:me.WRITE}],Be=e=>e.find((e=>e.type===he.PUBLIC)),He={saveEntitiesPermissions:function(e,t){return async(n,o)=>{const r=await(async e=>(await Se.Z.post("entities/permissions",new I.K(e))).json)(e),i=r.permissions.find((e=>e.type===he.PUBLIC)),a=(null==i?void 0:i.level)===fe.MIXED;if(t&&!a){const{unpublished:r,includeUnpublished:a}=o()[t].search||{},s=r||!a,l=r===!!i,c=(0,te.Qd)(n,t);s?l&&(c({type:we.XL,sharedIds:e.ids}),c((0,Ne.jh)())):c({type:we.dy,sharedIds:e.ids,published:!!i})}n(ge.J.notify("Update success","success"))}}},qe=(0,r.connect)(null,He)((({isOpen:e,onClose:t,sharedIds:n,saveEntitiesPermissions:o,storeKey:r})=>{var a;const[s,l]=(0,i.useState)([]),[c,d]=(0,i.useState)([]),[p,u]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),h=async(e,t)=>{const n=await(async e=>(await Se.Z.get("collaborators",new I.K({filterTerm:e}))).json)(e);l(n.filter((e=>!t.find((t=>t.refId===e.refId&&t.type===e.type)))))};(0,i.useEffect)((()=>((async e=>(await Se.Z.put("entities/permissions",new I.K({sharedIds:e}))).json)(n).then((e=>{const t=e.map((e=>Me(Me({},e),{},{refId:e.refId})));d(t);const n=Be(e);f((null==n?void 0:n.level)||!1),h("",t).catch((()=>{}))})).catch((()=>{})),()=>{d([]),l([]),u(!1),f(!1)})),[]);const v=Ke.concat(c),y=(null===(a=Be(v))||void 0===a?void 0:a.level)||!1;return ze(oe.Z,{isOpen:e,type:"content",className:"share-modal",zIndex:1e3},void 0,ze(oe.Z.Header,{},void 0,ze("div",{className:"round-icon"},void 0,ze(D.JO,{icon:"user-plus"})),ze("h1",{},void 0,ze(C.vN,{},void 0,"Share with people and groups"))),ze(oe.Z.Body,{},void 0,ze(De,{onChange:async e=>{await h(e,c)},onSelect:e=>{d([...c,Me(Me({},e),{},{level:e.level||me.READ})]),l(s.filter((t=>!(e.refId===t.refId&&e.type===t.type)))),u(!0)},options:s}),ze("div",{className:"member-list-wrapper"},void 0,ze(Je,{members:v,onChange:e=>{d(e.filter((e=>e.refId))),u(!0)}})),m!==y?ze("span",{className:"validation-message"},void 0,y?i.createElement(i.Fragment,null,ze(C.vN,{},void 0,"Caution: the selected entities will be "),ze("b",{},void 0,ze(C.vN,{},void 0,"public")),". ",ze(C.vN,{},void 0,"Anyone will be able to see them")):i.createElement(i.Fragment,null,ze(C.vN,{},void 0,"Caution: the selected entities will be "),ze("b",{},void 0,ze(C.vN,{},void 0,"private")),". ",ze(C.vN,{},void 0,"Only allowed users will be able to see them")),"."):null),p?ze(oe.Z.Footer,{},void 0,ze("button",{type:"button",className:"btn btn-default cancel-button",onClick:t},void 0,ze(D.JO,{icon:"times"}),ze(C.vN,{},void 0,"Discard changes")),ze("button",{type:"button",className:"btn confirm-button btn-success",onClick:async()=>(await o({ids:n,permissions:c.map((e=>({refId:e.refId,type:e.type,level:e.level})))},r),t())},void 0,ze(D.JO,{icon:"save"}),ze(C.vN,{},void 0,"Save changes"))):ze(oe.Z.Footer,{},void 0,ze("button",{type:"button",className:"btn btn-default pristine",onClick:t},void 0,ze(C.vN,{},void 0,"Close"))))}));var We;function Ge(e,t,n,o){We||(We="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:We,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qe=({sharedIds:e,storeKey:t})=>{const[n,o]=(0,i.useState)(!1);return i.createElement(i.Fragment,null,Ge("button",{className:"btn btn-success share-btn",type:"button",onClick:()=>o(!0)},void 0,Ge(D.JO,{icon:"user-plus"}),Ge("span",{className:"btn-label"},void 0,Ge(C.vN,{},void 0,"Share"))),n?Ge(qe,{isOpen:!0,onClose:()=>o(!1),sharedIds:e,storeKey:t},e.join("-")):null)};var Ye;function Xe(e,t,n,o){Ye||(Ye="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ye,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class et extends i.Component{render(){const{entityBeingEdited:e,exclusivelyViewButton:t,formName:n,hideDelete:o,uploadFileprogress:r}=this.props,a=this.props.data.toJS(),s=Xe(C.l3,{to:`entity/${a.sharedId}`,className:"edit-metadata btn btn-default",tabIndex:"0"},void 0,Xe(D.JO,{icon:"file"}),Xe("span",{className:"btn-label"},void 0,Xe(C.vN,{},void 0,"View")));return t?Xe("span",{},void 0,s):i.createElement(i.Fragment,null,Xe("div",{className:"btn-cluster"},void 0,this.props.includeViewButton&&s,Xe(ne.W,{roles:["admin","editor"],orWriteAccessTo:[a]},void 0,!e&&Xe("button",{type:"button",onClick:()=>{this.props.loadInReduxForm(this.props.formStatePath,a,this.props.templates.toJS()),this.props.clearMetadataSelections()},className:"edit-metadata btn btn-default"},void 0,Xe(D.JO,{icon:"pencil-alt"}),Xe("span",{className:"btn-label"},void 0,Xe(C.vN,{},void 0,"Edit")))),Xe(ne.W,{roles:["admin","editor"],orWriteAccessTo:[a]},void 0,!e&&!o&&a&&a.sharedId&&Xe(Qe,{sharedIds:[a.sharedId],storeKey:this.props.storeKey})),e&&Xe("button",{type:"button",className:"btn btn-default copy-from-btn",onClick:this.props.copyFrom,disabled:void 0!==r},void 0,Xe(D.JO,{icon:"copy-from",transform:"left-0.07 up-0.06"}),Xe("span",{className:"btn-label"},void 0," ",Xe(C.vN,{},void 0,"Copy From")))),Xe("div",{className:"btn-cluster content-right"},void 0,e&&i.createElement(i.Fragment,null,Xe("button",{type:"button",disabled:void 0!==r,onClick:()=>this.props.resetForm(this.props.formStatePath),className:"cancel-edit-metadata btn btn-default btn-extra-padding"},void 0,Xe("span",{className:"btn-label"},void 0,Xe(C.vN,{},void 0,"Cancel"))),Xe("button",{type:"submit",form:n,className:"btn btn-success btn-extra-padding",disabled:void 0!==r},void 0,r?Xe(D.JO,{icon:"spinner",spin:!0}):null,Xe("span",{className:"btn-label"},void 0,r?Xe("span",{},void 0,`${r}%`):Xe(C.vN,{},void 0,"Save")))),Xe(ne.W,{roles:["admin","editor"],orWriteAccessTo:[a]},void 0,!e&&!o&&Xe("button",{className:"delete-metadata btn btn-danger",type:"button",onClick:this.props.delete},void 0,Xe(D.JO,{icon:"trash-alt"}),Xe("span",{className:"btn-label"},void 0,Xe(C.vN,{},void 0,"Delete"))))))}}et.contextTypes={confirm:X().func},et.defaultProps={entityBeingEdited:!1,includeViewButton:!0,hideDelete:!1,formName:"metadataForm",delete:()=>{},copyFrom:()=>{},storeKey:void 0,uploadFileprogress:void 0};const tt=(0,r.connect)(((e,t)=>{const{sharedId:n}=t.data.toJS();return{templates:e.templates,uploadFileprogress:n?e.attachments.progress.get(n):e.attachments.progress.get("NEW_ENTITY")}}),(function(e,t){return(0,ee.bindActionCreators)({loadInReduxForm:o.loadInReduxForm,resetForm:o.resetReduxForm,clearMetadataSelections:o.clearMetadataSelections},(0,te.Qd)(e,t.storeKey))}))(et);var nt,ot=n(67941),rt=n(61903),it=n(45398),at=n(75677),st=n(92348),lt=n(85072);function ct(e,t,n,o){nt||(nt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:nt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dt=(0,l.P1)((e=>e.templates),(e=>{const t=e?e.toJS():[];return(0,it.Y)(t,{property:"name"})})),pt=(0,l.P1)(dt,(e=>e.entitiesSelected),lt.Z);class ut extends i.Component{constructor(e){super(e),this.close=this.close.bind(this),this.delete=this.delete.bind(this),this.cancel=this.cancel.bind(this),this.save=this.save.bind(this),this.edit=this.edit.bind(this),this.changeTemplate=this.changeTemplate.bind(this)}close(){this.props.unselectAllDocuments(),this.props.resetForm(this.props.formKey)}delete(){this.context.confirm({accept:()=>{this.props.deleteEntities(this.props.entitiesSelected.toJS())},title:"Confirm",message:"Confirm delete multiple items"})}metadataFieldModified(e){return!(this.props.formState.metadata[e].pristine||this.props.formState.metadata[e].$form&&this.props.formState.metadata[e].$form.pristine)}save(e){const t={metadata:{}},n=this.props.template.toJS();return Object.keys(e.metadata).forEach((n=>{this.metadataFieldModified(n)&&(t.metadata[n]=e.metadata[n])})),n._id&&(t.template=n._id),this.props.formState.icon&&!this.props.formState.icon.pristine&&(t.icon=e.icon),this.props.multipleUpdate(this.props.entitiesSelected,t).then((e=>{this.props.updateEntities(e),this.props.unselectAllDocuments(),this.props.resetForm(this.props.formKey)}))}changeTemplate(e,t){const n=this.props.entitiesSelected.map((e=>e.set("template",t)));this.props.updateSelectedEntities(n)}cancel(){this.context.confirm({accept:()=>{this.props.resetForm(this.props.formKey)},title:"Confirm",message:"Discard changes"})}edit(){this.props.loadForm(this.props.formKey,this.props.template.toJS())}sharedIds(){return this.props.entitiesSelected.map((e=>e.get("sharedId")))}renderEditingForm(){const{formKey:e,thesauris:t}=this.props;return i.createElement(i.Fragment,null,ct("div",{className:"alert alert-warning"},void 0,ct(D.JO,{icon:"exclamation-triangle",size:"2x"}),ct("p",{},void 0,ct(C.vN,{},void 0,"Warning: you are editing multiple entities. Fields marked with a")," ",ct(D.JO,{icon:"exclamation-triangle"})," ",ct(C.vN,{},void 0,"will be updated with the same value."))),ct(Q.ZP,{id:"multiEdit",model:e,onSubmit:this.save,thesauris:t,template:this.props.template,changeTemplate:this.changeTemplate,multipleEdition:!0}))}renderEditingButtons(){return ct(ne.W,{roles:["admin","editor"],orWriteAccessTo:this.props.entitiesSelected.toJS()},void 0,ct("div",{className:"btn-cluster content-right"},void 0,ct("button",{type:"button",onClick:this.cancel,className:"cancel-edit-metadata btn btn-default"},void 0,ct("span",{className:"btn-label"},void 0,(0,C.t)("System","Cancel"))),ct("button",{type:"submit",form:"multiEdit",className:"btn btn-success"},void 0,ct("span",{className:"btn-label"},void 0,(0,C.t)("System","Save")))))}renderListButtons(){return ct(ne.W,{roles:["admin","editor"],orWriteAccessTo:this.props.entitiesSelected.toJS()},void 0,ct("div",{className:"btn-cluster"},void 0,ct("button",{type:"button",onClick:this.edit,className:"edit btn btn-default"},void 0,ct(D.JO,{icon:"pencil-alt"}),ct("span",{className:"btn-label"},void 0,(0,C.t)("System","Edit"))),ct(Qe,{sharedIds:this.sharedIds(),storeKey:this.props.storeKey})),ct("div",{className:"btn-cluster content-right"},void 0,ct("button",{type:"button",className:"delete btn btn-danger",onClick:this.delete},void 0,ct(D.JO,{icon:"trash-alt"}),ct("span",{className:"btn-label"},void 0,(0,C.t)("System","Delete")))))}renderList(){const{entitiesSelected:e,getAndSelectDocument:t}=this.props;return ct("ul",{className:"entities-list"},void 0,e.map(((e,n)=>ct("li",{onClick:t.bind(this,e.get("sharedId"))},n,ct("span",{className:"entity-title"},void 0,e.get("title"),ct(at.Z,{template:e.get("template")}))))))}render(){const{entitiesSelected:e,open:t,editing:n}=this.props;return ct(st.Z,{open:t,className:"multi-edit"},void 0,ct("div",{className:"sidepanel-header"},void 0,ct(D.JO,{icon:"check"})," ",ct("span",{},void 0,e.size," ",(0,C.t)("System","selected")),ct("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.close},void 0,ct(D.JO,{icon:"times"}))),ct("div",{className:"sidepanel-body"},void 0,!n&&this.renderList(),n&&this.renderEditingForm()),ct("div",{className:"sidepanel-footer"},void 0,!n&&this.renderListButtons(),n&&this.renderEditingButtons()))}}ut.defaultProps={entitiesSelected:s().fromJS([]),template:null,open:!1,editing:!1},ut.contextTypes={confirm:X().func};const mt=(0,r.connect)(((e,t)=>({template:pt(t),open:t.entitiesSelected.size>1,editing:Object.keys(t.state||{}).length>0})),(function(e,t){return(0,ee.bindActionCreators)({deleteEntities:rt._L,loadForm:o.loadTemplate,resetForm:o.resetReduxForm,multipleUpdate:o.multipleUpdate},(0,te.Qd)(e,t.storeKey))}))(ut);var ft=n(84545);function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e){if(!e.metadata)return vt({},e);const t=(e.attachments||[]).filter((e=>e.fileLocalID)).reduce(((e,t,n)=>vt(vt({},e),{},{[t.fileLocalID]:{value:"",attachment:n}})),{}),n=Object.keys(e.metadata).reduce(((n,o)=>{const r=t[e.metadata[o]];return vt(vt({},n),{},{[o]:Array.isArray(e.metadata[o])?e.metadata[o].map((e=>({value:e}))):[r||{value:e.metadata[o]}]})}),{});return vt(vt({},e),{},{metadata:n})}const gt=async(e,t,n)=>{const o=n.properties.filter((e=>"image"===e.type||"media"===e.type)),{metadataFiles:r,entityAttachments:i,files:a}=await(async(e,t)=>{const n={},o=[],r=[];return(t.metadata||0===e.length)&&await Promise.all(e.map((async e=>{if(!t.metadata[e.name]||/^https?:\/\//.test(t.metadata[e.name]))return Promise.resolve();const{data:i,originalFile:a}=t.metadata[e.name],s=await fetch(i).then((e=>e.blob())),l=new File([s],a.name,{type:s.type}),c=(0,ft.Z)();return n[e.name]=c,o.push({originalname:l.name,filename:l.name,type:"attachment",mimetype:s.type,fileLocalID:c}),r.push(l),URL.revokeObjectURL(t.metadata[e.name])}))),{metadataFiles:n,entityAttachments:o,files:r}})(o,e),s=vt(vt({},e.metadata),r),l=bt(vt(vt({},e),{},{metadata:s,attachments:i}));return l.file=e.file?e.file[0]:void 0,l.attachments=[],l.attachments.push(...a),l.attachments.push(...t),vt(vt({},l),{},{template:n._id})}},83993:(e,t,n)=>{"use strict";n.d(t,{H:()=>o,_:()=>r});const o="SHOW_MODAL",r="CLOSE_MODAL"},49935:(e,t,n)=>{"use strict";function o(e,t){return function(n,o){return o.__reducerKey===t?e(n,o):e(n,{})}}n.d(t,{ZP:()=>i,c:()=>o,Qd:()=>r});function r(e,t){const n=o=>{let r=((e,t)=>(e.__reducerKey=t,e))(o,t);return"function"==typeof o&&(r=(e,t)=>o(n,t)),e(r)};return n}const i={multireducer:o,wrapDispatch:r}},62522:(e,t,n)=>{"use strict";n.d(t,{K:()=>r,m:()=>o});const o="NOTIFY",r="REMOVE_NOTIFICATION"},38540:(e,t,n)=>{"use strict";n.d(t,{F:()=>i,h:()=>a});var o=n(62522),r=n(84545);function i(e){return{type:o.K,id:e}}function a(e,t,n=6e3){return a=>{const s=(0,r.Z)();return a({type:o.m,notification:{message:e,type:t,id:s}}),n&&setTimeout((()=>{a(i(s))}),n),s}}},96038:(e,t,n)=>{"use strict";n.d(t,{P:()=>d,Z:()=>p});var o,r=n(67294),i=n(74127),a=n(37974),s=n(72027),l=n(38540);function c(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class d extends r.Component{close(){this.props.removeNotification(this.props.id)}render(){const{type:e,message:t}=this.props,n=`alert alert-${e}`;let o="check";"warning"!==e&&"danger"!==e||(o="exclamation-triangle");const i="string"!=typeof t?t:t.split("\n").map(((e,t)=>c(r.Fragment,{},t,e,c("br",{}))));return c("div",{className:n,onClick:this.close.bind(this)},void 0,c(s.JO,{icon:o}),c("span",{className:"alert-text"},void 0,i),c(s.JO,{icon:"times"}))}}d.defaultProps={type:"success"};const p=(0,a.connect)(null,(function(e){return(0,i.bindActionCreators)({removeNotification:l.F},e)}))(d)},39263:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m,J:()=>u});var o,r=n(38540),i=n(67294),a=n(37974),s=n(96038);function l(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c.apply(this,arguments)}class d extends i.Component{render(){return l("div",{className:"alert-wrapper"},void 0,this.props.notifications.map((e=>i.createElement(s.Z,c({key:e.id},e)))))}}const p=(0,a.connect)((e=>({notifications:e.notifications.toJS()})))(d),u={notify:r.h,removeNotification:r.F},m=p},55532:(e,t,n)=>{"use strict";n.d(t,{S:()=>i,g:()=>r});var o=n(98014);const r=(0,o.ZP)((()=>Promise.all([n.e(352),n.e(852)]).then(n.bind(n,48242)))),i=(0,o.ZP)((()=>Promise.all([n.e(352),n.e(741)]).then(n.bind(n,8759))))},83887:(e,t,n)=>{"use strict";n.d(t,{on:()=>o,ul:()=>r});const o="PAGE_SAVED",r="SAVING_PAGE"},83668:(e,t,n)=>{"use strict";n.d(t,{Ai:()=>C,Bc:()=>w,C0:()=>d,DX:()=>g,Lu:()=>u,Mt:()=>l,NU:()=>p,Ph:()=>s,T5:()=>O,UG:()=>c,bT:()=>P,cw:()=>_,d_:()=>h,eL:()=>k,f0:()=>b,gq:()=>v,mD:()=>S,mT:()=>y,n8:()=>m,sd:()=>f,uh:()=>j,wB:()=>N});var o=n(67294),r=n(79223),i=n(66139);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}const s=e=>o.createElement(r.oT.select,a({component:i.Ph},e)),l=e=>o.createElement(r.oT,a({component:i.Mt},e)),c=e=>o.createElement(r.oT,a({component:i.UG},e)),d=e=>o.createElement(r.oT.select,a({component:i.C0},e)),p=e=>o.createElement(r.oT.select,a({component:i.NU},e)),u=e=>o.createElement(r.oT.select,a({component:i.Lu},e)),m=e=>o.createElement(r.oT.select,a({component:i.n8},e)),f=e=>o.createElement(r.oT.text,a({component:i.sd},e)),h=e=>o.createElement(r.oT.select,a({component:i.d_},e)),v=e=>o.createElement(r.oT.select,a({component:i.gq},e)),y=e=>o.createElement(r.oT.select,a({component:i.mT},e)),b=e=>o.createElement(r.oT.select,a({component:i.f0},e)),g=e=>o.createElement(r.oT,a({component:i.DX},e)),S=e=>o.createElement(r.oT.select,a({component:i.mD},e)),w=e=>o.createElement(r.oT.select,a({component:i.Bc},e)),N=e=>o.createElement(r.oT.select,a({component:i.wB},e)),O=e=>o.createElement(r.oT.select,a({component:i.T5},e)),P=e=>o.createElement(r.oT,a({component:i.bT},e)),C=e=>o.createElement(r.oT,a({component:i.Ai},e)),k=e=>o.createElement(i.eL,e),_=e=>o.createElement(i.cw,e),j=e=>o.createElement(r.oT,a({component:i.uh},e))},97724:(e,t,n)=>{"use strict";n.d(t,{C:()=>o,HJ:()=>r,Iz:()=>m,JM:()=>S,J_:()=>c,Lw:()=>v,Nu:()=>a,O8:()=>p,Qe:()=>u,Sj:()=>g,Tq:()=>s,Wm:()=>b,ZF:()=>h,_0:()=>i,aG:()=>l,bv:()=>f,lh:()=>y,nK:()=>d});const o="PARSE_RELATIONSHIPS_RESULTS",r="ADD_RELATIONSHIPS_HUB",i="UPDATE_RELATIONSHIPS_LEFT_TYPE",a="UPDATE_RELATIONSHIPS_RIGHT_TYPE",s="TOGGLE_REMOVE_RELATIONSHIPS_LEFT",l="TOGGLE_REMOVE_RELATIONSHIPS_RIGHT_GROUP",c="EDIT_RELATIONSHIPS_GROUP",d="ADD_RELATIONSHIPS_ENTITY",p="TOGGLE_REMOVE_RELATIONSHIPS_ENTITY",u="TOGGLE_MOVE_RELATIONSHIPS_ENTITY",m="MOVE_RELATIONSHIPS_ENTITY",f="UPDATE_RELATIONSHIP_ENTITY_DATA",h="EDIT_RELATIONSHIPS",v="SAVING_RELATIONSHIPS",y="SAVED_RELATIONSHIPS",b="OPEN_RELATIONSHIPS_PANEL",g="CLOSE_RELATIONSHIPS_PANEL",S="SEARCHING_RELATIONSHIPS"},52173:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addEntity:()=>j,addHub:()=>w,edit:()=>S,immidiateSearch:()=>A,moveEntities:()=>T,parseResults:()=>g,reloadRelationships:()=>E,saveRelationships:()=>x,search:()=>F,selectConnection:()=>L,selectRelationTypes:()=>R,setAddToData:()=>C,toggelRemoveLeftRelationship:()=>N,toggleMoveEntity:()=>D,toggleRemoveEntity:()=>I,toggleRemoveRightRelationshipGroup:()=>O,unselectConnection:()=>J,updateLeftRelationshipType:()=>P,updateRelationshipEntityData:()=>k,updateRightRelationshipType:()=>_});var o=n(38562),r=n(59511),i=n(37265),a=n(22222),s=n(39263),l=n(91285),c=n(98373),d=n(47794),p=n(53641),u=n(2080),m=n(97724),f=n(99486),h=n(36416);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t,n){return{type:m.C,results:e,parentEntity:t,editing:n}}function S(e,t,n){return{type:m.ZF,value:e,results:t,parentEntity:n,editing:e}}function w(){return{type:m.HJ}}function N(e){return{type:m.Tq,index:e}}function O(e,t){return{type:m.aG,index:e,rightIndex:t}}function P(e,t){return{type:m._0,index:e,_id:t}}function C(e,t){return{type:m.J_,index:e,rightIndex:t}}function k(e){return{type:m.bv,entity:e}}function _(e,t,n){return(o,r)=>{const{hubs:i}=r().relationships,a=t===i.getIn([e,"rightRelationships"]).size-1;o({type:m.Nu,index:e,rightIndex:t,_id:n,newRightRelationshipType:a}),a&&(o(C(e,t)),o(f.Yp()))}}function j(e,t,n,o=[]){return r=>{let i=`${n.title.length>75?`${n.title.slice(0,75)}(...)`:n.title} added to hub`;o.length&&(i=`${i} with the following errors: ${JSON.stringify(o,null)}`),r(s.J.notify(`${i}. Save your work to make change permanent.`,o.length?"warning":"success")),r({type:m.nK,index:e,rightIndex:t,entity:n})}}function I(e,t,n){return{type:m.O8,index:e,rightIndex:t,relationshipIndex:n}}function D(e,t,n){return{type:m.Qe,index:e,rightIndex:t,relationshipIndex:n}}function T(e,t){return{type:m.Iz,index:e,rightRelationshipIndex:t}}function E(e){return(t,n)=>h.yR(new c.K({sharedId:e}),n()).then((([e,n])=>{t(r.N.set("relationships/list/connectionsGroups",e)),t(r.N.set("relationships/list/searchResults",n))}))}function x(){return(e,t)=>{e({type:m.Lw});const n=t().relationships.list.sharedId,i=t().relationships.hubs.toJS().reduce(((e,t)=>{if(!t.hub&&!t.deleted){const o=y({entity:n},t.leftRelationship),r=t.rightRelationships.reduce(((e,t)=>{if(!t.deleted){const n=t.relationships.filter((e=>!e.deleted));return e.concat(n)}return e}),[]),i=[o].concat(r);e.save.push(i)}return t.hub&&(t.deleted&&e.delete.push({_id:t.leftRelationship._id,entity:n}),t.modified&&!t.deleted&&e.save.push(y({entity:n,hub:t.hub},t.leftRelationship)),t.rightRelationships.forEach((n=>{n.relationships.forEach((o=>{const r=n.deleted||o.deleted||o.moved;r&&o._id&&e.delete.push({_id:o._id,entity:o.entity});(n.modified||!o._id)&&!r&&e.save.push(Object.assign(o,{entity:o.entity,hub:t.hub,template:n.template}))}))}))),e}),{save:[],delete:[]});return o.Z.post("relationships/bulk",new c.K(i)).then((o=>Promise.all([o,u.Z.get(new c.K({sharedId:n})).then((([e])=>e)),E(n)(e,t)]))).then((([o,i])=>{e(r.N.set("entityView/entity",i)),e(r.N.set("viewer/doc",i)),e(f.sR()),e(S(!1,t().relationships.list.searchResults,t().relationships.list.entity)),e(l.X.loadReferences(n)),e({type:m.lh,response:o}),e(s.J.notify("Relationships saved","success"))})).catch((t=>{e({type:m.lh,e:t})}))}}function A(e,t){e(f.w2());const n=new c.K({searchTerm:t,fields:["title"],includeUnpublished:!0});return d.Z.search(n).then((({rows:t})=>{e(r.N.set("relationships/searchResults",t))}))}const $=(0,i.Z)(A,400),R=(0,a.P1)((e=>e.translations),(e=>e.relationTypes),(e=>e.locale),((e,t,n)=>{const o=e.find((e=>e.get("locale")===n)),r=t.toJS().map((e=>{const[t]=o.get("contexts").filter((t=>t.get("id")===e._id)),n=t?(0,p.t)(t.get("id"),e.name,null,!1):e.name;return y(y({},e),{},{name:n})}));return[{_id:null,name:(0,p.t)("System","No Label",null,!1)}].concat(r)}));function F(e){return t=>(t(r.N.set("relationships/searchTerm",e)),$(t,e))}function L(e){return r.N.set("relationships/connection",e)}function J(){return r.N.set("relationships/connection",{})}},99486:(e,t,n)=>{"use strict";n.d(t,{Yp:()=>r,sR:()=>i,w2:()=>a});var o=n(97724);function r(){return{type:o.Wm}}function i(){return{type:o.Sj}}function a(){return{type:o.JM}}},18010:(e,t,n)=>{"use strict";n.d(t,{ne:()=>m,Nw:()=>r});var o,r=n(52173),i=n(67294),a=n(37974),s=n(74127),l=n(65879),c=n(53641),d=n(72027);function p(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class u extends i.Component{constructor(e){super(e),this.edit=this.edit.bind(this)}componentWillUnmount(){this.edit(!1)()}edit(e){return()=>{this.props.edit(e,this.props.searchResults,this.props.parentEntity)}}render(){const{editing:e,saving:t}=this.props,n=this.props.parentEntity.toJS();return i.createElement(i.Fragment,null,p(l.W,{roles:["admin","editor"],orWriteAccessTo:[n]},void 0,!e&&p("div",{className:"btn-cluster"},void 0,p("button",{type:"button",onClick:this.edit(!0),className:"edit-metadata btn btn-default"},void 0,p(d.JO,{icon:"pencil-alt"}),p("span",{className:"btn-label"},void 0,(0,c.t)("System","Edit"))))),p(l.W,{roles:["admin","editor"],orWriteAccessTo:[n]},void 0,e&&p("div",{className:"btn-cluster content-right"},void 0,p("button",{type:"button",onClick:this.edit(!1),className:"cancel-edit-metadata btn btn-default btn-extra-padding"},void 0,p("span",{className:"btn-label"},void 0,(0,c.t)("System","Cancel"))),p("button",{type:"button",onClick:this.props.save,className:"btn btn-success btn-extra-padding",disabled:t},void 0,t&&p(d.JO,{icon:"spinner",pulse:!0,fixedWidth:!0}),p("span",{className:"btn-label"},void 0,(0,c.t)("System","Save"))))))}}const m=(0,a.connect)((({relationships:e})=>({editing:e.hubActions.get("editing"),saving:e.hubActions.get("saving"),parentEntity:e.list.entity,searchResults:e.list.searchResults})),(function(e){return(0,s.bindActionCreators)({edit:r.edit,save:r.saveRelationships},e)}))(u)},36416:(e,t,n)=>{"use strict";n.d(t,{Zu:()=>d,xv:()=>p,yR:()=>c});var o=n(43393),r=n(79223),i=n(59511),a=n(32211),s=n(71182),l=n(65969);function c(e,t){return l.Z.getGroupedByConnection(e).then((n=>{const r=n.reduce(((e,t)=>e.concat(t.templates.map((e=>e._id.toString())))),[]),i=s.Z.get({currentCriteria:{},filteredTemplates:r,templates:t.templates}),l=t.relationships?t.relationships.list:{};l.sort=l.sort||i,l.filters=(0,o.fromJS)({limit:10}),l.sharedId=e.data.sharedId;const c=e.add(l);return Promise.all([n,a.Nw.search(c),l.sort,l.filters])}))}function d(){return e=>{e(i.N.unset("relationships/list/sharedId")),e(i.N.unset("relationships/list/entity")),e(i.N.unset("relationships/list/connectionsGroups")),e(i.N.unset("relationships/list/searchResults")),e(i.N.unset("relationships/list/filters")),e(i.N.unset("relationships/list.sort")),e(i.N.unset("relationships/list/view")),e(i.N.set("relationships/connection",{}))}}function p(e){return t=>{t(i.N.set("relationships/list/sharedId",e.relationships.list.sharedId)),t(i.N.set("relationships/list/entity",e.relationships.list.entity)),t(i.N.set("relationships/list/connectionsGroups",e.relationships.list.connectionsGroups)),t(i.N.set("relationships/list/searchResults",e.relationships.list.searchResults)),t(i.N.set("relationships/list/filters",e.relationships.list.filters)),t(r.Nw.merge("relationships/list.sort",e.relationships.list.sort)),t(i.N.set("relationships/list/view",e.relationships.list.view))}}},47794:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(38562),r=n(98373);const i={countByTemplate:e=>o.Z.get("search/count_by_template",e).then((e=>e.json)),searchSnippets:e=>o.Z.get("v2/entities",e).then((e=>e.json)),search(e=new r.K){const t=e.add({include:e.data&&e.data.include?e.data.include.concat(["permissions"]):["permissions"]});return o.Z.get("search",t).then((e=>e.json))},list:e=>o.Z.get("search/list",e).then((e=>e.json.rows)),getSuggestions:e=>o.Z.get("search/lookup",e).then((e=>e.json)),getAggregationSuggestions:e=>o.Z.get("search/lookupaggregation",e).then((e=>e.json))}},6504:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(38562);const r={search:e=>o.Z.post("semantic-search",e).then((e=>e.json)),getAllSearches:e=>o.Z.get("semantic-search",e).then((e=>e.json)),getEntitiesMatchingFilters:e=>o.Z.get("semantic-search/list",e).then((e=>e.json)),getSearch:e=>o.Z.get("semantic-search",e).then((e=>e.json)),deleteSearch:e=>o.Z.delete("semantic-search",e).then((e=>e.json)),stopSearch:e=>o.Z.post("semantic-search/stop",e).then((e=>e.json)),resumeSearch:e=>o.Z.post("semantic-search/resume",e).then((e=>e.json)),registerForUpdates:e=>o.Z.post("semantic-search/notify-updates",e).then((e=>e.json))}},691:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addSearchResults:()=>P,deleteSearch:()=>g,editSearchEntities:()=>m,fetchSearches:()=>p,getMoreSearchResults:()=>k,getSearch:()=>C,hideSemanticSearch:()=>b,registerForUpdates:()=>N,resumeSearch:()=>w,selectSemanticSearchDocument:()=>f,setEditSearchEntities:()=>u,showSemanticSearch:()=>y,stopSearch:()=>S,submitNewSearch:()=>v,unselectSemanticSearchDocument:()=>h,updateSearch:()=>O});var o=n(43393),r=n.n(o),i=n(59511),a=n(98373),s=n(6504);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){return e=>s.Z.getAllSearches().then((t=>{e(i.N.set("semanticSearch/searches",t))}))}function u(e=[]){return t=>{t(i.N.set("semanticSearch/multiedit",e))}}function m(e,t){const n=new a.K(c({searchId:e},t));return e=>s.Z.getEntitiesMatchingFilters(n).then((t=>{e(u(t))}))}function f(e){return t=>{t(i.N.set("semanticSearch/selectedDocument",e)),t(i.N.set("library.sidepanel.tab","semantic-search-results"))}}function h(){return e=>{e(i.N.set("semanticSearch/selectedDocument",{}))}}function v(e){const{searchTerm:t}=e,n=c(c({},e),{},{searchTerm:"",filters:(o=e.filters,Object.keys(o).reduce(((e,t)=>!o[t]||"object"==typeof o[t]&&!Object.keys(o[t]).length?e:c(c({},e),{},{[t]:o[t]})),{}))});var o;return e=>s.Z.search(new a.K({searchTerm:t,query:n})).then((()=>e(p())))}function y(){return e=>{e(i.N.set("semanticSearch/showSemanticSearchPanel",!0))}}function b(){return e=>{e(i.N.set("semanticSearch/showSemanticSearchPanel",!1))}}function g(e){return t=>s.Z.deleteSearch(new a.K({searchId:e})).then((()=>{t(p())}))}function S(e){return t=>s.Z.stopSearch(new a.K({searchId:e})).then((()=>{t(p())}))}function w(e){return t=>s.Z.resumeSearch(new a.K({searchId:e})).then((()=>{t(p())}))}function N(){return()=>s.Z.registerForUpdates()}function O(e){return t=>t(i.N.update("semanticSearch/searches",e))}function P(e){return(t,n)=>{const o=n().semanticSearch.search.update("results",(t=>e.reduce(((e,t)=>e.find((e=>t._id===e.get("_id")))?e:e.push(r().fromJS(t))),t)));t(i.N.set("semanticSearch/search",o))}}function C(e,t){const n=new a.K(c({searchId:e},t));return(e,t)=>s.Z.getSearch(n).then((n=>{e(i.N.set("semanticSearch/search",n));const o=t().semanticSearch.selectedDocument;if(o){const t=n.results.find((e=>e.sharedId===o.get("sharedId")));t&&e(i.N.set("semanticSearch/selectedDocument",t))}}))}function k(e,t){const n=new a.K(c({searchId:e},t));return e=>s.Z.getSearch(n).then((t=>e(i.N.concatIn("semanticSearch/search",["results"],t.results))))}},37713:(e,t,n)=>{"use strict";n.d(t,{S:()=>l});n(67294);var o,r=n(37974),i=n(65879);function a(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const s=({semanticSearchActivated:e,children:t})=>e?a(i.W,{roles:["admin"]},void 0,t):null;s.defaultProps={semanticSearchActivated:!1};const l=(0,r.connect)((function({settings:e}){return{semanticSearchActivated:(e.collection.toJS().features||{}).semanticSearch}}))(s)},28749:(e,t,n)=>{"use strict";n.d(t,{BM:()=>r,PD:()=>i,gY:()=>o});const o="NAVLINKS_SAVED",r="EDIT_LINK",i="SAVING_NAVLINKS"},11513:(e,t,n)=>{"use strict";n.d(t,{N_:()=>o,X8:()=>r,aT:()=>a,bU:()=>i,rx:()=>s});const o="SET_TEMPLATES",r="TEMPLATE_SAVED",i="EDIT_PROPERTY",a="SET_THESAURIS",s="SAVING_TEMPLATE"},8229:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={daddh:{key_es:"DADDH",key_en:"ADRDM",key_pt:"DADDH",label_es:"Declaración Americana de los Derechos y Deberes del Hombre",label_en:"American Declaration of the Rights and Duties of Man",label_pt:"Declaração Americana dos Direitos e Deveres do Homem"},dple:{key_es:"DPLE",key_en:"DPFE",key_pt:"DPLE",label_es:"Declaración de Principios sobre Libertad de Expresión",label_en:"Declaration of Principles on Freedom of Expresion",label_pt:"Declaração de Princípios sobre Liberdade de Expressão "},pbpppl:{key_es:"PBPPPL",key_en:"PBPPDL",key_pt:"PBPPPL",label_es:"Principios y Buenas Prácticas sobre la Protección de las Personas Privadas de Libertad en las Américas",label_en:"Principles and Best Practices on the Protection of Persons Deprived of Liberty in the Americas",label_pt:"Princípios e Boas Prácticas para as Pessoas Privadas de Liberdade nas Américas"},cadh:{key_es:"CADH",key_en:"ACHR",key_pt:"CADH",label_es:"Convención Americana sobre Derechos Humanos",label_en:"American Convention on Human Rights",label_pt:"Convenção Americana sobre Direitos Humanos"},"prot-pdm":{key_es:"Prot-PdM",key_en:"Prot-DP",key_pt:"Prot-PdM",label_es:"Protocolo a la Convención Americana sobre Derechos Humanos relativo a la Abolición de la Pena de Muerte",label_en:"Protocol to the American Convention on Human Rights to Abolish the Death Penalty",label_pt:"Protocolo à Convenção Americana sobre Direitos Humanos relativo à abolição da Pena de Morte"},"prot-desc":{key_es:"Prot-DESC",key_en:"Prot-ESCR",key_pt:"Prot-desc",label_es:"Protocolo Adicional a la Convención Americana sobre Derechos Humanos en Materia de Derechos Económicos, Sociales y Culturales 'Protocolo de San Salvador'",label_en:"Additional Protocol to the American Convention on Human Rights in the Area of Economic, Social and Cultural Rights 'Protocol of San Salvador'",label_pt:"Protocolo adicional à Convenção Americana sobre Direitos Humanos em matéria de Direitos Econômicos, sociais e culturais 'Protocolo de São Salvador'"},cipst:{key_es:"CIPST",key_en:"IACPPT",key_pt:"CIPST",label_es:"Convención Interamericana para Prevenir y Sancionar la Tortura",label_en:"Inter-American Convention to Prevent and Punish Torture",label_pt:"Convenção Interamericana para Prevenir e Sancionar a Tortura"},cidfp:{key_es:"CIDFP",key_en:"IACFDP",key_pt:"CIDFP",label_es:"Convención Interamericana sobre Desaparición Forzada de Personas",label_en:"Inter-American Convention on Forced Disappearance of Persons",label_pt:"Convenção Interamericana sobre Desaparecimento Forçado de Pessoas"},ciedpd:{key_es:"CIEDPD",key_en:"IACEDAPD",key_pt:"CIEDPD",label_es:"Convención Interamericana para la Eliminación de todas las Formas de Discriminación contra las Personas con Discapacidad",label_en:"Inter-American Convention on the Elimination of All Forms of Discrimination Against Persons with Disabilities",label_pt:"Convenção Interamericana para a eliminação de todas as formas de discriminação contra as pessoas portadoras de deficiência"},cbdopara:{key_es:"CBdoPara",key_en:"IACBdoPara",key_pt:"CIBdoPara",label_es:"Convención Interamericana para Prevenir, Sancionar y Erradicar la Violencia contra la Mujer 'Convención de Belem Do Para'",label_en:"Inter-American Convention on the Prevention, Punishment and Eradication of Violence Against Women 'Convention of Belém Do Pará'",label_pt:"Convenção Interamericana para Prevenir, Punir e Erradicar a violência contra a mulher 'Convenção de Belém do Pará'"},cicc:{key_es:"CICC",key_en:"IACAC",key_pt:"CICC",label_es:"Convención Interamericana contra la Corrupción",label_en:"Inter-American Convention Against Corruption",label_pt:"Convenção Interamericana contra a corrupção"},cdi:{key_es:"CDI",key_en:"IADC",key_pt:"CDI",label_es:"Carta Democrática Interamericana",label_en:"Inter-American Democratic Charter",label_pt:"Carta Democrática Interamericana"},cicdi:{key_es:"CICDI",key_en:"IACDI",key_pt:"CICDI",label_es:"Convención Interamericana contra toda Forma de Discriminación e Intolerancia",label_en:"Inter-American Convention against all forms of Discrimination and Intolerance",label_pt:"Convenção Interamericana contra toda a Forma de Discriminação y Intolerância "},cirdri:{key_es:"CIRDRI",key_en:"IACRDRI",key_pt:"CIRDRI",label_es:"Convención Interamericana contra el Racismo, la Discriminación Racial y Formas Conexas de Intolerancia",label_en:"Inter-American Convention against Racism, Racial Discrimination and related forms of Intolerance",label_pt:"Convenção Interamericana contra o Racismo, a Discriminação Racial y Formas Correlatas de Intolerância"},"e-cidh":{key_es:"E-CIDH",key_en:"S-IACHR",key_pt:"E-CIDH",label_es:"Estatuto de la Comisión Interamericana de Derechos Humanos ",label_en:"Statute of the Inter-American Commission on Human Rights",label_pt:"Estatuto da Comissão Interamericana de Direitos Humanos"},"e-corteidh":{key_es:"E-CorteIDH",key_en:"S-IACoHR",key_pt:"E-CorteIDH",label_es:"Estatuto de la Corte Interamericana de Derechos Humanos ",label_en:"Statute of the Inter-American Court of Human Rights",label_pt:"Estatuto da Corte Interamericana de Direitos Humanos"},"r-cidh (2013)":{key_es:"R-CIDH (2013)",key_en:"R-IACHR (2013)",key_pt:"R-CIDH (2013)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2013 – vigente)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2013 - in force)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2013 – em vigor)"},"r-cidh (2011)":{key_es:"R-CIDH (2011)",key_en:"R-IACHR (2011)",key_pt:"R-CIDH (2011)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2011)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2011)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2011)"},"r-cidh (2009)":{key_es:"R-CIDH (2009)",key_en:"R-IACHR (2009)",key_pt:"R-CIDH (2009)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2009)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2009)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2009)"},"r-cidh (2008)":{key_es:"R-CIDH (2008)",key_en:"R-IACHR (2008)",key_pt:"R-CIDH (2008)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2008)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2008)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2008)"},"r-cidh (2006)":{key_es:"R-CIDH (2006)",key_en:"R-IACHR (2006)",key_pt:"R-CIDH (2006)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2006)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2006)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2006)"},"r-cidh (2003)":{key_es:"R-CIDH (2003)",key_en:"R-IACHR (2003)",key_pt:"R-CIDH (2003)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2003)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2003)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2003)"},"r-cidh (2002)":{key_es:"R-CIDH (2002)",key_en:"R-IACHR (2002)",key_pt:"R-CIDH (2002)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2002)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2002)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2002)"},"r-cidh (2000)":{key_es:"R-CIDH (2000)",key_en:"R-IACHR (2000)",key_pt:"R-CIDH (2000)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (2000)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (2000)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (2000)"},"r-cidh (1980)":{key_es:"R-CIDH (1980)",key_en:"R-IACHR (1980)",key_pt:"R-CIDH (1980)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (1980)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (1980)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (1980)"},"r-cidh (1966)":{key_es:"R-CIDH (1966)",key_en:"R-IACHR (1966)",key_pt:"R-CIDH (1966)",label_es:"Reglamento de la Comisión Interamericana de Derechos Humanos (1966)",label_en:"Rules of Procedure of the Inter-American Commission on Human Rights (1966)",label_pt:"Regulamento da Comissão Interamericana de Direitos Humanos (1966)"},"r-corteidh (2009/noviembre)":{key_es:"R-CorteIDH (2009/noviembre)",key_en:"R-IACoHR (2009/november)",key_pt:"R-CorteIDH (2009/novembro)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (2009/noviembre)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (2009/november)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (2009/novembro)"},"r-corteidh (2009/enero)":{key_es:"R-CorteIDH (2009/enero)",key_en:"R-IACoHR (2009/january)",key_pt:"R-CorteIDH (2009/janeiro)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (2009/enero)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (2009/january)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (2009/janeiro)"},"r-corteidh (2003)":{key_es:"R-CorteIDH (2003)",key_en:"R-IACoHR (2003)",key_pt:"R-CorteIDH (2003)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (2003)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (2003)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (2003)"},"r-corteidh (2000)":{key_es:"R-CorteIDH (2000)",key_en:"R-IACoHR (2000)",key_pt:"R-CorteIDH (2000)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (2000)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (2000)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (2000)"},"r-corteidh (1996)":{key_es:"R-CorteIDH (1996)",key_en:"R-IACoHR (1996)",key_pt:"R-CorteIDH (1996)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (1996)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (1996)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (1996)"},"r-corteidh (1991)":{key_es:"R-CorteIDH (1991)",key_en:"R-IACoHR (1991)",key_pt:"R-CorteIDH (1991)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (1991)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (1991)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (1991)"},"r-corteidh (1980)":{key_es:"R-CorteIDH (1980)",key_en:"R-IACoHR (1980)",key_pt:"R-CorteIDH (1980)",label_es:"Reglamento de la Corte Interamericana de Derechos Humanos (1980)",label_en:"Rules of Procedure of the Inter-American Court of Human Rights (1980)",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos (1980)"},rcfal:{key_es:"RCFAL",key_en:"RICLAF",key_pt:"RCFAJ",label_es:"Reglamento de la Comisión Interamericana de derechos humanos sobre el Fondo de Asistencia Legal del Sistema Interamericano de Derechos Humanos",label_en:"Rules of Procedure of the Inter-American Commission of Human Rights on the Legal Assistance Fund of the Inter-American Human Rights System",label_pt:"Regulamento da Comissão Interamericana sobre o Fundo de Assistência Jurídica do Sistema Interamericano de Direitos Humanos"},rcofalv:{key_es:"RCoFALV",key_en:"RCoVLAF",key_pt:"RCoFALV",label_es:"Reglamento de la Corte Interamericana de derechos humanos sobre el funcionamiento del fondo de asistencia legal de victimas",label_en:"Rules of Procedure of the Inter-American Court of Human Rights on the Victims Legal Assistance Fund",label_pt:"Regulamento da Corte Interamericana de Direitos Humanos sobre o funcionamento do Fundo de Assistência Jurídica às Vítimas"}}},88020:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(53641);function r(e,t){const n=t&&t.toJS?t.toJS():t;return"title"===e&&n?function(e){const t=e.commonProperties.find((e=>"title"===e.name));return(0,o.t)(e._id,t.label)}(n):e.startsWith("metadata.")&&n&&function(e,t){const n=e.split(".")[1],r=t.properties.find((e=>e.name===n));return r&&(0,o.t)(t._id,r.label)||e}(e,n)||e}},99875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={get:()=>[{localID:"commonTitle",label:"Title",name:"title",isCommonProperty:!0,type:"text",prioritySorting:!1,generatedId:!1},{localID:"commonCreationDate",label:"Date added",name:"creationDate",isCommonProperty:!0,type:"date",prioritySorting:!1},{localID:"commonEditDate",label:"Date modified",name:"editDate",isCommonProperty:!0,type:"date",prioritySorting:!1}]}},17565:(e,t,n)=>{"use strict";n.d(t,{CQ:()=>T,BO:()=>N,Ot:()=>a,Cv:()=>$});n(67294);var o,r=n(81478);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a=({file:e,children:t})=>i(r.e,{feature:"tocGeneration"},void 0,e.generatedToc&&i("div",{className:"badge"},void 0,t));var s=n(72027),l=n(37974),c=n(74127),d=n(56900),p=n(79223),u=n(98373),m=n(38562),f=n(39263),h=n(35940);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const g={reviewToc:e=>async(t,n)=>{const o=n().documentViewer.doc.toJS();t(p.Nw.reset("documentViewer.sidepanel.metadata"));const r=(await m.Z.post("files/tocReviewed",new u.K({fileId:e}))).json,i=y(y({},o),{},{defaultDoc:r,documents:(0,h.zx)(o.documents).map((e=>e._id===r._id?r:e))});t(f.J.notify("Document updated","success")),t(p.Nw.reset("documentViewer.sidepanel.metadata")),t(d.Nw.set("viewer/doc",i))}};var S;function w(e,t,n,o){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const N=(0,l.connect)(null,(e=>(0,c.bindActionCreators)({onClick:g.reviewToc},e)))((({file:e,onClick:t,children:n})=>w(r.e,{feature:"tocGeneration"},void 0,e.generatedToc&&w("button",{type:"button",onClick:()=>t(e._id),className:"edit-toc btn btn-success"},void 0,w(s.JO,{icon:"tasks"}),w("span",{className:"btn-label"},void 0,n)))));var O,P=n(78526),C=n(58010),k=n(53641),_=n(65879);function j(e,t,n,o){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const I=(e,t)=>{var n,o;return(((null==e||null===(n=e.all)||void 0===n||null===(o=n.generatedToc)||void 0===o?void 0:o.buckets)||[]).find((e=>e.key===t))||{filtered:{doc_count:0}}).filtered.doc_count},D=(e={all:{}})=>[{label:(0,k.t)("System","Automatically generated"),value:!0,results:I(e,"true")},{label:(0,k.t)("System","Reviewed"),value:!1,results:I(e,"false")}],T=({onChange:e,aggregations:t})=>j(_.W,{roles:["admin"]},void 0,j(r.e,{feature:"tocGeneration"},void 0,j(C.Z,{className:"admin-filter"},"generatedToc",j(P.Z,{model:".customFilters.generatedToc",prefix:"generatedToc",label:(0,k.t)("System","Automatic Table of Contents"),onChange:e,options:D(t),showBoolSwitch:!1}))));function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $={aggregations(e,t){var n;return x(x({},e),null!=t&&null!==(n=t.features)&&void 0!==n&&n.tocGeneration?{aggregateGeneratedToc:!0}:{})}}},76386:(e,t,n)=>{"use strict";n.d(t,{W:()=>ft,y:()=>mt});var o=n(78947),r=n(9399),i=n(90185),a=n(68686),s=n(77905),l=n(83183),c=n(55346),d=n(50906),p=n(69323),u=n(61730),m=n(774),f=n(5600),h=n(76409),v=n(52038),y=n(85322),b=n(71421),g=n(15100),S=n(89468),w=n(79186),N=n(68055),O=n(6811),P=n(85020),C=n(65394),k=n(17319),_=n(42137),j=n(47982),I=n(34601),D=n(30615),T=n(75213),E=n(96165),x=n(26433),A=n(12249),$=n(70396),R=n(71746),F=n(81511),L=n(77007),J=n(76553),Z=n(26561),M=n(17726),V=n(3471),U=n(48059),z=n(15231),K=n(17654),B=n(863),H=n(47947),q=n(40729),W=n(16688),G=n(78076),Q=n(82414),Y=n(22539),X=n(84176),ee=n(9685),te=n(41259),ne=n(75386),oe=n(23284),re=n(71858),ie=n(609),ae=n(29774),se=n(6767),le=n(57310),ce=n(31156),de=n(49185),pe=n(6019),ue=n(30619),me=n(753),fe=n(40098),he=n(96343),ve=n(36322),ye=n(55502),be=n(70195),ge=n(27149),Se=n(95337),we=n(59986),Ne=n(32505),Oe=n(20096),Pe=n(42775),Ce=n(52276),ke=n(48778),_e=n(92332),je=n(59801),Ie=n(58708),De=n(13461),Te=n(23848),Ee=n(91883),xe=n(34327),Ae=n(15405),$e=n(72559),Re=n(59545),Fe=n(94370),Le=n(42139),Je=n(16887),Ze=n(88673),Me=n(40864),Ve=n(2723),Ue=n(41097),ze=n(20446),Ke=n(54670),Be=n(96427),He=n(27879),qe=n(46357),We=n(77617),Ge=n(4241),Qe=n(67714),Ye=n(50996),Xe=n(89331),et=n(97733);const tt={prefix:"fas",iconName:"two-factor-auth",fillRule:"nonzero",icon:[18,18,[],"e001","m 4.92478,2.8916 c 1.1013,0 2.03317,0.93187 2.03317,2.03318 0,1.12954 -0.93187,2.03317 -2.03317,2.03317 -1.12955,0 -2.03318,-0.90363 -2.03318,-2.03317 0,-1.10131 0.90363,-2.03318 2.03318,-2.03318 z m 9.93992,0 c 1.1013,0 2.0332,0.93187 2.0332,2.03318 0,1.12954 -0.9319,2.03317 -2.0332,2.03317 -1.1295,0 -2.0331,-0.90363 -2.0331,-2.03317 0,-1.10131 0.9036,-2.03318 2.0331,-2.03318 z m -2.9368,2.03318 c 0,1.12954 -0.9318,2.03317 -2.03314,2.03317 -1.12954,0 -2.03318,-0.90363 -2.03318,-2.03317 0,-1.10131 0.90364,-2.03318 2.03318,-2.03318 1.10134,0 2.03314,0.93187 2.03314,2.03318 z m 5.2744,4.56534 c 0.2504,-0.12305 0.489,-0.26641 0.7136,-0.42795 0.2403,-0.0887 0.5,-0.13737 0.7716,-0.13737 1.2187,0 2.25,1.03125 2.25,2.25 v 2.25 h -4.5 v -2.25 c 0,-0.6619 0.295,-1.26855 0.7648,-1.68468 z M 18.6875,6.4248 C 16.852,6.4248 15.261,7.47907 14.47,9 H 5 C 2.79086,9 1,7.20914 1,5 1,2.79086 2.79086,1 5,1 h 10 c 2.2091,0 4,1.79086 4,4 0,0.502 -0.0925,0.98239 -0.2613,1.42509 C 18.7216,6.4249 18.7046,6.4248 18.6875,6.4248 Z M 0,5 c 0,2.76142 2.23858,5 5,5 h 5.268852 3.817448 c -0.0971,0.3766 -0.1488,0.7704 -0.1488,1.1748 v 2.25 h -0.75 c -0.8437,0 -1.5,0.6875 -1.5,1.5 v 6 c 0,0.8438 0.6563,1.5 1.5,1.5 h 11 c 0.8125,0 1.5,-0.6562 1.5,-1.5 v -6 c 0,-0.8125 -0.6875,-1.5 -1.5,-1.5 h -0.75 v -2.25 c 0,-2.22743 -1.5902,-4.13221 -3.6821,-4.62581 C 19.9142,6.06129 20,5.54067 20,5 20,2.23858 17.7614,0 15,0 H 12.408196 5 C 2.23858,0 0,2.23858 0,5 Z"]},nt={prefix:"fas",iconName:"info-circle-hollow",icon:[14,14,[],"e001","M 6.781,0 C 3.035,0 0,3.0625 0,6.78125 c 0,3.7461 3.035,6.7812 6.781,6.7812 3.719,0 6.781,-3.0351 6.781,-6.7812 C 13.562,3.0625 10.5,0 6.781,0 Z m 0,12.25005 c -3.035,0 -5.469,-2.4336 -5.469,-5.4688 0,-3.00781 2.434,-5.46875 5.469,-5.46875 3.008,0 5.469,2.46094 5.469,5.46875 0,3.0352 -2.461,5.4688 -5.469,5.4688 z m 0,-9.24224 c -0.656,0 -1.148,0.51953 -1.148,1.14844 0,0.65625 0.492,1.14844 1.148,1.14844 0.629,0 1.148,-0.49219 1.148,-1.14844 0,-0.62891 -0.519,-1.14844 -1.148,-1.14844 z m 1.531,6.94534 v -0.6563 c 0,-0.164 -0.164,-0.3281 -0.328,-0.3281 H 7.656 V 6.23437 C 7.656,6.07031 7.492,5.90625 7.328,5.90625 h -1.75 c -0.192,0 -0.328,0.16406 -0.328,0.32812 v 0.65626 c 0,0.1914 0.136,0.32812 0.328,0.32812 h 0.328 v 1.75 H 5.578 c -0.192,0 -0.328,0.1641 -0.328,0.3281 v 0.6563 c 0,0.1914 0.136,0.3281 0.328,0.3281 h 2.406 c 0.164,0 0.328,-0.1367 0.328,-0.3281 z"]};var ot=n(9221),rt=n(36031),it=n(42494),at=n(51436);const st={prefix:"fas",iconName:"save-and-next",icon:[448,448,[],"e001","M316.118,0 C328.646297,0 340.669588,4.89796549 349.627934,13.6333306 L350.059,14.059 L433.941,97.941 C442.799876,106.799811 447.838459,118.764857 447.996182,131.276197 L448,131.882 L448,400 C448,426.2449 426.937651,447.569698 400.793778,447.993569 L400,448 L48,448 C21.7551,448 0.430302,426.937651 0.00643053,400.793778 L0,400 L0,48 C0,21.7551 21.062349,0.430302 47.2062225,0.00643053 L48,0 L316.118,0 Z M229.58855,116.6485 C224.81453,111.783833 217.011829,111.783833 212.186475,116.6485 L212.186475,116.6485 L200.790425,128.137394 C195.862404,133.053813 195.965071,141.075338 200.995759,145.888253 L200.995759,145.888253 L262.852695,205.29929 L115.320054,205.29929 C108.492691,205.29929 103,210.83673 103,217.719716 L103,217.719716 L103,234.280284 C103,241.16327 108.492691,246.70071 115.320054,246.70071 L115.320054,246.70071 L262.852695,246.70071 L200.995759,306.111747 C196.016404,310.924662 195.913737,318.946187 200.790425,323.862606 L200.790425,323.862606 L212.186475,335.3515 C216.960495,340.216167 224.763196,340.216167 229.58855,335.3515 L229.58855,335.3515 L329.380984,234.74605 C334.206339,229.933135 334.206339,222.066865 329.380984,217.202198 L329.380984,217.202198 Z"]},lt={prefix:"fas",iconName:"export-csv",icon:[17,17,[],"e001","M11.7382 0.617802L15.1979 4.03631C15.5686 4.40699 15.8157 4.94242 15.8157 5.43666V19.1519C15.8157 20.2227 14.9096 21.0877 13.7976 21.0877H9.20995V19.1519H13.8388V7.29007H9.51416C8.97873 7.29007 8.52567 6.83701 8.52567 6.30158V2.01815H1.93578V19.1519H5.6261V21.0877H1.93578C0.864923 21.0877 0 20.2227 0 19.1519V2.01815C0 0.90611 0.864923 0.0411868 1.93578 0H10.3791C10.8733 0 11.3676 0.247121 11.7382 0.617802ZM13.674 5.3131L10.5026 2.14172V5.3131H13.674ZM8.00289 17.5106C8.30154 17.5106 8.6002 17.7584 8.6002 18.1055V22.253H10.9894C11.537 22.253 11.7859 22.8975 11.4374 23.2446L7.85356 26.8141C7.60468 27.062 7.1567 27.062 6.90782 26.8141L3.32396 23.2446C2.97553 22.8975 3.22441 22.253 3.77194 22.253H6.21096V18.1055C6.21096 17.7584 6.45984 17.5106 6.80827 17.5106H8.00289ZM3.16316 9.65899V16.3429C3.16316 16.7136 3.45147 17.0019 3.82215 17.0019H11.73C12.0595 17.0019 12.389 16.7136 12.389 16.3429V9.65899C12.389 9.3295 12.0595 9 11.73 9H3.82215C3.45147 9 3.16316 9.3295 3.16316 9.65899ZM11.071 10.412H8.43507V12.389H11.071V10.412ZM8.43507 13.707H11.071V15.6839H8.43507V13.707ZM7.1171 13.707H4.48114V15.6839H7.1171V13.707ZM4.48114 10.412H7.1171V12.389H4.48114V10.412Z"]},ct={prefix:"fas",iconName:"import-csv",icon:[17,17,[],"e001","M8.09613 9.55878C8.39826 9.55878 8.70039 9.30908 8.70039 8.95951V4.78165H11.1175C11.6714 4.78165 11.9232 4.13244 11.5707 3.78287L7.94506 0.187271C7.69328 -0.0624237 7.24008 -0.0624237 6.9883 0.187271L3.36269 3.78287C3.0102 4.13244 3.26198 4.78165 3.81589 4.78165H6.28332V8.95951C6.28332 9.30908 6.5351 9.55878 6.88759 9.55878H8.09613ZM8.625 10.1763V12.1059C8.625 12.6452 9.08333 13.1016 9.625 13.1016H14V25.0501H1.95833V7.79117H5.69161V5.75827H1.95833C0.875 5.79976 0 6.671 0 7.79117V25.0501C0 26.1288 0.875 27 1.95833 27H13.9583C15.0833 27 16 26.1288 16 25.0501V11.2347C16 10.7368 15.75 10.1975 15.375 9.82407L11.875 6.38059C11.5 6.0072 11 5.75827 10.5 5.75827H9.31722V9.30138C9.31722 9.74421 8.99658 10.0806 8.625 10.1763ZM13.8333 11.1102L10.625 7.91564V11.1102H13.8333ZM3.20001 15.5V22.2206C3.20001 22.594 3.49168 22.8844 3.86668 22.8844H11.8667C12.2 22.8844 12.5333 22.594 12.5333 22.2206V15.5C12.5333 15.1681 12.2 14.8362 11.8667 14.8362H3.86668C3.49168 14.8362 3.20001 15.1681 3.20001 15.5ZM11.2 16.2464H8.53335V18.2378H11.2V16.2464ZM8.53335 19.5654H11.2V21.5568H8.53335V19.5654ZM7.20001 19.5654H4.53335V21.5568H7.20001V19.5654ZM4.53335 16.2464H7.20001V18.2378H4.53335V16.2464Z"]},dt={prefix:"fas",iconName:"copy-from",icon:[16,16,[],"e001","M11.5 3H2.5C1.6875 3 1 3.6875 1 4.5V13.5C1 14.3438 1.6875 15 2.5 15H11.5C12.3438 15 13 14.3438 13 13.5V12.1624H9.02806V13.5556C9.02806 14.1781 8.25736 14.5041 7.81274 14.0595L5.26353 11.4807C4.96711 11.2139 4.96711 10.7693 5.26353 10.5025L7.81274 7.92365C8.25736 7.47902 9.02806 7.80508 9.02806 8.42756V9.79109H13V4.5C13 3.6875 12.3438 3 11.5 3ZM14 9.79109V6.41033C14 6.27055 13.9883 6.13349 13.966 6.00006H19.5C20.3438 6.00006 21 6.68756 21 7.50006V16.5001C21 17.3438 20.3438 18.0001 19.5 18.0001H10.5C9.6875 18.0001 9 17.3438 9 16.5001V15.9488H11.5385C12.8979 15.9488 14 14.8467 14 13.4873V12.1624H16.6442C16.8517 12.1624 16.9999 12.0142 16.9999 11.8067V10.1468C16.9999 9.96894 16.8517 9.79109 16.6442 9.79109H14Z"]},pt={prefix:"fas",iconName:"funnel-filter",icon:[12,12,[],"e001","M4.86858 9.74499c-.18725 0-.3745.18725-.3745.37451v.749c0 .2107.18725.3745.3745.3745h2.26284c.18725 0 .3745-.1638.3745-.3745v-.749c0-.18726-.18725-.37451-.3745-.37451H4.86858zm-2.99605-5.9921c-.18725 0-.3745.18725-.3745.3745v.74901c0 .21066.18725.37451.3745.37451h8.25497c.1872 0 .3745-.16385.3745-.37451v-.74901c0-.18725-.1873-.3745-.3745-.3745H1.87253zm1.49803 2.99605c-.18726 0-.37451.18725-.37451.3745v.74902c0 .21065.18725.3745.37451.3745h5.25888c.18726 0 .37451-.16385.37451-.3745v-.74902c0-.18725-.18725-.3745-.37451-.3745H3.37056zM.374506.756836C.187253.756836 0 .944089 0 1.13134v.74901c0 .21066.187253.37451.374506.37451H11.6255c.1872 0 .3745-.16385.3745-.37451v-.74901c0-.187251-.1873-.374504-.3745-.374504H.374506z"]},ut={faAlignJustify:r.z1,faAngleDoubleLeft:i.UX,faAngleDoubleRight:a.cL,faAngleLeft:s.Ey,faAngleRight:l.yO,faArrowLeft:c.ac,faArrowsAlt:Ke.Qg,faArrowUp:p.FP,faArrowDown:u.r5,faArrowRight:d.eF,faBars:m.xi,faBook:f.FL,faBullhorn:h.Ac,faCalculator:v.lT,faCalendar:y.fT,faCaretDown:b.eW,faCaretSquareDown:g.Oz,faCaretUp:S.l1,faChartBar:w.ko,faCheck:N.LE,faCheckCircle:O.f8,faChevronLeft:P.A3,faChevronRight:C._t,faCircle:k.di,faClock:_.SZ,faClone:j.WM,faCloudUploadAlt:I.r6,faCloudDownloadAlt:D.W9,faCode:T.dT,faCoffee:E.Sv,faCog:x.b7,faComment:A.Mz,faCubes:$.Nk,faEmptyCircle:R.di,faEnvelope:F.FU,faExchangeAlt:L.Ss,faExclamationTriangle:J.eH,faFlask:M.jZ,faFile:Z.gM,faFilter:V.G_,faFilePdf:U.gS,faFileImage:z.Oi,faFingerprint:K.QG,faFont:B.yG,faGavel:H.JH,faGlobeAfrica:q.kC,faHome:W.J9,faImage:G.Vm,faInfoCircle:Q.sq,faKey:X.DD,faLanguage:Y.BC,faLevelDownAlt:ee.IG,faLightbulb:te.X8,faLink:ne.nN,faUnlink:oe.AE,faList:re.Zr,faLock:ie.by,faMapMarker:ae.Mz,faMinus:se.Kl,faPaperPlane:le.XC,faPaperclip:ce.Al,faParagraph:de.CK,faPassport:pe.Gg,faPencilAlt:ue.UJ,faPlay:me.zc,faPlus:fe.r8,faPowerOff:he.oT,faQuestionCircle:ve.sp,faQuoteLeft:ye.y1,faQuoteRight:be.El,faSave:ge.r6,faSearch:Se.wn,faServer:we.xf,faSearchMinus:Ne.vs,faSearchPlus:Oe.N7,faSitemap:Pe.Hw,faSort:Ce.Cm,faSortAlphaDown:ke.tH,faSpinner:_e.LM,faSquare:je.pL,faSolidSquare:Ie.pL,faStar:De.T,faStop:Te.Bg,faSync:Ee.UO,faTag:xe.LE,faTerminal:Ae.Jw,faTh:$e.sz,faTimes:Re.NB,faTimesCircle:Fe.nY,faToggleOff:Le.Bl,faToggleOn:Je.WZ,faTrashAlt:Ze.I7,faUndo:Me.X7,faUpload:Ve.cf,faVideo:Ue.Iy,faEye:ze.Md,faEyeSlash:Be.Aq,faUser:He.IL,faUsers:qe.FV,faUserTimes:Qe.iC,faUserPlus:Ge.FK,faUserCheck:We.hk,faHandPaper:Ye.R3,faExternalLinkAlt:et.Xj,faMap:rt.Wx,faMapMarkerAlt:it.FG,saveAndNext:st,faTasks:ot.A8,exportCsv:lt,importCsv:ct,copyFrom:dt,funnelFilter:pt,twoFactorAuth:tt,infoCircleHollow:nt,faBullseye:Xe.sc,faColumns:at.rWw},mt=()=>{o.vI.add(...Object.keys(ut).map((e=>ut[e])))},ft=Object.keys(ut).map((e=>ut[e].iconName))},72027:(e,t,n)=>{"use strict";n.d(t,{TZ:()=>b,JO:()=>u,ko:()=>v,CO:()=>w});var o=n(67294),r=n(37974),i=n(67814),a=n(40922),s=n(76386);const l=["locale","directionAware"];function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c.apply(this,arguments)}function d(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(0,s.y)();const p=e=>{let{locale:t,directionAware:n}=e,r=d(e,l);const s=a.mT.find((e=>e.key===t));return o.createElement(i.G,c({},r,{flip:s&&s.rtl?"horizontal":null}))};p.defaultProps={locale:"",directionAware:!1};const u=(0,r.connect)((({locale:e})=>({locale:e})),(()=>({})))(p);var m;function f(e,t,n,o){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const h=({max:e,value:t})=>f("div",{className:"uw-progress-bar--container"},void 0,f("div",{className:"uw-progress-bar"},void 0,f("div",{className:"uw-progress-bar--progress",style:{width:`${100*t/e}%`}})),f("div",{className:"uw-progress-bar--counter"},void 0,t,"/",e));h.defaultProps={max:100,value:0};const v=h;var y=n(33228);const b=new Map(y.Z.map((e=>[e.cca3,{cca2:e.cca2,label:e.name.common,cca3:e.cca3}])));var g;function S(e,t,n,o){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const w=({checked:e,onClick:t})=>S("label",{className:"toggleButton"},void 0,S("input",{type:"checkbox",checked:e,onChange:t}),S("span",{className:"slider"}))},37501:(e,t,n)=>{"use strict";n.d(t,{F6:()=>r,L5:()=>c,T_:()=>o,Yy:()=>i,le:()=>a,rW:()=>s,sV:()=>l});const o="NEW_UPLOAD_DOCUMENT",r="UPLOAD_PROGRESS",i="UPLOAD_COMPLETE",a="UPLOADS_COMPLETE",s="BATCH_UPLOAD_COMPLETE",l="ENTER_UPLOADS_SECTION",c="ELEMENT_CREATED"},11992:(e,t,n)=>{"use strict";n.d(t,{Ap:()=>b,Ig:()=>C,OE:()=>S,Vt:()=>_,WT:()=>y,_Z:()=>g,au:()=>O,dk:()=>w,iG:()=>k,qF:()=>P,z0:()=>v});var o=n(80569),r=n.n(o),i=n(59511),a=n(39263),s=n(93673),l=n(55505),c=n(37501),d=n(33983),p=n(84545),u=n(98373),m=n(8772),f=n(38562),h=n(2080);function v(){return e=>{e(i.N.set("showImportPanel",!0))}}function y(){return e=>{e(i.N.set("showImportPanel",!1))}}function b(){return e=>{e(i.N.set("importProgress",0)),e(i.N.set("importStart",!1)),e(i.N.set("importEnd",!1)),e(i.N.set("importError",{}))}}function g(e="uploads"){return async(t,n)=>{const o={title:"",type:"entity"};t(l.Nw.loadInReduxForm(`${e}.sidepanel.metadata`,o,n().templates.toJS())),await t((0,s.qC)(o))}}function S(e){return t=>f.Z.post("documents",new u.K(e)).then((e=>{const n=e.json;return t({type:c.T_,doc:n.sharedId}),t({type:c.L5,doc:n}),n}))}function w([e],t){return n=>new Promise((o=>{r().post(`${m.z}import`).set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").field("template",t).attach("file",e,e.name).on("progress",(e=>{n(i.N.set("importUploadProgress",Math.floor(e.percent)))})).on("response",(e=>{n(i.N.set("importUploadProgress",0)),o(e)})).end()}))}function N(e,t,n="files/upload/document"){return async o=>new Promise((i=>{r().post(m.z+n).set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").field("entity",e).field("originalname",t.name).attach("file",t).on("progress",(t=>{o({type:c.F6,doc:e,progress:Math.floor(t.percent)})})).on("response",(t=>{o({type:c.Yy,doc:e,file:t.body}),i(JSON.parse(t.text))})).end()}))}function O(e,t=!1){return n=>new Promise((o=>{const i=r().post(t?`${m.z}remotepublic`:`${m.z}public`).set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").field("captcha",JSON.stringify(e.captcha));let s,l;e.file&&i.attach("file",e.file),e.attachments&&e.attachments.forEach(((e,t)=>{i.attach(`attachments[${t}]`,e),i.field(`attachments_originalname[${t}]`,e.name)})),i.field("entity",JSON.stringify({title:e.title,template:e.template,metadata:e.metadata}));const c=new Promise(((e,t)=>{s=e,l=t}));i.on("progress",(()=>{o({promise:c})})).on("response",(e=>200===e.status?(n(a.J.notify("Success","success")),void s(e)):403===e.status?(n(a.J.notify(e.body.error,"danger")),void l(e)):(l(e),void n(a.J.notify("An error has ocurred","danger"))))).end()}))}function P(e){return t=>N(`customUpload_${(0,p.Z)()}`,e,"files/upload/custom")(t).then((e=>{t(i.N.push("customUploads",e))}))}function C(e){return t=>f.Z.delete("files",new u.K({_id:e})).then((e=>{t(i.N.remove("customUploads",e.json[0]))}))}function k(e,t){return async n=>N(e,t)(n)}function _(e,t){return n=>{h.Z.get(new u.K({sharedId:e})).then((([o])=>{n({type:c.F6,doc:e,progress:100}),n({type:d.wO,doc:o,__reducerKey:t}),n({type:d.So,__reducerKey:t}),n({type:d.St,doc:o,__reducerKey:t}),n({type:c.le,doc:e,files:o.documents,__reducerKey:"library"}),n(i.N.update("entityView/entity",o)),n(i.N.update("viewer/doc",o)),n({type:c.rW,doc:e})}))}}},11074:(e,t,n)=>{"use strict";n.d(t,{$M:()=>b,C9:()=>l,F:()=>v,Fn:()=>y,GF:()=>p,LX:()=>u,Ls:()=>i,SA:()=>g,U8:()=>w,VQ:()=>h,X8:()=>s,Zb:()=>a,d$:()=>S,gL:()=>o,m7:()=>d,nh:()=>c,no:()=>f,x0:()=>m,xV:()=>r});const o="SET_REFERENCES",r="RESET_DOCUMENT_VIEWER",i="SET_SELECTION",a="UNSET_SELECTION",s="SET_TARGET_SELECTION",l="UNSET_TARGET_SELECTION",c="VEWER_UPDATE_DOCUMENT",d="ADD_CREATED_REFERENCE",p="REMOVE_REFERENCE",u="LOAD_DEFAULT_VIEWER_MENU",m="GO_TO_ACTIVE",f="OPEN_PANEL",h="CLOSE_PANEL",v="SELECT_TARGET_DOCUMENT",y="RESET_REFERENCE_CREATION",b="HIGHLIGHT_REFERENCE",g="ACTIVE_REFERENCE",S="DEACTIVATE_REFERENCE",w="SELECT_SNIPPET"},32368:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addReference:()=>v,deleteReference:()=>b,loadReferences:()=>h,saveTargetRangedReference:()=>y,setReferences:()=>f});var o=n(11074),r=n(65969),i=n(39263),a=n(59511),s=n(98373),l=n(11062),c=n(52173),d=n(87496);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return{type:o.gL,references:e}}function h(e){return t=>r.Z.get(new s.K({sharedId:e})).then((e=>{t(f(e))}))}function v(e,t){return(n,r)=>{n({type:o.m7,reference:e.saves[1]}),n({type:o.m7,reference:e.saves[0]}),n(a.N.unset("viewer/targetDoc")),n(a.N.unset("viewer/targetDocHTML")),n(a.N.unset("viewer/targetDocReferences")),n((0,c.reloadRelationships)(r().relationships.list.sharedId)),n(d._V(e.saves[0],"references",t))}}function y(e,t,n,o){return(r,i)=>{if(t.text)return r(a.N.unset("viewer/targetDocReferences")),l.Nw.saveConnection(u(u({},e),{},{targetRange:t,targetFile:n}),o)(r,i)}}function b(e){const{_id:t}=e.associatedRelationship;return(n,a)=>r.Z.delete(new s.K({_id:t})).then((()=>{n((0,c.reloadRelationships)(a().relationships.list.sharedId)),n({type:o.GF,reference:e}),n(i.J.notify("Connection deleted","success"))}))}},2669:(e,t,n)=>{"use strict";n.d(t,{FJ:()=>a,T8:()=>s,Z5:()=>r,px:()=>i});var o=n(11074);function r(e,t){return{type:o.Ls,sourceRange:e,sourceFile:t}}function i(e,t){return{type:o.X8,targetRange:e,targetFile:t}}function a(){return{type:o.Zb}}function s(){return{type:o.C9}}},87496:(e,t,n)=>{"use strict";n.d(t,{D$:()=>u,D6:()=>S,G8:()=>y,HS:()=>v,Mr:()=>h,Nt:()=>b,QB:()=>m,Yp:()=>d,_V:()=>g,hy:()=>w,sR:()=>c,yk:()=>p});var o=n(59511),r=n(36651),i=n(2669),a=n(54876),s=n(37242),l=n(11074);function c(){return{type:l.VQ}}function d(e){return{type:l.no,panel:e}}function p(){return function(e){e({type:l.Fn}),e(o.N.unset("viewer/targetDoc")),e(o.N.unset("viewer/targetDocHTML")),e(o.N.unset("viewer/targetDocReferences"))}}function u(e){return{type:l.$M,reference:e}}function m(){return{type:l.d$}}function f(e=!0){return{type:l.x0,value:e}}function h(e){a.Z.init(".document-viewer"),a.Z.unmark();const t=e.get("text");if(!t)return;const n=e=>e.replace(/…/g,"...").replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&").replace(/<[^>]*>/g,"").replace(/\s+/g,"\\s*").replace(/\n/g,"\\s*"),o=t.match(/<b>(.|\n)*?<\/b>/g),r=o?o.map((e=>e.replace(/<.*?>/g,""))):[],i=n(t),s=()=>{a.Z.init("mark"),a.Z.mark(r,{className:"searchTerm",diacritics:!1,acrossElements:!1,separateWordSearch:!0,accuracy:"exactly"})},l=(e=20)=>{if(!e)return;const o=n(t.substring(0,e)),r=n(t.substring(t.length-e-1,t.length-1)),i=new RegExp(`${o}.{1,200}${r}`);a.Z.markRegExp(i,{separateWordSearch:!1,acrossElements:!0,done:s,noMatch:l.bind(this,e-5)})},c=new RegExp(i);a.Z.markRegExp(c,{separateWordSearch:!1,acrossElements:!0,done:s,noMatch:l.bind(this,20)})}function v(e,t=50){s.Z.to(`.document-viewer div#page-${e}`,".document-viewer",{duration:t,dividerOffset:1,offset:50})}async function y(e){const{page:t,top:n}=e.selectionRectangles[0];await s.Z.to(`.document-viewer div#page-${t}`,".document-viewer",{duration:1,dividerOffset:1,offset:n,force:!0})}function b(e,t){return v(e),setTimeout((()=>{s.Z.to(".document-viewer mark",".document-viewer",{duration:0})}),500),e=>{e({type:l.U8,snippet:t})}}function g(e,t,n=!1){const i=t&&!Array.isArray(t)?t:"references";return r.U3.removeAllListeners("referenceRendered"),t=>{t({type:l.SA,reference:e._id}),n&&t(f()),t({type:l.no,panel:"viewMetadataPanel"}),t(o.N.set("viewer.sidepanel.tab",i)),n||setTimeout((()=>{!async function(e){const{page:t}=e.reference.selectionRectangles[0];await s.Z.to(`.document-viewer div#page-${t}`,".document-viewer",{duration:1,dividerOffset:1}),await s.Z.to(`.document-viewer [data-id="${e._id}"] .highlight-rectangle`,".document-viewer",{duration:50,dividerOffset:1,offset:-30}),await s.Z.to(`.metadata-sidepanel .item-${e._id}`,".metadata-sidepanel .sidepanel-body",{duration:50})}(e)}))}}function S(e,t,n){return o=>{n&&(o(f(!1)),o(g(e,t)))}}function w(e){return t=>{t(g(e)),t((0,i.px)(e.reference))}}},91285:(e,t,n)=>{"use strict";n.d(t,{X:()=>r,w:()=>o});var o=n(72861),r=n(32368)},65969:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(38562);const r={get:e=>o.Z.get("references/by_document",e).then((e=>e.json)),getGroupedByConnection:e=>o.Z.get("references/group_by_connection",e).then((e=>e.json)),getInbound:e=>o.Z.get("references/by_target/",e).then((e=>e.json.rows)),search:e=>o.Z.get("references/search",e).then((e=>e.json)),save:e=>o.Z.post("references",e).then((e=>e.json)),delete:e=>o.Z.delete("references",e).then((e=>e.json)),countByRelationType:e=>o.Z.get("references/count_by_relationtype",e).then((e=>e.json))}},72861:(e,t,n)=>{"use strict";n.r(t),n.d(t,{parseReferences:()=>a,selectDoc:()=>s,selectReferences:()=>c,selectTargetDoc:()=>d,selectTargetReferences:()=>u});var o=n(22222),r=n(43393);const i=e=>e.documentViewer;const a=(e,t)=>{const n=(0,r.Set)(t.filter((t=>function(e,t){return t.get("entity")===e.get("sharedId")&&void 0!==t.getIn(["reference","text"])}(e,t)))),o=new Map;n.forEach((e=>{const t=e.get("hub");o.has(t)||o.set(t,e)}));const i=new Map;Array.from(o.keys()).forEach((e=>{i.set(e,[])})),t.forEach((e=>{const t=e.get("hub"),r=o.get(t);!n.has(e)&&r&&i.get(t).push(r.set("associatedRelationship",e))}));return(0,r.List)(Array.from(i.values())).flatMap((e=>e))},s=(0,o.P1)((e=>i(e).doc),(e=>e)),l=(0,o.P1)((e=>i(e).references),(e=>e)),c=(0,o.P1)(s,l,a),d=(0,o.P1)((e=>i(e).targetDoc),(e=>e)),p=(0,o.P1)((e=>i(e).targetDocReferences),(e=>e)),u=(0,o.P1)(d,p,a)},54876:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(36651);let r,i;o.C5&&(r=n(813),window.Marker=r);const a={init(e){i=new r(e),o.C5&&(window.Marker=i)},markRegExp(e,t){i.markRegExp(e,t)},mark(e,t){i.mark(e,t)},unmark(){i.unmark()}}},37242:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={getElement:e=>document.querySelector(e),isVisible(e,t){const n=this.getElement(e),o=this.getElement(t);if(!o||!n)return!1;const r=n.getBoundingClientRect(),i=o.getBoundingClientRect();return r.top<i.top&&r.bottom>i.top||r.top>i.top&&r.top<i.bottom},to(e,t,n={}){const o=this.getOptions(n);if(this.isVisible(e,t)&&!o.force)return Promise.resolve();const r=this.getElement(e),i=this.getElement(t);if(!i||!r)return Promise.resolve();const a=this.getTargetScrollTop(r,i,o);return this.animateScroll(i,a,o)},getTargetScrollTop(e,t,n){const o=e.getBoundingClientRect().top-t.getBoundingClientRect().top+t.scrollTop;return t.scrollHeight-t.offsetHeight-(t.scrollHeight-o)+n.offset+e.scrollHeight+(t.offsetHeight-e.offsetHeight)/n.dividerOffset},animateScroll(e,t,n){const o=e,r=Date.now();return new Promise((e=>{const i=window.setInterval((()=>{const a=(Date.now()-r)/n.duration,s=this[n.animation](a);o.scrollTop+=s*(t-o.scrollTop),s>=.9&&(o.scrollTop=t,window.clearInterval(i),e())}),25);e(i)}))},getOptions:e=>Object.assign({duration:400,offset:0,animation:"easeIn",dividerOffset:2,force:!1},e),easeIn:e=>e*e,easeOut:e=>e*(2-e)}},37667:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});const o=(e,t)=>e.selectionRectangles[0].page===t.selectionRectangles[0].page?e.selectionRectangles[0].top-t.selectionRectangles[0].top:e.selectionRectangles[0].page-t.selectionRectangles[0].page},81478:(e,t,n)=>{"use strict";n.d(t,{e:()=>a});var o=n(67294),r=n(37974);const i=({featureActivated:e,children:t})=>e?o.createElement(o.Fragment,null,t):null;i.defaultProps={featureActivated:!1};const a=(0,r.connect)((function({settings:e},t){const n=e.collection.get("features");return{featureActivated:!!n&&Boolean(n.getIn(t.feature.split(".")))}}))(i)},76395:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o,r=n(67294);function i(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var s=new Array(a),l=0;l<a;l++)s[l]=arguments[l+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class a extends r.Component{render(){return i("div",{className:"cs-loader"},void 0,i("div",{className:"cs-loader-inner"},void 0,i("label",{},void 0," ●"),i("label",{},void 0," ●"),i("label",{},void 0," ●")))}}const s=a},8772:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});const o={NODE_ENV:"production"}.API_URL||"/api/"},78579:(e,t,n)=>{"use strict";var o={};n.r(o),n.d(o,{hideModal:()=>gr,showModal:()=>br});var r=n(67294),i=n(73935),a=n(27923),s=n(97914),l=n(57209),c=n(37974),d=n(52786),p=n(45697),u=n.n(p),m=n(36651);class f extends r.Component{constructor(e){super(e),this.data=m.C5&&window.__reduxData__?window.__reduxData__:e.initialData,this.renderedFromServer=!0,this.user=m.C5&&window.__user__?window.__user__:e.user}getChildContext(){return{getInitialData:this.getInitialData.bind(this),isRenderedFromServer:this.isRenderedFromServer.bind(this),getUser:this.getUser.bind(this),language:this.props.language}}getUser(){return this.user}isRenderedFromServer(){const{renderedFromServer:e}=this;return this.renderedFromServer=!1,e}getInitialData(){const{data:e}=this;return delete this.data,e}render(){const{children:e}=this.props;return r.Children.only(e)}}f.childContextTypes={getInitialData:u().func,isRenderedFromServer:u().func,getUser:u().func,language:u().string};const h=f;var v,y=n(39263),b=n(12209),g=n(53641),S=n(96038);function w(e,t,n,o){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class N extends r.Component{constructor(e){super(e),this.state={cookieExists:!m.C5||m.C5&&Boolean(b.U2("cookiepolicy"))},this.close=this.close.bind(this)}close(){b.t8("cookiepolicy",1,{expires:3650}),this.setState({cookieExists:!0})}render(){const{cookiepolicy:e}=this.props,{cookieExists:t}=this.state;if(!e||t)return w("div",{className:"alert-wrapper"});const n=w(g.vN,{},void 0,"To bring you a better experience, this site uses cookies.");return w("div",{className:"alert-wrapper"},void 0,w(S.P,{id:"cookiepolicy",removeNotification:this.close,message:n}))}}const O=(0,c.connect)((e=>({cookiepolicy:Boolean(e.settings.collection.get("cookiepolicy"))})))(N);var P,C=n(72027),k=n(74127),_=n(49935),j=n(65879),I=n(93673),D=n(691),T=n(37713),E=n(15316);function x(e,t){(0,r.useEffect)((()=>{const n=n=>{e.current&&!e.current.contains(n.target)&&t(n)};return document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}}),[e,t])}function A(e,t,n,o){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $=({link:e,position:t})=>{const[n,o]=(0,r.useState)(!1),i=(0,r.useRef)(null),a=(0,r.useCallback)((()=>{o(!1)}),[]),s=()=>{o(!n)};return x(i,a),r.createElement("li",{className:"menuNav-item",key:t,ref:i},A("button",{type:"button",className:`btn menuNav-btn menuNav-link dropdown-toggle ${n?"expanded":""} `,id:"navbarDropdownMenuLink",onClick:e=>{o(!n),e.stopPropagation()}},void 0,A(g.vN,{context:"Menu"},void 0,e.get("title")),"  ",A(C.JO,{icon:"caret-down"})),A("ul",{className:`dropdown-menu ${n?"expanded":""} `},void 0,e.get("sublinks").map(((e,t)=>{const n=(null==e?void 0:e.get("url"))||"/";return n.startsWith("http")?A("li",{},t,A("a",{href:n,className:"btn dropdown-item",target:"_blank",rel:"noreferrer",onClick:s},void 0,A(g.vN,{context:"Menu"},void 0,null==e?void 0:e.get("title")))):A("li",{},t,A(g.l3,{to:n,className:"btn dropdown-item",onClick:s},void 0,A(g.vN,{context:"Menu"},void 0,null==e?void 0:e.get("title"))))}))))};var R;function F(e,t,n,o){R||(R="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:R,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class L extends r.Component{libraryUrl(){const{location:e,librarySearch:t,libraryFilters:n,defaultLibraryView:o}=this.props,{searchTerm:r}=e.query,i=(0,I.Qk)(t,n.toJS());return i.searchTerm=r,`/${E.M[o].url}/${(0,I._K)(i)}`}render(){const{links:e,defaultLibraryView:t}=this.props,n=this.props.user.toJS(),o=e.map(((e,t)=>{if("link"===(e.get("type")||"link")){const t=e.get("url")||"/";return t.startsWith("http")?F("li",{className:"menuNav-item"},e.get("_id"),F("a",{href:t,className:"btn menuNav-btn",activeClassName:"active-link",target:"_blank",rel:"noreferrer"},void 0,(0,g.t)("Menu",e.get("title")))):F("li",{className:"menuNav-item"},e.get("_id"),F(g.l3,{to:t,className:"btn menuNav-btn",activeClassName:"active-link"},void 0,(0,g.t)("Menu",e.get("title"))))}return F($,{link:e,position:t},t)}));return F("ul",{className:this.props.className},void 0,F("li",{className:"menuItems",onClick:this.props.onClick},void 0,F("ul",{className:"menuNav-list"},void 0,o)),F(g.ju,{}),F("li",{className:"menuActions mobile-menuActions",onClick:this.props.onClick},void 0,F("ul",{className:"menuNav-list"},void 0,F(T.S,{},void 0,F("li",{className:"menuNav-item semantic-search"},void 0,F("button",{type:"button",onClick:this.props.showSemanticSearch,className:"menuNav-btn btn btn-default","aria-label":(0,g.t)("System","Semantic search",null,!1)},void 0,F(C.JO,{icon:"flask"}),F("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Semantic search"))))),F("li",{className:"menuNav-item"},void 0,F(g.l3,{to:this.libraryUrl(),className:"menuNav-btn btn btn-default public-documents",activeClassName:"active-link","aria-label":(0,g.t)("System","Library",null,!1)},void 0,F(C.JO,{icon:E.M[t].icon}),F("span",{className:"tab-link-label"},void 0,(0,g.t)("System","Library")))),F(j.W,{roles:["admin","editor","collaborator"]},void 0,F("li",{className:"menuNav-item"},void 0,F(g.l3,{to:"/settings/account",className:"menuNav-btn btn btn-default settings-section",activeClassName:"active-link","aria-label":(0,g.t)("System","Settings",null,!1)},void 0,F(C.JO,{icon:"cog"}),F("span",{className:"tab-link-label"},void 0,(0,g.t)("System","Settings"))))),F(j.W,{roles:["admin","editor","collaborator"]},void 0,F("li",{className:"menuNav-item only-mobile"},void 0,F("a",{href:"/logout",className:"menuNav-btn btn btn-default"},void 0,F(C.JO,{icon:"power-off"}),F("span",{className:"tab-link-label"},void 0,(0,g.t)("System","Logout"))))),n._id?null:F("li",{className:"menuNav-item"},void 0,F(g.l3,{to:"/login",className:"menuNav-btn btn btn-default","aria-label":(0,g.t)("System","Sign in",null,!1)},void 0,F(C.JO,{icon:"power-off"}),F("span",{className:"tab-link-label"},void 0,(0,g.t)("System","Sign in")))))))}}L.defaultProps={showSemanticSearch:()=>{},defaultLibraryView:"cards"};const J=(0,c.connect)((function({user:e,settings:t,library:n,uploads:o}){return{user:e,librarySearch:n.search,libraryFilters:n.filters,uploadsSearch:o.search,uploadsFilters:o.filters,uploadsSelectedSorting:o.selectedSorting,links:t.collection.get("links"),defaultLibraryView:t.collection.get("defaultLibraryView")}}),(function(e){return(0,k.bindActionCreators)({showSemanticSearch:D.showSemanticSearch},(0,_.Qd)(e,"library"))}))(L);var Z,M=n(64593);function V(e,t,n,o){Z||(Z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class U extends r.Component{render(){return V("div",{},void 0,V(M.q,{titleTemplate:`%s • ${this.props.siteName}`,meta:[{"char-set":"utf-8"},{name:"description",content:"Uwazi docs"}]}),V(g.l3,{to:"/"},void 0,this.props.siteName))}}const z=(0,c.connect)((function(e){return{siteName:e.settings.collection.get("site_name")}}))(U);var K,B=n(587),H=n(76395);function q(e,t,n,o){K||(K="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:K,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class W extends r.Component{static getDerivedStateFromProps(e,t){return e.accept!==t.accept?{isOpen:!0,accept:e.accept}:null}constructor(e){super(e),this.state={isOpen:e.isOpen,isLoading:e.isLoading,confirmInputValue:""},this.accept=this.accept.bind(this),this.cancel=this.cancel.bind(this),this.close=this.close.bind(this),this.handleInput=this.handleInput.bind(this)}close(){this.setState({isOpen:!1,confirmInputValue:"",isLoading:!1})}accept(){if(this.props.accept){const e=this.props.accept();if(e&&e instanceof Promise)return this.setState({isLoading:!0}),e.then(this.close),void e.catch(this.close)}this.close()}cancel(){this.props.cancel&&this.props.cancel(),this.close()}handleInput(e){this.setState({confirmInputValue:e.target.value})}renderExtraConfirm(){return r.createElement(r.Fragment,null,q("p",{},void 0,q(g.vN,{},void 0,"If you want to continue, please type")," '",this.props.extraConfirmWord,"'"," "),q("input",{type:"text",onChange:this.handleInput,value:this.state.confirmInputValue}))}render(){const{type:e,acceptLabel:t,zIndex:n,message:o,title:r,messageKey:i}=this.props;return q(B.Z,{isOpen:this.state.isOpen,type:e,zIndex:n},void 0,q(B.Z.Body,{},void 0,q("h4",{},void 0,"string"!=typeof r&&r,"string"==typeof r&&q(g.vN,{},void 0,r)),q("p",{},void 0,"string"!=typeof o&&o,"string"==typeof o&&q(g.vN,{translationKey:i},void 0,o)),this.props.extraConfirm&&!this.state.isLoading&&this.renderExtraConfirm(),this.state.isLoading&&q(H.Z,{})),!this.state.isLoading&&q(B.Z.Footer,{},void 0,!this.props.noCancel&&q("button",{type:"button",className:"btn btn-default cancel-button",onClick:this.cancel},void 0,q(g.vN,{},void 0,"Cancel")),q("button",{type:"button",disabled:this.props.extraConfirm&&this.state.confirmInputValue!==this.props.extraConfirmWord,className:`btn confirm-button btn-${e}`,onClick:this.accept},void 0,q(g.vN,{},void 0,t))))}}W.defaultProps={isLoading:!1,extraConfirm:!1,isOpen:!1,noCancel:!1,type:"danger",title:"Confirm action",messageKey:"",message:"Are you sure you want to continue?",extraConfirmWord:"CONFIRM",acceptLabel:"Accept",zIndex:99};const G=W;var Q;function Y(e,t,n,o){Q||(Q="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Q,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function X(){m.C5&&window.gtag&&window.gtag("send","pageview"),m.C5&&window._paq&&(window._paq.push(["setCustomUrl",window.location.href]),window._paq.push(["deleteCustomVariables","page"]),window._paq.push(["setGenerationTimeMs",0]),window._paq.push(["trackPageView"]))}class ee extends r.Component{constructor(e){super(e),e.analyticsTrackingId&&m.C5&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",e.analyticsTrackingId),X())}render(){return!!this.props.analyticsTrackingId&&Y("script",{async:!0,src:`https://www.googletagmanager.com/gtag/js?id=${this.props.analyticsTrackingId}`})}}ee.defaultProps={analyticsTrackingId:""};const te=(0,c.connect)((function({settings:e}){return{analyticsTrackingId:e.collection.get("analyticsTrackingId")}}))(ee);var ne;function oe(e,t,n,o){ne||(ne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class re extends r.Component{render(){if(!this.props.id&&!this.props.url)return!1;return oe("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:`\n              var _paq = _paq || [];\n              _paq.push(['trackPageView']);\n              _paq.push(['enableLinkTracking']);\n              (function() {\n                var u="${this.props.url.replace(/\/?$/,"/")}";\n                _paq.push(['setTrackerUrl', u+'piwik.php']);\n                _paq.push(['setSiteId', '${this.props.id}']);\n                var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];\n                g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);\n              })();\n        `}})}}re.defaultProps={id:"",url:""};const ie=(0,c.connect)((function({settings:e}){try{const{id:t,url:n}=JSON.parse(e.collection.get("matomoConfig"));return{id:t,url:n}}catch(e){return{}}}))(re);var ae;function se(e,t,n,o){ae||(ae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class le extends r.Component{constructor(e,t){super(e,t),this.state={showmenu:!1,confirmOptions:{}},this.toggleMenu=this.toggleMenu.bind(this)}getChildContext(){return{confirm:this.confirm.bind(this)}}toggleMenu(){this.setState({showmenu:!this.state.showmenu})}confirm(e){this.setState({confirmOptions:e})}renderTools(){return r.Children.map(this.props.children,(e=>{if(e.type.renderTools)return e.type.renderTools()}))}render(){const{routes:e,location:t,params:n}=this.props;let o="bars",i="menuNav";this.state.showmenu&&(o="times",i+=" is-active");const a=e.reduce(((e,t)=>Object.keys(t).includes("customHomePageId")?t.customHomePageId:e),""),s=t.pathname.match("page/")&&n.sharedId?n.sharedId:"";return se("div",{id:"app",className:a||s?`pageId_${a||s}`:""},void 0,se(y.Z,{}),se(O,{}),se("div",{className:"content"},void 0,se("nav",{},void 0,se("h1",{},void 0,se(z,{}))),se("header",{},void 0,se("button",{className:"menu-button",onClick:this.toggleMenu,"aria-label":(0,g.t)("System","Menu",null,!1)},void 0,se(C.JO,{icon:o})),se("h1",{className:"logotype"},void 0,se(z,{})),this.renderTools(),se(J,{location:t,onClick:this.toggleMenu,className:i})),se("div",{className:"app-content container-fluid"},void 0,r.createElement(G,this.state.confirmOptions),se(g.Vk,{}),this.props.children,se(te,{}),se(ie,{}))))}}le.defaultProps={params:{},routes:[]},le.childContextTypes={confirm:u().func,locale:u().string},le.contextTypes={getUser:u().func,router:u().object};const ce=le;var de=n(38562),pe=n(98373),ue=n(30381),me=n.n(ue);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ve={parseNested(e){if("object"!=typeof e)return e;const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return Object.keys(e).forEach((n=>{try{t[n]=JSON.parse(e[n])}catch(o){t[n]=e[n]}})),t}},ye=["lang"];var be;function ge(e,t,n,o){be||(be="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:be,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}class Pe extends r.Component{static async requestState(e,t){return new Promise(((e,t)=>{e([])}))}emptyState(){}static renderTools(){}isRenderedFromServer(){const e=Pe.renderedFromServer;return Pe.renderedFromServer=!1,e}constructor(e,t){var n;super(e,t),n=(({store:e})=>e.getState().locale)(t),me().locale(n),de.Z.locale(n),g.ee.saveLocale(n),!this.isRenderedFromServer()&&m.C5&&this.getClientState(this.props)}componentDidUpdate(e){this.urlHasChanged(e)&&(this.emptyState(),this.getClientState(this.props))}async getClientState(e){let t;e.location&&(t=ve.parseNested(e.location.query));const{store:n={getState:()=>{}}}=this.context,o=e.params,{lang:r}=o,i=Oe(o,ye),a=new pe.K(we(we({},t),i),{});(await this.constructor.requestState(a,n.getState())).forEach((e=>{n.dispatch(e)}))}urlHasChanged(e){const{params:t={},routes:n=[]}=e,{params:o,routes:r}=this.props,i=Object.keys(t).reduce(((t,n)=>t&&e.params[n]===o[n]),!0),a=Object.keys(t).length===Object.keys(o).length,s=r.reduce(((e,t)=>e+t.path),""),l=n.reduce(((e,t)=>e+t.path),"");return!i||!a||!(s===l)}render(){return ge("div",{},void 0,!1)}}Pe.renderedFromServer=!0,Pe.defaultProps={params:{}},Pe.contextTypes={getInitialData:u().func,isRenderedFromServer:u().func,router:u().object,store:u().object};const Ce=Pe;var ke=n(59511),_e=n(79223),je=n(43393),Ie=n.n(je),De=n(83668);const Te=(e,t=!1)=>{const n=t?"concat":"set";return t=>de.Z.get("activitylog",new pe.K(e)).then((e=>{t(ke.N.set("activitylog/search",e.json)),t(ke.N[n]("activitylog/list",e.json.rows))}))};function Ee(e){return Te(e)}function xe(e){return Te(e,!0)}var Ae;function $e(e,t,n,o){Ae||(Ae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Je extends r.Component{constructor(e){super(e),this.state={query:{}},this.handleSubmit=this.handleSubmit.bind(this),this.loadMore=this.loadMore.bind(this)}handleSubmit(e){const{submit:t}=this.props,n=Object.keys(e).reduce(((t,n)=>e[n]?Object.assign(t,{[n]:e[n]}):t),{});this.setState({query:n}),t(n)}loadMore(){const{searchResults:e,searchMore:t}=this.props;if(e.get("remainingRows")){const{query:n}=this.state,o=parseInt(e.getIn(["rows",-1,"time"]),10);t(Fe(Fe({},n),{},{before:o}))}}render(){const{children:e,searchResults:t}=this.props;return $e("div",{},void 0,$e("div",{className:"activity-log-form"},void 0,$e(_e.hD,{onSubmit:this.handleSubmit},void 0,$e("div",{className:"form-group col-sm-12 col-md-6 col-lg-2"},void 0,$e("label",{htmlFor:"find"},void 0,$e(g.vN,{},void 0,"User")),$e(_e.oT.text,{className:"form-control",model:".username",id:"username"})),$e("div",{className:"form-group col-sm-12 col-md-6 col-lg-4"},void 0,$e("label",{htmlFor:"find"},void 0,$e(g.vN,{},void 0,"Find")),$e(_e.oT.text,{className:"form-control",model:".find",id:"find",placeholder:"by ids, methods, keywords, etc."})),$e("div",{className:"form-group col-sm-12 col-lg-6"},void 0,$e("label",{htmlFor:"time"},void 0,$e(g.vN,{},void 0,"Time")),$e(De.C0,{className:"form-control",model:".time",id:"time",format:"yyyy-MM-dd",useTimezone:!0})),$e("div",{className:"form-group col-sm-12"},void 0,$e("button",{type:"submit",className:"btn btn-success"},void 0,$e(g.vN,{},void 0,"Search"))))),e,$e("div",{className:"text-center"},void 0,$e("button",{type:"button",className:"btn btn-default btn-load-more "+(t.get("remainingRows")?"":"disabled"),onClick:()=>{this.loadMore()}},void 0,(0,g.t)("System","x more"))))}}Je.defaultProps={children:null};const Ze=(0,c.connect)((({activitylog:e})=>({searchResults:e.search})),(e=>(0,k.bindActionCreators)({submit:Ee,searchMore:xe},e)))(Je);var Me;function Ve(e,t,n,o){Me||(Me="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Me,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ue=e=>{const{entry:t,toggleExpand:n,expanded:o,children:r}=e;return Ve("div",{},void 0,Ve("div",{},void 0,Ve("span",{className:"expand",onClick:()=>{n()}},void 0,r)),o&&Ve("div",{className:"expanded-content"},void 0,Ve("table",{},void 0,Ve("tbody",{},void 0,t.getIn(["semantic","beautified"])&&Ve("tr",{},void 0,Ve("td",{},void 0,Ve(g.vN,{},void 0,"Route")),Ve("td",{},void 0,t.get("method")," : ",t.get("url"))),Ve("tr",{},void 0,Ve("td",{},void 0,Ve(g.vN,{},void 0,"Query")),Ve("td",{className:"tdquery"},void 0,t.get("query"))),Ve("tr",{},void 0,Ve("td",{},void 0,Ve(g.vN,{},void 0,"Body")),Ve("td",{className:"tdbody"},void 0,t.get("body"))),t.getIn(["semantic","errorStack"])&&Ve("tr",{},void 0,Ve("td",{},void 0,Ve(g.vN,{},void 0,"Error")),Ve("td",{className:"tdbody"},void 0,t.getIn(["semantic","errorStack"])))))))};Ue.defaultProps={children:Ve("span",{}),expanded:!1};const ze=Ue;var Ke;function Be(e,t,n,o){Ke||(Ke="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ke,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class He extends r.Component{constructor(e){super(e),this.state={expanded:!1},this.toggleExpand=this.toggleExpand.bind(this)}toggleExpand(){const{expanded:e}=this.state;this.setState({expanded:!e})}render(){const{entry:e}=this.props,{expanded:t}=this.state,n=`${me()(e.get("time")).format("L")} ${me()(e.get("time")).locale("en").format("LTS")}`,o=e.get("semantic").toJS(),r=Be(ze,{entry:e,toggleExpand:this.toggleExpand,expanded:t},void 0,Be("span",{},void 0,o.description&&Be("span",{className:"activitylog-prefix"},void 0,o.description),o.name&&Be("span",{className:"activitylog-name"},void 0," ",o.name),o.extra&&Be("span",{className:"activitylog-extra"},void 0," ",o.extra)));return Be("tr",{className:"RAW"===o.action?"activitylog-raw":"activitylog-beautified"},e.get("_id"),Be("td",{},void 0,(e=>{switch(e){case"CREATE":return Be("span",{className:"badge btn-color-9"},void 0,e);case"UPDATE":return Be("span",{className:"badge btn-color-6"},void 0,e);case"DELETE":return Be("span",{className:"badge btn-color-2"},void 0,e);case"RAW":default:return Be("span",{className:"badge btn-color-17"},void 0,e);case"MIGRATE":return Be("span",{className:"badge btn-color-12"},void 0,e);case"WARNING":return Be("span",{className:"badge btn-color-13"},void 0,e," ",Be(C.JO,{icon:"exclamation-triangle"}))}})(o.action)),Be("td",{className:e.get("username")?"":"color-0"},void 0,e.get("username")||"anonymous"),Be("td",{},void 0,r),Be("td",{className:"activitylog-time"},void 0,n))}}He.defaultProps={entry:(0,je.Map)()};const qe=He;var We;function Ge(e,t,n,o){We||(We="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:We,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qe extends r.Component{render(){const{list:e}=this.props;return Ge("div",{className:"activity-log-list"},void 0,Ge("table",{className:"table"},void 0,Ge("thead",{},void 0,Ge("tr",{},void 0,Ge("th",{},void 0,Ge(g.vN,{},void 0,"Action")),Ge("th",{},void 0,Ge(g.vN,{},void 0,"User")),Ge("th",{className:"activitylog-description"},void 0,Ge(g.vN,{},void 0,"Description")),Ge("th",{className:"activitylog-time"},void 0,Ge(g.vN,{},void 0,"Time")))),Ge("tbody",{},void 0,e.map((e=>Ge(qe,{entry:e},e.get("_id")))))))}}const Ye=(0,c.connect)((function({activitylog:e}){return{list:e.list}}),null)(Qe);var Xe;function et(e,t,n,o){Xe||(Xe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tt=class extends Ce{static async requestState(e){const t=await de.Z.get("activitylog",e);return[ke.N.set("activitylog/search",t.json),ke.N.set("activitylog/list",t.json.rows)]}render(){return et("div",{className:"settings-content without-footer"},void 0,et("div",{className:"activity-log"},void 0,et(Ze,{},void 0,et(Ye,{}))))}};var nt=n(98014);const ot={setSecret:async e=>(await de.Z.post("auth2fa-secret",e)).json,enable:async e=>(await de.Z.post("auth2fa-enable",e)).json,reset2fa:async e=>(await de.Z.post("auth2fa-reset",e)).json};function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){at(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(){return ke.N.setIn("auth/user","using2fa",!0)}var lt;function ct(e,t,n,o){lt||(lt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:lt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dt=(0,nt.ZP)((async()=>n.e(545).then(n.bind(n,84059))),{resolveComponent:e=>e.QRCodeSVG}),pt=(e,t)=>ct(g.l3,{to:"/settings/account",className:`btn btn-${e}`},void 0,(0,g.t)("System",t));class ut extends r.Component{constructor(e){super(e),this.state={conflict:!1,otpauth:"",secret:""},this.setSecret=this.setSecret.bind(this),this.enable2fa=this.enable2fa.bind(this)}async componentDidMount(){const{userUsing2fa:e}=this.props;e||await this.setSecret()}async setSecret(){const{otpauth:e,secret:t}=await ot.setSecret(new pe.K);this.setState({otpauth:e,secret:t})}async enable2fa(e){const{token:t}=e,{enable2fa:n}=this.props;try{const{success:e}=await ot.enable(new pe.K({token:t}));e&&n()}catch(e){409===e.status&&this.setState({conflict:!0})}}render(){const{otpauth:e,secret:t,conflict:n}=this.state,{userUsing2fa:o}=this.props;return ct("div",{className:"settings-content"},void 0,ct("div",{className:"configure2fa-settings"},void 0,ct("div",{className:"panel panel-default"},void 0,ct("div",{className:"panel-heading"},void 0,ct(g.vN,{},void 0,"Two-step verification")),ct("div",{className:"panel-body"},void 0,o&&r.createElement(r.Fragment,null,ct("div",{className:"alert alert-success"},void 0,ct(C.JO,{icon:"check"}),ct("div",{className:"force-ltr"},void 0,ct(g.vN,{},void 0,"Congratulations!"),ct("br",{}),ct(g.vN,{},void 0,"You have successfully configured two-step verification."))),pt("success","OK")),!o&&ct("div",{},void 0,ct("p",{},void 0,ct(g.vN,{},void 0,"Activate this feature for enhanced account security")),ct("h3",{},void 0,ct(g.vN,{},void 0,"Using Google Authenticator")),ct(_e.hD,{model:"2fa",onSubmit:this.enable2fa},void 0,ct("ol",{},void 0,ct("li",{},void 0,ct(g.vN,{},void 0,"Install the Google Authenticator app on your mobile device")),ct("li",{},void 0,ct(g.vN,{},void 0,'Open the app and select "Add Account" (usually a plus symbol)')),ct("li",{},void 0,ct(g.vN,{},void 0,'Scan the following QR code selecting the "scan barcode" option:'),ct("div",{className:"qr-code"},void 0,e&&ct(dt,{value:e,level:"Q",includeMargin:!1,size:200,bgColor:"white",fgColor:"black"})),ct(g.vN,{},void 0,"Or enter this secret key into your Authenticator app"),ct("br",{}),ct(g.vN,{},void 0,"(please keep this key secret and don't share it):"),ct("div",{className:"secret-key"},void 0,ct("span",{},void 0,t))),ct("li",{},void 0,ct(g.vN,{},void 0,"Enter the 6-digit verification code generated by your Authenticator app:"),ct("br",{}),ct("div",{className:"row"},void 0,ct("div",{className:"col-8 col-md-4 col-lg-2 "+(n?"has-error":"")},void 0,ct(_e.oT.text,{className:"form-control",model:".token",id:"token"}))))),ct("p",{},void 0,pt("default","Cancel"),ct("button",{type:"submit",className:"btn btn-success"},void 0,ct(g.vN,{},void 0,"Confirm")))))))))}}var mt,ft,ht;ht=void 0,(ft="defaultProps")in(mt=ut)?Object.defineProperty(mt,ft,{value:ht,enumerable:!0,configurable:!0,writable:!0}):mt[ft]=ht,ut.defaultProps={userUsing2fa:!1,enable2fa:()=>{}};const vt=(0,c.connect)((e=>({userUsing2fa:e.user.toJS().using2fa})),(e=>(0,k.bindActionCreators)({enable2fa:st},e)))(ut);var yt,bt=n(74371),gt=n(58010);function St(e,t,n,o){yt||(yt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:yt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wt=({onFileImported:e,children:t})=>{const n=(0,r.useRef)();return St("div",{onClick:()=>{var e;null!==n.current&&(null===(e=n.current)||void 0===e||e.click())},style:{display:"inline"}},void 0,t,r.createElement("input",{ref:n,type:"file",accept:"text/csv",style:{display:"none"},onChange:t=>{const n=t.target.files[0];n&&e(n)}}))};var Nt;function Ot(e,t,n,o){Nt||(Nt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Nt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){kt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _t extends r.Component{static getDefaultTranslation(e,t){const n=t.find((e=>e.default)).key;return e.find((e=>e.locale===n))}static translationExists(e,t){return e.find((e=>e.locale===t))}constructor(e){super(e),this.save=this.save.bind(this),this.importTranslationsFile=this.importTranslationsFile.bind(this)}shouldComponentUpdate(e){return this.props.translationsForm.length!==e.translationsForm.length}componentWillUnmount(){this.props.resetForm()}importTranslationsFile(e){this.props.importTranslations(this.props.context,e)}prepareTranslations(){const{translationsForm:e,settings:t}=this.props;if(e.length){const{languages:n}=t.collection.toJS();n.forEach((t=>{if(!_t.translationExists(e,t.key)){const o=_t.getDefaultTranslation(e,n),r={locale:t.key,values:Ct({},o.values)};e.push(r)}}))}return e}save(e){const t=e.map((e=>Ct(Ct({},e),{},{contexts:e.contexts.filter((e=>e.id===this.props.context))})));this.props.saveTranslations(t)}render(){const e=this.props.context;let t={values:[]};const n=this.prepareTranslations.call(this);n.length&&(t=n[0].contexts.find((t=>t.id===e))||t);const o="System"===e&&Ot(wt,{onFileImported:this.importTranslationsFile},void 0,Ot("button",{type:"button",className:"btn btn-default import-template"},void 0,Ot(C.JO,{icon:"upload"}),Ot("span",{className:"btn-label"},void 0,Ot(g.vN,{},void 0,"Import")))),r=Object.keys(t.values),i=t.label;return Ot("div",{className:"EditTranslationForm"},void 0,Ot(_e.l0,{model:"translationsForm",onSubmit:this.save},void 0,Ot("div",{className:"panel panel-default"},void 0,Ot("div",{className:"panel-heading"},void 0,(0,g.t)("System","Translations")," ",Ot(C.JO,{icon:"angle-right"})," ",i),Ot("ul",{className:"list-group"},void 0,(()=>{if(n.length)return r.sort().map((t=>Ot("li",{className:"list-group-item"},t,Ot("h5",{},void 0,t),n.map(((n,o)=>{const r=n.contexts.find((t=>t.id===e)),i=n.contexts.indexOf(r);return Ot(gt.Z,{},`${n.locale}-${t}-${o}`,Ot("div",{className:"input-group"},void 0,Ot("span",{className:"input-group-addon"},void 0,n.locale),Ot(_e.gN,{model:["translationsForm",o,"contexts",i,"values",t]},void 0,Ot("input",{className:"form-control",type:"text"}))))})))))})())),Ot("div",{className:"settings-footer"},void 0,Ot("div",{className:"btn-cluster"},void 0,Ot(bt.xE,{to:"/settings/translations",className:"btn-plain"}),o),Ot("div",{className:"btn-cluster content-right"},void 0,Ot(g.l3,{to:"/settings/translations",className:"btn btn-extra-padding btn-default"},void 0,Ot("span",{className:"btn-label"},void 0,Ot(g.vN,{},void 0,"Cancel"))),Ot("button",{type:"submit",className:"btn btn-extra-padding btn-success save-template"},void 0,Ot("span",{className:"btn-label"},void 0,Ot(g.vN,{},void 0,"Save")))))))}}const jt=(0,c.connect)((function({translationsForm:e,translationsFormState:t,settings:n}){return{translationsForm:e,settings:n,formState:t}}),(function(e){return(0,k.bindActionCreators)({saveTranslations:g.Nw.saveTranslations,resetForm:g.Nw.resetForm,importTranslations:g.Nw.importTranslations},e)}))(_t);var It;function Dt(e,t,n,o){It||(It="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:It,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Tt=n(6858),Et=n(48802);function xt(e,t,n){const o=e.metaKey||e.ctrlKey||e.shiftKey;if(o||this.props.unselectAllDocuments(),n&&!o)return this.props.selectDocument(t);if(n)return this.props.unselectDocument(t.get("_id"));if(!n&&e.shiftKey){const e=this.props.selectedDocuments.last(),n=this.props.documents.get("rows"),o=n.reduce(((t,n,o)=>n.get("_id")===e.get("_id")?o:t),-1),r=n.reduce(((e,n,o)=>n.get("_id")===t.get("_id")?o:e),-1);let i=n.slice(o,r+1);return r<o&&(i=n.slice(r,o+1)),this.props.selectDocuments(i.toJS())}return this.props.selectDocument(t)}function At(){const e=this.props.documents.get("rows");return this.props.selectDocuments(e.toJS())}const $t=(0,c.connect)((function(e,t){return{documents:e[t.storeKey].documents,filters:e[t.storeKey].filters,filtersPanel:e[t.storeKey].ui.get("filtersPanel"),search:e[t.storeKey].search,selectedDocuments:e[t.storeKey].ui.get("selectedDocuments"),multipleSelected:e[t.storeKey].ui.get("selectedDocuments").size>1,rowListZoomLevel:e[t.storeKey].ui.get("zoomLevel"),clickOnDocument:xt,selectAllDocuments:At}}),(function(e,t){return(0,k.bindActionCreators)({loadMoreDocuments:I.rh,searchDocuments:I.W7,selectDocument:I.P7,selectDocuments:I.aE,unselectDocument:I.HU,unselectAllDocuments:I.jh,onSnippetClick:()=>ke.N.set(`${t.storeKey}.sidepanel.tab`,"text-search")},(0,_.Qd)(e,t.storeKey))}))(Et.Z);var Rt,Ft=n(11954),Lt=n(22222),Jt=n(66139);function Zt(e,t,n,o){Rt||(Rt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Rt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mt=e=>t=>{e.selectAll&&t&&void 0!==e.indeterminate&&(t.indeterminate=e.indeterminate)},Vt=({item:e})=>r.createElement(r.Fragment,null,r.createElement("input",{ref:Mt(e),type:"checkbox",checked:!e.hidden,onChange:()=>{}}),Zt(g.vN,{context:e.translationContext},void 0,e.label)),Ut=(e,t,n)=>()=>Zt("span",{className:"columns-hint",onClick:n},void 0,Zt(C.JO,t?{icon:"times"}:{icon:"bars",rotation:90}),e.length?`${e.length} `:"",Zt(g.vN,{},void 0,e.length?"columns hidden":"Hide columns"));function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ht=(0,c.connect)((e=>({columns:e.library.ui.get("tableViewColumns")})),(e=>(0,k.bindActionCreators)({setTableViewColumnHidden:I.SQ,setTableViewAllColumnsHidden:I.Jq},(0,_.Qd)(e,"library")))),qt=Ht((({setTableViewAllColumnsHidden:e,setTableViewColumnHidden:t,columns:n})=>{const[o,i]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1),{sortedColumns:l,hiddenColumns:c}=(e=>{const t=e.toJS().slice(1),n=t.filter((e=>e.hidden)),o=t.filter((e=>!e.hidden));return{sortedColumns:[{label:"Show all",selectAll:!0,indeterminate:0!==n.length&&0!==o.length,hidden:0===o.length,type:"text"}].concat(o.concat(n).map((e=>Kt(Kt({},e),{},{selectAll:!1})))),hiddenColumns:n}})(n),d=(0,r.useRef)(null),p=(0,r.useRef)(null);x(d,(0,r.useCallback)((e=>{var t;"columns-hint"===e.target.className||e.target.parentElement&&"columns-hint"===e.target.parentElement.className||(s(!0),null===(t=p.current)||void 0===t||t.props.onToggle())}),[]));return r.createElement("div",{className:"hidden-columns-dropdown",ref:d},r.createElement(Jt.sV,{ref:p,open:o,data:l,filter:(e,t)=>e.label.toLowerCase().includes(t.toLowerCase()),itemComponent:Vt,valueComponent:Ut(c,o,(()=>{o&&i(!1)})),onSelect:n=>{var o;(o=n).selectAll?e(!o.indeterminate&&!o.hidden):t(o.name,!o.hidden)},onToggle:()=>{var e;if(a)return i(!1),s(!1),void(null===(e=p.current)||void 0===e||e.forceUpdate());o||i(!0)}}))}));var Wt;function Gt(e,t,n,o){Wt||(Wt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Wt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qt extends r.Component{render(){const{zoomLevel:e,zoomOut:t,zoomIn:n,showGeolocation:o,searchUrl:r,storeKey:i,tableViewMode:a,mapViewMode:s}=this.props;return Gt("div",{className:"list-view-mode"},void 0,a&&Gt(qt,{className:"table-view-column-selector",storeKey:i}),!s&&Gt("div",{className:`list-view-mode-zoom list-view-buttons-zoom-${e} buttons-group ${a?"unpinned-mode":""}`},void 0,Gt("button",{className:"btn btn-default zoom-out",onClick:t,type:"button","aria-label":(0,g.t)("System","Zoom out library view",null,!1)},void 0,Gt(C.JO,{icon:"search-minus"}),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Zoom out"))),Gt("button",{className:"btn btn-default zoom-in",onClick:n,type:"button","aria-label":(0,g.t)("System","Zoom in library view",null,!1)},void 0,Gt(C.JO,{icon:"search-plus"}),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Zoom in")))),Gt("div",{className:"list-view-mode-map buttons-group"},void 0,Gt(g.l3,{to:`library${r}`,className:"btn btn-default",activeClassName:"is-active","aria-label":(0,g.t)("System","library list view",null,!1)},void 0,Gt(C.JO,{icon:"th"}),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Cards view"))),Gt(g.l3,{to:`library/table${r}`,className:"btn btn-default",activeClassName:"is-active","aria-label":(0,g.t)("System","library table view",null,!1)},void 0,Gt(C.JO,{icon:"align-justify"}),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Table view"))),o&&Gt(g.l3,{to:`library/map${r}`,className:"btn btn-default",activeClassName:"is-active","aria-label":(0,g.t)("System","library map view",null,!1)},void 0,Gt(C.JO,{icon:"map-marker"}),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Map view")))),Gt("div",{className:"buttons-group toggle-button "+(a?"unpinned":"only-mobile")},void 0,Gt("button",{type:"button",className:"btn btn-default",onClick:this.props.showFilters},void 0,Gt(C.JO,{icon:"funnel-filter"}),Gt("span",{className:"filters-label"},void 0,Gt(g.vN,{},void 0,"Show filters")),Gt("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Show filters")))))}}Qt.defaultProps={tableViewMode:!1,mapViewMode:!1,zoomIn:null,zoomOut:null,showFilters:()=>{}};const Yt=(0,Lt.P1)((e=>e.search),(e=>e.filters),((e,t)=>{const n=(0,I.Qk)(e,t.toJS());return(0,I._K)(n)}));const Xt=(0,c.connect)((function(e,t){const{templates:n}=e,o=Boolean(n.find((e=>e.get("properties").find((e=>"geolocation"===e.get("type"))))));return{searchUrl:Yt(e[t.storeKey]),showGeolocation:o,zoomLevel:-1!==Object.keys(t).indexOf("zoomLevel")?t.zoomLevel:e[t.storeKey].ui.get("zoomLevel")}}),(function(e,t){return(0,k.bindActionCreators)({showFilters:Ft.rR},(0,_.Qd)(e,t.storeKey))}))(Qt);var en=n(96185),tn=n(47794),nn=n(71182),on=n(73581),rn=n.n(on),an=n(9813),sn=n(17565),ln=n(90648);let cn;!function(e){e.ADMIN="admin",e.EDITOR="editor",e.COLLABORATOR="collaborator"}(cn||(cn={}));ln.y6,ln.y6,Object.values(cn),ln.y6;var dn=n(35940);function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fn(e,t,n=[]){let o=[];const r=((e,t,n)=>{const o=e.aggregations.all._types.buckets;if(n.length||o){const e=n.length?n:o.filter((e=>e.filtered.doc_count>0)).map((e=>e.key));return t.filter((t=>e.find((e=>t._id===e))))}return[]})(e,t,n);if(r.length>0){o=[...r[0].commonProperties||[],{label:"Template",name:"templateName",type:"text",isCommonProperty:!0}].map((e=>un(un({},e),{},{showInCard:!0}))).concat(function(e){return e.reduce(((e,t)=>{const n=[];return(t.properties||[]).forEach((o=>{["image","preview","media","nested"].includes(o.type)||e.find((e=>o.name===e.name))||n.push(un(un({},o),{},{translationContext:(0,dn.zx)(t._id)}))})),e.concat(n)}),[])}(r))}return o}function hn(e,t,n){return o=>{const r=(0,_.Qd)(o,t);r(_e.Nw.load(`${t}.search`,e[t].search)),r((0,I.lo)({documentTypes:e[t].filters.documentTypes,libraryFilters:e[t].filters.properties,aggregations:e[t].aggregations})),r(n?(0,I.Cs)(e[t].documents):(0,I.ku)(e[t].documents)),"library"===t&&r(ke.N.set("library.markers",e[t].markers))}}const vn=["userSelectedSorting"];function yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(n),!0).forEach((function(t){gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sn(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const wn=(e,t,n)=>{const o=nn.Z.get({templates:t.templates});let r=(e=>{try{return rn().decode(e.q||"()")}catch(e){throw e.status=404,e}})(e);r=Object.assign(r,{order:r.order||o.order,sort:r.sort||o.sort,view:e.view});(!t[n]||!t[n].documents.get("rows").size)&&r.limit&&(r=Object.assign(r,{limit:r.limit+(r.from||0),from:0}));const{userSelectedSorting:i}=r,a=Sn(r,vn),s=t.user&&t.user.has("role"),l=s&&t.user.get("role")===cn.ADMIN;return bn(bn(bn(bn({},sn.Cv.aggregations(a,t.settings.collection.toJS())),s?{aggregatePublishingStatus:!0}:{}),s&&!l?{aggregatePermissionsByLevel:!0}:{}),l?{aggregatePermissionsByUsers:!0}:{})},Nn=(e,t,n={calculateTableColumns:!1,geolocation:!1})=>{const o=wn(e.data,t,"library"),r=e.set(sn.Cv.aggregations(o,t.settings.collection.toJS())),i=n.geolocation?tn.Z.search(e.set(bn(bn({},o),{},{geolocation:!0}))):{rows:[]};return Promise.all([tn.Z.search(r),i]).then((([i,a])=>{const s=t.templates.toJS(),l=en.ZP.URLQueryToState(r.data,s,t.thesauris.toJS(),t.relationTypes.toJS(),e.data.quickLabelThesaurus?(0,an.VQ)(e.data.quickLabelThesaurus,s):[]),c=[hn({library:{filters:{documentTypes:r.data.types||[],properties:l.properties},aggregations:i.aggregations,search:l.search,documents:i,markers:a}},"library",Boolean(o.from)),ke.N.set("library.sidepanel.quickLabelState",{thesaurus:e.data.quickLabelThesaurus,autoSave:!1})];if(n.calculateTableColumns){const e=fn(i,s,r.data.types);c.push((t=>(0,_.Qd)(t,"library")((0,I.mQ)(e))))}return c}))};var On=n(92348),Pn=n(33983),Cn=n(9075);function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e,t="library"){return(n,o)=>{const r=o(),i=r.templates.toJS(),a=r.thesauris.toJS();let s=Cn.Z.comonProperties(i,e).filter((e=>e.filter));s=en.ZP.populateOptions(s,a);const l=e.length?i.filter((t=>e.includes(t._id))):i,{sort:c,order:d}=nn.Z.get({currentCriteria:{sort:r[t].search.sort,order:r[t].search.order},filteredTemplates:l.map((e=>e._id)),templates:r.templates,selectedSorting:r[t].selectedSorting}),p=_n(_n({types:e},r[t].search),{},{sort:c,order:d}),u={documentTypes:e,properties:s};n(I.W7({filters:u,search:p},t))}}function Dn(e){return(t,n)=>{t({type:Pn.Br,documentTypes:[],libraryFilters:[]}),t(_e.Nw.load(`${e}.search`,{searchTerm:"",filters:{},order:"desc",sort:"creationDate"})),I.W7({search:n()[e].search},e)(t,n)}}var Tn,En=n(37265),xn=n(96486),An=n.n(xn),$n=n(55316);function Rn(e,t,n,o){Tn||(Tn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Tn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Fn extends r.Component{constructor(e){super(e),this.state={ui:{}}}shouldComponentUpdate(e,t){return!(0,je.is)(this.props.selectedTemplates,e.selectedTemplates)||!(0,je.is)(this.props.settings,e.settings)||!(0,je.is)(this.props.aggregations,e.aggregations)||this.stateChanged(t)}changeAll(e,t){const{selectedTemplates:n}=this.props;t.target.checked&&e.items.forEach((e=>{this.checked(e)||n.push(e.id)})),t.target.checked||e.items.forEach((e=>{if(this.checked(e)){const t=n.indexOf(e.id);n.splice(t,1)}})),this.props.filterDocumentTypes(n)}change(e){const{selectedTemplates:t}=this.props;if(t.includes(e.id)){const n=t.indexOf(e.id);t.splice(n,1)}else t.push(e.id);this.props.filterDocumentTypes(t)}toggleOptions(e,t){if(t.preventDefault(),!this.checked(e)&&e.items.find((e=>this.checked(e))))return;const{ui:n}=this.state;n[e.id]=!n[e.id],this.setState({ui:n})}aggregations(e){const t=this.aggs,n=(t.all&&t.all._types?t.all._types.buckets:[]).find((t=>t.key===e.id));return n?n.filtered.doc_count:e.items?e.items.reduce(((e,t)=>e+this.aggregations(t)),0):0}showSubOptions(e){return!!(this.state.ui[e.id]||!this.checked(e)&&e.items.find((e=>this.checked(e))))}checked(e){return e.items?e.items.reduce(((e,t)=>e&&this.checked(t)),e.items.length>0):this.props.selectedTemplates.includes(e.id)}stateChanged(e){return Object.keys(e.ui).length===Object.keys(this.state.ui).length||Object.keys(e.ui).reduce(((t,n)=>t||e.ui[n]===this.state.ui[n]),!1)}renderSingleType(e,t){const n="missing"===e.id?"System":e.id;return Rn("li",{className:"multiselectItem",title:e.name},t,Rn("input",{type:"checkbox",className:"multiselectItem-input",value:e.id,id:e.id,onChange:this.change.bind(this,e),checked:this.checked(e)}),Rn("label",{className:"multiselectItem-label",htmlFor:e.id},void 0,Rn("span",{className:"multiselectItem-icon"},void 0,Rn(C.JO,{icon:["far","square"],className:"checkbox-empty"}),Rn(C.JO,{icon:"check",className:"checkbox-checked"})),Rn("span",{className:"multiselectItem-name"},void 0,Rn(g.vN,{context:n},void 0,e.name))),Rn("span",{className:"multiselectItem-results"},void 0,this.aggregations(e)))}renderGroupType(e,t){return Rn("li",{},t,Rn("div",{className:"multiselectItem"},void 0,Rn("input",{type:"checkbox",className:"form-control multiselectItem-input",id:e.id,onChange:this.changeAll.bind(this,e),checked:this.checked(e)}),Rn("label",{htmlFor:e.id,className:"multiselectItem-label"},void 0,Rn("span",{className:"multiselectItem-icon"},void 0,Rn(C.JO,{icon:["far","square"],className:"checkbox-empty"}),Rn(C.JO,{icon:"check",className:"checkbox-checked"})),Rn("span",{className:"multiselectItem-name"},void 0,Rn("b",{},void 0,(0,g.t)("Filters",e.name)))),Rn("span",{className:"multiselectItem-results"},void 0,Rn("span",{},void 0,this.aggregations(e)),Rn("span",{className:"multiselectItem-action",onClick:this.toggleOptions.bind(this,e)},void 0,Rn(C.JO,{icon:this.state.ui[e.id]?"caret-up":"caret-down"})))),Rn($n.Z,{if:this.showSubOptions(e)},void 0,Rn("ul",{className:"multiselectChild is-active"},void 0,e.items.map(((e,t)=>this.renderSingleType(e,t))))))}render(){const{fromFilters:e,templates:t,settings:n}=this.props,o=((e,t,n)=>{var o;let r=e?n.collection.toJS().filters:[];return null!==(o=r)&&void 0!==o&&o.length||(r=t.toJS().map((e=>({id:e._id,name:e.name})))),r})(e,t,n);return this.aggs=this.props.aggregations.toJS(),Rn("ul",{className:"multiselect is-active"},void 0,o.map(((e,t)=>e.items?this.renderGroupType(e,t):this.renderSingleType(e,t))))}}Fn.defaultProps={fromFilters:!0,templates:Ie().fromJS([]),settings:{},aggregations:Ie().fromJS({}),selectedTemplates:[],filterDocumentTypes:{}};const Ln=(0,c.connect)((function(e){return{settings:e.settings,templates:e.templates,aggregations:e.library.aggregations}}),(function(e,t){return(0,k.bindActionCreators)({filterDocumentTypes:In},e)}))(Fn);var Jn;function Zn(e,t,n,o){Jn||(Jn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Jn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mn=(0,c.connect)((e=>({collection:e.settings.collection,libraryFilters:e.library.filters})),(function(e){return(0,k.bindActionCreators)({filterDocumentTypes:In},e)})),Vn=(e,t)=>e.length?t.filter((t=>e.includes(t))):t;class Un extends r.Component{constructor(e){super(e);const t=(e=>e.reduce(((e,t)=>{if(t.items&&t.items.length){const n=t.items.map((e=>e.id));e.push(...n)}return e.push(t.id),e}),[]))(e.collection.toJS().filters||[]),n=e.libraryFilters.toJS().documentTypes||[],o=Vn(t,n),r=An().isEqual(n,o);this.state={documentTypeFromFilters:r,selectedTemplates:o,configuredFilters:t}}static getDerivedStateFromProps(e,t){const n=e.libraryFilters.toJS().documentTypes||[];return{selectedTemplates:t.documentTypeFromFilters?Vn(t.configuredFilters,n):n}}toggleTemplateFilter(e,t,n){if(e){const e=Vn(t,n);this.setState({selectedTemplates:e}),this.props.filterDocumentTypes(e)}this.setState({documentTypeFromFilters:e})}render(){return Zn("div",{className:"form-group"},void 0,Zn("ul",{className:"search__filter"},void 0,this.state.configuredFilters.length>0&&Zn(j.W,{roles:["admin","editor","collaborator"]},void 0,Zn("li",{},void 0," ",Zn(De.T5,{className:"template-filter-switcher",model:"",value:this.state.documentTypeFromFilters,onChange:e=>this.toggleTemplateFilter(e,this.state.configuredFilters,this.state.selectedTemplates),leftLabel:Zn(g.vN,{},void 0,"FEATURED"),rightLabel:Zn(g.vN,{},void 0,"ALL")}))),Zn("li",{className:"wide documentTypes-selector"},void 0,Zn(Ln,{fromFilters:this.state.documentTypeFromFilters&&this.state.configuredFilters.length>0,selectedTemplates:this.state.selectedTemplates}))))}}const zn=Mn(Un);var Kn;function Bn(e,t,n,o){Kn||(Kn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Kn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wn=(e,t)=>{var n,o;return(null==e||null===(n=e.all)||void 0===n||null===(o=n[`_permissions.${t}`])||void 0===o?void 0:o.buckets.filter((e=>"any"!==e.key)).map((e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hn(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({label:e.label,title:e.label,value:e.key,results:e.filtered.doc_count},e.icon?{icon:{type:"Icons",_id:e.icon}}:{}))))||[]},Gn=({onChange:e,aggregations:t,value:n=[]})=>{const o=(0,r.useMemo)((()=>Wn(t,"read")),[t]),i=(0,r.useMemo)((()=>Wn(t,"write")),[t]),a=t=>o=>{const r=n.filter((e=>e.level!==t)).concat(o.map((e=>({refId:e,level:t}))));e(r)},s=(0,r.useCallback)(a("read"),[n,e]),l=(0,r.useCallback)(a("write"),[n,e]),c=n.filter((e=>"read"===e.level)).map((e=>e.refId)),d=n.filter((e=>"write"===e.level)).map((e=>e.refId));return r.createElement(r.Fragment,null,Bn("li",{},void 0,Bn(g.vN,{},void 0,"Shared as viewer")),Bn("li",{className:"wide"},void 0,Bn(Jt.NU,{prefix:"permissions.read",onChange:s,options:o,value:c})),Bn("li",{className:"spaced"},void 0,Bn(g.vN,{},void 0,"Shared as editor")),Bn("li",{className:"wide"},void 0,Bn(Jt.NU,{prefix:"permissions.write",onChange:l,options:i,value:d})))},Qn=({model:e,prefix:t,onChange:n,aggregations:o})=>Bn(_e.oT.select,{component:Gn,model:e,prefix:t,onChange:n,aggregations:o}),Yn=({onChange:e,aggregations:t})=>Bn(j.W,{},void 0,Bn(gt.Z,{className:"admin-filter"},"permissions",Bn("ul",{className:"search__filter is-active"},void 0,Bn("li",{},void 0,Bn(g.vN,{},void 0,"Permissions"),Bn(De.T5,{model:".customFilters['permissions'].and",prefix:"permissions",onChange:e})),Bn(Qn,{model:".customFilters['permissions'].values",prefix:"permissions",onChange:e,aggregations:t})))),Xn=["read","write"];var eo;function to(e,t,n,o){eo||(eo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:eo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const no=(e,t)=>{var n,o;return(((null==e||null===(n=e.all)||void 0===n||null===(o=n["_permissions.self"])||void 0===o?void 0:o.buckets)||[]).find((e=>e.key===t))||{filtered:{doc_count:0}}).filtered.doc_count},oo=e=>[{label:to(g.vN,{},void 0,"Can edit"),title:"Can edit",value:"write",icon:{type:"Icons",_id:"pencil-alt"},results:no(e,"write")},{label:to(g.vN,{},void 0,"Can view"),title:"Can view",value:"read",icon:{type:"Icons",_id:"file"},results:no(e,"read")}],ro=(0,c.connect)((({user:e})=>({user:e})))((({value:e=Ie().fromJS([]),onChange:t,aggregations:n,user:o})=>{const i=(0,r.useMemo)((()=>{var e;return[o.get("_id"),...(null===(e=o.toJS().groups)||void 0===e?void 0:e.map((e=>e._id)))||[]]}),[o]),a=(0,r.useMemo)((()=>Xn.filter((t=>i.every((n=>e.find((e=>e.refId===n&&e.level===t))))))),[i,e]),s=oo(n);return to(gt.Z,{className:"admin-filter"},"permissions.level",to(Jt.NU,{prefix:"permissions.level",onChange:e=>{t(e.reduce(((e,t)=>e.concat(i.map((e=>({refId:e,level:t}))))),[]))},options:s,value:a}))})),io=({model:e,prefix:t,onChange:n,aggregations:o})=>to(_e.oT.select,{component:ro,model:`${e}.values`,prefix:t,onChange:n,aggregations:o}),ao=({onChange:e,aggregations:t})=>0===oo(t).reduce(((e,t)=>e+t.results),0)?null:to(j.W,{roles:["editor","collaborator"]},void 0,to(gt.Z,{className:"admin-filter"},"permissions.level",to("ul",{className:"search__filter is-active"},void 0,to("li",{className:"wide"},void 0,to(io,{model:".customFilters['permissions']",prefix:"permissions",onChange:e,aggregations:t})))));var so,lo=n(78526);function co(e,t,n,o){so||(so="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:so,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const po=(e,t)=>{var n,o;return(((null==e||null===(n=e.all)||void 0===n||null===(o=n._published)||void 0===o?void 0:o.buckets)||[]).find((e=>e.key===t))||{filtered:{doc_count:0}}).filtered.doc_count||0},uo=({onChange:e,aggregations:t})=>{const n=(e=>[{label:r.createElement(r.Fragment,null,co(C.JO,{icon:"globe-africa"})," ",co(g.vN,{},void 0,"Published")),title:"Published",value:"published",results:po(e,"true")},{label:r.createElement(r.Fragment,null,co(C.JO,{icon:"lock"})," ",co(g.vN,{},void 0,"Restricted")),title:"Restricted",value:"restricted",results:po(e,"false")}])(t);return 0===n.reduce(((e,t)=>e+t.results),0)?null:co(j.W,{roles:["admin","editor","collaborator"]},void 0,co(gt.Z,{className:"admin-filter"},"publishedStatus",co(lo.Z,{model:".publishedStatus",prefix:"publishedStatus",onChange:e,options:n,showBoolSwitch:!1})))},mo=(0,Lt.P1)((e=>e.templates),(e=>e.toJS()));var fo;function ho(e,t,n,o){fo||(fo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:fo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vo=({onChange:e,model:t,label:n,format:o})=>ho("ul",{className:"search__filter is-active"},void 0,ho("li",{},void 0,ho("label",{},void 0,n)),ho("li",{className:"wide"},void 0,ho(De.C0,{model:t,onChange:e,format:o})));vo.defaultProps={onChange:()=>{},label:"",format:""};const yo=vo;var bo;function go(e,t,n,o){bo||(bo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:bo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class So extends r.Component{render(){const{onChange:e,model:t,label:n,property:o,aggregations:r}=this.props;return go("ul",{className:"search__filter is-active"},void 0,go("li",{},void 0,go("label",{},void 0,n),go("div",{className:"nested-strict"},void 0,go(_e.gN,{model:`${t}.strict`},void 0,go("input",{id:`${t}strict`,type:"checkbox",onChange:e})),go("label",{htmlFor:`${t}strict`},void 0,go("span",{},void 0," ",go(g.vN,{},void 0,"Strict mode"))))),go("li",{className:"wide"},void 0,go(De.eL,{aggregations:r,property:o,onChange:e})))}}So.defaultProps={onChange:()=>{},label:"",aggregations:Ie().Map()};const wo=So;var No;function Oo(e,t,n,o){No||(No="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:No,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Po=({onChange:e,model:t,label:n})=>Oo("ul",{className:"search__filter is-active"},void 0,Oo("li",{},void 0,Oo("label",{},void 0,n)),Oo("li",{className:"wide"},void 0,Oo(De.mD,{model:t,onChange:e})));Po.defaultProps={onChange:()=>{},label:""};const Co=Po;var ko;function _o(e,t,n,o){ko||(ko="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ko,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const jo=({onChange:e,model:t,label:n})=>_o(_e.gN,{model:t},void 0,_o("ul",{className:"search__filter is-active"},void 0,_o("li",{},void 0,_o("label",{},void 0,n)),_o("li",{className:"wide"},void 0,_o("input",{className:"form-control",onChange:e}))));jo.defaultProps={onChange:()=>{},label:""};const Io=jo,Do=["onChange","properties","translationContext","modelPrefix","storeKey","templates"];var To;function Eo(e,t,n,o){To||(To="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:To,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function xo(){return xo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},xo.apply(this,arguments)}function Ao(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Lo=e=>{let{onChange:t,properties:n,translationContext:o,modelPrefix:i="",storeKey:a,templates:s}=e,l=Ao(e,Do);return r.createElement(r.Fragment,null,n.map((e=>{var n;const{type:s}=null!==(n=e.inherit)&&void 0!==n&&n.property?e.inherit:e,c={model:`.filters${i}.${e.name}`,label:(0,g.t)(o,e.label),onChange:t},d=e.options?(e=>{const t=Ro(Ro({},e),{},{options:e.options.filter((e=>"any"!==e.id))});return t.options.map((e=>{const n=Ro(Ro({},e),{},{label:(0,g.t)(t.content,e.label,void 0,!1)});if(e.options){const o=e.options.map((e=>Ro(Ro({},e),{},{label:(0,g.t)(t.content,e.label,void 0,!1)})));n.options=o}return n}))})(e):[];let p=r.createElement(Io,c);return"numeric"===s&&(p=r.createElement(Co,c)),["select","multiselect","relationship"].includes(s)&&(p=r.createElement(lo.Z,xo({},c,{lookup:I.wx.bind(null,a,e.name),options:d,prefix:e.name,showBoolSwitch:"multiselect"===e.type||"relationship"===e.type,sort:"relationship"===e.type,totalPossibleOptions:e.totalPossibleOptions,allowSelectGroup:!0}))),"nested"===s&&(p=r.createElement(wo,xo({},c,{property:e,aggregations:l.aggregations}))),"date"!==s&&"multidate"!==s&&"multidaterange"!==s&&"daterange"!==s||(p=r.createElement(yo,xo({},c,{format:l.dateFormat}))),Eo(gt.Z,{},e.name,p)})))};Lo.defaultProps={onChange:()=>{},dateFormat:"",modelPrefix:"",translationContext:""};const Jo=(0,c.connect)((function(e,t){return{dateFormat:e.settings.collection.get("dateFormat"),aggregations:e[t.storeKey].aggregations,storeKey:t.storeKey,templates:mo(e)}}))(Lo);var Zo;function Mo(e,t,n,o){Zo||(Zo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Zo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Vo extends r.Component{constructor(e){super(e),this.search=(0,En.Z)((e=>{this.props.searchDocuments({search:e},this.props.storeKey)}),300),this.submit=this.submit.bind(this),this.onChange=this.onChange.bind(this),this.activateAutoSearch=()=>{this.autoSearch=!0},this.state={documentTypeFromFilters:!0}}shouldComponentUpdate(e,t){return!((0,je.is)(this.props.fields,e.fields)&&(0,je.is)(this.props.aggregations,e.aggregations)&&(0,je.is)(this.props.documentTypes,e.documentTypes)&&(0,je.is)(this.state.documentTypeFromFilters,t.documentTypeFromFilters))}onChange(e){this.autoSearch&&(this.autoSearch=!1,this.search(e,this.props.storeKey))}submit(e){this.props.searchDocuments({search:e},this.props.storeKey)}render(){const{templates:e,documentTypes:t}=this.props,n=this.props.aggregations.toJS(),o=t.get(0)||(e.get(0)||(0,je.fromJS)({})).get("_id")||"System",r=this.props.fields.toJS(),i=r.size,a=en.ZP.parseWithAggregations(r.slice(0),n,i).filter((e=>!e.options||e.options.length)),s=`${this.props.storeKey}.search`;return Mo("div",{className:"filters-box"},void 0,Mo(_e.l0,{model:s,id:"filtersForm",onSubmit:this.submit,onChange:this.onChange},void 0,Mo(uo,{onChange:this.activateAutoSearch,aggregations:n}),Mo(ao,{onChange:this.activateAutoSearch,aggregations:n}),Mo(zn,{}),Mo(Jo,{onChange:this.activateAutoSearch,properties:a,translationContext:o,storeKey:this.props.storeKey}),Mo(sn.CQ,{onChange:this.activateAutoSearch,aggregations:n}),Mo(Yn,{onChange:this.activateAutoSearch,aggregations:n})),e.filter((e=>t.includes(e.get("_id")))).size>0&&0===a.length?Mo("div",{className:"blank-state"},void 0,Mo(C.JO,{icon:"times"}),Mo("h4",{},void 0,Mo(g.vN,{},void 0,"No common filters")),Mo("p",{},void 0,Mo(g.vN,{},void 0,"The combination of entity types doesn't have any filters in common.")),Mo("a",{href:"https://github.com/huridocs/uwazi/wiki/Filter",target:"_blank",rel:"noopener noreferrer"},void 0,Mo(g.vN,{},void 0,"Learn more"))):null)}}const Uo=(0,c.connect)((function(e,t){return{fields:e[t.storeKey].filters.get("properties"),aggregations:e[t.storeKey].aggregations,templates:e.templates,documentTypes:e[t.storeKey].filters.get("documentTypes")}}),(function(e,t){return(0,k.bindActionCreators)({searchDocuments:I.W7},(0,_.Qd)(e,t.storeKey))}))(Vo);var zo;function Ko(e,t,n,o){zo||(zo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:zo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Bo extends r.Component{reset(){this.props.resetFilters(this.props.storeKey)}render(){return Ko(On.Z,{className:"library-filters",mode:this.props.sidePanelMode,open:this.props.open},void 0,Ko("div",{className:"sidepanel-body"},void 0,Ko("div",{className:"sidepanel-title"},void 0,Ko("div",{},void 0,(0,g.t)("System","Filters configuration")),Ko("div",{className:"filter-buttons"},void 0,Ko("button",{type:"button",className:"closeSidepanel "+("unpinned-mode"===this.props.sidePanelMode?"":"only-mobile"),onClick:this.props.hideFilters,"aria-label":"Close side panel"},void 0,Ko(C.JO,{icon:"times"})))),Ko(Uo,{storeKey:this.props.storeKey})),Ko("div",{className:"sidepanel-footer"},void 0,Ko("button",{type:"button",className:"btn btn-default",onClick:this.reset.bind(this)},void 0,Ko(C.JO,{icon:"times"}),Ko("span",{className:"btn-label"},void 0,Ko(g.vN,{},void 0,"Clear Filters")))))}}Bo.defaultProps={open:!1,storeKey:"library",sidePanelMode:"",hideFilters:()=>{}};const Ho=(0,c.connect)((function(e,t){const n=0===e[t.storeKey].ui.get("selectedDocuments").size,o=!1!==e[t.storeKey].ui.get("filtersPanel");return{open:n&&o}}),(function(e,t){return(0,k.bindActionCreators)({resetFilters:Dn,hideFilters:Ft.BP},(0,_.Qd)(e,t.storeKey))}))(Bo);var qo;function Wo(e,t,n,o){qo||(qo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:qo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Go extends r.Component{static learnIconSvg(){return Wo("svg",{width:"29",height:"29",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},void 0,Wo("circle",{cx:"14.5",cy:"14.5",r:"14.5",fill:"#2B56C1"}),Wo("path",{d:"M14.8971 16.9227C14.8314 16.9446 14.7657 16.9665 14.7 16.9665C14.6343 16.9665 14.5686 16.9446 14.503 16.9227L7.86842 14.3389V18.1927C7.86842 20.8202 12.6418 21.1048 14.7 21.1048C16.7583 21.1048 21.5316 20.8202 21.5316 18.1927V14.3389L14.8971 16.9227Z",fill:"#FAFBFF"}),Wo("path",{d:"M24.1372 11.6238L14.8533 8.03284C14.7438 7.98905 14.6343 7.98905 14.5467 8.03284L5.28465 11.6238C5.10948 11.6895 5 11.8428 5 12.0398C5 12.2369 5.10948 12.3902 5.28465 12.4559L14.5467 16.0249C14.5905 16.0468 14.6562 16.0468 14.7 16.0468C14.7438 16.0468 14.8095 16.0468 14.8533 16.0249L24.1154 12.4559C24.2905 12.3902 24.4 12.2369 24.4 12.0398C24.4 11.8428 24.2905 11.6895 24.1372 11.6238Z",fill:"#FAFBFF"}))}constructor(e){super(e),this.state={isHidden:!1},this.close=this.close.bind(this)}close(){this.setState({isHidden:!0})}render(){const{children:e,title:t,allowClose:n}=this.props,{isHidden:o}=this.state;return Wo("div",{className:"notice "+(o?"is-hidden":"")},void 0,Wo("div",{className:"header"},void 0,Wo("span",{className:"icon"},void 0,Go.learnIconSvg()),Wo("span",{className:"title"},void 0,t),n&&Wo("button",{className:"close-notice",onClick:this.close,type:"button","no-translate":!0},void 0,"X")),Wo("div",{className:"main"},void 0,e))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Go,"defaultProps",{allowClose:!0,children:""});var Qo=n(96220),Yo=n(67941);function Xo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(n),!0).forEach((function(t){tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nr extends r.Component{render(){return this.props.children(this.props)}}const or=(0,c.connect)(((e,t)=>Object.keys(t).filter((e=>!["children"].includes(e))).reduce(((n,o)=>er(er({},n),{},{[o]:t[o](e)})),{})))(nr);var rr,ir=n(8482);function ar(e,t,n,o){rr||(rr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:rr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const lr={formKey:"library.sidepanel.quickLabelMetadata",quickLabelMetadata:{},quickLabelThesaurus:void 0,opts:{},selectedDocuments:Ie().fromJS([]),templates:Ie().fromJS([]),unselectAllDocuments:()=>{},toggleQuickLabelAutoSave:()=>{},selectedDocumentsChanged:()=>{},maybeSaveQuickLabels:e=>{},multipleUpdate:(e,t)=>{}},cr=(0,Lt.P1)((e=>e.library.sidepanel.quickLabelMetadataForm.$form.pristine),(e=>e));class dr extends r.Component{constructor(e){super(e),this.publish=this.publish.bind(this)}publish(){this.context.confirm({accept:()=>{this.props.multipleUpdate(this.props.selectedDocuments,{published:!0})},title:"Confirm",message:"Confirm publish multiple items",type:"success"})}renderAutoSaveToggle(){const{opts:e}=this.props;return ar("button",{type:"button",onClick:()=>this.props.toggleQuickLabelAutoSave(),className:"btn btn-default btn-header btn-toggle-"+(e.autoSave?"on":"off")},void 0,ar(C.JO,{icon:e.autoSave?"toggle-on":"toggle-off"}),ar("span",{className:"btn-label"},void 0,ar(g.vN,{},void 0,"Auto-save")))}renderButtons(e){return ar(or,{isPristine:cr},void 0,(({isPristine:t})=>{const n=t?"btn btn-default btn-disabled":"btn btn-default";return r.createElement(r.Fragment,null,e&&t&&ar("button",{type:"button",className:"publish btn btn-success",onClick:this.publish},void 0,ar(C.JO,{icon:"paper-plane"}),ar("span",{className:"btn-label"},void 0,ar(g.vN,{},void 0,"Publish"))),ar("button",{type:"button",onClick:()=>this.props.selectedDocumentsChanged(),className:`cancel-edit-metadata ${t?"":"btn-danger"} ${n}`},void 0,ar(C.JO,{icon:"undo"}),ar("span",{className:"btn-label"},void 0,ar(g.vN,{},void 0,"Discard changes"))),ar("button",{type:"button",onClick:()=>this.props.maybeSaveQuickLabels(!0),className:`save-metadata ${n}`},void 0,ar(C.JO,{icon:"save"}),ar("span",{className:"btn-label"},void 0,ar(g.vN,{},void 0,"Save document(s)"))))}))}renderProp(e){var t;const{quickLabelThesaurus:n,templates:o}=this.props,r=o.map((t=>{var n;return null==t||null===(n=t.get("properties"))||void 0===n?void 0:n.find((t=>(null==t?void 0:t.get("name"))===e))})).filter((e=>!!e));return ar("div",{className:"form-group"},e,ar("ul",{className:"search__filter is-active"},void 0,ar("li",{className:"title"},void 0,ar("label",{},void 0,(0,g.t)("System",r.size?null===(t=r.get(0))||void 0===t?void 0:t.get("label"):e))),ar("li",{className:"wide"}),ar(De.n8,{model:`library.sidepanel.quickLabelMetadata.${e}`,optionsValue:"id",options:(0,Yo.uT)(n),prefix:`library.sidepanel.quickLabelMetadata.${e}`,sort:!0,placeholder:`${(0,g.t)("System","Search",null,!1)} '${n.get("name")}'`})))}static renderNotice(){return ar(Go,{title:"Label your collection"},void 0,ar("div",{},void 0,ar("div",{},void 0,ar(g.vN,{translationKey:"Label your collection note"},void 0,'Note: Make the sample set of documents for each topic diverse and representative. For example, use various methods to find sample documents and don\'t just search for the term "education" to find documents for the topic "Education".'),ar("br",{}),ar("br",{}),ar(g.vN,{},void 0,"Return to the thesaurus page when you finished labeling to start learning."))))}renderSidePanelBody(){const{quickLabelThesaurus:e,quickLabelMetadata:t}=this.props;let n;return n=e?Object.keys(t).length?ar("div",{},void 0,dr.renderNotice(),Object.keys(t).sort().map((e=>this.renderProp(e)))):ar("div",{},void 0,dr.renderNotice(),ar("label",{className:"errormsg"},void 0,ar(g.vN,{},void 0,"Nothing to see here! The selected documents are not using the selected thesaurus")," ",ar("b",{},void 0,e.get("name")),"."," ",ar(g.vN,{},void 0,"Try selecting other documents."))):ar("div",{},void 0,dr.renderNotice(),ar("label",{className:"errormsg"},void 0,ar(g.vN,{},void 0,"Oops! We couldn't find the thesaurus you're trying to edit. Try navigating back to this page through Settings."))),n}render(){const{selectedDocuments:e}=this.props,t=this.props.selectedDocuments.reduce(((e,t)=>{const n=!t.get("file");return!!e&&(!!t.get("processed")||n)&&!t.get("published")&&!!t.get("template")}),!0);return ar(On.Z,{open:e.size>0,className:"quick-label"},void 0,ar("div",{className:"sidepanel-header"},void 0,ar(C.JO,{icon:"check"})," ",ar("span",{},void 0,e.size," ",ar(g.vN,{},void 0,"selected")),this.renderAutoSaveToggle(),ar("button",{type:"button",className:"closeSidepanel close-modal",onClick:()=>this.props.unselectAllDocuments()},void 0,ar(C.JO,{icon:"times"}))),ar("div",{className:"sidepanel-body"},void 0,this.renderSidePanelBody()),ar("div",{className:"sidepanel-footer"},void 0,this.renderButtons(t)))}}sr(dr,"defaultProps",lr),sr(dr,"contextTypes",{confirm:u().func});const pr=(0,Lt.P1)((e=>e.thesauris.find((t=>t.get("_id")===e.library.sidepanel.quickLabelState.get("thesaurus")))),(e=>e));const ur=(0,c.connect)((e=>({selectedDocuments:e.library.ui.get("selectedDocuments"),quickLabelMetadata:e.library.sidepanel.quickLabelMetadata,quickLabelThesaurus:pr(e),opts:e.library.sidepanel.quickLabelState.toJS(),templates:(0,Lt.P1)((e=>e.templates),(e=>e))(e)})),(function(e){return(0,k.bindActionCreators)({unselectAllDocuments:I.jh,toggleQuickLabelAutoSave:ir.SD,selectedDocumentsChanged:ir.AQ,maybeSaveQuickLabels:ir.al,multipleUpdate:Qo.multipleUpdate},(0,_.Qd)(e,"library"))}))(dr);var mr=n(3827),fr=n(55505),hr=n(61903),vr=n(41865),yr=n(83993);function br(e,t){return{type:yr.H,modal:e,data:t}}function gr(e){return{type:yr._,modal:e}}const Sr={actions:o};const wr=(0,c.connect)((function(e,t){const{templates:n}=e,{thesauris:o}=e;return{model:`${t.storeKey}.sidepanel.metadata`,templateId:e[t.storeKey].sidepanel.metadata.template,templates:n,thesauris:o}}),(function(e,t){return(0,k.bindActionCreators)({changeTemplate:fr.Nw.changeTemplate,onSubmit:I.FU},(0,_.Qd)(e,t.storeKey))}))(fr.n0),Nr=e=>e.templates;const Or=(0,c.connect)(((e,t)=>{const n=e[t.storeKey],o=n.ui.get("selectedDocuments").first()||Ie().fromJS({documents:[]}),r=e.settings.collection.get("languages").find((e=>e.get("defautl"))),i=(0,vr.K)(o.get("documents")?o.get("documents").toJS():[{}],o.get("language"),r);return{open:1===n.ui.get("selectedDocuments").size,doc:o,file:i,references:n.sidepanel.references,tab:n.sidepanel.tab,docBeingEdited:!!Object.keys(n.sidepanel.metadata).length,searchTerm:n.search.searchTerm,formDirty:!n.sidepanel.metadataForm.$form.pristine,templates:Nr(e),formPath:`${t.storeKey}.sidepanel.metadata`,readOnly:!0,EntityForm:wr}}),(function(e,t){return(0,k.bindActionCreators)({loadInReduxForm:fr.Nw.loadInReduxForm,getDocumentReferences:I.hN,closePanel:I.jh,resetForm:()=>e=>{e(_e.Nw.setInitial(`${t.storeKey}.sidepanel.metadata`)),e(_e.Nw.reset(`${t.storeKey}.sidepanel.metadata`))},saveDocument:I.gv,deleteDocument:I.iH,searchSnippets:I.uO,deleteEntity:hr.Ks,showModal:Sr.actions.showModal,showTab:e=>ke.N.set(`${t.storeKey}.sidepanel.tab`,e)},(0,_.Qd)(e,t.storeKey))}))(mr.GV);const Pr=(0,c.connect)((function(e,t){return{formKey:`${t.storeKey}.sidepanel.multipleEdit`,state:e[t.storeKey].sidepanel.multipleEdit,formState:e[t.storeKey].sidepanel.multipleEditForm,templates:e.templates,entitiesSelected:e[t.storeKey].ui.get("selectedDocuments"),thesauris:e.thesauris,storeKey:t.storeKey}}),(function(e,t){return(0,k.bindActionCreators)({unselectAllDocuments:I.jh,updateSelectedEntities:I.tt,updateEntities:I.jB,getAndSelectDocument:I.Gj},(0,_.Qd)(e,t.storeKey))}))(fr.W3);var Cr,kr=n(82135);function _r(e,t,n,o){Cr||(Cr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class jr extends r.Component{render(){const{searchTerm:e,query:t,properties:n}=this.props,o=t&&t.filters?function(e,t){return Object.keys(e.filters).reduce(((n,o)=>{const{values:r}=e.filters[o],i=t.find((e=>e.name===o));if(!r||!i)return n;const a=`${i.label}: ${function(e,t){const n=t.map((t=>e.options.find((e=>e.id===t))));return n.map((e=>e&&e.label)).filter((e=>e)).join(", ")}(i,r)}`;return[...n,a]}),[])}(t,n):[];return _r("span",{},void 0,e,o.length?` ${o.join(" - ")}`:"")}}jr.defaultProps={query:void 0};const Ir=(0,c.connect)((function({templates:e,relationTypes:t},{query:n}){return{properties:n&&n.filters?en.ZP.URLQueryToState(n,e.toJS(),t.toJS()).properties:[]}}))(jr);var Dr;function Tr(e,t,n,o){Dr||(Dr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Dr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Er extends r.Component{constructor(e){super(e),this.delete=this.delete.bind(this),this.handleResumeClicked=this.handleResumeClicked.bind(this),this.handleStopClicked=this.handleStopClicked.bind(this)}delete(e){const{confirm:t}=this.context,{onDeleteClicked:n,search:o}=this.props;e.preventDefault(),t({accept:n.bind(this,o._id),title:"Confirm delete",message:"Are you sure you want to delete this search?"})}handleStopClicked(e){const{search:t,onStopClicked:n}=this.props;n(t._id),e.preventDefault()}handleResumeClicked(e){const{search:t,onResumeClicked:n}=this.props;n(t._id),e.preventDefault()}renderButtons(){const{search:e}=this.props,{status:t}=e;return Tr("div",{className:"buttons"},void 0,Tr("button",{type:"button",className:"btn btn-danger delete-search btn-xs",onClick:this.delete},void 0,Tr(C.JO,{icon:"trash-alt",size:"sm"})),["inProgress","pending"].includes(t)&&Tr("button",{type:"button",className:"btn btn-warning stop-search btn-xs",onClick:this.handleStopClicked},void 0,Tr(C.JO,{icon:"stop",size:"sm"})),"stopped"===t&&Tr("button",{type:"button",className:"btn btn-success resume-search btn-xs",onClick:this.handleResumeClicked},void 0,Tr(C.JO,{icon:"play",size:"sm"})))}render(){const{search:e}=this.props,{status:t,documents:n}=e,o=n.filter((e=>"completed"===e.status)).length,r=n.length;return Tr(g.l3,{className:"semantic-search-list-item",to:`semanticsearch/${e._id}`},void 0,Tr("div",{className:"item-header"},void 0,Tr("div",{className:"title"},void 0,Tr(Ir,{searchTerm:e.searchTerm,query:e.query})),this.renderButtons()),Tr("div",{},void 0,"completed"!==t&&Tr(C.ko,{value:o,max:r})))}}Er.contextTypes={confirm:u().func};const xr=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({onDeleteClicked:D.deleteSearch,onStopClicked:D.stopSearch,onResumeClicked:D.resumeSearch},e)}))(Er);var Ar;function $r(e,t,n,o){Ar||(Ar="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ar,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Rr=({searches:e})=>$r("div",{className:"semantic-search-list"},void 0,e.map((e=>$r(xr,{search:e},e._id))));Rr.defaultProps={searches:[]};const Fr=(0,c.connect)()(Rr);var Lr;function Jr(e,t,n,o){Lr||(Lr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Lr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Zr extends r.Component{constructor(e){super(e),this.registeredForUpdates=!1,this.onSearchUpdated=this.onSearchUpdated.bind(this),kr.W.on("semanticSearchUpdated",this.onSearchUpdated)}componentDidMount(){this.registeredForUpdates||(this.props.registerForUpdates(),this.registeredForUpdates=!0),this.props.fetchSearches()}componentWillUnmount(){kr.W.removeListener("semanticSearchUpdated",this.onSearchUpdated)}onSearchUpdated({updatedSearch:e}){this.props.updateSearch(e)}render(){const e=this.props.searches.toJS(),{open:t}=this.props;return Jr(On.Z,{open:t,className:"metadata-sidepanel semantic-search"},void 0,Jr("div",{className:"sidepanel-header"},void 0,Jr("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.props.hideSemanticSearch},void 0,Jr(C.JO,{icon:"times"}))),Jr("div",{className:"sidepanel-body"},void 0,Jr($n.Z,{if:!!e},void 0,Jr(Fr,{searches:e}))))}}const Mr=(0,c.connect)((function(e){return{searches:e.semanticSearch.searches,search:e.semanticSearch.search,open:e.semanticSearch.showSemanticSearchPanel}}),(function(e){return(0,k.bindActionCreators)({fetchSearches:D.fetchSearches,submitNewSearch:D.submitNewSearch,registerForUpdates:D.registerForUpdates,updateSearch:D.updateSearch,hideSemanticSearch:D.hideSemanticSearch},e)}))(Zr);var Vr,Ur=n(11992);function zr(e,t,n,o){Vr||(Vr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Vr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Kr extends r.Component{constructor(e){super(e),this.state={expand:!1},this.toggle=this.toggle.bind(this)}toggle(){const{expand:e}=this.state;this.setState({expand:!e})}render(){const{message:e,validations:t}=this.props,{expand:n}=this.state,o=n?e:`${e.substr(0,50)}...`;return zr("div",{className:"stack-trace",onClick:this.toggle},void 0,zr(C.JO,{icon:"sort"})," ",zr("span",{},void 0,o),((e,t)=>e&&t?r.createElement(r.Fragment,null,t.reduce(((e,t,n)=>e.concat(zr("div",{},n,t.get("message"),": ",t.get("instancePath")))),[])):null)(n,t))}}Kr.defaultProps={message:"",validations:null};const Br=Kr;var Hr;function qr(e,t,n,o){Hr||(Hr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Hr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Wr extends r.Component{render(){const{close:e,importState:{importStart:t,importProgress:n,importError:o,importEnd:r}}=this.props;return!(!t&&!n)&&(r?qr("div",{className:"alert alert-info"},void 0,qr(C.JO,{icon:"check",size:"2x"}),qr("div",{className:"force-ltr"},void 0,qr(g.vN,{},void 0,"Import completed:")," ",n," ",qr(g.vN,{},void 0,"created"),qr("br",{}),qr(g.vN,{},void 0,"Indexing entities may take a few minutes")),qr(C.JO,{style:{cursor:"pointer"},icon:"times",onClick:e})):o.get("prettyMessage")?qr("div",{},void 0,qr("div",{className:"alert alert-danger"},void 0,qr(C.JO,{icon:"exclamation-triangle",size:"2x"}),qr("div",{className:"force-ltr"},void 0,qr(g.vN,{},void 0,"The import process threw an error:")),qr(C.JO,{style:{cursor:"pointer"},icon:"times",onClick:e})),qr(Br,{message:o.get("prettyMessage"),validations:o.get("validations")})):qr("div",{className:"alert alert-info"},void 0,qr(C.JO,{icon:"cog",size:"2x"}),qr("div",{className:"force-ltr"},void 0,qr(g.vN,{},void 0,"Importing data in progress"),": ",n)))}}const Gr=(0,c.connect)((e=>({importState:e.importEntities})),(function(e){return(0,k.bindActionCreators)({close:Ur.Ap},e)}))(Wr);var Qr;function Yr(e,t,n,o){Qr||(Qr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Qr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Xr extends r.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this),this.close=this.close.bind(this)}handleSubmit(e){this.props.importData(e.file,e.template)}close(){this.props.closeImportPanel()}renderForm(){const{templates:e}=this.props,t=e.find((e=>e.get("default"))).get("_id");return Yr("div",{},void 0,Yr("div",{className:"alert alert-info"},void 0,Yr(C.JO,{icon:"info-circle",size:"2x"}),Yr("div",{className:"force-ltr"},void 0,Yr(g.vN,{},void 0,"Upload a ZIP or CSV file.")," ",Yr("a",{rel:"noopener noreferrer",href:"https://github.com/huridocs/uwazi/wiki/Import-CSV",target:"_blank"},void 0,Yr(g.vN,{},void 0,"Import instructions")))),Yr(_e.hD,{onSubmit:this.handleSubmit,id:"import",initialState:{template:t}},void 0,Yr("div",{className:"form-group"},void 0,Yr("ul",{className:"search__filter"},void 0,Yr("li",{},void 0,Yr("label",{htmlFor:"file"},void 0,Yr(g.vN,{},void 0,"File"))),Yr("li",{className:"wide"},void 0,Yr(_e.oT.file,{id:"file",model:".file",accept:".zip,.csv"})))),Yr("div",{className:"form-group"},void 0,Yr("ul",{className:"search__filter"},void 0,Yr("li",{},void 0,Yr("label",{htmlFor:"template"},void 0,Yr(g.vN,{},void 0,"Template"))),Yr("li",{className:"wide"},void 0,Yr(_e.oT.select,{id:"template",model:".template"},void 0,e.map((e=>Yr("option",{value:e.get("_id")},e.get("_id"),e.get("name")))))))),Yr("div",{className:"form-group"})),Yr("div",{className:"sidepanel-footer"},void 0,Yr("button",{form:"import",type:"submit",className:"btn btn-primary",id:"import-csv"},void 0,Yr(C.JO,{icon:"upload"}),Yr("span",{className:"btn-label"},void 0,Yr(g.vN,{},void 0,"Import")))))}renderUploadProgress(){const{uploadProgress:e}=this.props;return Yr("div",{className:"alert alert-info"},void 0,Yr(C.JO,{icon:"info-circle",size:"2x"}),Yr("div",{className:"force-ltr"},void 0,Yr(g.vN,{},void 0,"Uploading file")," ",e,"%"))}renderContents(){const{uploadProgress:e,importStart:t,importProgress:n}=this.props;return e?this.renderUploadProgress():t||n?Yr(Gr,{}):this.renderForm()}render(){const{open:e}=this.props;return Yr(On.Z,{open:e,className:"metadata-sidepanel"},void 0,Yr("div",{className:"sidepanel-header"},void 0,Yr("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.close},void 0,Yr(C.JO,{icon:"times"}))),this.renderContents())}}Xr.defaultProps={open:!1,uploadProgress:0,importStart:!1,importProgress:0};const ei=(0,c.connect)((e=>({open:e.importEntities.showImportPanel,templates:e.templates,uploadProgress:e.importEntities.importUploadProgress,importStart:e.importEntities.importStart,importProgress:e.importEntities.importProgress})),(function(e){return(0,k.bindActionCreators)({closeImportPanel:Ur.WT,importData:Ur.dk},e)}))(Xr);var ti,ni=n(234);function oi(e,t,n,o){ti||(ti="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ti,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ri={quickLabelThesaurus:void 0};class ii extends r.Component{render(){const{quickLabelThesaurus:e}=this.props,t=e?e.get("name"):"";return oi("div",{className:"content-header"},void 0,!t&&oi("div",{className:"content-header-title"},void 0,oi("h1",{},void 0,(0,g.t)("System","Ooops... please go")," ",oi(ni.ZP,{className:"btn btn-default",to:"/settings/dictionaries"},void 0,oi(C.JO,{icon:"arrow-left"})," ",oi("span",{className:"btn-label"},void 0,(0,g.t)("System","Back to thesauri"))))),t&&oi("div",{className:"content-header-title"},void 0,oi(ni.ZP,{className:"btn btn-default",to:`/settings/dictionaries/cockpit/${null==e?void 0:e.get("_id")}`},void 0,oi(C.JO,{icon:"arrow-left"})," ",oi("span",{className:"btn-label"},void 0,(0,g.t)("System","Back to thesaurus"))),oi("h1",{},void 0,oi("span",{className:"large"},void 0,(0,g.t)("System","Quick labeling for")," ",oi("b",{},void 0,t)))))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ii,"defaultProps",ri);const ai=(0,Lt.P1)((e=>e.thesauris.find((t=>t.get("_id")===e.library.sidepanel.quickLabelState.get("thesaurus")))),(e=>e)),si=(0,c.connect)((e=>({quickLabelThesaurus:ai(e)})))(ii);var li=n(80569),ci=n.n(li),di=n(62787),pi=n(38540);function ui(e){e(ke.N.set("exportSearchResultsProcessing",!1)),e(ke.N.set("exportSearchResultsContent","")),e(ke.N.set("exportSearchResultsFileName",""))}function mi(){return(e,t)=>{const{exportSearchResultsContent:n,exportSearchResultsFileName:o}=t().exportSearchResults;!function(e,t){const n=window.URL.createObjectURL(new Blob([e])),o=document.createElement("a");o.href=n,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)}(n,o),ui(e)}}function fi(e,t){return async(n,o)=>{const r=o()[e],{search:i,filters:a}=r,s=a.toJS(),l=(0,I.Qk)(i,s,1e4);l.searchTerm=r.search.searchTerm,r.ui.get("selectedDocuments").size&&(l.ids=r.ui.get("selectedDocuments").map((e=>e.get("sharedId")))),"uploads"===e&&(l.unpublished=!0),n(ke.N.set("exportSearchResultsProcessing",!0)),((e,t,n)=>{let o=ci().get(`/api/export${(0,di._k)(e)}`).set("Accept","text/csv").set("X-Requested-With","XMLHttpRequest");n&&(o=o.set("Captcha-text",n.text).set("Captcha-id",n.id)),o.then((e=>{const n=function(e){const t=e.indexOf('filename="')+10,n=e.length-1;return e.substring(t,n)}(e.header["content-disposition"]);t(ke.N.set("exportSearchResultsContent",e.text)),t(ke.N.set("exportSearchResultsFileName",n)),t(mi())})).catch((e=>(ui(t),403===e.status?t((0,pi.h)((0,g.t)("System","Invalid captcha"),"danger")):t((0,pi.h)((0,g.t)("System","An error has occured during data export"),"danger")),e)))})(l,n,t)}}var hi;function vi(e,t,n,o){hi||(hi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:hi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class yi extends r.Component{constructor(e){super(e),this.state={modal:!1},this.export=this.export.bind(this),this.showModal=this.showModal.bind(this),this.exportWithCaptcha=this.exportWithCaptcha.bind(this)}export(){this.props.processing||this.props.exportDocuments(this.props.storeKey)}exportWithCaptcha(e){this.props.processing||this.props.exportDocuments(this.props.storeKey,e.captcha),this.setState({modal:!1})}showModal(){this.setState({modal:!0})}render(){let e="btn btn-default btn-export";return e+=this.props.processing?" btn-disabled":"",e+=` ${this.props.className}`,r.createElement(r.Fragment,null,vi("button",{type:"button",onClick:this.props.user.get("_id")?this.export:this.showModal,className:e},void 0,this.props.processing?vi(C.JO,{icon:"spinner",spin:!0}):vi(C.JO,{icon:"export-csv",transform:"up-0.1"}),vi("span",{className:"btn-label"},void 0,(0,g.t)("System","Export CSV"))),this.state.modal&&vi(B.Z,{isOpen:!0,type:"export"},void 0,vi(_e.hD,{onSubmit:this.exportWithCaptcha,validators:{captcha:{required:e=>e&&e.text.length}}},void 0,vi(De.cw,{model:".captcha"},"captcha",vi("h3",{},void 0,vi(g.vN,{},void 0,"Exporting entities to CSV")),vi("p",{},void 0,vi(g.vN,{},void 0,"Please type in letters and numbers from the image to start the export.")),vi(De.UG,{remote:!1,model:".captcha"})),vi("div",{className:"buttons"},void 0,vi("input",{type:"button",className:"btn",onClick:()=>{this.setState({modal:!1})},value:"Cancel"}),vi("input",{type:"submit",className:"btn btn-success",value:"Export"})))))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(yi,"defaultProps",void 0),yi.defaultProps={className:""};const bi=(0,c.connect)((function(e){return{processing:e.exportSearchResults.exportSearchResultsProcessing,user:e.user}}),(function(e,t){return(0,k.bindActionCreators)({exportDocuments:fi},(0,_.Qd)(e,t.storeKey))}))(yi);var gi;function Si(e,t,n,o){gi||(gi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:gi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wi=e=>{const t=e.name.replace(/\.[^/.]+$/,"").replace(/_/g," ").replace(/-/g," ").replace(/ {2}/g," ");return t.charAt(0).toUpperCase()+t.slice(1)};const Ni=(0,c.connect)(null,(function(e,t){return(0,k.bindActionCreators)({uploadDocument:Ur.iG,unselectAllDocuments:I.jh,createDocument:Ur.OE},(0,_.Qd)(e,t.storeKey))}))((({createDocument:e,uploadDocument:t,unselectAllDocuments:n})=>{const o=(0,r.useMemo)((()=>(({createDocument:e,uploadDocument:t,unselectAllDocuments:n})=>o=>{const{files:r}=o.target,i=(null==r?void 0:r.length)||0;for(let n=0;n<i;n++){const o=r[n],i={title:wi(o)};e(i).then((e=>{t(e.sharedId,o)})).catch((()=>{}))}n()})({createDocument:e,uploadDocument:t,unselectAllDocuments:n})),[e,t,n]);return Si("label",{htmlFor:"pdf-upload-button",className:"btn btn-default"},void 0,Si(C.JO,{icon:"cloud-upload-alt"}),Si("span",{className:"btn-label"},void 0,Si(g.vN,{},void 0,"Upload PDF(s) to create")),Si("input",{type:"file",id:"pdf-upload-button",style:{display:"none"},accept:"application/pdf",multiple:!0,onChange:o}))}));var Oi;function Pi(e,t,n,o){Oi||(Oi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Oi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ci=(0,c.connect)(null,(function(e,t){return(0,k.bindActionCreators)({newEntity:Ur._Z,showImportPanel:Ur.z0},(0,_.Qd)(e,t.storeKey))}))((({storeKey:e,newEntity:t,showImportPanel:n})=>Pi("div",{className:"library-footer with-sidepanel remove-nesting"},void 0,Pi("div",{className:"btn-cluster"},void 0,Pi(j.W,{roles:["admin","editor","collaborator"]},void 0,Pi("button",{className:"btn btn-default btn-footer-hover-success",type:"button",onClick:()=>t(e)},void 0,Pi(C.JO,{icon:"plus"}),Pi("span",{className:"btn-label"},void 0,Pi(g.vN,{},void 0,"Create entity")))),Pi(j.W,{roles:["admin","editor","collaborator"]},void 0,Pi(Ni,{storeKey:e})),Pi(j.W,{roles:["admin","editor"]},void 0,Pi("button",{className:"btn btn-default sm-order-1",type:"button",onClick:n},void 0,Pi(C.JO,{icon:"import-csv",transform:"up-0.2"}),Pi("span",{className:"btn-label"},void 0,Pi(g.vN,{},void 0,"Import CSV")))),Pi(bi,{className:"sm-order-1",storeKey:e})))));var ki;function _i(e,t,n,o){ki||(ki="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ki,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ji extends r.Component{render(){const{className:e,children:t,quickLabelThesaurus:n,sidePanelMode:o,noScrollable:r}=this.props,i=`${n?"with-header ":""} content-holder library-viewer document-viewer with-footer with-panel ${o} ${r?"no-scroll-layout":""}`;return _i("div",{className:"row panels-layout"},void 0,_i(M.q,{},void 0,_i("title",{},void 0,(0,g.t)("System","Library",null,!1))),n&&_i(si,{}),_i("div",{className:i},void 0,_i("main",{className:`${e}`},void 0,t),_i(Ci,{storeKey:"library"}),_i(Ho,{storeKey:"library",sidePanelMode:o}),!n&&_i(Or,{storeKey:"library"}),!n&&_i(Pr,{storeKey:"library"}),n&&_i(ur,{storeKey:"library"}),_i(T.S,{},void 0,_i(Mr,{storeKey:"library"})),_i(ei,{})))}}ji.defaultProps={className:"",quickLabelThesaurus:"",sidePanelMode:"",noScrollable:!1};const Ii=(0,c.connect)((e=>({quickLabelThesaurus:e.library.sidepanel.quickLabelState.get("thesaurus")})))(ji);var Di,Ti=n(38904),Ei=n(21292);function xi(e,t,n,o){Di||(Di="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Di,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ai=e=>{const t=(e=>{if(null==e||!e.value)return;const t="inherit"===e.type&&("image"===e.inheritedType||"media"===e.inheritedType),n="image"===e.type||"media"===e.type;return t||n?void 0:(0,Ei.q)(e,!0)})(e.content);return xi("div",{className:`table-view-cell table-view-row-zoom-${e.zoomLevel}`},void 0,t)},$i=r.memo(Ai);var Ri;function Fi(e,t,n,o){Ri||(Ri="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ri,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ji={templates:Ie().fromJS([]),thesauris:Ie().fromJS([]),zoomLevel:2};class Zi extends r.Component{constructor(...e){super(...e),Li(this,"onRowClick",(e=>{this.props.clickOnDocument&&this.props.clickOnDocument(e,this.props.entity,this.props.selected)})),Li(this,"renderCell",((e,t,n)=>e?Fi($i,{content:n,zoomLevel:this.props.zoomLevel}):Fi("div",{},void 0,!e&&Fi("input",{type:"checkbox",onChange:()=>{},checked:t,onClick:this.onRowClick}),Fi($i,{content:n,zoomLevel:this.props.zoomLevel}))))}render(){const{entity:e,templates:t,thesauris:n,columns:o,selected:r}=this.props,i=Ti.Z.prepareMetadata(e.toJS(),t,n,null,{sortedProperties:["editDate","creationDate"]}),a=new Map;return i.metadata.forEach((e=>{a.set(e.name,e)})),Fi("tr",{className:`template-${i.template} ${r?"selected":""}`},void 0,o.map(((e,t)=>{const n=((e,t,n)=>{let o;const r=n.name;if(n.isCommonProperty&&"creationDate"!==r&&"editDate"!==r){const t="templateName"===r?e.documentType:e[r];o=n,o.value=t}else o=t.get(r);return o})(i,a,e);return Fi("td",{className:t?"":"sticky-col"},`column_${i._id+e.name}`,this.renderCell(t,r,n))})))}}Li(Zi,"defaultProps",Ji);const Mi=(0,c.connect)((function(e,t){return{selected:void 0!==e[t.storeKey].ui.get("selectedDocuments").find((e=>(null==e?void 0:e.get("_id"))===t.entity.get("_id"))),templates:e.templates,thesauris:e.thesauris,zoomLevel:e[t.storeKey].ui.get("zoomLevel")}}))(Zi);const Vi={documents:Ie().fromJS({rows:[]})};class Ui extends r.Component{render(){const{columns:e,clickOnDocument:t,storeKey:n}=this.props;return r.createElement(r.Fragment,null,this.props.documents.get("rows").map((o=>r.createElement(Mi,{entity:o,columns:e,clickOnDocument:t,storeKey:n,key:o.get("_id")}))))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ui,"defaultProps",Vi);const zi=(0,c.connect)(((e,t)=>({documents:e[t.storeKey].documents})))(Ui);var Ki;function Bi(e,t,n,o){Ki||(Ki="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ki,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Hi extends r.Component{constructor(...e){super(...e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleScroll",(e=>{const t=e.target;t.scrollHeight-t.scrollTop===t.clientHeight&&this.props.loadNextGroupOfEntities()}))}render(){const e=this.props.columns.filter((e=>!e.hidden));return Bi("div",{className:"tableview-wrapper",onScroll:this.handleScroll},void 0,Bi("table",{},void 0,Bi("thead",{},void 0,Bi("tr",{},void 0,e.map(((e,t)=>Bi("th",{className:t?"":"sticky-col"},e.name,Bi("div",{className:"table-view-cell"},void 0,Bi(g.vN,{context:e.translationContext},void 0,e.label))))))),Bi("tbody",{},void 0,Bi(zi,{columns:e,clickOnDocument:this.props.clickOnDocument,storeKey:this.props.storeKey}))))}}const qi=(0,Lt.P1)((e=>e.ui.get("tableViewColumns")),(e=>null==e?void 0:e.toJS())),Wi=(0,c.connect)(((e,t)=>({columns:qi(e[t.storeKey])})))(Hi);var Gi;function Qi(e,t,n,o){Gi||(Gi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Gi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Yi extends Ce{constructor(e,t){super(e,t),this.superComponentWillReceiveProps=super.componentWillReceiveProps;const{dispatch:n}=t.store;(0,_.Qd)(n,"library")((0,I.MI)()),this.zoomIn=()=>(0,_.Qd)(n,"library")((0,I.kr)()),this.zoomOut=()=>(0,_.Qd)(n,"library")((0,I.vG)())}static renderTools(){}static async requestState(e,t){return Nn(e,t)}urlHasChanged(e){return e.location.query.q!==this.props.location.query.q}componentWillUnmount(){this.emptyState()}componentDidUpdate(e){this.urlHasChanged(e)&&this.getClientState(this.props)}emptyState(){(0,_.Qd)(this.context.store.dispatch,"library")((0,I.uz)()),ke.N.set("library.sidepanel.quickLabelState",{})}render(){const e=this.props.viewer===Wi;return Qi(Ii,{sidePanelMode:this.props.sidePanelMode,noScrollable:this.props.noScrollable},void 0,Qi(Xt,{storeKey:"library",zoomIn:this.zoomIn,zoomOut:this.zoomOut,tableViewMode:e}),Qi($t,{storeKey:"library",CollectionViewer:this.props.viewer}))}}var Xi,ea=n(33530),ta=n(89628);function na(e,t,n,o){Xi||(Xi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xi,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oa extends r.Component{constructor(e){super(e),this.clickOnMarker=this.clickOnMarker.bind(this),this.clickOnCluster=this.clickOnCluster.bind(this)}clickOnMarker(e){this.props.getAndSelectDocument(e.properties.entity.sharedId)}clickOnCluster(e){this.props.unselectAllDocuments(),this.props.selectDocuments(e.map((e=>e.properties.entity)))}render(){const{storeKey:e,markers:t}=this.props;return na("div",{className:"library-map main-wrapper",style:{width:"100%",height:"100%"}},void 0,na("div",{className:"search-list"},void 0,na(ta.ZP,{storeKey:e})),na("div",{className:"documents-counter"},void 0,na("span",{},void 0,na("b",{},void 0,t.get("totalRows"))," ",(0,g.t)("System","documents"))),na(ea.sR,{entities:t.get("rows")},void 0,(e=>r.createElement(ea.D5,{ref:e=>{this.map=e},markers:e,clickOnMarker:this.clickOnMarker,clickOnCluster:this.clickOnCluster,renderPopupInfo:!0,cluster:!0}))))}}const ra=(0,c.connect)((function(e,t){return{markers:e[t.storeKey].markers}}),(function(e,t){return(0,k.bindActionCreators)({getAndSelectDocument:I.Gj,selectDocuments:I.aE,unselectAllDocuments:I.jh},(0,_.Qd)(e,t.storeKey))}),null,{withRef:!0})(oa);var ia;function aa(e,t,n,o){ia||(ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class sa extends Yi{static async requestState(e,t){return Nn(e,t,{geolocation:!0})}render(){return aa(Ii,{className:"library-map-layout"},void 0,aa(Xt,{storeKey:"library",mapViewMode:!0}),r.createElement(ra,{storeKey:"library",ref:e=>{this.mapView=e}}))}}var la=n(69899);const ca={checkbox:"check",numeric:"calculator",relationship:"exchange-alt",relationshipfilter:"filter",select:"sort",multiselect:"list",date:"calendar",text:"font",markdown:"file",nested:"cubes",multidate:"calendar",multidaterange:"calendar",daterange:"calendar",image:"image",preview:"passport",media:"video",geolocation:"map-marker",link:"link",generatedid:"fingerprint"};var da=n(2080),pa=n(37242);const ua=e=>async t=>{const n=await(async e=>{const{json:t}=await de.Z.post("suggestions/configurations",e);return t})(new pe.K(e));t(ke.N.set("settings/collection",n)),t(y.J.notify((0,g.t)("System","Settings updated"),"success"))};var ma;function fa(e,t,n,o){ma||(ma="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ma,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ha=["text","number","date"],va=({isOpen:e,onClose:t,onAccept:n,templates:o,currentProperties:i})=>{const a=i.reduce(((e,t)=>{const{template:n,properties:o}=t,r=o.map((e=>`${n}-${e}`));return e.concat(r)}),[]),[s,l]=(0,r.useState)(a),c=o.map((e=>{var t,n;return{label:e.name,id:e._id,value:e._id,options:null===(t=e.properties)||void 0===t?void 0:t.map((t=>{var n;return{label:t.label,value:`${null===(n=e._id)||void 0===n?void 0:n.toString()}-${t.name}`,type:t.type,icon:{type:"Icons",_id:ca[t.type]}}})).filter((e=>ha.includes(e.type))).concat([{label:"Title",value:`${null===(n=e._id)||void 0===n?void 0:n.toString()}-title`,type:"text",icon:{type:"Icons",_id:ca.text}}])}}));return fa(B.Z,{isOpen:e,type:"content",className:"suggestion-acceptance-modal"},void 0,fa(B.Z.Header,{},void 0,fa("h1",{},void 0,fa(g.vN,{},void 0,"Add properties"),fa("span",{},void 0,"*"))),fa(B.Z.Body,{},void 0,fa(Jt.NU,{value:s,onChange:l,options:c,optionsToShow:20,showSearch:!0})),fa(B.Z.Footer,{},void 0,fa("span",{className:"left"},void 0,"*",fa(g.vN,{},void 0,"Only text, number and date properties are currently supported")),fa("button",{type:"button",className:"btn btn-default cancel-button",onClick:t},void 0,fa(g.vN,{},void 0,"Cancel")),fa("button",{type:"button",className:"btn confirm-button btn-success",onClick:()=>(e=>{const t=e.reduce(((e,t)=>{const n=t.split("-")[0],r=t.split("-")[1],i=o.find((e=>e._id===n));if(!i)return e;const a=e.find((e=>e.template===i._id));return a?(a.properties.push(r),e):e.concat({template:i._id.toString(),properties:[r]})}),[]);n(t)})(s)},void 0,fa(g.vN,{},void 0,"Save"))))};var ya;function ba(e,t,n,o){ya||(ya="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ya,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ga extends r.Component{constructor(e){super(e),this.saveConfigs=this.saveConfigs.bind(this),this.state={configurationModalIsOpen:!1}}arrangeTemplatesAndProperties(){var e,t;const n={};return((null===(e=this.props.settings.get("features"))||void 0===e||null===(t=e.get("metadataExtraction"))||void 0===t?void 0:t.get("templates"))||[]).forEach((e=>{const t=e.has("template")?this.props.templates.find((t=>(null==t?void 0:t.get("_id"))===e.get("template"))):this.props.templates.find((t=>(null==t?void 0:t.get("name"))===e.get("name")));if(!t)return void(null===la.h||void 0===la.h||la.h.dispatch((0,pi.h)(`Template "${e.get("_id")||e.get("name")}" not found.`,"warning")));const o=e.get("properties"),r="string"==typeof o?[o]:o;null==r||r.forEach((e=>{var o;let r,i=null===(o=t.get("properties"))||void 0===o?void 0:o.find((t=>(null==t?void 0:t.get("name"))===e));var a;i?r=i.get("label"):(i=null===(a=t.get("commonProperties"))||void 0===a?void 0:a.find((t=>(null==t?void 0:t.get("name"))===e)),r=e);i?n.hasOwnProperty(e)?(n[e].properties.push(i.toJS()),n[e].templates.push(t.toJS())):n[e]={properties:[i.toJS()],templates:[t.toJS()]}:null===la.h||void 0===la.h||la.h.dispatch((0,pi.h)(`Property "${r}" not found on template "${t.get("name")}".`,"warning"))}))})),n}async saveConfigs(e){this.setState({configurationModalIsOpen:!1}),await this.props.saveConfigurations(e)}render(){const e=this.arrangeTemplatesAndProperties(),t=this.props.settings.toJS().features.metadataExtraction.templates||[];return ba("div",{className:"settings-content without-footer"},void 0,ba("div",{className:"panel panel-default"},void 0,ba("div",{className:"panel-heading"},void 0,ba(g.vN,{},void 0,"Metadata extraction dashboard")),ba("div",{className:"panel-subheading"},void 0,ba(g.vN,{},void 0,"Extract information from your documents")),ba("button",{className:"btn btn-default",type:"button",onClick:()=>{this.setState({configurationModalIsOpen:!0})}},void 0,ba(g.vN,{},void 0,"Configure properties")),ba(va,{isOpen:this.state.configurationModalIsOpen,onClose:()=>this.setState({configurationModalIsOpen:!1}),onAccept:this.saveConfigs,templates:this.props.templates.toJS(),currentProperties:t}),ba("div",{className:"metadata-extraction-table"},void 0,ba("table",{className:"table"},void 0,ba("thead",{},void 0,ba("tr",{},void 0,ba("th",{},void 0,ba(g.vN,{},void 0,"Metadata to extract")),ba("th",{},void 0,ba(g.vN,{},void 0,"Template")))),ba("tbody",{},void 0,Object.entries(e).map((([e,t])=>ba("tr",{},e,ba("td",{},void 0,ba(C.JO,{icon:ca[t.properties[0].type],fixedWidth:!0}),t.properties[0].label),ba("td",{className:"templateNameViewer"},void 0,t.templates.map(((e,n)=>ba("div",{},e.name,e.name,n!==t.templates.length-1?",":"")))),ba("td",{},void 0,ba(g.l3,{to:`settings/metadata_extraction/suggestions/${t.properties[0].name}`,className:"btn btn-success btn-xs"},void 0,ba(C.JO,{icon:"bars"})," ",ba(g.vN,{},void 0,"Review")))))))))))}}const Sa=(0,c.connect)((function({settings:e,templates:t}){return{settings:e.collection,templates:t}}),(e=>(0,k.bindActionCreators)({saveConfigurations:ua},e)))(ga);var wa;function Na(e,t,n,o){wa||(wa="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:wa,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Oa=(e,t)=>t<6?An().range(1,t+1):e%5>=0&&e>4&&e+2<t?[1,e-1,e,e+1,t]:e%5>=0&&e>4&&e+2>=t?[1,t-3,t-2,t-1,t]:[1,2,3,4,5,t];const Pa=({totalPages:e,resetActivePage:t,onPageChange:n,onPageSizeChange:o})=>{const[i,a]=(0,r.useState)(1),[s,l]=(0,r.useState)(Oa(1,e)),[c,d]=(0,r.useState)(5);(0,r.useEffect)((()=>{l(Oa(i,e))}),[i,e]),(0,r.useEffect)((()=>{t&&a(1)}),[t]);const p=e=>{e!==i&&(a(e),n(e-1))};return Na("div",{},void 0,e>0&&Na("div",{className:"table-pagination"},void 0,Na("div",{className:"page-numbers"},void 0,Na("div",{className:"prev-page"},void 0,Na("button",{type:"button",className:"page-button",onClick:()=>{1!==i&&p(i-1)},disabled:1===i},void 0,Na(C.JO,{icon:"angle-double-left"})," ",Na(g.vN,{},void 0,"Previous"))),Na("div",{className:"visible-pages"},void 0,s.map(((e,t,n)=>Na("button",{type:"button",className:i===e?"page-button active":"page-button",onClick:()=>p(e)},e,function(e,t,n){return e[t-1]+2<n||n>1&&e[t-1]!==n-1?`...${n}`:n}(n,t,e))))),Na("div",{className:"next-page"},void 0,Na("button",{type:"button",className:"page-button",onClick:()=>{i!==e&&p(i+1)},disabled:i===e},void 0,Na(g.vN,{},void 0,"Next")," ",Na(C.JO,{icon:"angle-double-right"})))),Na("div",{},void 0,Na("select",{value:c,onChange:e=>{const t=Number(e.target.value);d(t),o(t)}},void 0,[100,300,500].map((e=>Na("option",{value:e},e,`${e} ${(0,g.t)("System","per page",null,!1)}`)))))))};var Ca;function ka(e,t,n,o){Ca||(Ca="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ca,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _a=({isOpen:e,propertyType:t,onClose:n,onAccept:o})=>{const[i,a]=(0,r.useState)(!0);return ka(B.Z,{isOpen:e,type:"content",className:"suggestion-acceptance-modal"},void 0,ka(B.Z.Header,{},void 0,ka("h1",{},void 0,ka(g.vN,{},void 0,"Confirm suggestion acceptance"))),ka(B.Z.Body,{},void 0,ka("label",{className:"language-checkbox"},void 0,"date"!==t?r.createElement(r.Fragment,null,ka("input",{type:"checkbox",checked:i,onChange:e=>a(e.target.checked)})," ",ka(g.vN,{},void 0,"Apply to all languages")):ka(g.vN,{},void 0,"This will update the entity across all languages"))),ka(B.Z.Footer,{},void 0,ka("button",{type:"button",className:"btn btn-default cancel-button","aria-label":"Close acceptance modal",onClick:n},void 0,ka(g.vN,{},void 0,"Cancel")),ka("button",{type:"button",className:"btn confirm-button btn-success",onClick:()=>o(i)},void 0,ka(g.vN,{},void 0,"Confirm"))))};var ja=n(79521),Ia=n(12871),Da=n(43358);let Ta;!function(e){e.labelMatch="Match / Label",e.labelMismatch="Mismatch / Label",e.valueMatch="Match / Value",e.valueMismatch="Mismatch / Value",e.empty="Empty / Empty",e.obsolete="Obsolete",e.labelEmpty="Empty / Label",e.valueEmpty="Empty / Value",e.error="Error",e.processing="Processing",e.emptyMismatch="Mismatch / Empty"}(Ta||(Ta={}));ln.y6,Da.D,ln.u0,ln.y6,ln.y6,ln.u0,Object.values(Ta),ln.aN,ln.y6,Da.D,ln.u0,ln.y6,ln.u0,ln.u0,ln.u0,ln.aN,Object.values(Ta),Object.values(Ta);var Ea,xa=n(13265);function Aa(e,t,n,o){Ea||(Ea="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ea,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $a=e=>(t,n)=>"date"===e?((e,t)=>me().unix(e).utc().isSame(me().unix(t).utc(),"day"))(t,n):t===n,Ra=(e,t)=>{const{modelCreationDate:n,error:o,date:r}=e;if(o&&""!==o)return Ta.error;if(r<n)return Ta.obsolete;const i=(({suggestedValue:e,currentValue:t},n)=>{const o=$a(n);return""===e?"Empty":o(e,t)?"Match":"Mismatch"})(e,t),a=(({currentValue:e,labeledValue:t})=>t?"Label":e?"Value":"Empty")(e),s={Empty:{Empty:Ta.empty,Label:Ta.labelEmpty,Value:Ta.valueEmpty},Match:{Empty:null,Label:Ta.labelMatch,Value:Ta.valueMatch},Mismatch:{Empty:Ta.emptyMismatch,Label:Ta.labelMismatch,Value:Ta.valueMismatch}}[i][a];if(null===s)throw new Error("Invalid suggestion state");return s};var Fa=n(2669),La=n(87496),Ja=n(55532),Za=n(40922);const Ma=({language:e})=>{const t=(0,Za.dK)(e,"ISO639_1");return"force-"+((Za.mT.find((e=>e.key===t))||{}).rtl?"rtl":"ltr")};var Va=n(8772);const Ua=["regionId"];var za;function Ka(e,t,n,o){za||(za="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:za,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(Object(n),!0).forEach((function(t){qa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wa(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}class Ga extends r.Component{constructor(e){super(e),this.pages={1:0},this.previousMostVisible=e.page,this.pdfLoaded=this.pdfLoaded.bind(this),this.onDocumentReady=this.onDocumentReady.bind(this),this.onTextDeselection=this.onTextDeselection.bind(this),this.onTextSelected=this.onTextSelected.bind(this),this.handleClick=this.handleClick.bind(this),this.highlightReference=this.highlightReference.bind(this)}componentDidMount(){this.props.unsetSelection()}componentDidUpdate(e){e&&e.doc.get("_id")!==this.props.doc.get("_id")&&this.props.unsetSelection(),(0,La.Mr)(this.props.selectedSnippet,this.props.searchTerm)}onTextSelected(e){if(this.props.disableTextSelection)return;const t=e.selectionRectangles.map((e=>{let{regionId:t}=e;return Ha(Ha({},Wa(e,Ua)),{},{page:t})}));return this.props.setSelection(Ha(Ha({},e),{},{selectionRectangles:t}),this.props.file._id),this.props.deactivateReference()}onTextDeselection(){this.props.unsetSelection()}onDocumentReady(){this.props.onDocumentReady(this.props.doc)}handleClick(){this.props.executeOnClickHandler&&this.props.onClick()}highlightReference(e){return this.props.activateReference(e)}pdfLoaded(){if(this.props.doScrollToActive){const e=this.props.references.toJS();this.props.scrollToActive(e.find((e=>e._id===this.props.activeReference)),e,this.props.doScrollToActive)}this.props.onPDFLoaded(),this.componentDidUpdate()}handleOver(){}renderPDF(e){return e._id?Ka(Ja.g,{onPageChange:this.props.onPageChange,onPDFReady:this.onDocumentReady,onPageLoaded:this.props.onPageLoaded,onLoad:this.pdfLoaded,file:`${Va.z}files/${e.filename}`,filename:e.filename,onTextSelection:this.onTextSelected,onTextDeselection:this.onTextDeselection,highlightReference:this.highlightReference,activeReference:this.props.activeReference},e.filename):Ka(H.Z,{})}render(){const{file:e}=this.props,t=this.props.header;return Ka("div",{},void 0,Ka("div",{className:`_${this.props.doc.get("_id")} document ${this.props.className} ${Ma(e)}`},void 0,Ka(t,{}),r.createElement("div",{className:"pages",ref:e=>this.pagesContainer=e,onMouseOver:this.handleOver.bind(this),onClick:this.handleClick},this.renderPDF(e))))}}Ga.defaultProps={onPageLoaded:()=>{},onDocumentReady:()=>{},onPageChange:()=>{},onClick:()=>{},onPDFLoaded:()=>{},file:{},searchTerm:"",page:1,selectedSnippet:Ie().fromJS({}),deactivateReference:()=>{},header:()=>!1,activateReference:()=>{},doScrollToActive:!1,scrollToActive:()=>{},activeReference:"",className:"",executeOnClickHandler:!1};const Qa=Ga;var Ya=n(72861);function Xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function es(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xa(Object(n),!0).forEach((function(t){ts(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ts(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ns=(0,Lt.P1)((e=>e.uiState),(e=>e.toJS().reference.sourceRange)),os=(0,Lt.P1)((e=>e.uiState),(e=>e.toJS().activeReference));const rs=(0,c.connect)((e=>{const{user:t,documentViewer:n}=e;return{selectedSnippet:n.uiState.get("snippet"),selection:ns(n),doScrollToActive:n.uiState.get("goToActive"),doc:(0,Ya.selectDoc)(e),references:(0,Ya.selectReferences)(e),className:"sourceDocument",activeReference:os(n),executeOnClickHandler:!!n.targetDoc.get("_id"),disableTextSelection:!t.get("_id"),panelIsOpen:!!n.uiState.get("panel"),forceSimulateSelection:"targetReferencePanel"===n.uiState.get("panel")||"referencePanel"===n.uiState.get("panel")}}),(function(e){const t={setSelection:Fa.Z5,unsetSelection:Fa.FJ,onClick:La.yk,highlightReference:La.D$,activateReference:La._V,scrollToActive:La.D6,deactivateReference:La.QB};return(0,k.bindActionCreators)(t,e)}),(function(e,t,n){return es(es(es(es({},e),t),n),{},{unsetSelection:t.unsetSelection})}))(Qa);var is=n(18010),as=n(65969),ss=n(11074),ls=n(65014),cs=n(63978),ds=n(37667);function ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function us(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(n),!0).forEach((function(t){ms(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ps(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ms(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fs(e,t){const n=(0,xn.omit)(e,"fullText","defaultDoc");return async(o,r)=>{const i=r().documentViewer.metadataExtraction.toJS(),a=t||r().documentViewer.doc.toJS().defaultDoc._id;n.__extractedMetadata=us({fileID:a},i);const s=await(0,cs.o)(n,o);return((e,t,n,o)=>{e(y.J.notify("Document updated","success")),e({type:ss.nh,doc:t}),e(_e.Nw.reset("documentViewer.sidepanel.metadata"));const r=n.entity.documents.find((e=>e._id===o));e(ke.N.update("viewer/doc",us(us({},n.entity),{},{defaultDoc:r}))),e(is.Nw.reloadRelationships(n.entity.sharedId))})(o,e,s,a),n}}function hs(e,t){return async(n,o)=>{const r=o().documentViewer.doc.toJS();n(_e.Nw.reset("documentViewer.sidepanel.metadata")),n(ke.N.set("documentViewer/tocBeingEdited",!1));const i=(await de.Z.post("files",new pe.K({toc:e,_id:t}))).json,a=us(us({},r),{},{defaultDoc:i,documents:r.documents.map((e=>e._id===i._id?i:e))});n(y.J.notify("Document updated","success")),n({type:ss.nh,doc:a}),n(_e.Nw.reset("documentViewer.sidepanel.metadata")),n(ke.N.set("viewer/doc",a))}}function vs(e){return async t=>{await mr.Tg.delete(new pe.K({sharedId:e.sharedId})),t(y.J.notify("Document deleted","success")),t({type:ss.xV}),t((0,I.Cf)(e)),await t((0,I.jh)())}}async function ys(e,t,n){const[o]=await da.Z.get(e.add({omitRelationships:!0}));return o.defaultDoc=function(e,t,n){let o=e.documents.find((e=>e.filename===t));o=void 0!==o?o:{};const r=(0,vr.K)(e.documents,e.language,n);return t?o:r}(o,n,t),o}function bs(e){return(t,n)=>ys(new pe.K({sharedId:e}),n().locale).then((n=>(t(ke.N.set("viewer/targetDoc",n)),as.Z.get(new pe.K({sharedId:e,file:n.defaultDoc._id,onlyTextReferences:!0})).then((e=>{t(ke.N.set("viewer/targetDocReferences",e))})))))}function gs(e){return(t,n)=>Promise.all([ys(new pe.K({sharedId:e}),n().locale),as.Z.get(new pe.K({sharedId:e}))]).then((([e,n])=>{t(ke.N.set("viewer/doc",e)),t(ke.N.set("viewer/references",n))}))}function Ss(){return e=>{e({type:ls.p3}),e(ke.N.unset("viewer/targetDoc")),e(ke.N.unset("viewer/targetDocReferences")),e(Fa.T8()),e(La.Yp("viewMetadataPanel"))}}function ws(e){return t=>{t(ke.N.set("documentViewer/tocBeingEdited",!0)),t(_e.Nw.load("documentViewer.tocForm",e)),t(La.Yp("viewMetadataPanel")),t(ke.N.set("viewer.sidepanel.tab","toc"))}}function Ns(){return e=>{e(ke.N.set("documentViewer/tocBeingEdited",!1)),e(_e.Nw.reset("documentViewer.sidepanel.metadata"))}}function Os(e){return(t,n)=>{let o=n().documentViewer.tocForm;o=o.filter((t=>t!==e)),t(_e.Nw.load("documentViewer.tocForm",o))}}function Ps(e,t){return(n,o)=>{const r=o().documentViewer.tocForm.map((n=>us(us({},n),n===e?{indentation:t}:{})));n(_e.Nw.load("documentViewer.tocForm",r))}}function Cs(e,t){return(n,o)=>{let r=o().documentViewer.tocForm.concat();r.length||(r=t);const i={selectionRectangles:e.sourceRange.selectionRectangles,label:e.sourceRange.text,indentation:0};r.push(i),r=r.sort(ds.O),n(ws(r))}}const ks=(0,c.connect)((function({documentViewer:e,templates:t,thesauris:n}){return{model:"documentViewer.sidepanel.metadata",isEntity:!e.sidepanel.file,templateId:e.sidepanel.metadata.template,templates:t,thesauris:n}}),(function(e,t){const{fileID:n,onEntitySave:o=(()=>{})}=t;return(0,k.bindActionCreators)({changeTemplate:fr.Nw.changeTemplate,onSubmit:e=>async(t,r)=>{const i=await fs(e,n)(t,r);t(is.Nw.reloadRelationships(e.sharedId)),o(i)}},e)}))(fr.n0);var _s;function js(e,t,n,o){_s||(_s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:_s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Is=({open:e,entitySuggestion:t,closeSidePanel:n,handleSave:o})=>{const[i,a]=(0,r.useState)({}),[s,l]=(0,r.useState)({}),c=null===la.h||void 0===la.h?void 0:la.h.getState().templates;return(0,r.useEffect)((()=>{(async(e,t)=>{const n=new pe.K({_id:e});return da.Z.get(n,t)})(t.entityId,t.language).then((e=>{a(e[0]),(0,Qo.loadFetchedInReduxForm)("documentViewer.sidepanel.metadata",e[0],null==c?void 0:c.toJS()).forEach((e=>null===la.h||void 0===la.h?void 0:la.h.dispatch(e)))})).catch((e=>e))}),[t]),(0,r.useEffect)((()=>{t.fileId&&(async e=>{const t=new pe.K({_id:e});return de.Z.get("files",t)})(t.fileId).then((e=>{l(e.json[0])})).catch((e=>e))}),[t]),e?js(bt.hs,{className:"wide",open:e},void 0,r.createElement(r.Fragment,null,js("div",{className:"sidepanel-header buttons-align-right"},void 0,js("button",{type:"button",className:"closeSidepanel close-modal",onClick:n,"aria-label":"Close side panel"},void 0,js(C.JO,{icon:"times"})),js("div",{className:"button-list"},void 0,js("button",{type:"button",className:"btn btn-default",onClick:n},void 0,js(g.vN,{},void 0,"Cancel")),js("button",{type:"submit",className:"btn btn-success",form:"metadataForm"},void 0,js(g.vN,{},void 0,"Save")))),i.sharedId&&s.filename&&r.createElement(r.Fragment,null,js(ks,{sharedId:i.sharedId,showSubset:[t.propertyName],storeKey:"documentViewer",fileID:t.fileId,onEntitySave:o}),js("div",{className:"document-viewer"},void 0,js(rs,{file:s,onPageLoaded:async()=>{await(async e=>pa.Z.to(`.document-viewer div#page-${e}`,".document-viewer",{duration:0,dividerOffset:1,offset:50}))(t.page||1)}}))))):r.createElement(r.Fragment,null)};var Ds;function Ts(e,t,n,o){Ds||(Ds="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ds,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Es=(e,t)=>{const n=[];if(e.length>t)return e.slice(0,t);for(let o=e.length;o<t;o+=1)n.push(e[e.length-1]);return e.concat(n)},xs=(e,t)=>{const{main:n,overlaying:o}=(e=>{const t=[...e],n=e.findIndex((e=>e.overlaying));if(n>=0){const[e]=t.splice(n,1);return{main:t,overlaying:e}}return{main:t}})(t),r=(e=>e.reduce(((e,t)=>e+t.value),0))(n),i=r/e,a=((e,t)=>{const n=[];return e.forEach((e=>{const o=Math.round(e.value/t);for(let t=0;t<o;t+=1)n.push(e.color)})),n})(n,i),s=Es(a,e);if(!o)return[s,s];const l=((e,t,n,o)=>{const r=[],i=Math.round(e.value/o);for(let t=0;t<i;t+=1)r.push(e.color);for(let e=i;e<n;e+=1)r.push(t[e]);return r})(o,s,e,i);return[s,Es(l,e)]},As=({data:e,className:t,squareSide:n,spaceBetweenSquares:o})=>{const i=n||14,a=o||2,s=(0,r.useRef)(null),l=((e,t,n)=>e?Math.floor((e-n)/(t+n)):0)(function(e){const[t,n]=(0,r.useState)(0);return(0,r.useLayoutEffect)((()=>{const t=()=>{var t;n((null===(t=e.current)||void 0===t?void 0:t.offsetWidth)||0)};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[]),t}(s),i,a),c=(0,r.useMemo)((()=>xs(l,e)),[l,e]),d=[...Array(l).keys()],p=[0,1];return r.createElement("div",{ref:s,className:t,style:{width:"100%"}},l?Ts("ul",{className:"grid-chart",style:{height:2*i+1*a}},void 0,d.map((e=>p.map((t=>Ts("li",{style:{backgroundColor:c[t][e]}},`${e}-${t}`)))))):null)};var $s;function Rs(e,t,n,o){$s||($s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fs=({data:e,total:t,accuracy:n})=>Rs("ul",{className:"legend"},void 0,e.map((e=>e.label?Rs("li",{style:{color:e.label.color||e.color}},`${e.color}-${e.value}`,e.label.text," ",Rs("b",{},void 0,e.value," (",((e,t)=>`${(e/t*100).toFixed(2)}%`)(e.value,t),")")):null)),Rs("li",{style:{color:"#6c6c7b"}},void 0,Rs(g.vN,{},void 0,"Accuracy")," ",(100*n).toFixed(2),"%"));var Ls;function Js(e,t,n,o){Ls||(Ls="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ls,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Zs=({stats:e})=>{if(!e)return null;const t=(e=>[{color:"#5073CF",value:e.labeled,label:{text:Js(g.vN,{},void 0,"Training")}},{color:"#4CAE4C",value:e.nonLabeledMatching,label:{text:Js(g.vN,{},void 0,"Matching")}},{color:"#ECA41A",value:e.nonLabeledNotMatching,label:{text:Js(g.vN,{},void 0,"Non-matching")}},{color:"#E8E7EC",value:e.emptyOrObsolete,label:{text:Js(g.vN,{},void 0,"Empty / Obsolete"),color:"black"}}])(e.counts);return Js("div",{className:"training-dashboard"},void 0,Js(Fs,{data:t,total:e.counts.all,accuracy:e.accuracy}),Js(As,{className:"training-dashboard-chart",data:t}))};var Ms;function Vs(e,t,n,o){Ms||(Ms="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ms,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Us=({isOpen:e,onClose:t,onAccept:n})=>Vs(B.Z,{isOpen:e,type:"content",className:"suggestion-acceptance-modal"},void 0,Vs(B.Z.Header,{},void 0,Vs("h1",{},void 0,Vs(g.vN,{},void 0,"Confirm"))),Vs(B.Z.Body,{},void 0,Vs(g.vN,{},void 0,"This will cancel the finding suggestion process")),Vs(B.Z.Footer,{},void 0,Vs("button",{type:"button",className:"btn btn-default cancel-button","aria-label":"Close acceptance modal",onClick:t},void 0,Vs(g.vN,{},void 0,"Cancel")),Vs("button",{type:"button",className:"btn confirm-button btn-success",onClick:n},void 0,Vs(g.vN,{},void 0,"Confirm"))));function zs(){return zs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},zs.apply(this,arguments)}function Ks(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Bs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ks(Object(n),!0).forEach((function(t){Hs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ks(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qs;function Ws(e,t,n,o){qs||(qs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:qs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gs=({property:e,acceptIXSuggestion:t})=>{const n=(0,r.useRef)(!1),[o,i]=(0,r.useState)([]),[a,s]=(0,r.useState)(0),[l,c]=(0,r.useState)(!1),[d,p]=(0,r.useState)({key:"ready"}),[u,m]=(0,r.useState)(!1),[f,h]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[b,S]=(0,r.useState)(void 0),w=e=>{let t="btn ";return e===Ta.labelMatch&&(t+="btn-outline-success label-match"),e!==Ta.labelMismatch&&e!==Ta.valueMismatch||(t+="btn-outline-warning label-value-mismatch"),e===Ta.valueMatch&&(t+="btn-outline-primary value-match"),e!==Ta.labelEmpty&&e!==Ta.valueEmpty&&e!==Ta.obsolete&&e!==Ta.empty&&e!==Ta.error||(t+="btn-outline-secondary disabled"),t},N=t=>"title"===t.propertyName&&""===t.suggestedValue||e.required&&""===t.suggestedValue,{getTableProps:O,getTableBodyProps:P,headerGroups:k,page:_,prepareRow:j,gotoPage:I,setPageSize:D,selectedFlatRows:T,toggleAllRowsSelected:E,state:{pageIndex:x,pageSize:A,filters:$}}=((e,t,n,o,i)=>{const a=({column:{filterValue:e,setFilter:t}})=>Aa("select",{className:e?"filtered":"",value:e,onChange:e=>{t(e.target.value||void 0)}},void 0,Aa("option",{value:""},void 0,(0,g.t)("System","All","All",!1)),Object.values(Ta).filter((e=>e!==Ta.processing)).sort().map((e=>Aa("option",{value:e},e,(0,g.t)("System",e,e,!1))))),s=t=>t?"date"===e.type&&An().isNumber(t)?Ti.V.date(t):t:"-",l=({row:e})=>{const t=e.values.currentValue||e.original.currentValue;return Aa("div",{},void 0,Aa("p",{className:"current-value"},void 0,s(t)))},c=({row:e})=>{const t=e.original;return Aa("div",{},void 0,Aa("p",{className:"suggested-value"},void 0,s(t.suggestedValue)))},d=r.useMemo((()=>[{accessor:"segment",Header:()=>Aa(g.vN,{},void 0,"Context"),className:"Title"===e.label?"long-segment":"segment",Cell:i},{id:"suggestion",Header:()=>Aa(g.vN,{},void 0,"Suggestion"),Cell:c,className:"suggestion"},{id:"action",Header:()=>"",Cell:o,className:"action"},{id:"currentValue",Header:()=>Aa(g.vN,{},void 0,"Current value"),Cell:l,className:"current"},{id:"entityTitle",accessor:"entityTitle",Header:()=>Aa(g.vN,{},void 0,"Title"),className:"title"},{accessor:"language",Header:()=>Aa(g.vN,{},void 0,"Language"),className:"language",Cell:({row:e})=>Aa(g.vN,{},void 0,e.original.language)},{accessor:"state",Header:()=>r.createElement(r.Fragment,null,Aa(xa.Z,{label:Aa(C.JO,{icon:"question-circle"}),title:(0,g.t)("System","State Legend","State Legend",!1)},void 0,Aa("h5",{},void 0,(0,g.t)("System",Ta.labelMatch,Ta.labelMatch,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"labelMatchDesc"},void 0,"It has a current value and a text selection matching with the modelsuggested value and selection. It will be used as a training sample.")),Aa("h5",{},void 0,(0,g.t)("System",Ta.labelMismatch,Ta.labelMismatch,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"labelMismatchDesc"},void 0,'It has a current value and text selection but they do not match the model prediction. Accepting the suggestion will replace the current value and text selection with the suggested ones becoming a "match / labeled". If the labeled data is correct and the suggestion is wrong no action is needed. It will be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.labelEmpty,Ta.labelEmpty,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"labelEmptyDesc"},void 0,"Accepting is not available since there is no suggestion.If the value is correct and the suggestion is wrong no action is needed. It will be used as a training sample.")),Aa("h5",{},void 0,(0,g.t)("System",Ta.valueMatch,Ta.valueMatch,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"valueMatchDesc"},void 0,'It has a current value that matches the suggestion, but it doesn\'t have a text selection. Accepting will keep the value as it is and enrich it with the suggested text selection becoming a "match / label" that can be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.valueMismatch,Ta.valueMismatch,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"valueMismatchDesc"},void 0,'Accepting the suggestion will replace the current value and text selection with the suggested ones becoming a "match / label" that will be used as a training sample. If the current value is correct, you can still click to fill the text selection so it becomes a "mismatch / label" that will be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.emptyMismatch,Ta.emptyMismatch,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"emptyMismatchDesc"},void 0,'There is no current value and the model is suggesting a value. Accepting the suggestion will replace the current (empty) value and text selection with the suggested ones becoming a "match / label" that will be used as a training sample. Alternatively you can ignore the suggestion and click to fill the text selection so it becomes a "mismatch / label" that will be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.valueEmpty,Ta.valueEmpty,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"valueEmptyDesc"},void 0,'Accepting is not available since there is no suggestion. If the current value is correct, you can click to fill the text selection so it becomes a "empty / label" that will be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.empty,Ta.empty,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"emptyDesc"},void 0,'Both the current value and the suggestion are empty. You can click to fill the value and text selection so it becomes a "empty / label" that will be used as a training sample.')),Aa("h5",{},void 0,(0,g.t)("System",Ta.obsolete,Ta.obsolete,!1)),Aa("div",{},void 0,Aa(g.vN,{translationKey:"obsoleteDesc"},void 0,"A new model is training and processing suggestions. This suggestion was created by a previous model so no actions are possible until the new suggestion is received."))),Aa(g.vN,{},void 0,"State")),Cell:({row:e})=>Aa("div",{className:e.original.state!==e.values.state?"new-state":""},void 0,Aa(g.vN,{},void 0,e.values.state)),Filter:a,className:"state"}]),[]),p="Title"===e.label?["entityTitle"]:[];return(0,ja.useTable)({columns:d,data:t,manualPagination:!0,manualFilters:!0,initialState:{hiddenColumns:p,pageIndex:0,pageSize:100},pageCount:n,autoResetPage:!1,autoResetFilters:!1},ja.useFilters,ja.usePagination,ja.useRowSelect,ja.useRowState,Ia.useSticky)})(e,o,a,(({row:e})=>{const t=e.values,{state:n}=t;return Ws("div",{},void 0,Ws("button",{type:"button","aria-label":"Accept suggestion",className:w(n),disabled:n===Ta.labelEmpty||n===Ta.valueEmpty||n===Ta.obsolete||n===Ta.labelMatch||n===Ta.error||N(e.original),onClick:async()=>(e=>{e.toggleRowSelected(),m(!0)})(e)},void 0,Ws(C.JO,{icon:"arrow-right"})))}),(({row:e})=>Ws("div",{onClick:()=>(e=>{E(!1),e.toggleRowSelected(),y(!0)})(e)},void 0,Ws("span",{className:"segment-pdf"},void 0,Ws(g.vN,{},void 0,"Open PDF")),Ws("span",{className:"segment-context"},void 0,e.original.segment)))),R=(t=x+1)=>{const n=$.reduce(((e,t)=>Bs(Bs({},e),{},{[t.id]:t.value})),{});(async e=>{const{json:t}=await de.Z.get("suggestions",e);return{suggestions:t.suggestions,totalPages:t.totalPages}})(new pe.K({page:{number:t,size:A},filter:Bs(Bs({},n),{},{propertyName:e.name})})).then((e=>{i(e.suggestions),s(e.totalPages)})).catch((()=>{}))},F=()=>{(async e=>{const{json:t}=await de.Z.get("suggestions/stats",e);return t})(new pe.K({propertyName:e.name})).then((e=>{S(e)})).catch((()=>{}))},L=(t,n)=>Ra(Bs(Bs({},t),{},{currentValue:n,modelCreationDate:0}),e.type),J=async()=>{p({key:"sending_labeled_data"});const t=new pe.K({property:e.name}),n=await(async e=>{const{json:t}=await de.Z.post("suggestions/train",e);return t})(t),o="error"===n.status?"danger":"success";p({key:n.status,data:n.data}),null===la.h||void 0===la.h||la.h.dispatch((0,pi.h)(n.message,o)),"ready"===d.key&&await R()},Z=async()=>{h(!1);const t=new pe.K({property:e.name});"ready"!==d.key&&(p({key:"cancel"}),await(async e=>{const{json:t}=await de.Z.post("suggestions/stop",e);return t})(t))};(0,r.useEffect)(R,[x,A,$]),(0,r.useEffect)((()=>{n.current?(R(1),I(0),c(!0)):n.current=!0}),[$]),(0,r.useEffect)((()=>((async e=>{const{json:t}=await de.Z.post("suggestions/status",e);return t})(new pe.K({property:e.name})).then((e=>{p({key:e.status,data:e.data})})).catch((()=>{p({key:"error"})})),kr.W.on("ix_model_status",((t,n,o,r)=>{t===e.name&&(p({key:n,data:r}),(r&&r.total===r.processed||"ready"===n)&&(p({key:"ready"}),R()),F())})),F(),()=>{kr.W.off("ix_model_status")})),[]);return r.createElement(r.Fragment,null,Ws("div",{className:"panel entity-suggestions"},void 0,Ws("div",{className:"dashboard-link"},void 0,Ws(g.l3,{to:"settings/metadata_extraction"},void 0,Ws(C.JO,{icon:"arrow-left"}),Ws(g.vN,{},void 0,"Back to dashboard"))),Ws("div",{className:"panel-subheading"},void 0,Ws("div",{className:"property-info-container"},void 0,Ws("div",{},void 0,Ws("span",{className:"suggestion-header"},void 0,Ws(g.vN,{},void 0,"Reviewing"),": "),Ws("span",{className:"suggestion-property"},void 0,Ws(g.vN,{},void 0,e.label))),Ws("div",{},void 0,Ws("button",{type:"button",title:"ready"!==d.key?"Cancel":"Train",className:`btn service-request-button ${d.key}`,onClick:async()=>{"ready"===d.key?(p({key:"sending_labeled_data"}),await J()):h(!0)}},void 0,Ws(g.vN,{},void 0,{ready:"Find suggestions",sending_labeled_data:"Sending labeled data...",processing_model:"Training model...",processing_suggestions:"Finding suggestions",cancel:"Cancelling...",error:"Error"}[d.key])," ",(M=d.data)?`${M.processed}/${M.total}`:""))),Ws(Zs,{stats:b})),r.createElement("table",zs({},O(),{className:"table sticky"}),Ws("thead",{className:"header"},void 0,k.map((e=>r.createElement("tr",e.getHeaderGroupProps(),e.headers.map((e=>{const t=e.className+($.find((t=>t.id===e.id))?" filtered":"");return r.createElement("th",e.getHeaderProps({className:t}),e.render("Header"),e.canFilter&&e.Filter&&e.render("Filter"))})))))),r.createElement("tbody",P(),_.map((e=>(j(e),r.createElement("tr",e.getRowProps(),e.cells.map((e=>r.createElement("td",e.getCellProps({className:e.column.className}),e.render("Cell")))))))))),Ws(Pa,{resetActivePage:l,onPageChange:I,onPageSizeChange:D,totalPages:a}),Ws(_a,{isOpen:u,propertyType:e.type,onClose:()=>m(!1),onAccept:async e=>(async e=>{if(T.length>0){var n;const o=T[0].original;await t(o,e);let{labeledValue:r}=o;!r&&null!==(n=o.selectionRectangles)&&void 0!==n&&n.length&&(r=o.suggestedValue),T[0].toggleRowSelected(),T[0].values.state=L(Bs(Bs({},o),{},{labeledValue:r}),o.suggestedValue),T[0].values.currentValue=o.suggestedValue,T[0].setState({})}m(!1),E(!1),F()})(e)}),Ws(Us,{isOpen:f,onClose:()=>h(!1),onAccept:async()=>Z()})),Boolean(T.length)&&Ws(Is,{open:v,closeSidePanel:()=>{y(!1)},handleSave:t=>{var n;y(!1);const o=t[e.name]||(null===(n=t.metadata)||void 0===n?void 0:n[e.name]);T[0].values.currentValue=Array.isArray(o)?o[0].value||"-":o,T[0].setState({}),T[0].toggleRowSelected();const r=T[0].original;T[0].values.state=L(r,t.title),T[0].setState({}),F()},entitySuggestion:T[0].original}));var M};var Qs,Ys=n(66239),Xs=n(12006);function el(e,t,n,o){Qs||(Qs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Qs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tl={400:{title:"Bad Request",summary:"Bad Request",name:"The request could not be processed.",message:"",code:"400"},404:{title:"Not Found",summary:"",name:"We can’t find the page you’re looking for. ",message:"",code:"404"},500:{title:"Unexpected error",summary:"Unexpected error",name:"",message:"",code:"500"}};const nl=class extends Ce{render(){var e;const t=(null===(e=tl[this.props.params.errorCode])||void 0===e?void 0:e.code)||"404",{requestId:n}=this.props.location.query,o=/^[0-9-]{4}$/.exec(n),r=tl[t];return r.requestId=o?o[0]:void 0,el("div",{},void 0,el(M.q,{},void 0,el("title",{},void 0,r.title)),el(Ys.H,{error:r}),el(Xs.Z,{}))}};var ol;function rl(e,t,n,o){ol||(ol="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ol,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const il=e=>({templates:e.templates}),al={acceptSuggestion:(e,t)=>async n=>{const o=new pe.K({allLanguages:t,suggestion:{_id:e._id,sharedId:e.sharedId,entityId:e.entityId}});(await(async e=>{const{json:t}=await de.Z.post("suggestions/accept",e);return t})(o)).success&&n(y.J.notify("Saved successfully.","success"))}},sl=((0,c.connect)(il,al),(0,c.connect)(il,al)((({routeParams:{propertyName:e},templates:t,acceptSuggestion:n})=>{const o="title"===e?"commonProperties":"properties",r=t.map((t=>{var n;return null===(n=(0,dn.zx)(t).get(o))||void 0===n?void 0:n.find((t=>(null==t?void 0:t.get("name"))===e))})).filter((e=>!An().isUndefined(e)));return r&&r.size>0?rl("div",{className:"settings-content"},void 0,rl(Gs,{property:r.get(0).toJS(),acceptIXSuggestion:n})):rl("div",{className:"settings-content"},void 0,rl(nl,{}))}))),ll={get:e=>de.Z.get("pages",e).then((e=>e.json)),getById:e=>de.Z.get("page",e).then((e=>e.json)),save:e=>de.Z.post("pages",e).then((e=>e.json)),delete:e=>de.Z.delete("pages",e).then((e=>e.json))};var cl,dl=n(83887);function pl(){return async e=>{const t=await ll.get(new pe.K);e(ke.N.set("pages",t))}}function ul(){return e=>{e(_e.Nw.reset("page.data")),e(_e.Nw.setInitial("page.data"))}}function ml(e,t){return n=>{n(_e.Nw.change(`page.data${e}`,t))}}function fl(e){return t=>(t({type:dl.ul}),ll.save(new pe.K(e)).then((e=>{t(y.J.notify("Saved successfully.","success")),t(_e.Nw.merge("page.data",{_id:e._id,sharedId:e.sharedId,_rev:e._rev})),t({type:dl.on,data:e}),d.mW.push(`/settings/pages/edit/${e.sharedId}`)})).catch((()=>{t({type:dl.on,data:{}})})))}function hl(e){return t=>ll.delete(new pe.K({sharedId:e.sharedId})).then((()=>{t(ke.N.remove("pages",e))}))}function vl(e,t,n,o){cl||(cl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:cl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yl=(0,c.connect)((({page:e})=>({page:e,formState:e.formState,savingPage:e.uiState.get("savingPage")})),(e=>(0,k.bindActionCreators)({resetPage:ul,savePage:fl,updateValue:ml},e)));class bl extends r.Component{componentWillUnmount(){const{resetPage:e}=this.props;e()}render(){const{formState:e,page:t,savePage:n,updateValue:o,savingPage:r}=this.props,i="/settings/pages",a=`/page/${t.data.sharedId}/${An().kebabCase(t.data.title)}`;let s="template-name form-group";return e.title&&!e.title.valid&&(e.submitFailed||e.title.touched)&&(s+=" has-error"),vl("div",{className:"page-creator"},void 0,vl(_e.l0,{model:"page.data",onSubmit:n,validators:{"":{},title:{required:e=>e&&""!==e.trim()}}},void 0,vl("div",{className:"panel panel-default"},void 0,vl("div",{className:"metadataTemplate-heading panel-heading"},void 0,vl("div",{className:s},void 0,vl(_e.gN,{model:".title"},void 0,vl("input",{placeholder:"Page name",className:"form-control"})))),vl("div",{className:"panel-body page-viewer document-viewer"},void 0,vl("div",{className:"entity-view"},void 0,vl(g.vN,{},void 0,"Enable this page to be used as an entity view page:"),vl(_e.oT,{model:".entityView",component:C.CO,checked:Boolean(t.data.entityView),onClick:()=>{o(".entityView",!t.data.entityView)}})),vl($n.Z,{if:Boolean(t.data._id)&&!t.data.entityView},void 0,vl("div",{className:"alert alert-info"},void 0,vl(C.JO,{icon:"angle-right"})," ",a," ",vl("a",{target:"_blank",rel:"noopener noreferrer",href:a,className:"pull-right"},void 0,vl(g.vN,{},void 0,"(view page)")))),vl(De.sd,{htmlOnViewer:!0,model:".metadata.content",rows:18,showPreview:!t.data.entityView}),vl("div",{className:"alert alert-info"},void 0,vl(C.JO,{icon:"info-circle",size:"2x"}),vl("div",{className:"force-ltr"},void 0,vl(g.vN,{},void 0,"Use")," ",vl("a",{target:"_blank",rel:"noopener noreferrer",href:"https://guides.github.com/features/mastering-markdown/"},void 0,vl(g.vN,{},void 0,"Markdown"))," ",vl(g.vN,{},void 0,"syntax to create page content"),vl("br",{}),vl(g.vN,{},void 0,"You can also embed advanced components like maps, charts and entity lists in your page.")," ",vl("a",{target:"_blank",rel:"noopener noreferrer",href:"https://uwazi.readthedocs.io/en/latest/admin-docs/analysing-and-visualising-your-collection.html"},void 0,vl(g.vN,{},void 0,"Click here"))," ",vl(g.vN,{},void 0,"to learn more about the components."))),vl("div",{},void 0,vl("div",{},void 0,vl("span",{className:"form-group-label"},void 0,vl(g.vN,{},void 0,"Page Javascript"))),vl("div",{className:"alert alert-warning"},void 0,vl(C.JO,{icon:"exclamation-triangle",size:"2x"}),vl("div",{className:"force-ltr"},void 0,vl(g.vN,{},void 0,"With great power comes great responsibility!"),vl("br",{}),vl("br",{}),vl(g.vN,{},void 0,"This area allows you to append custom Javascript to the page. This opens up a new universe of possibilities."),vl("br",{}),vl(g.vN,{},void 0,"It could also very easily break the app. Only write code here if you know exactly what you are doing."))),vl(_e.gN,{model:".metadata.script"},void 0,vl("textarea",{placeholder:"// Javascript - With great power comes great responsibility!",className:"form-control",rows:12}))))),vl("div",{className:"settings-footer"},void 0,vl("div",{className:"btn-cluster"},void 0,vl(bt.xE,{to:i,className:"btn-plain"})),vl("div",{className:"btn-cluster content-right"},void 0,vl(g.l3,{to:i,className:"btn btn-extra-padding btn-default"},void 0,vl("span",{className:"btn-label"},void 0,vl(g.vN,{},void 0,"Cancel"))),vl("button",{type:"submit",className:"btn btn-extra-padding btn-success save-template",disabled:!!r},void 0,vl("span",{className:"btn-label"},void 0,vl(g.vN,{},void 0,"Save")))))))}}const gl=yl(bl);var Sl,wl,Nl;function Ol(e,t,n,o){Sl||(Sl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Sl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Pl(e,t,n,o){wl||(wl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:wl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Cl(e,t,n,o){Nl||(Nl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Nl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kl extends r.Component{deletePage(e){return this.context.confirm({accept:()=>{this.props.deletePage(e.toJS())},title:r.createElement(r.Fragment,null,Cl(g.vN,{},void 0,"Confirm delete page:")," ",e.get("title")),message:"Are you sure you want to delete this page?"})}render(){const{pages:e}=this.props;return Cl("div",{className:"panel panel-default"},void 0,Cl("div",{className:"panel-heading"},void 0,(0,g.t)("System","Pages")),Cl("ul",{className:"list-group pages"},void 0,e.map(((e,t)=>Cl("li",{className:"list-group-item"},t,Cl(g.l3,{to:`/settings/pages/edit/${e.get("sharedId")}`},void 0,e.get("title")),Cl("div",{className:"list-group-item-actions"},void 0,Cl(g.l3,{to:`/settings/pages/edit/${e.get("sharedId")}`,className:"btn btn-default btn-xs"},void 0,Cl(C.JO,{icon:"pencil-alt"})," ",Cl("span",{},void 0,(0,g.t)("System","Edit"))),Cl("a",{onClick:this.deletePage.bind(this,e),className:"btn btn-danger btn-xs template-remove"},void 0,Cl(C.JO,{icon:"trash-alt"})," ",Cl("span",{},void 0,(0,g.t)("System","Delete")))))))),Cl("div",{className:"settings-footer"},void 0,Cl(g.l3,{to:"/settings/pages/new",className:"btn btn-default"},void 0,Cl(C.JO,{icon:"plus"})," ",Cl("span",{className:"btn-label"},void 0,(0,g.t)("System","Add page")))))}}kl.contextTypes={confirm:u().func};const _l=(0,c.connect)((function({pages:e}){return{pages:e}}),(function(e){return(0,k.bindActionCreators)({deletePage:hl},e)}))(kl);var jl;function Il(e,t,n,o){jl||(jl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:jl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Dl=class extends Ce{static async requestState(e){const t=await ll.get(e);return[ke.N.set("pages",t)]}render(){return Il("div",{className:"settings-content"},void 0,Il(_l,{}))}};var Tl=n(81485),El=n(94534),xl=n(27199);class Al extends r.Component{constructor(e){super(e),this.scriptElement=null}componentDidMount(){this.appendScript(),window.addEventListener("error",this.props.onError),window.addEventListener("unhandledrejection",this.props.onError)}componentDidUpdate(e){const{children:t}=this.props;t!==e.children?(this.removeScript(),window.removeEventListener("error",this.props.onError),window.removeEventListener("unhandledrejection",this.props.onError),this.appendScript()):null===this.scriptElement&&this.appendScript()}componentWillUnmount(){this.removeScript(),window.removeEventListener("error",this.props.onError),window.removeEventListener("unhandledrejection",this.props.onError)}appendScript(){const{children:e,scriptRendered:t}=this.props;if(e&&!1===t){const t=document.createElement("script");t.src=`data:text/javascript,(function(){${encodeURIComponent(`\n\n${e}\n\n`)}})()`,document.body.appendChild(t),this.scriptElement=t,this.props.dispatch(ke.N.setIn("page/pageView","scriptRendered",!0))}}removeScript(){this.scriptElement&&(this.scriptElement.remove(),this.scriptElement=null)}render(){return null}}Al.defaultProps={children:"",scriptRendered:null,onError:()=>{}};const $l=(0,c.connect)()(Al);var Rl;function Fl(e,t,n,o){Rl||(Rl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Rl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ll extends r.Component{constructor(e){super(e),this.state={},this.warningPageError=this.warningPageError.bind(this)}componentDidUpdate(e){e.page.get("title")!==this.props.page.get("title")&&this.removeCustomPageError()}componentWillUnmount(){this.state.customPageError&&this.removeCustomPageError()}warningPageError(e){this.setState({customPageError:e})}removeCustomPageError(){this.setState({customPageError:null})}renderErrorWarning(){return Fl("div",{className:"alert alert-danger"},void 0,Fl(C.JO,{icon:"exclamation-triangle"}),Fl(g.vN,{},void 0,"There is an unexpected error on this custom page, it may not work properly. Please contact an admin for details."),Fl(C.JO,{icon:"times",onClick:()=>this.removeCustomPageError()}))}render(){const{page:e,itemLists:t,datasets:n,error:o,setBrowserTitle:i}=this.props,a=t.toJS(),s=e.getIn(["metadata","content"])||"",l=e.getIn(["scriptRendered"]);let c=e.getIn(["metadata","script"])||"";c=`var datasets = window.store.getState().page.datasets.toJS();\n    ${c}`;const d=(e=>{const t=e instanceof Ie().Map?e.toJS():e;return null!=t&&t.json&&(n=t)?{name:n.json.error||"Unexpected error",message:n.json.prettyMessage,requestId:n.json.requestId,code:n.status}:null;var n})(o);return Fl("div",{className:"row"},void 0,!d&&r.createElement(r.Fragment,null,i&&Fl(M.q,{},void 0,Fl("title",{},void 0,e.get("title")?e.get("title"):"Page")),Fl("main",{className:"page-viewer document-viewer"},void 0,Fl("div",{className:"main-wrapper"},void 0,this.state.customPageError&&this.renderErrorWarning(),Fl(xl.Context.Provider,{value:n},void 0,Fl(Tl.S,{},void 0,Fl(El.Z,{html:!0,markdown:s,lists:a}))),Fl(Xs.Z,{}))),Fl($l,{scriptRendered:l,onError:e=>this.warningPageError(e)},void 0,c)),d&&Fl("div",{className:"main-wrapper"},void 0,Fl(Ys.H,{error:d}),Fl(Xs.Z,{})))}}Ll.defaultProps={page:Ie().fromJS({}),itemLists:Ie().fromJS([]),datasets:Ie().fromJS({}),error:Ie().fromJS({}),setBrowserTitle:!0};const Jl=(0,c.connect)((({page:e})=>({page:e.pageView,datasets:e.datasets,itemLists:e.itemLists,error:e.error})))(Ll),Zl=function(){const e=/^([\S\s]+?)\.\.\.([\S\s]+)/,t=/[-[\]{}()*+?.\\^$|,]/g,n=function(e){return e.replace(t,"\\$&")};return function(t,o,r=""){const i=e.exec(o);if(!i)throw new Error('format must include start and end tokens separated by "..."');if(i[1]===i[2])throw new Error("start and end format tokens cannot be identical");const a=i[1],s=i[2],l=new RegExp(5===o.length?`[${n(a+s)}]`:`${n(a)}|${n(s)}`,"g"),c=[];let d,p,u;do{for(d=0;null!==(u=l.exec(t));)u[0]===a?(d||(p=l.lastIndex),d+=1):d&&(d-=1,d||t.slice(p-r.length-a.length,p-a.length)===r&&c.push(t.slice(p,u.index)))}while(d&&(l.lastIndex=p));return c}}(),Ml="{list}",Vl=e=>{const t=Zl(e,"(...)",Ml),n=[];let o=e||"";const r=t.map((e=>{const t=((e,t)=>{const n=Zl(e,"(...)",`{list}(${t})`)[0];let o={},r="";if(n){r=`(${n})`;try{o=rn().decode(`(${n})`)}catch(e){o={}}}return{options:o,matchString:r}})(o,e);n.push(t.options),o=o.replace(`{list}(${e})${t.matchString}`,"{---UWAZILIST---}");const r=/\?(.*)/g.exec(e);return r?r[0]:""}));return{params:r,content:o,options:n}};function Ul(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function zl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ul(Object(n),!0).forEach((function(t){Kl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ul(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bl=(e,t)=>{const n=Vl(e);return n.searchs=Promise.all(n.params.map(((e,o)=>{const r=(e=>{const t={filters:{},types:[]};if(e){const n=rn().decode(e.replace("?q=","")||"()");return"object"!=typeof n?t:n}return t})(e?decodeURI(e):"");return r.limit=n.options[o].limit?String(n.options[o].limit):"6",tn.Z.search(t.set(r))}))),n},Hl=async(e,t,n)=>{var o;const r=await ll.getById(e),{content:i,errors:a}=((e,t)=>{if(!e||!t||!t.entityData&&!t.template)return{content:e,errors:[]};const n={entity:t.entityData,template:t.template},o=[];return{content:e.replace(/\$\{((entity.|template.)[^}^\s]*)\}/g,((e,t)=>{switch(!0){case/entity.metadata.\w*$/.test(t):return(0,xn.get)(n,`${t}[0].value`);case/entity.metadata.\w*.(value|displayValue)$/.test(t):{const e=t.split("."),o=e.pop();return(0,xn.get)(n,`${e.join(".")}[0].${o}`)}case/entity.metadata.\w*\[\d+]$/.test(t):return(0,xn.get)(n,`${t}.value`);case(0,xn.has)(n,t):return(0,xn.get)(n,t);default:return o.push(e),e}})),errors:o}})(null===(o=r.metadata)||void 0===o?void 0:o.content,n);r.metadata.content=i;const s=Bl(r.metadata.content,e),l=El.N.fetch(r.metadata.content,e.onlyHeaders(),{additionalDatasets:t}),[c,d,p,u,m]=await Promise.all([r,s.params,s.options,l,s.searchs]);c.scriptRendered=!1;const f=d.map(((e,t)=>({params:e,items:m[t].rows,options:p[t]}))),h=(0,xn.uniq)(a).join("\n");return zl({pageView:c,itemLists:f,datasets:zl(zl({},u),n)},h.length&&{errors:`The following expressions are not valid properties:\n ${h}`})};var ql;function Wl(e,t,n,o){ql||(ql="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ql,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gl=class extends Ce{static async requestState(e){try{const{pageView:t,itemLists:n,datasets:o}=await Hl(e);return[ke.N.set("page/pageView",t),ke.N.set("page/itemLists",n),ke.N.set("page/datasets",o)]}catch(e){return[ke.N.set("page/error",e)]}}closeSidePanel(){(0,_.Qd)(this.context.store.dispatch,"library")((0,I.jh)())}componentDidMount(){this.closeSidePanel()}componentWillUnmount(){this.emptyState()}emptyState(){this.closeSidePanel(),this.context.store.dispatch(ke.N.unset("page/pageView")),this.context.store.dispatch(ke.N.unset("page/itemLists")),this.context.store.dispatch(ke.N.unset("page/datasets")),this.context.store.dispatch(ke.N.unset("page/error"))}setReduxState(e){this.context.store.dispatch(ke.N.set("page/pageView",e.page.pageView)),this.context.store.dispatch(ke.N.set("page/itemLists",e.page.itemLists)),this.context.store.dispatch(ke.N.set("page/datasets",e.page.datasets)),this.context.store.dispatch(ke.N.set("page/error",e.page.error))}render(){return Wl(Tl.S,{},void 0,Wl(Jl,{}),Wl(Or,{storeKey:"library"}),Wl(Pr,{storeKey:"library"}))}},Ql={get:e=>de.Z.get("relationtypes",e).then((e=>e.json.rows)),save:e=>de.Z.post("relationtypes",e).then((e=>e.json)),delete:e=>de.Z.delete("relationtypes",e).then((e=>e.json))};function Yl(e){return _e.Nw.load("template.data",e)}function Xl(e){return function(t){return Ql.delete(new pe.K({_id:e._id})).then((()=>{t(ke.N.remove("relationTypes",e))}))}}function ec(e){return function(){return as.Z.countByRelationType(new pe.K({relationtypeId:e._id})).then((e=>{if(e)return Promise.reject()}))}}var tc=n(90937),nc=n(13812),oc=n(11513);const rc={get:e=>de.Z.get("templates",e).then((e=>e.json.rows)),save:e=>de.Z.post("templates",e).then((e=>e.json)),setAsDefault:e=>de.Z.post("templates/setasdefault",e).then((e=>e.json)),countByThesauri:e=>de.Z.get("templates/count_by_thesauri",e).then((e=>e.json)),delete:e=>de.Z.delete("templates",e).then((e=>e.json))};var ic=n(84545),ac=n(99875);const sc=["localID"],lc=["localID","inserting"];function cc(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function pc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dc(Object(n),!0).forEach((function(t){uc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mc=e=>{const t=e.commonProperties&&e.commonProperties.length?e.commonProperties:ac.Z.get();return pc(pc({},e),{},{commonProperties:t.map((e=>pc(pc({},e),{},{localID:(0,ic.Z)()}))),properties:e.properties.map((e=>pc(pc({},e),{},{localID:(0,ic.Z)()})))})};function fc(){return e=>{e(_e.Nw.reset("template.data")),e(_e.Nw.setInitial("template.data"))}}function hc(e={},t){return(n,o)=>{const r=o().template.data.properties.slice(0),i=void 0!==t?t:r.length,a=function(e,t){const n=t;return n.localID=(0,ic.Z)(),"select"!==t.type&&"multiselect"!==t.type||(n.content=e().thesauris.get(0).get("_id")),"relationship"===t.type&&(n.inherit=!1,n.content=""),"nested"===t.type&&(n.nestedProperties=[{key:"",label:""}]),n}(o,e);r.splice(i,0,a),n(_e.Nw.change("template.data.properties",r))}}function vc(e,t){return n=>{n(_e.Nw.load(`template.data.properties[${e}].nestedProperties`,t))}}function yc(e){return t=>{t(_e.Nw.change(`template.data.properties[${e}].inserting`,null))}}function bc(e){return t=>{t(_e.Nw.remove("template.data.properties",e)),t(_e.Nw.resetErrors("template.data"))}}function gc(e,t){return n=>{n(_e.Nw.move("template.data.properties",e,t))}}function Sc(e){let t=(e=>{const t=e.commonProperties.map((e=>{const{localID:t}=e;return cc(e,sc)})),n=e.properties.map((e=>{const{localID:t,inserting:n}=e,o=cc(e,lc);return o.inherit&&!o.content&&(o.inherit=!1),o}));return pc(pc({},e),{},{properties:n,commonProperties:t})})(e);return n=>(n({type:oc.rx}),rc.save(new pe.K(t)).then((e=>{t=mc(e),n({type:oc.X8,data:t}),n(ke.N.update("templates",t)),n(_e.Nw.merge("template.data",t)),n(y.J.notify("Saved successfully.","success"))})).catch((t=>{throw n({type:oc.X8,data:e}),t})))}function wc(e,t){return n=>{n(_e.Nw.change(`template.data${e}`,t))}}function Nc(e){return t=>Ql.save(new pe.K(e)).then((e=>{t({type:"RELATION_TYPE_SAVED"}),t(ke.N.push("relationTypes",e)),t(y.J.notify((0,g.t)("System","RelationType saved",null,!1),"success"))}))}var Oc,Pc=n(24198),Cc=n(29573);function kc(e,t,n,o){Oc||(Oc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Oc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _c extends r.Component{constructor(e){super(e),this.state={active:!1},this.onButtonClick=this.onButtonClick.bind(this),this.onBlur=this.onBlur.bind(this),this.onColorChange=this.onColorChange.bind(this)}onColorChange({hex:e}){const{onChange:t}=this.props;t(e)}onButtonClick(){this.setState((e=>({active:!e.active})))}onBlur(){this.setState({active:!1})}render(){const{active:e}=this.state,{value:t,defaultValue:n}=this.props;return kc("div",{className:"ColorPicker"},void 0,kc("div",{className:"ColorPicker__button",style:{backgroundColor:t||n},onClick:this.props.disabled?()=>{}:this.onButtonClick}),e&&kc("div",{className:"ColorPicker__popover"},void 0,kc("div",{className:"ColorPicker__cover",onClick:this.onBlur}),kc(Pc.e8,{color:t||n,colors:Cc.D,onChangeComplete:this.onColorChange})))}}_c.defaultProps={value:"",defaultValue:"",disabled:!1};const jc=_c;function Ic(e){return{type:oc.bU,id:e}}const Dc=(0,Lt.P1)(((e,t)=>e.template.formState.$form.errors[`properties.${t.index}.label.required`]),((e,t)=>e.template.formState.$form.errors[`properties.${t.index}.label.duplicated`]),((e,t)=>e||t));var Tc;function Ec(e,t,n,o){Tc||(Tc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Tc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xc="Properties with the same label but different thesauri as content are not allowed.",Ac="Relationship properties with the same label but different relationship types are not allowed.",$c="Properties with the same label but incompatible types are not allowed.",Rc="Properties with the same label but incompatible inherited types are not allowed.",Fc=e=>e.inheritType?e.inheritType[0].toUpperCase()+e.inheritType.slice(1):"",Lc=e=>e.typeConflict||e.relationConflict||e.inheritConflict,Jc=e=>e.contentConflict?xc:"";class Zc extends r.Component{render(){const{templateProperty:e}=this.props,t=e.type,n=e.contentConflict&&e.thesaurusName;return Ec("tr",{className:"property-atributes is-active"},void 0,Ec("td",{},void 0,Ec(C.JO,{icon:"file"})," ",e.template),Ec("td",{className:Lc(e)?"conflict":"",title:(o=e,o.inheritConflict?Rc:o.relationConflict?Ac:o.typeConflict?$c:"")},void 0,Lc(e)&&Ec(C.JO,{icon:"exclamation-triangle"})," ",Ec(C.JO,{icon:ca[t]||"fa fa-font"})," ",(e=>e.type[0].toUpperCase()+e.type.slice(1))(e),e.relationTypeName&&` (${e.relationTypeName})`,Fc(e)&&` (Inherit: ${Fc(e)})`),Ec("td",{className:e.contentConflict?"conflict":"",title:Jc(e)},void 0,n&&Ec(C.JO,{icon:"exclamation-triangle"}),e.thesaurusName&&Ec(C.JO,{icon:"book"}),e.thesaurusName));var o}}var Mc;function Vc(e,t,n,o){Mc||(Mc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Mc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(n),!0).forEach((function(t){Kc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Bc extends r.Component{static findProperty(e,t){return t.reduce(((t,n)=>{var o;return t||(null===(o=n.properties)||void 0===o?void 0:o.find((t=>t._id===e)))}),void 0)}getRelationTypeName(e){const t=e?this.props.relationTypes.toJS().find((t=>t._id===e)):void 0;return t?t.name:void 0}getThesauriName(e){const t=e?this.props.thesauris.toJS().find((t=>t._id===e)):void 0;return t?t.name:void 0}findSameLabelProperties(e,t){return t.filter((e=>e._id!==this.props.templateId&&e.properties)).map((t=>{const n=(t.properties||[]).find((t=>t.label.trim().toLowerCase()===e.trim().toLowerCase()));return n?{template:t.name,property:n}:{template:void 0}})).filter((e=>void 0!==e.template))}render(){const{type:e,content:t,relationType:n,inherit:o,label:i,templates:a}=this.props,s=a.toJS(),l=Bc.findProperty(null==o?void 0:o.property,s),c=this.findSameLabelProperties(i,s).map((o=>{var r;const{property:i}=o,a=Bc.findProperty(null===(r=i.inherit)||void 0===r?void 0:r.property,s);return zc(zc({},o),{},{typeConflict:!(0,Da._)(e).includes(i.type),relationConflict:n&&i.relationType!==n,contentConflict:i.content!==t,type:i.type,relationTypeName:this.getRelationTypeName(i.relationType),thesaurusName:this.getThesauriName(i.content),inheritConflict:(null==l?void 0:l.type)!==(null==a?void 0:a.type),inheritType:null==a?void 0:a.type})})),d=[{template:`${this.props.templateName} (this template)`,type:e,relationTypeName:this.getRelationTypeName(n),thesaurusName:this.getThesauriName(t),typeConflict:!1,contentConflict:!1,relationConflict:!1,inheritConflict:!1,inheritType:null==l?void 0:l.type},...c],p=d.find((e=>e.thesaurusName));return r.createElement(r.Fragment,null,Vc("label",{className:"suggestions-label"},void 0,Vc(g.vN,{},void 0,"Properties from other templates in the collection using the same label")),Vc("table",{className:"table"},void 0,Vc("thead",{},void 0,Vc("tr",{},void 0,Vc("th",{},void 0,Vc(g.vN,{},void 0,"Template")),Vc("th",{},void 0,Vc(g.vN,{},void 0,"Type")),p&&Vc("th",{},void 0,Vc(g.vN,{},void 0,"Thesauri"),"/",Vc(g.vN,{},void 0,"Entity")))),Vc("tbody",{},void 0,d.map(((e,t)=>Vc(Zc,{templateProperty:e},t))))))}}const Hc=(0,c.connect)((function(e,t){const n=e.template.data.properties[t.index],{relationTypes:o}=e;return{templates:e.templates,thesauris:e.thesauris,relationTypes:o,templateName:e.template.data.name,templateId:e.template.data._id,type:n.type,filter:n.filter,label:n.label,content:n.content,relationType:n.relationType,inherit:n.inherit}}))(Bc);var qc;function Wc(e,t,n,o){qc||(qc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:qc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Gc=({children:e,model:t,label:n})=>Wc(_e.gN,{model:t},void 0,Wc("label",{className:"property-label",htmlFor:`test${t}`},void 0,Wc("input",{id:`test${t}`,type:"checkbox"})," ",Wc(g.vN,{translationKey:n},void 0,n)),e);Gc.defaultProps={children:""};const Qc=Gc;var Yc,Xc=n(96959);function ed(e,t,n,o){Yc||(Yc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Yc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class td extends r.Component{render(){const{index:e,filter:t,type:n,canBeFilter:o}=this.props;return ed("div",{},void 0,ed(Qc,{label:"Hide label",model:`template.data.properties[${e}].noLabel`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{},void 0,"This property will be shown without the label."))),ed(Qc,{label:"Required property",model:`template.data.properties[${e}].required`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{},void 0,"You won't be able to save an entity if this property is empty."))),ed(Qc,{label:"Show in cards",model:`template.data.properties[${e}].showInCard`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{},void 0,"This property will appear in the library cards as part of the basic info."))),o&&ed("div",{className:"inline-group"},void 0,ed(Qc,{label:"Use as filter",model:`template.data.properties[${e}].filter`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{translationKey:"Property as filter description"},void 0,"This property will be used for filtering the library results. When properties match in equal name and field type with other entity types, they will be combined for filtering."))),t&&r.createElement(r.Fragment,null,ed(Qc,{label:"Default filter",model:`template.data.properties[${e}].defaultfilter`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{translationKey:"Property as default filter description"},void 0,"Use this property as a default filter in the library. When there are no entity types selected, this property will show as a default filter for your collection."))),["text","date","numeric","select"].includes(n)&&ed(Qc,{label:"Priority sorting",model:`template.data.properties[${e}].prioritySorting`},void 0,ed(Xc.Z,{},void 0,ed(g.vN,{translationKey:"Priority sorting description"},void 0,"Properties marked as priority sorting will be used as default sorting criteria. If more than one property is marked as priority sorting the system will try to pick-up the best fit. When listing mixed template types, the system will pick-up the best combined priority sorting."))))),ed(Hc,{index:e}))}}td.defaultProps={canBeFilter:!0,filter:!1};const nd=(0,c.connect)((function({template:e},t){return{filter:e.data.properties[t.index].filter}}))(td);var od;function rd(e,t,n,o){od||(od="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:od,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class id extends r.Component{render(){const{index:e,labelHasError:t,type:n,canBeFilter:o}=this.props;return rd("div",{},void 0,rd("div",{className:"form-group"+(t?" has-error":"")},void 0,rd("label",{},void 0,rd(g.vN,{},void 0,"Name")),rd(_e.gN,{model:`template.data.properties[${e}].label`},void 0,rd("input",{className:"form-control"}))),"geolocation"===n&&rd("div",{className:"geolocation-grouping-alert"},void 0,rd(C.JO,{icon:"info-circle"}),rd("p",{},void 0,rd(g.vN,{},void 0,"Adjacent geolocation properties will render on the same map"),".")),rd(nd,{index:e,type:n,canBeFilter:o}))}}id.defaultProps={canBeFilter:!0,labelHasError:!1};const ad=(0,c.connect)((function(e,t){return{labelHasError:Dc(e,t)}}))(id);var sd;function ld(e,t,n,o){sd||(sd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:sd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function dd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(n),!0).forEach((function(t){pd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ud extends r.Component{static getDerivedStateFromProps(e,t){return{warning:Boolean(t.initialContent!==e.content)}}static contentValidation(){return{required:e=>""!==e.trim()}}constructor(e){super(e),this.state={warning:!1,initialContent:e.content}}render(){const{index:e,type:t,labelHasError:n,contentRequiredError:o,templateId:r}=this.props,i=this.props.thesauris.toJS(),a=(0,xn.orderBy)(i.filter((e=>e._id!==r&&"template"!==e.type)).map((e=>dd(dd({},e),{},{name:(0,g.t)(e._id,e.name,null,!1)}))),"name");return ld("div",{},void 0,ld("div",{className:"form-group"+(n?" has-error":"")},void 0,ld("label",{},void 0,ld(g.vN,{},void 0,"Label")),ld(_e.gN,{model:`template.data.properties[${e}].label`},void 0,ld("input",{className:"form-control"}))),ld("div",{className:o?"form-group has-error":"form-group"},void 0,ld("label",{},void 0,ld(g.vN,{},void 0,"Select list"),ld("span",{className:"required"},void 0,"*")),this.state.warning&&ld(bt.v3,{inline:!0},void 0,ld(g.vN,{},void 0,"All entities and documents that have already this property assigned will loose its current value")),ld(De.Ph,{model:`template.data.properties[${e}].content`,options:a,optionsLabel:"name",optionsValue:"_id"})),ld(nd,{index:e,type:t}))}}ud.defaultProps={labelHasError:!1,contentRequiredError:!1,templateId:"",content:""};const md=(0,c.connect)((function(e,t){const{template:n,thesauris:o}=e;return{labelHasError:Dc(e,t),contentRequiredError:n.formState.$form.errors[`properties.${t.index}.content.required`]&&n.formState.$form.submitFailed,templateId:n.data._id,thesauris:o,content:n.data.properties[t.index].content}}))(ud);var fd;function hd(e,t,n,o){fd||(fd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:fd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class vd extends r.Component{static contentValidation(){return{required:e=>e&&""!==e.trim()}}constructor(e){super(e),this.state={inherit:e.showInheritSelect},this.onInheritChange=this.onInheritChange.bind(this),this.onInheritTypeChange=this.onInheritTypeChange.bind(this)}onInheritChange(){const{index:e}=this.props;this.state.inherit&&this.props.resetFormValue(`template.data.properties[${e}].inherit.property`),this.props.resetFormValue(`template.data.properties[${e}].filter`),this.setState((e=>({inherit:!e.inherit})))}onInheritTypeChange(){const{index:e}=this.props;this.props.resetFormValue(`template.data.properties[${e}].filter`)}render(){const{index:e,type:t,labelError:n,relationTypeError:o,templates:r,relationTypes:i,templateId:a,showInheritOption:s,templateProperties:l,inheritSelectPropertyType:c}=this.props,d=r.toJS().filter((e=>e._id!==a)),p=n?"form-group has-error":"form-group",u=!this.state.inherit||this.state.inherit&&!["image","geolocation","preview","media","link"].includes(c);return hd("div",{},void 0,hd("div",{className:p},void 0,hd("label",{htmlFor:"label"},void 0,hd(g.vN,{},void 0,"Label")),hd(_e.gN,{model:`template.data.properties[${e}].label`},void 0,hd("input",{id:"label",className:"form-control"}))),hd("div",{className:o?"form-group has-error":"form-group"},void 0,hd("label",{},void 0,hd(g.vN,{},void 0,"Relationship"),hd("span",{className:"required"},void 0,"*")),hd(De.Ph,{model:`template.data.properties[${e}].relationType`,options:i.toJS(),optionsLabel:"name",validators:vd.contentValidation(),optionsValue:"_id"})),hd("div",{className:"form-group"},void 0,hd("label",{},void 0,hd(g.vN,{},void 0,"Entities")),hd(De.Ph,{model:`template.data.properties[${e}].content`,options:d,optionsLabel:"name",placeholder:"Any entity or document",optionsValue:"_id"})),s&&hd("div",{},void 0,hd("label",{className:"property-label",htmlFor:`inherit${e}`},void 0,hd("input",{id:`inherit${e}`,type:"checkbox",checked:this.state.inherit,onChange:this.onInheritChange})," ",hd(g.vN,{},void 0,"Inherit property")),hd(Xc.Z,{},void 0,hd(g.vN,{},void 0,"This property will be inherited from the related entities and shown as metadata of this type of entities."))),this.state.inherit&&hd("div",{className:"form-group"},void 0,hd(De.Ph,{model:`template.data.properties[${e}].inherit.property`,options:l,onChange:this.onInheritTypeChange,optionsLabel:"label",optionsValue:"_id"})),this.state.inherit&&"geolocation"===c&&hd("div",{className:"geolocation-grouping-alert"},void 0,hd(C.JO,{icon:"info-circle"}),hd("p",{},void 0,hd(g.vN,{},void 0,"Adjacent geolocation properties will render on the same map"),".")),hd(nd,{canBeFilter:u,index:e,type:t}))}}vd.defaultProps={labelError:!1,relationTypeError:!1,showInheritOption:!1,showInheritSelect:!1,templateId:null,inheritSelectPropertyType:null};const yd=(0,Lt.P1)((e=>e.templates),((e,t)=>e.template.formState.properties[t.index].content?e.template.formState.properties[t.index].content.value:null),((e,t)=>{const n=e.find((e=>e.get("_id")===t));return n?n.get("properties").toJS():[]})),bd=(0,Lt.P1)(yd,((e,t)=>{var n;return null===(n=e.template.data.properties[t.index].inherit)||void 0===n?void 0:n.property}),((e,t)=>{const n=e.find((e=>e._id===t));return n&&n.type}));const gd=(0,c.connect)((function(e,t){var n,o;const{template:r,templates:i,relationTypes:a}=e,s=yd(e,t);return{labelError:r.formState.$form.errors[`properties.${t.index}.label.required`]||r.formState.$form.errors[`properties.${t.index}.label.duplicated`],relationTypeError:r.formState.$form.errors[`properties.${t.index}.relationType.required`]&&r.formState.$form.submitFailed,showInheritOption:Boolean(r.formState.properties[t.index].content&&s.length),showInheritSelect:Boolean((null===(n=r.formState.properties[t.index].inherit)||void 0===n||null===(o=n.property)||void 0===o?void 0:o.value)&&s.length),inheritSelectPropertyType:bd(e,t),templateProperties:s,templateId:r.data._id,templates:i,relationTypes:a}}),(function(e){return(0,k.bindActionCreators)({resetFormValue:e=>_e.Nw.reset(e)},e)}))(vd);var Sd,wd=n(8229);function Nd(e,t,n,o){Sd||(Sd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Sd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Od extends r.Component{constructor(e){super(e),e.setNestedProperties(e.index,Object.keys(wd.Z))}render(){const{index:e,type:t,labelHasError:n}=this.props;return Nd("div",{},void 0,Nd("div",{className:"form-group"+(n?" has-error":"")},void 0,Nd("label",{},void 0,Nd(g.vN,{},void 0,"Label")),Nd(_e.gN,{model:`template.data.properties[${e}].label`},void 0,Nd("input",{className:"form-control"}))),Nd(_e.gN,{model:`template.data.properties[${e}].required`},void 0,Nd("input",{id:`required${this.props.index}`,type:"checkbox"})," ",Nd("label",{className:"property-label",htmlFor:`required${this.props.index}`},void 0,Nd(g.vN,{},void 0,"Required property"),Nd("span",{className:"property-help"},void 0,Nd(C.JO,{icon:"question-circle"}),Nd("div",{className:"property-description"},void 0,Nd(g.vN,{},void 0,"You won't be able to save an entity if this property is empty."))))),Nd(nd,{index:e,type:t}))}}Od.defaultProps={labelHasError:!1};const Pd=(0,c.connect)((function(e,t){return{labelHasError:Dc(e,t)}}),(function(e){return(0,k.bindActionCreators)({setNestedProperties:vc},e)}))(Od);var Cd;function kd(e,t,n,o){Cd||(Cd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _d extends r.Component{render(){return kd("label",{className:"property-label",htmlFor:this.props.htmlFor},void 0,kd(g.vN,{},void 0,"Priority sorting"),kd("span",{className:"property-help"},void 0,kd(C.JO,{icon:"question-circle"}),kd("div",{className:"property-description"},void 0,kd(g.vN,{translationKey:"Priority sorting description"},void 0,"Properties marked as priority sorting will be used as default sorting criteria. If more than one property is marked as priority sorting the system will try to pick-up the best fit. When listing mixed template types, the system will pick-up the best combined priority sorting."))))}}const jd=(0,c.connect)()(_d);var Id;function Dd(e,t,n,o){Id||(Id="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Id,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Td extends r.Component{getZeroIndex(){const{index:e,data:t}=this.props;return e+t.commonProperties.length}renderTitleField(){const{index:e,formState:t}=this.props;let n="form-group";const o=`commonProperties.${this.getZeroIndex()}.label`,r=t.$form.errors[`${o}.required`],i=t.$form.errors[`${o}.duplicated`];return(r||i)&&(n+=" has-error"),Dd("div",{className:n},void 0,Dd("label",{htmlFor:`label${e}`},void 0,Dd(g.vN,{},void 0,"Name")),Dd(_e.gN,{model:`template.data.commonProperties[${this.getZeroIndex()}].label`},void 0,Dd("input",{id:`label${e}`,className:"form-control"})))}render(){const{index:e,data:t}=this.props,n=t.commonProperties[this.getZeroIndex()];return Dd("div",{},void 0,"title"===n.name&&this.renderTitleField(),Dd(_e.gN,{model:`template.data.commonProperties[${this.getZeroIndex()}].prioritySorting`},void 0,Dd("input",{id:`prioritySorting${e}`,type:"checkbox"})," ",Dd(jd,{htmlFor:`prioritySorting${e}`})),"title"===n.name&&Dd(Qc,{label:"Generated ID",model:`template.data.commonProperties[${this.getZeroIndex()}].generatedId`},void 0,Dd(Xc.Z,{},void 0,Dd(g.vN,{},void 0,"A generated ID will be the default title."))))}}const Ed=(0,c.connect)((function({template:e}){return{data:e.data,formState:e.formState}}))(Td);var xd;function Ad(e,t,n,o){xd||(xd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:xd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $d extends r.Component{render(){const{index:e,canShowInCard:t,helpText:n,canSetStyle:o,canBeRequired:r,labelHasError:i}=this.props;return Ad("div",{},void 0,Ad("div",{className:"form-group"+(i?" has-error":"")},void 0,Ad("label",{},void 0,Ad(g.vN,{},void 0,"Name")),Ad(_e.gN,{model:`template.data.properties[${e}].label`},void 0,Ad("input",{className:"form-control"}))),n&&Ad("div",{className:"protip"},void 0,Ad(C.JO,{icon:"lightbulb"}),Ad("span",{},void 0,n)),Ad(Qc,{label:"Hide label",model:`template.data.properties[${e}].noLabel`},void 0,Ad(Xc.Z,{},void 0,Ad(g.vN,{},void 0,"This property will be shown without the label."))),Ad(Qc,{label:"Full width",model:`template.data.properties[${e}].fullWidth`},void 0,Ad(Xc.Z,{},void 0,Ad(g.vN,{},void 0,"This property will be shown using all the width available."))),r&&Ad(Qc,{label:"Required property",model:`template.data.properties[${e}].required`},void 0,Ad(Xc.Z,{},void 0,Ad(g.vN,{},void 0,"You won't be able to save an entity if this property is empty."))),t&&Ad(Qc,{label:"Show in cards",model:`template.data.properties[${e}].showInCard`},void 0,Ad(Xc.Z,{},void 0,Ad(g.vN,{},void 0,"This property will appear in the library cards as part of the basic info."))),o&&(e=>Ad("div",{},void 0,Ad("div",{className:"form-group"},void 0,Ad("label",{},void 0,Ad(g.vN,{},void 0,"Style")),Ad(De.Ph,{model:`template.data.properties[${e}].style`,options:[{_id:"contain",name:"Fit"},{_id:"cover",name:"Fill"}],optionsLabel:"name",optionsValue:"_id"})),Ad("div",{className:"protip"},void 0,Ad("p",{},void 0,Ad("b",{},void 0,Ad(g.vN,{},void 0,"Fit"))," ",Ad(g.vN,{translationKey:"Multimedia fit description"},void 0,"will show the entire media inside the container."),Ad("br",{}),Ad("b",{},void 0,Ad(g.vN,{},void 0,"Fill"))," ",Ad(g.vN,{translationKey:"Multimedia fill description"},void 0,"will attempt to fill the container, using it's entire width. In cards, cropping is likely to occur.")))))(e),Ad(Hc,{index:e}))}}$d.defaultProps={canShowInCard:!0,canSetStyle:!0,canBeRequired:!0,labelHasError:!1,helpText:""};const Rd=(0,c.connect)((function(e,t){return{labelHasError:Dc(e,t)}}))($d);var Fd;function Ld(e,t,n,o){Fd||(Fd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Fd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Jd=(e,t,n)=>{const o=e+t.commonProperties.length;return Boolean(n.$form.errors[`properties.${e}.label.duplicated`])||Boolean(n.$form.errors[`commonProperties.${o}.label.duplicated`])};class Zd extends r.Component{renderForm(){const{type:e,index:t}=this.props;let n=Ld(ad,{type:e,index:t});return this.props.isCommonProperty?Ld(Ed,{index:t,type:e}):("relationship"===e&&(n=Ld(gd,{index:t,type:e})),"select"!==e&&"multiselect"!==e||(n=Ld(md,{index:t,type:e})),"nested"===e&&(n=Ld(Pd,{index:t,type:e})),"media"!==e&&"image"!==e&&"preview"!==e||(n=Ld(Rd,{type:e,index:t,canSetStyle:"image"===e||"preview"===e,canBeRequired:"preview"!==e})),"geolocation"!==e&&"link"!==e||(n=Ld(ad,{type:e,index:t,canBeFilter:!1})),n)}render(){const{label:e,connectDragSource:t,isDragging:n,connectDropTarget:o,uiState:i,index:a,localID:s,inserting:l,hasErrors:c,submitFailed:d}=this.props,{editingProperty:p}=i.toJS();let u="list-group-item";(n||l)&&(u+=" dragging"),c&&d&&(u+=" error");const m=ca[this.props.type]||"font",f=p===s,h=Ld("div",{className:u},void 0,Ld("span",{className:"property-name"},void 0,Ld(C.JO,{icon:this.props.isCommonProperty?"lock":"bars",fixedWidth:!0}),Ld(C.JO,{icon:m,fixedWidth:!0}),null!==e?e:Ld(or,{propertyLabel:(0,Lt.P1)((e=>e.template.data.properties[this.props.index]?e.template.data.properties[this.props.index].label:""),(e=>e))},void 0,(({propertyLabel:e})=>e))),Ld("div",{className:"list-group-item-actions"},void 0,this.props.isLabelDuplicated&&Ld("span",{className:"validation-error"},void 0,Ld(C.JO,{icon:"exclamation-triangle"})," ",Ld(g.vN,{},void 0,"Duplicated label")),this.props.isRelationDuplicated&&Ld("span",{className:"validation-error"},void 0,Ld(C.JO,{icon:"exclamation-triangle"}),Ld(g.vN,{},void 0,"Cannot use 'any entity or document' if another relationship of the same type is already with a specific entity.")),!this.props.syncedTemplate&&r.createElement(r.Fragment,null,Ld("button",{type:"button",className:"btn btn-default btn-xs property-edit",onClick:()=>this.props.editProperty(f?null:s)},void 0,Ld(C.JO,{icon:"pencil-alt"})," ",Ld(g.vN,{},void 0,"Edit")),!this.props.isCommonProperty&&Ld("button",{type:"button",className:"btn btn-danger btn-xs property-remove",onClick:()=>this.props.removeProperty("RemovePropertyModal",a)},void 0,Ld(C.JO,{icon:"trash-alt"})," ",Ld(g.vN,{},void 0,"Delete")))));return this.props.isCommonProperty?Ld("li",{},void 0,h,Ld($n.Z,{if:f&&!n},void 0,Ld("div",{className:"propery-form"+(p===s?" expand":"")},void 0,this.renderForm()))):o(Ld("li",{},void 0,t(h),Ld($n.Z,{if:f&&!n},void 0,Ld("div",{className:"propery-form"+(p===s?" expand":"")},void 0,this.renderForm()))))}}Zd.defaultProps={label:null,submitFailed:!1,hasErrors:!1,isLabelDuplicated:!1,isRelationDuplicated:!1,syncedTemplate:!1};const Md={hover(e,t){const n=t.getItem().index,o=e.index,r=t.getItem();if(e.localID===r.editingProperty&&e.editProperty(null),void 0===n)return r.inserting=!0,r.index=0,void e.addProperty({label:r.label,type:r.type,inserting:!0},0);n!==o&&(r.alreadyReordered?r.alreadyReordered=!1:(e.reorderProperty(n,o),r.index=o,r.alreadyReordered=!0))}},Vd=(0,tc.GR)(["METADATA_PROPERTY","METADATA_OPTION"],Md,(e=>({connectDropTarget:e.dropTarget()})))(Zd),Ud={beginDrag:e=>({index:e.index,label:e.label,type:e.type,editingProperty:e.uiState.get("editingProperty")}),endDrag(e,t){const n=t.getItem();e.editProperty(n.editingProperty)}},zd=(0,tc.Ej)("METADATA_PROPERTY",Ud,((e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()})))(Vd);const Kd=(0,c.connect)((({template:e},t)=>({uiState:e.uiState,hasErrors:Object.keys(e.formState.$form.errors||{}).reduce(((n,o)=>n||((e,t,n,o)=>{const r=t+o.commonProperties.length,[i,a]=e.split(".");return"commonProperties"===i?a===r.toString()&&n:a===t.toString()&&!n})(o,t.index,t.isCommonProperty,e.data)&&e.formState.$form.errors[o]),!1),isLabelDuplicated:Jd(t.index,e.data,e.formState),isRelationDuplicated:Boolean(e.formState.$form.errors[`properties.${t.index}.relationType.duplicated`]),submitFailed:e.formState.$form.submitFailed})),(function(e){return(0,k.bindActionCreators)({removeProperty:br,reorderProperty:gc,addProperty:hc,editProperty:Ic},e)}))(zd);var Bd;function Hd(e,t,n,o){Bd||(Bd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Bd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class qd extends r.Component{confirm(){this.props.hideModal("RemovePropertyModal"),this.props.removeProperty(this.props.propertyBeingDeleted)}render(){return Hd(B.Z,{isOpen:this.props.isOpen||!1,type:"danger",zIndex:99},void 0,Hd(B.Z.Body,{},void 0,Hd("h4",{},void 0,Hd(g.vN,{},void 0,"Confirm deletion")),Hd("p",{},void 0,Hd(g.vN,{translationKey:"Property delete warning"},void 0,"Deleting a template property will delete this metadata information on all documents using this template.")),Hd("p",{},void 0,Hd(g.vN,{},void 0,"Change will take effect after saving the template"))),Hd(B.Z.Footer,{},void 0,Hd("button",{type:"button",className:"btn btn-default cancel-button",onClick:()=>this.props.hideModal("RemovePropertyModal")},void 0,Hd(g.vN,{},void 0,"Cancel")),Hd("button",{type:"button",className:"btn btn-danger confirm-button",onClick:()=>this.confirm()},void 0,Hd(g.vN,{},void 0,"Delete Property"))))}}const Wd=(0,c.connect)((e=>{const t=e.modals.toJS().RemovePropertyModal;return{propertyBeingDeleted:t,isOpen:"number"==typeof t}}),(function(e){return(0,k.bindActionCreators)({hideModal:gr,removeProperty:bc},e)}))(qd);var Gd=n(42283);const Qd="THESAURI_SAVED",Yd={get:e=>de.Z.get("thesauris",e).then((e=>e.json.rows)),getThesauri:e=>de.Z.get("dictionaries",e).then((e=>e.json.rows)),getModelStatus:e=>de.Z.get("models",e).then((e=>e.json)),getModelTrainStatus:e=>de.Z.get("models/train",e).then((e=>e.json)),trainModel:e=>de.Z.post("models/train",e).then((e=>e.json)),save:e=>de.Z.post("thesauris",e).then((e=>e.json)),delete:e=>de.Z.delete("thesauris",e).then((e=>e.json))};var Xd,ep=n(45398),tp=n(13996);function np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function op(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?np(Object(n),!0).forEach((function(t){rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):np(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ip(e){return t=>Yd.save(new pe.K(e)).then((e=>{t({type:Qd}),pi.h((0,g.t)("System","Thesaurus saved",null,!1),"success")(t),t(_e.Nw.change("thesauri.data",e))}))}function ap(e,t){return async n=>{try{const o={Accept:"application/json","X-Requested-With":"XMLHttpRequest"},r={thesauri:JSON.stringify(e)},i=await(0,tp.c)("thesauris",r,o,t);n({type:Qd}),pi.h((0,g.t)("System","Data imported",null,!1),"success")(n),n(_e.Nw.change("thesauri.data",i))}catch(e){pi.h((0,g.t)("System",e.error,null,!1),"danger")(n)}}}function sp(){return(e,t)=>{let n=t().thesauri.data.values.slice(0);n=(0,ep.Y)(n,{property:"label"}),n=n.map((e=>op(op({},e),e.values?{values:(0,ep.Y)(e.values.slice(0),{property:"label"})}:{}))),e(_e.Nw.change("thesauri.data.values",n))}}function lp(e,t){return(n,o)=>{const r=o().thesauri.data.values.slice(0),i=function(e){const t=[...e],n=t.reduce(((e,n,o)=>!n.label&&o<t.length?e.concat([o]):e),[]);if(n.length>1)return null;if(1===n.length){const e=n[0],o=t[e];t.splice(e,1),t.push(o)}return t}(e);if(i){if(void 0!==t){if(function(e){return e.some((e=>e.values))}(i))return;return r[t]=op(op({},r[t]),{},{values:i}),void n(_e.Nw.change("thesauri.data.values",r))}var a;if(a=e,!r.some((e=>!!e.values&&!a.some((t=>t.id===e.id)))))n(_e.Nw.change("thesauri.data.values",i))}}}function cp(e){return(t,n)=>{const o=n().thesauri.data.values.slice(0);void 0!==e?(o[e]=op({},o[e]),o[e].values=o[e].values.slice(0),o[e].values.push({label:"",id:(0,ic.Z)()})):o.push({label:"",id:(0,ic.Z)()}),t(_e.Nw.change("thesauri.data.values",o))}}function dp(){return(e,t)=>{const n=t().thesauri.data.values.slice(0),o=n.length-1,r={label:"",id:(0,ic.Z)(),values:[{label:"",id:(0,ic.Z)()}]};n[o].values?n.push(r):n[o]=r,e(_e.Nw.change("thesauri.data.values",n))}}function pp(e,t){return(n,o)=>{const r=o().thesauri.data.values.slice(0);"number"==typeof t?(r[t]=op({},r[t]),r[t].values=r[t].values.slice(0),r[t].values.splice(e,1)):r.splice(e,1),n(_e.Nw.change("thesauri.data.values",r))}}function up(e,t,n,o){Xd||(Xd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mp=(0,c.connect)((e=>({thesauri:e.thesauris})),(e=>(0,k.bindActionCreators)({thesaurusSave:ip},e)))((({thesaurusSave:e,thesauri:t})=>{var n,o;const[i,a]=(0,r.useState)(!1),{register:s,handleSubmit:l,errors:c}=(0,Gd.cI)({mode:"onSubmit"});return r.createElement(r.Fragment,null,up("button",{type:"button",className:"btn btn-default",onClick:()=>a(!0)},void 0,up(C.JO,{icon:"book"}),up("span",{className:"btn-label"},void 0,up(g.vN,{translationKey:"Add thesaurus"},void 0,"Add thesaurus"))),up(B.Z,{isOpen:i,type:"content",className:"new-thesaurus-modal"},void 0,up(B.Z.Header,{},void 0,up("h3",{},void 0,up(g.vN,{translationKey:"Add thesaurus"},void 0,"Add thesaurus")),up("p",{className:"description"},void 0,up(g.vN,{translationKey:"Add thesaurus modal description"},void 0,"After creation you can go into Settings -> Thesauri to add items"))),up("form",{},void 0,up(B.Z.Body,{},void 0,up("label",{htmlFor:"thesaurusInput"},void 0,up(g.vN,{translationKey:"Thesaurus"},void 0,"Thesaurus")),r.createElement("input",{type:"text",name:"thesaurus",id:"thesaurusInput",ref:s({required:!0,validate:{duplicated:e=>(e=>!(null!=t&&t.find((t=>"template"!==(null==t?void 0:t.get("type"))&&(null==t?void 0:t.get("name"))===e))))(e)}}),autoComplete:"off"}),"required"===(null===(n=c.thesaurus)||void 0===n?void 0:n.type)&&up("p",{className:"error",role:"alert"},void 0,up(g.vN,{translationKey:"This field is required"},void 0,"This field is required")),"duplicated"===(null===(o=c.thesaurus)||void 0===o?void 0:o.type)&&up("p",{className:"error",role:"alert"},void 0,up(g.vN,{translationKey:"Duplicated name"},void 0,"Duplicated name"))),up(B.Z.Footer,{},void 0,up("button",{type:"button",className:"btn",onClick:()=>a(!1)},void 0,up(g.vN,{translationKey:"Cancel"},void 0,"Cancel")),up("button",{type:"button",className:"btn btn-success",onClick:l((t=>{const n={name:t.thesaurus,values:[]};e(n),a(!1)}))},void 0,up(g.vN,{translationKey:"Save"},void 0,"Save"))))))}));var fp;function hp(e,t,n,o){fp||(fp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:fp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vp=(0,c.connect)((e=>({relationshipTypes:e.relationTypes})),(e=>(0,k.bindActionCreators)({relationshipTypeSave:Nc},e)))((({relationshipTypeSave:e,relationshipTypes:t})=>{var n,o;const[i,a]=(0,r.useState)(!1),{register:s,handleSubmit:l,errors:c}=(0,Gd.cI)({mode:"onSubmit"});return r.createElement(r.Fragment,null,hp("button",{type:"button",className:"btn btn-default",onClick:()=>a(!0)},void 0,hp(C.JO,{icon:"exchange-alt"}),hp("span",{className:"btn-label"},void 0,hp(g.vN,{translationKey:"Add relationship type"},void 0,"Add relationship type"))),hp(B.Z,{isOpen:i,type:"content",className:"new-relationshipType-modal"},void 0,hp(B.Z.Header,{},void 0,hp("h3",{},void 0,hp(g.vN,{translationKey:"Add relationship type"},void 0,"Add relationship type"))),hp("form",{},void 0,hp(B.Z.Body,{},void 0,hp("label",{htmlFor:"relationshipTypeInput"},void 0,hp(g.vN,{translationKey:"Relationship"},void 0,"Relationship")),r.createElement("input",{type:"text",name:"relationshipType",id:"relationshipTypeInput",ref:s({required:!0,validate:{duplicated:e=>(e=>!(null!=t&&t.find((t=>(null==t?void 0:t.get("name"))===e))))(e)}}),autoComplete:"off"}),"required"===(null===(n=c.relationshipType)||void 0===n?void 0:n.type)&&hp("p",{className:"error",role:"alert"},void 0,hp(g.vN,{translationKey:"This field is required"},void 0,"This field is required")),"duplicated"===(null===(o=c.relationshipType)||void 0===o?void 0:o.type)&&hp("p",{className:"error",role:"alert"},void 0,hp(g.vN,{translationKey:"Duplicated name"},void 0,"Duplicated name"))),hp(B.Z.Footer,{},void 0,hp("button",{type:"button",className:"btn",onClick:()=>a(!1)},void 0,hp(g.vN,{translationKey:"Cancel"},void 0,"Cancel")),hp("button",{type:"button",className:"btn btn-success",onClick:l((t=>{const n={name:t.relationshipType,properties:[]};e(n),a(!1)}))},void 0,hp(g.vN,{translationKey:"Save"},void 0,"Save"))))))}));var yp;function bp(e,t,n,o){yp||(yp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:yp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gp=({children:e,toggled:t=!1,onToggleOff:n=(()=>{}),onToggleOn:o=(()=>{})})=>{const[i,a]=(0,r.useState)(t);return r.createElement(r.Fragment,null,bp("div",{className:"toggle-children-button"},void 0,bp(C.CO,{onClick:()=>{i?n():o(),a(!i)},checked:i})),bp("div",{className:"toggle-children-children",style:{display:i?"block":"none"}},void 0,e))};var Sp;function wp(e,t,n,o){Sp||(Sp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Sp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Np=(0,c.connect)((({pages:e},t)=>({pages:(null==e?void 0:e.filter((e=>e.get("entityView"))))||[],selectedPage:t.selectedPage})),(e=>(0,k.bindActionCreators)({loadPages:pl,updateValue:wc},e)))((({pages:e,loadPages:t,selectedPage:n,updateValue:o})=>((0,r.useEffect)((()=>{t()}),[]),wp("div",{},void 0,wp("label",{},void 0,e.size>0?(0,g.t)("System","Display entity view from page"):(0,g.t)("System","There are no pages enabled for entity view"),wp(bt.Ch,{icon:"info-circle",position:"right"},void 0,(0,g.t)("System","Entities can be displayed in a custom page. For that, a custom page needs to be created in Pages, and then selected here."))),e.size>0&&wp(gp,{toggled:Boolean(n),onToggleOff:()=>o(".entityViewPage","")},void 0,wp(De.Ph,{model:".entityViewPage",optionsValue:"sharedId",optionsLabel:"title",options:e.toJS()}))))));function Op(e,t){return{required:e=>e&&""!==e.trim(),duplicated:n=>!e.find((e=>e._id!==t&&e.name.trim().toLowerCase()===n.trim().toLowerCase()))}}function Pp(e,t){return n=>{if(!n[e][t])return!0;const{label:o}=n[e][t];return o&&""!==o.trim()}}function Cp(e,t){return n=>{if(!n[e][t])return!0;return function(e,{properties:t,commonProperties:n}){const o=n.find((e=>"title"===e.name));return(o?[o,...t]:t||[]).reduce(((t,n)=>{const o=(n._id||n.localID)===(e._id||e.localID),r=n.label.trim().toLowerCase()!==e.label.trim().toLowerCase();return t&&(o||r)}),!0)}(n[e][t],n)}}function kp(e,t,n,o){const r={"":{},name:Op(n,o)},i=t.findIndex((e=>"title"===e.name));return i>=0&&(r[""][`commonProperties.${i}.label.required`]=Pp("commonProperties",i),r[""][`commonProperties.${i}.label.duplicated`]=Cp("commonProperties",i)),e.forEach(((e,t)=>{r[""][`properties.${t}.label.required`]=Pp("properties",t),r[""][`properties.${t}.label.duplicated`]=Cp("properties",t),r[""][`properties.${t}.content.required`]=e=>{if(!e.properties[t]||"select"!==e.properties[t].type||"multiselect"!==e.properties[t].type)return!0;const{content:n}=e.properties[t];return n&&""!==n.trim()},r[""][`properties.${t}.relationType.required`]=e=>{if(!e.properties[t]||"relationship"!==e.properties[t].type)return!0;const{relationType:n}=e.properties[t];return n&&""!==n.trim()},r[""][`properties.${t}.relationType.duplicated`]=e=>{if(!e.properties[t]||"relationship"!==e.properties[t].type)return!0;return function(e,t){return(t||[]).reduce(((t,n)=>{const o=(n._id||n.localID)===(e._id||e.localID),r=!n.relationType||n.relationType!==e.relationType,i=n.content===e.content,a=Boolean(e.content&&""!==e.content.trim());return t&&(o||r||i||!i&&a)}),!0)}(e.properties[t],e.properties)}})),r}function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_p.apply(this,arguments)}var jp;function Ip(e,t,n,o){jp||(jp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:jp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Dp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Tp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dp(Object(n),!0).forEach((function(t){Ep(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ep(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xp=(e,t)=>t.data.color?t.data.color:Cc.D[e.size%Cc.D.length];class Ap extends r.Component{constructor(e){super(e),Ep(this,"confirmation",{templateConflict:{title:"Template conflict",key:"Mapping conflict error",text:"A reindex of your collection is necessary. The reason may vary\n       -- from certain changes made to a template's property to new fields\n       that need to be populated across entities.\n       This process will not negatively affect the data in your collection.\n       It can last a few minutes and some parts of your collection might take\n       some time to reappear in the Library, but this is temporary. Do you want to continue?"},largeNumberOfEntities:{title:"Lengthy reindex process",key:"Template with a long number of entities",text:"The template has changed and the associated entities will be re-indexed,\n      this process may take several minutes, do you want to continue?"}}),Ep(this,"onSubmit",(async e=>{var t;const n=Tp({},e);if("relationType"===this.props.environment&&(n.commonProperties=void 0),n.properties=null===(t=n.properties)||void 0===t?void 0:t.map((e=>{const t=Tp({},e);return t.label=e.label.trim(),t})),n._id){const e=await function(e){return da.Z.countByTemplate(new pe.K({templateId:e._id}))}(n);if(e>=3e4)return this.confirmAndSaveTemplate(n,"largeNumberOfEntities")}try{await this.props.saveTemplate(n)}catch(e){if(409===e.status)return this.confirmAndSaveTemplate(n,"templateConflict")}})),this.onSubmit=this.onSubmit.bind(this),this.onSubmitFailed=this.onSubmitFailed.bind(this)}onSubmitFailed(){this.props.notify((0,g.t)("System","The template contains errors",null,!1),"danger")}confirmAndSaveTemplate(e,t){return this.context.confirm({accept:()=>{try{this.props.saveTemplate(Tp(Tp({},e),{},{reindex:"templateConflict"===t}))}catch(t){if(409===t.status)return this.confirmAndSaveTemplate(e,"templateConflict")}},cancel:()=>{},title:this.confirmation[t].title,messageKey:this.confirmation[t].key,message:this.confirmation[t].text,type:"success",acceptLabel:"Confirm",zIndex:99})}render(){const{connectDropTarget:e,defaultColor:t,environment:n,syncedTemplate:o}=this.props,i=this.props.commonProperties||[];return Ip("div",{},void 0,Ip(Wd,{}),Ip(_e.l0,{model:"template.data",onSubmit:this.onSubmit,onSubmitFailed:this.onSubmitFailed,className:"metadataTemplate",validators:kp(this.props.properties,i,this.props.templates.toJS(),this.props._id)},void 0,"template"===n&&o&&Ip("div",{className:"metadataTemplate-sync"},void 0,Ip(C.JO,{icon:"exclamation-triangle"}),"  ",Ip(g.vN,{translationKey:"syncedTemplateEditorMessage"},void 0,"This template is synced from another instance. Only entity view page can be enabled.")),Ip("div",{className:"metadataTemplate-heading"},void 0,Ip(Jt.cw,{model:".name"},void 0,Ip(_e.gN,{model:".name"},void 0,Ip("input",{placeholder:"Template name",className:"form-control",disabled:o}))),t&&!("relationType"===n)&&Ip(_e.oT,{model:".color",component:jc,defaultValue:t,mapProps:{defaultValue:e=>e.defaultValue},disabled:o})),"template"===n&&r.createElement(r.Fragment,null,Ip("div",{className:"metadataTemplate-pageview"},void 0,Ip(Jt.cw,{model:".entityViewPage"},void 0,Ip(Np,{selectedPage:this.props.entityViewPage||""}))),e(Ip("ul",{className:"metadataTemplate-list list-group"},void 0,i.map(((e,t)=>r.createElement(Kd,_p({},e,{key:e.localID,localID:e.localID,index:t-i.length,syncedTemplate:o})))),this.props.properties.map(((e,t)=>Ip(Kd,{_id:e._id,type:e.type,inserting:e.inserting,localID:e.localID,index:t,syncedTemplate:o},e.localID))),!o&&Ip("div",{className:"no-properties"},void 0,Ip("span",{className:"no-properties-wrap"},void 0,Ip(C.JO,{icon:"clone"}),Ip(g.vN,{},void 0,"Drag properties here")))))),Ip("div",{className:"settings-footer remove-extra-nesting"},void 0,Ip("div",{className:"btn-cluster"},void 0,Ip(g.l3,{to:this.props.backUrl,className:"btn btn-default btn-plain"},void 0,Ip(C.JO,{icon:"arrow-left",directionAware:!0}),Ip("span",{className:"btn-label"},void 0,Ip(g.vN,{},void 0,"Back")))),"template"===n&&Ip("div",{className:"btn-cluster lg-margin-left-12 sm-order-1 sm-footer-extra-row"},void 0,Ip(mp,{}),Ip(vp,{})),Ip("div",{className:"btn-cluster content-right"},void 0,Ip(g.l3,{to:this.props.backUrl,className:"btn btn-default btn-extra-padding"},void 0,Ip("span",{className:"btn-label"},void 0,Ip(g.vN,{},void 0,"Cancel"))),Ip("button",{type:"submit",className:"btn btn-success save-template btn-extra-padding",disabled:!!this.props.savingTemplate},void 0,Ip("span",{className:"btn-label"},void 0,Ip(g.vN,{},void 0,"Save")))))))}}Ep(Ap,"contextTypes",{confirm:u().func}),Ep(Ap,"defaultProps",{notify:pi.h,saveTemplate:Sc,environment:"template",savingTemplate:!1,defaultColor:null,properties:[]});const $p={canDrop:()=>!0,drop(e,t){const n=t.getItem();return e.properties[n.index]?(e.inserted(n.index),{}):(e.addProperty({label:n.label,type:n.type},e.properties.length),{name:"container"})}},Rp=(0,tc.GR)("METADATA_OPTION",$p,(e=>({connectDropTarget:e.dropTarget()})))(Ap);const Fp=(0,c.connect)((({template:e,templates:t,relationTypes:n},o)=>{const r=o.relationType?"relationType":"template",i="relationType"===r?n:t;return{_id:e.data._id,commonProperties:e.data.commonProperties,properties:e.data.properties,entityViewPage:e.data.entityViewPage,syncedTemplate:e.data.synced,templates:i,savingTemplate:e.uiState.get("savingTemplate"),defaultColor:xp(t,e),environment:r}}),(function(e){return(0,k.bindActionCreators)({inserted:yc,addProperty:hc,setErrors:_e.Nw.setErrors,notify:y.J.notify},e)}),null,{withRef:!0})(Rp);function Lp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Jp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lp(Object(n),!0).forEach((function(t){Zp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mp(){return Mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Mp.apply(this,arguments)}var Vp;function Up(e,t,n,o){Vp||(Vp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Vp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class zp extends r.Component{constructor(e){super(e),this.addProperty=this.addProperty.bind(this)}addProperty(){const{disabled:e,label:t,type:n,addProperty:o}=this.props;e||o({label:(0,g.t)("System",`property ${n}`,t,!1),type:n})}render(){const{connectDragSource:e,label:t,disabled:n,type:o}=this.props,r=ca[o]||"font";return e(Up("li",{className:"list-group-item"+(n?" disabled":"")},void 0,Up("button",{type:"button",onClick:this.addProperty},void 0,Up(C.JO,{icon:"plus"})),Up("span",{},void 0,Up(C.JO,{icon:r})," ",Up(g.vN,{translationKey:`property ${o}`},void 0,t))))}}const Kp={beginDrag(e){let t=Mp({},e);return Jp(Jp({},t),{},{label:(0,g.t)("System",`property ${t.type}`,t.label,!1)})},canDrag:e=>!e.disabled,endDrag(e,t){const n=t.getItem();!t.getDropResult()&&n.index&&e.removeProperty(n.index)}},Bp=(0,tc.Ej)("METADATA_OPTION",Kp,(e=>({connectDragSource:e.dragSource()})))(zp);const Hp=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({removeProperty:bc,addProperty:hc},e)}),null,{withRef:!0})(Bp);var qp;function Wp(e,t,n,o){qp||(qp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:qp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Gp extends r.Component{componentWillUnmount(){this.props.resetTemplate()}render(){let e=this.props.saveTemplate,t="/settings/templates",n="document";return this.props.relationType&&(e=this.props.saveRelationType,t="/settings/connections",n="relationship"),Wp("div",{className:"metadata"},void 0,Wp("div",{className:"panel panel-default"},void 0,Wp("div",{className:"panel-heading"},void 0,Wp(g.vN,{},void 0,"Metadata creator")),Wp("div",{className:"panel-body"},void 0,Wp("div",{className:"row"},void 0,Wp("main",{className:"col-xs-12 col-sm-9"},void 0,Wp(Fp,{saveTemplate:e,backUrl:t,relationType:this.props.relationType})),"relationship"!==n&&!this.props.syncedTemplate&&Wp("aside",{className:"col-xs-12 col-sm-3"},void 0,Wp("div",{className:"metadataTemplate-constructor"},void 0,Wp("div",{},void 0,Wp("i",{},void 0,Wp(g.vN,{},void 0,"Properties"))),Wp("ul",{className:"list-group property-options-list"},void 0,Wp(Hp,{label:"Text",type:"text"}),Wp(Hp,{label:"Numeric",type:"numeric"}),Wp(Hp,{label:"Select",type:"select",disabled:this.props.noDictionaries}),Wp(Hp,{label:"Multi Select",type:"multiselect",disabled:this.props.noDictionaries}),"relationship"!==n&&Wp(Hp,{label:"Relationship",type:"relationship",disabled:this.props.noRelationtypes}),Wp(Hp,{label:"Date",type:"date"}),Wp(Hp,{label:"Date Range",type:"daterange"}),Wp(Hp,{label:"Multi Date",type:"multidate"}),Wp(Hp,{label:"Multi Date Range",type:"multidaterange"}),Wp(Hp,{label:"Rich Text",type:"markdown"}),Wp(Hp,{label:"Link",type:"link"}),Wp(Hp,{label:"Image",type:"image"}),"document"===n&&Wp(Hp,{label:"Preview",type:"preview"}),Wp(Hp,{label:"Media",type:"media"}),Wp(Hp,{label:"Geolocation",type:"geolocation"}),"cejil"===this.props.project&&Wp(Hp,{label:"Violated articles",type:"nested"}),Wp(Hp,{label:"Generated ID",type:"generatedid"})),this.props.noRelationtypes&&Wp("div",{className:"alert alert-warning"},void 0,Wp(g.vN,{translationKey:"No relationship types warning"},void 0,"Relationship fields can not be added untill you have at least one relationship type to select."))))))))}}Gp.defaultProps={relationType:!1,noRelationtypes:!0,noDictionaries:!0,project:"",syncedTemplate:!1},Gp.contextTypes={router:u().object};const Qp=(0,tc.Z5)(nc.PD)((0,c.connect)((({settings:e,relationTypes:t,thesauris:n,template:o},r)=>({project:e.collection.toJS().project,noRelationtypes:!t.size,noDictionaries:!n.size,syncedTemplate:!r.relationType&&o.data.synced})),(function(e){return(0,k.bindActionCreators)({resetTemplate:fc,saveTemplate:Sc,saveRelationType:Nc},e)}))(Gp));var Yp,Xp;function eu(e,t,n,o){Yp||(Yp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Yp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function tu(e,t,n,o){Xp||(Xp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var nu=n(36416),ou=n(82673);function ru(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ru(Object(n),!0).forEach((function(t){au(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ru(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function au(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}async function su(e,t,n,o){const[[r],[i,a,s,l]]=await Promise.all([da.Z.get(e),o?nu.yR(e,n):[[],{rows:[]},{},Ie().fromJS({})]]);return[ke.N.set("entityView/entity",r),nu.xv({relationships:{list:{sharedId:r.sharedId,entity:r,connectionsGroups:i,searchResults:a,sort:s,filters:l,view:"graph"}}}),...(0,Qo.loadFetchedInReduxForm)("entityView.entityForm",r,t)]}function lu(){return async(e,t)=>{var n;const o=t(),r=null===(n=o.oneUpReview.state)||void 0===n?void 0:n.toJS();if(r&&r.fullEdit&&!o.entityView.entityFormState.$form.pristine){const t=await da.Z.denormalize(new pe.K((0,fr.Q2)(ou.Z.filterBaseProperties(o.entityView.entityForm))));e(ke.N.set("entityView/entity",t))}e(ke.N.set("oneUpReview.state",iu(iu({},r),{},{fullEdit:!!r&&!r.fullEdit})))}}function cu(e,t){return async(n,o)=>{var r;const i=o(),a=null===(r=i.oneUpReview.state)||void 0===r?void 0:r.toJS();if(!a)return;if(t){const e=(0,fr.Q2)(ou.Z.filterBaseProperties(i.entityView.entityForm));await da.Z.save(new pe.K(e,a.requestHeaders))}const s=i.entityView.entity.get("sharedId"),l=Math.max(0,Math.min(i.library.documents.get("rows").findIndex((e=>e.get("sharedId")===s))+e,a.totalDocs-1));await async function(e,t,n,o){const r=t<o.totalDocs?n.library.documents.get("rows").get(t).get("sharedId"):"";[...r?await su(new pe.K({sharedId:r},o.requestHeaders),n.templates.toJS(),n,o.loadConnections):[],ke.N.set("oneUpReview.state",iu(iu({},o),{},{indexInDocs:t}))].forEach((t=>{e(t)}))}(n,l,i,a)}}function du(){return async(e,t)=>{var n;const o=null===(n=t().oneUpReview.state)||void 0===n?void 0:n.toJS();o&&(e(ke.N.set("oneUpReview.state",iu(iu({},o),{},{loadConnections:!o.loadConnections}))),await e(cu(0,!1)))}}var pu,uu=n(52949),mu=n(99052),fu=n(11062),hu=n(32211),vu=n(96739),yu=n(14003);function bu(){return{type:yu.v}}function gu(){return{type:yu.m}}function Su(e,t,n,o){pu||(pu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:pu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class wu extends r.Component{render(){let e=(r.Children.map(this.props.children,(e=>e))||[]).filter((e=>{const t=this.props.overrideShow&&this.props.show,n=e.type.name===this.props.type,o=e.type.WrappedComponent&&e.type.WrappedComponent.name===this.props.type;return t||n||o}));const t=`ContextMenu-${this.props.align||"bottom"}`;return e=r.Children.map(e,(e=>r.cloneElement(e,{active:this.props.open}))),Su("div",{className:`ContextMenu ${t}`,onMouseEnter:this.props.openMenu,onMouseLeave:this.props.closeMenu,onClick:this.props.closeMenu},void 0,e)}}const Nu=(0,c.connect)((e=>e.contextMenu.toJS()),(function(e){return(0,k.bindActionCreators)({openMenu:bu,closeMenu:gu},e)}))(wu);var Ou;function Pu(e,t,n,o){Ou||(Ou="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ou,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Cu extends r.Component{render(){const{panelIsOpen:e,openPanel:t,active:n}=this.props;return Pu("div",{className:n?"active":""},void 0,Pu($n.Z,{if:!e},void 0,Pu("div",{className:"btn btn-primary",onClick:e=>t(e)},void 0,Pu(C.JO,{icon:"columns"}))))}}Cu.defaultProps={active:!1};var ku,_u=n(18719),ju=n(99486),Iu=n(69474),Du=n(52173);function Tu(e,t,n,o){ku||(ku="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ku,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Eu extends r.Component{constructor(e){super(e),this.search=this.search.bind(this)}search(e){this.props.search(e.target.value)}render(){return Tu(Iu.Z,{value:this.props.searchTerm,onChange:this.search})}}const xu=(0,c.connect)((function({relationships:e}){return{searchTerm:e.searchTerm}}),(function(e){return(0,k.bindActionCreators)({search:Du.search},e)}))(Eu);var Au;function $u(e,t,n,o){Au||(Au="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Au,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ru extends r.Component{constructor(e){super(e),this.addEntity=this.addEntity.bind(this),this.newEntity=this.newEntity.bind(this)}addEntity(e,t){this.props.addEntity(this.props.hubIndex,this.props.rightRelationshipIndex,t)}newEntity(){this.props.selectConnection({metadata:{}}),this.props.loadInReduxForm("relationships.metadata",{metadata:{}},this.props.templates.toJS()),this.props.closePanel()}render(){const{uiState:e,searchResults:t}=this.props,n=Boolean(this.props.uiState.get("open"));return $u(On.Z,{open:n,className:"create-reference"},void 0,$u("div",{className:"sidepanel-header"},void 0,$u("h1",{},void 0,$u(g.vN,{},void 0,"Add entities / documents")),$u("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.props.closePanel},void 0,$u(C.JO,{icon:"times"}))),$u("div",{className:"sidepanel-body"},void 0,$u("div",{className:"search-box"},void 0,$u(xu,{})),$u(_u.Z,{results:t,searching:e.get("searching"),onClick:this.addEntity})),$u("div",{className:"sidepanel-footer"},void 0,$u("button",{type:"button",className:"btn btn-success",onClick:this.newEntity},void 0,$u(C.JO,{icon:"plus"}),$u("span",{className:"btn-label"},void 0,$u(g.vN,{},void 0,"Create Entity")))))}}const Fu=(0,c.connect)((({relationships:e,templates:t})=>({uiState:e.uiState,searchResults:e.searchResults,hubIndex:e.hubActions.getIn(["addTo","hubIndex"]),rightRelationshipIndex:e.hubActions.getIn(["addTo","rightRelationshipIndex"]),templates:t})),(function(e){return(0,k.bindActionCreators)({addEntity:Du.addEntity,closePanel:ju.sR,loadInReduxForm:Qo.loadInReduxForm,selectConnection:Du.selectConnection},e)}))(Ru);var Lu,Ju=n(21667),Zu=n(59276);function Mu(e,t,n,o){Lu||(Lu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Lu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Vu extends r.Component{constructor(e){super(e),this.state={copyFrom:!1,copyFromProps:[]},this.toggleCopyFrom=this.toggleCopyFrom.bind(this),this.onCopyFromSelect=this.onCopyFromSelect.bind(this),this.deleteDocument=this.deleteDocument.bind(this),this.saveEntity=this.saveEntity.bind(this),this.closeSidePanel=this.closeSidePanel.bind(this)}onCopyFromSelect(e){this.setState({copyFromProps:e})}async deleteDocument(){this.context.confirm({accept:async()=>{this.props.unselectConnection(),await Zu.h.delete(new pe.K({sharedId:this.props.entity.sharedId})),await this.props.reloadRelationships(this.props.parentSharedId)},title:"Confirm delete entity",message:"Are you sure you want to delete this entity?"})}async saveEntity(e,t){this.props.resetForm(t),this.props.unselectConnection();const{entity:n,errors:o}=await(0,cs.o)(e);this.props.updateRelationshipEntityData(n),Number.isInteger(this.props.hubIndex)&&(this.props.addEntity(this.props.hubIndex,this.props.rightRelationshipIndex,n,o),this.props.setAddToData(null,null))}toggleCopyFrom(){this.setState((e=>({copyFrom:!e.copyFrom})))}closeSidePanel(){return this.props.entityBeingEdited?this.props.resetForm("relationships.metadata"):this.props.unselectConnection()}renderForm(){const e=Mu(fr.n0,{model:"relationships.metadata",initialTemplateId:this.props.entity.template,templateId:this.props.formState.template,onSubmit:this.saveEntity,changeTemplate:this.props.changeTemplate,highlightedProps:this.state.copyFromProps});return this.state.copyFrom?Mu("div",{className:"tab-content tab-content-visible"},void 0,e,Mu(Ju.O,{originalEntity:this.props.formState,templates:this.props.templates,onSelect:this.onCopyFromSelect,formModel:"relationships.metadata",onCancel:this.toggleCopyFrom})):e}renderBody(){return this.props.entityBeingEdited?this.renderForm():Mu(fr.$o,{entity:this.props.entity,showTitle:!0,showType:!0})}render(){const e=this.state.copyFrom?"two-columns":"";return Mu(On.Z,{open:this.props.selectedConnection,className:`connections-metadata ${e}`},void 0,!this.state.copyFrom&&Mu("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.closeSidePanel},void 0,Mu(C.JO,{icon:"times"})),Mu("div",{className:"sidepanel-body"},void 0,this.renderBody()),Mu("div",{className:"sidepanel-footer"},void 0,!this.state.copyFrom&&Mu(fr.rJ,{data:Ie().fromJS(this.props.entity),delete:this.deleteDocument,formStatePath:"relationships.metadata",entityBeingEdited:this.props.entityBeingEdited,copyFrom:this.toggleCopyFrom,hideDelete:this.props.hubsBeingEdited,includeViewButton:!1})))}}Vu.contextTypes={confirm:u().func},Vu.defaultProps={selectedConnection:!1,entityBeingEdited:!1,hubsBeingEdited:!1,hubIndex:null,rightRelationshipIndex:null};const Uu=(0,Lt.P1)((e=>e.relationships.connection),(e=>e&&e.toJS?e.toJS():{metadata:{}}));const zu=(0,c.connect)((e=>{const t=Boolean(e.relationships.metadata.metadata);return{selectedConnection:Boolean(e.relationships.connection&&e.relationships.connection.get("_id")||t),entity:Uu(e),entityBeingEdited:t,hubsBeingEdited:Boolean(e.relationships.hubActions.get("editing")),templates:e.templates,formState:e.relationships.metadata,hubIndex:e.relationships.hubActions.getIn(["addTo","hubIndex"]),rightRelationshipIndex:e.relationships.hubActions.getIn(["addTo","rightRelationshipIndex"]),parentSharedId:e.relationships.list.sharedId}}),(function(e){return(0,k.bindActionCreators)({unselectConnection:Du.unselectConnection,updateRelationshipEntityData:Du.updateRelationshipEntityData,changeTemplate:fr.Nw.changeTemplate,addEntity:Du.addEntity,setAddToData:Du.setAddToData,resetForm:_e.Nw.reset,reloadRelationships:Du.reloadRelationships},e)}))(Vu),Ku=(0,Lt.P1)((e=>e.entityView.entity),(e=>null==e?void 0:e.toJS())),Bu=(0,Lt.P1)((e=>e.oneUpReview.state),(e=>null==e?void 0:e.toJS())),Hu=(0,Lt.P1)((e=>e.thesauris),(e=>e.filter((e=>!!e.get("enable_classification"))).map((e=>{var t,n;return null!==(t=null===(n=e.get("_id"))||void 0===n?void 0:n.toString())&&void 0!==t?t:""})).toJS())),qu=(0,Lt.P1)((e=>e.entityView.entityFormState.$form.pristine),(e=>e));var Wu;function Gu(e,t,n,o){Wu||(Wu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Wu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qu extends r.Component{renderNextButton(e,t){return Gu("button",{type:"button",onClick:()=>this.props.switchOneUpEntity(1,!0),className:`save-and-next ${e?"":"btn-success"} ${t}`},void 0,Gu(C.JO,{icon:"save-and-next"}),Gu("span",{className:"btn-label"},void 0,(0,g.t)("System","Save and go to next")))}render(){const{isPristine:e}=this.props,t=e?"btn btn-default btn-disabled":"btn btn-default";return Gu("div",{className:"content-footer"},void 0,Gu("button",{type:"button",onClick:()=>this.props.switchOneUpEntity(0,!1),className:`cancel-edit-metadata ${e?"":"btn-danger"} ${t}`},void 0,Gu(C.JO,{icon:"undo"}),Gu("span",{className:"btn-label"},void 0,(0,g.t)("System","Discard changes"))),Gu("button",{type:"button",onClick:()=>this.props.switchOneUpEntity(0,!0),className:`save-metadata ${t}`},void 0,Gu(C.JO,{icon:"save"}),Gu("span",{className:"btn-label"},void 0,(0,g.t)("System","Save document"))),this.renderNextButton(e,t))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qu,"defaultProps",{isPristine:!0,isLast:!1,thesaurusName:"",switchOneUpEntity:(e,t)=>{}});const Yu=(0,c.connect)((e=>({isPristine:qu(e)})),{switchOneUpEntity:cu})(Qu);var Xu,em=n(28151);function tm(e,t,n,o){Xu||(Xu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Xu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nm={entity:{},connectionsGroups:Ie().fromJS([]),templates:Ie().fromJS([]),mlThesauri:[],oneUpState:{},tab:"info",panelOpen:!0,selectedConnection:!1,closePanel:()=>{},showTab:e=>({}),connectionsChanged:()=>{},deleteConnection:e=>{},toggleOneUpLoadConnections:()=>{}};class om extends r.Component{mlProps(){var e,t;const{entity:n,mlThesauri:o,templates:r}=this.props;return(null!==(t=(null!==(e=r.find((e=>e.get("_id")===n.template)))&&void 0!==e?e:Ie().fromJS({})).get("properties"))&&void 0!==t?t:Ie().fromJS([])).filter((e=>{var t;return o.includes(null!==(t=e.get("content"))&&void 0!==t?t:"")})).map((e=>e.get("name"))).toJS()}render(){var e,t;const{entity:n,tab:o,selectedConnection:r,connectionsGroups:i,oneUpState:a,panelOpen:s}=this.props,l=null!=o?o:"info",c=i.reduce(((e,t)=>(t.get("templates").forEach((t=>{e.totalConnections+=t.get("count")})),e)),{totalConnections:0});return tm(On.Z,{className:`entity-connections entity-${this.props.tab}`,open:s&&!r},void 0,tm("div",{className:"sidepanel-header content-header-tabs"},void 0,tm("div",{className:"blank"}),tm(em.mQ,{selectedTab:l,handleSelect:e=>{this.props.showTab(e)}},void 0,tm("ul",{className:"nav nav-tabs"},void 0,tm("li",{},void 0,tm(em.fK,{to:"info",component:"div"},void 0,tm(C.JO,{icon:"info-circle"}),tm("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Info")))),tm("li",{},void 0,tm(em.fK,{to:"connections",component:"div"},void 0,tm(C.JO,{icon:"exchange-alt"}),tm("span",{className:"connectionsNumber"},void 0,c.totalConnections),tm("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Connections")))))),tm("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.props.closePanel},void 0,tm(C.JO,{icon:"times"}))),tm("div",{className:"sidepanel-body"},void 0,tm(em.mQ,{selectedTab:l},void 0,tm(em.I5,{for:"connections"===l?l:"none"},void 0,tm(hu.Bc,{connectionsGroups:i})),tm(em.I5,{for:"info"===l?l:"none"},void 0,tm(fr.n0,{id:"sidePanelMetadataForm",model:"entityView.entityForm",templateId:null!==(e=null===(t=n.template)||void 0===t?void 0:t.toString())&&void 0!==e?e:"",showSubset:this.mlProps(),version:"OneUp"})))),tm($n.Z,{if:"connections"===l},void 0,tm(or,{isPristine:qu},void 0,(({isPristine:e})=>tm("div",{className:"sidepanel-footer"},void 0,tm("button",{type:"button",onClick:()=>this.props.toggleOneUpLoadConnections(),className:e?"btn btn-default":"btn btn-default btn-disabled"},void 0,tm(C.JO,{icon:a.loadConnections?"times":"undo"}),tm("span",{className:"btn-label"},void 0,(0,g.t)("System",a.loadConnections?"Hide Connections":"Load Connections"))))))))}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(om,"defaultProps",nm);const rm=(0,c.connect)((e=>{var t;return{entity:Ku(e),connectionsGroups:e.relationships.list.connectionsGroups,selectedConnection:Boolean(e.relationships.connection&&e.relationships.connection.get("_id")),tab:e.entityView.uiState.get("tab"),oneUpState:null!==(t=Bu(e))&&void 0!==t?t:{},templates:e.templates,mlThesauri:Hu(e)}}),(function(e){return(0,k.bindActionCreators)({connectionsChanged:vu.connectionsChanged,deleteConnection:vu.deleteConnection,showTab:Ft.$1,toggleOneUpLoadConnections:du},e)}))(om);var im;function am(e,t,n,o){im||(im="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:im,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function sm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lm extends r.Component{backToThesaurus(){const{oneUpState:e,isPristine:t}=this.props;return e.reviewThesaurusName?am(g.l3,{to:`/settings/dictionaries/cockpit/${e.reviewThesaurusId}`,className:"btn btn-default",confirmTitle:t?"":"Confirm discard changes",confirmMessage:t?"":"There are unsaved changes. Are you sure you want to discard them and navigate away?"},void 0,am(C.JO,{icon:"arrow-left"}),am("span",{className:"btn-label"},void 0,(0,g.t)("System","Back to")," ",am("span",{},void 0,`'${e.reviewThesaurusName}'`))):null}navButtons(){const{oneUpState:e,isPristine:t}=this.props,n=e.indexInDocs>0?"":" btn-disabled",o=e.indexInDocs<e.totalDocs-1?"":" btn-disabled",r=t?e=>()=>this.props.switchOneUpEntity(e,!1):e=>()=>this.context.confirm({accept:()=>this.props.switchOneUpEntity(e,!1),title:"Confirm discard changes",message:"There are unsaved changes. Are you sure you want to discard them and switch to a different document?"});return am("span",{},void 0,am("button",{type:"button",onClick:r(-1),className:`btn btn-default${n}`},void 0,am(C.JO,{icon:"arrow-left"})),am("button",{type:"button",onClick:r(1),className:`btn btn-default${o}`},void 0,am(C.JO,{icon:"arrow-right"})))}render(){const{oneUpState:e}=this.props;return am("div",{className:"content-header-title"},void 0,this.backToThesaurus(),e.reviewThesaurusValues&&1===e.reviewThesaurusValues.length?am("span",{className:"large"},void 0,am("span",{className:"space8"}),(0,g.t)("System","Documents including suggestion:")," ",am("b",{},void 0,`'${e.reviewThesaurusValues[0]}'`),am("span",{className:"separator"})):am("span",{className:"large"},void 0,am("span",{className:"space8"}),(0,g.t)("System","Documents for custom filter"),am("span",{className:"separator"})),e.totalDocs?am("div",{},void 0,(0,g.t)("System","Document")," ",am("span",{},void 0,e.indexInDocs+1)," ",(0,g.t)("System","of")," ",am("span",{},void 0,e.totalDocs>=e.maxTotalDocs?">"+(e.totalDocs-1):`${e.totalDocs}`),am("span",{className:"space8"})):(0,g.t)("System","No Documents found"),this.navButtons())}}sm(lm,"defaultProps",{isPristine:!0,oneUpState:{},switchOneUpEntity:(e,t)=>{}}),sm(lm,"contextTypes",{confirm:u().func});const cm=(0,c.connect)((e=>{var t;return{isPristine:qu(e),oneUpState:null!==(t=Bu(e))&&void 0!==t?t:{}}}),(function(e){return(0,k.bindActionCreators)({switchOneUpEntity:cu,toggleOneUpFullEdit:lu},e)}))(lm);var dm;function pm(e,t,n,o){dm||(dm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:dm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function um(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mm={entity:{},relationships:Ie().fromJS([]),templates:Ie().fromJS([]),mlThesauri:[],oneUpState:{},tab:"info",connectionsChanged:()=>{},deleteConnection:e=>{},toggleOneUpFullEdit:()=>{}};class fm extends r.Component{constructor(e,t){super(e,t),this.state={panelOpen:!0},this.closePanel=this.closePanel.bind(this),this.openPanel=this.openPanel.bind(this),this.deleteConnection=this.deleteConnection.bind(this)}deleteConnection(e){"metadata"!==e.sourceType&&this.context.confirm({accept:()=>{this.props.deleteConnection(e)},title:"Confirm delete connection",message:"Are you sure you want to delete this connection?"})}closePanel(){this.setState({panelOpen:!1})}openPanel(){this.setState({panelOpen:!0})}nonMlProps(){var e,t;const{entity:n,mlThesauri:o,templates:r}=this.props;return(null!==(t=(null!==(e=r.find((e=>e.get("_id")===n.template)))&&void 0!==e?e:Ie().fromJS({})).get("properties"))&&void 0!==t?t:Ie().fromJS([])).filter((e=>{var t;return!o.includes(null!==(t=e.get("content"))&&void 0!==t?t:"")})).map((e=>e.get("name"))).toJS()}renderFullEditToggle(){const{oneUpState:e}=this.props;let t=()=>this.props.toggleOneUpFullEdit();return e.fullEdit||(t=()=>this.context.confirm({accept:()=>this.props.toggleOneUpFullEdit(),title:"Keep this in mind if you want to edit:",message:"Changes can't be undone after saving. Changing text fields may invalidate the suggestions."})),pm("button",{type:"button",onClick:t,className:e.fullEdit?"btn btn-default btn-toggle-on":"btn btn-default btn-toggle-off"},void 0,pm(C.JO,{icon:e.fullEdit?"toggle-on":"toggle-off"}),pm("span",{className:"btn-label"},void 0,pm(g.vN,{},void 0,"Full edit mode")))}render(){var e,t,n,o;const{entity:r,tab:i,relationships:a,oneUpState:s}=this.props,{panelOpen:l}=this.state,c=null!=i?i:"info";return pm("div",{className:"row flex"},void 0,pm(M.q,{},void 0,pm("title",{},void 0,r.title?r.title:"Entity")),pm("div",{className:"content-holder"},void 0,pm("main",{className:"content-main"},void 0,pm("div",{className:"content-header content-header-entity"},void 0,pm(cm,{}),this.renderFullEditToggle()),pm("div",{className:"entity-viewer"},void 0,pm(em.mQ,{selectedTab:c},void 0,pm(em.I5,{for:"info"===c||"attachments"===c?c:"none"},void 0,pm("div",{className:"entity-metadata"},void 0,pm($n.Z,{if:s.fullEdit},void 0,pm(fr.n0,{id:"fullEditMetadataForm",model:"entityView.entityForm",templateId:null!==(e=null===(t=r.template)||void 0===t?void 0:t.toString())&&void 0!==e?e:"",showSubset:[...this.nonMlProps(),"title"],version:"OneUp"})),pm($n.Z,{if:!s.fullEdit},void 0,pm("div",{},void 0,pm("div",{className:"content-header-title"},void 0,pm(bt.JO,{className:"item-icon item-icon-center",data:r.icon,size:"sm"}),pm("h1",{className:"item-name"},void 0,r.title),pm(bt.L2,{template:null!==(n=null===(o=r.template)||void 0===o?void 0:o.toString())&&void 0!==n?n:""}),r.published?"":pm(Xc.Z,{icon:"eye-slash"},void 0,pm(g.vN,{},void 0,"This entity is not public."))),pm(fr.$o,{relationships:a,entity:r,showTitle:!1,showType:!1,showSubset:this.nonMlProps()}),pm(mu.m,{files:r.documents,entity:r}),pm(uu.Fy,{attachments:r.attachments,parentId:r._id,parentSharedId:r.sharedId,isDocumentAttachments:Boolean(r.file),entityView:!0,processed:r.processed}))))),pm(em.I5,{for:"connections"},void 0,pm(hu.Z8,{deleteConnection:this.deleteConnection,searchCentered:!0,hideFooter:!0})))),pm($n.Z,{if:"connections"===c},void 0,pm("div",{className:"content-footer"},void 0,pm(is.ne,{}))),pm($n.Z,{if:"connections"!==c},void 0,pm(Yu,{isLast:s.indexInDocs===s.totalDocs-1,thesaurusName:s.reviewThesaurusValues[0]})),pm(Nu,{align:"bottom",overrideShow:!0,show:!l,className:"show-info-sidepanel-context-menu"},void 0,pm(Cu,{className:"show-info-sidepanel-menu",panelIsOpen:l,openPanel:this.openPanel}))),pm(rm,{panelOpen:l,closePanel:this.closePanel}),pm(fu.CJ,{className:"entity-create-connection-panel",containerId:r.sharedId,onCreate:this.props.connectionsChanged}),pm(Fu,{}),pm(zu,{})),pm(Xs.Z,{}))}}um(fm,"defaultProps",mm),um(fm,"contextTypes",{confirm:u().func});const hm=(0,c.connect)((e=>{var t;return{entity:Ku(e),relationships:e.entityView.entity.get("relationships"),tab:e.entityView.uiState.get("tab"),oneUpState:null!==(t=Bu(e))&&void 0!==t?t:{},templates:e.templates,mlThesauri:Hu(e)}}),(function(e){return(0,k.bindActionCreators)({connectionsChanged:vu.connectionsChanged,deleteConnection:vu.deleteConnection,toggleOneUpFullEdit:lu},e)}))(fm);var vm,ym=n(32368);function bm(e,t,n,o){vm||(vm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:vm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function gm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Sm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gm(Object(n),!0).forEach((function(t){wm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nm(e,t,n,o){var r,i;const a=[],s=Object.keys(null!==(r=null===(i=e.data)||void 0===i?void 0:i.filters)&&void 0!==r?r:{}).reduce(((t,n)=>{const r=n.startsWith("__")?n.substring(2):n;return n.startsWith("__")&&a.push(...e.data.filters[n].values.filter((e=>e&&!["any","missing"].includes(e)))),Sm(Sm({},t),o.reduce(((e,t)=>{const n=(t.properties||[]).find((e=>e.name===r));return!n||!n.content||n.type!==Da.D.select&&n.type!==Da.D.multiselect?e:Sm(Sm({},e),{},{[n.content]:!0})}),{}))}),{}),l=1===Object.keys(s).length?n.find((e=>e._id.toString()===Object.keys(s)[0])):null;return n.forEach((e=>{(e.values||[]).forEach((e=>{const t=a.findIndex((t=>t===e.id));t>=0&&(a[t]=e.label)}))})),{loaded:!0,fullEdit:!1,loadConnections:!1,indexInDocs:0,totalDocs:t,maxTotalDocs:5001,requestHeaders:e.headers,reviewThesaurusName:l?l.name:"",reviewThesaurusId:l?l._id.toString():"",reviewThesaurusValues:a}}const Om=(0,c.connect)((e=>({entity:e.entityView.entity,oneUpState:e.oneUpReview.state})))(class extends Ce{static async requestState(e,t){const n=e.set(Sm(Sm({},wn(e.data,t)),{},{limit:5001,select:["sharedId"],unpublished:!!e.data.unpublished,includeUnpublished:!!e.data.includeUnpublished,includeReviewAggregations:!0})),[o,r,i,a]=await Promise.all([rc.get(e.onlyHeaders()),Yd.getThesauri(e.onlyHeaders()),Ql.get(e.onlyHeaders()),tn.Z.search(n)]),s=a.rows.length?a.rows[0].sharedId:"";return[ke.N.set("relationTypes",i),e=>(0,_.Qd)(e,"library")((0,I.uz)()),e=>(0,_.Qd)(e,"library")((0,I.ku)(a)),ke.N.set("oneUpReview.state",Nm(n,a.rows.length,r,o)),...s?await su(e.set({sharedId:s}),o,t,!1):[]]}urlHasChanged(e){return e.location.query.q!==this.props.location.query.q}componentWillUnmount(){this.emptyState()}componentDidMount(){this.context.store.dispatch(Ft.$1("info"))}emptyState(){(0,_.Qd)(this.context.store.dispatch,"library")((0,I.uz)()),this.context.store.dispatch((0,ym.setReferences)([])),this.context.store.dispatch(ke.N.unset("entityView/entity")),this.context.store.dispatch(_e.Nw.reset("entityView.entityForm")),this.context.store.dispatch(nu.Zu()),ke.N.set("oneUpReview.state",{})}render(){const{entity:e,oneUpState:t}=this.props;return t&&t.get("loaded")&&(!t.get("totalDocs")||e&&e.get("_id"))?bm(hm,{}):bm(H.Z,{})}});var Pm;function Cm(e,t,n,o){Pm||(Pm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Pm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class km extends r.Component{render(){let e=this.props.open?this.props.hideFilters:this.props.showFilters,t=this.props.open?" is-active":"";return this.props.open&&this.props.metadataPanelIsOpen&&(e=this.props.unselectAllDocuments,t=""),!this.props.open&&this.props.metadataPanelIsOpen&&(e=()=>{this.props.showFilters(),this.props.unselectAllDocuments()}),Cm("a",{href:"#",className:`search-button btn ${t}`,onClick:e},void 0,Cm("div",{className:"searchButton-open"},void 0,Cm(C.JO,{icon:"funnel-filter"}),Cm("span",{},void 0,(0,g.t)("System","Search"),"...")))}}km.contextTypes={storeKey:u().string};const _m=(0,c.connect)((function(e,t){return{open:!1!==e[t.storeKey].ui.get("filtersPanel"),metadataPanelIsOpen:e[t.storeKey].ui.get("selectedDocuments").size>0}}),(function(e,t){return(0,k.bindActionCreators)({showFilters:I.rR,hideFilters:I.BP,unselectAllDocuments:I.jh},(0,_.Qd)(e,t.storeKey))}))(km);var jm,Im=n(43857),Dm=n(30743);function Tm(e,t,n,o){jm||(jm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:jm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Em=[{label:"Threshold",model:"threshold",min:.3,max:1,step:.01,minLabel:"Exploration",maxLabel:"Precision"},{label:"Minimum relevant sentences per document",model:"minRelevantSentences",min:1,max:50,step:1,minLabel:"",maxLabel:""}];const xm=(0,c.connect)((function({semanticSearch:e}){return{open:e.selectedDocument.isEmpty(),filtersValues:e.resultsFilters}}))((({open:e,filtersValues:t})=>Tm(On.Z,{open:e},void 0,Tm("div",{className:"sidepanel-body"},void 0,Tm("div",{className:"sidepanel-title"},void 0,(0,g.t)("System","Fine tune")),Tm(_e.l0,{model:"semanticSearch.resultsFilters"},void 0,Tm("div",{className:"view"},void 0,Em.map((e=>Tm("dl",{className:"metadata-type-text"},e.label,Tm("dt",{},void 0,(0,g.t)("System",e.label)," ",((e,t)=>"threshold"===e.model?`${(100*t[e.model]).toFixed(2)}%`:t[e.model])(e,t)),Tm("dd",{},void 0,Tm(De.Bc,{delay:200,model:`.${e.model}`,prefix:e.model,min:e.min,max:e.max,step:e.step,minLabel:(0,g.t)("System",e.minLabel),maxLabel:(0,g.t)("System",e.maxLabel)}))))))),Tm("div",{className:"semantic-search-help"},void 0,Tm("div",{className:"alert alert-info alert-vertical"},void 0,Tm(C.JO,{icon:"info-circle",size:"2x"}),Tm("p",{},void 0,Tm(g.vN,{translationKey:"Semantic search overview"},void 0,"Semantic search is a technique to provide contextual results. Its ability to capture concepts and word associations in human language enables the retrieval of related information such as synonyms, connected categories or entities, etc. .")),Tm("p",{},void 0,Tm(g.vN,{translationKey:"Semantic search threshold help"},void 0,"The threshold determines how close the results match the search concept. Move the slider to the right to narrow down the concept of the search query. The obtained results will be more precise. Move the slider to the left to more broaden the concept and explore related content.")),Tm("p",{},void 0,Tm(g.vN,{translationKey:"Semantic search minimum sentences help"},void 0,"Semantic search is applied to each sentence in a document. Filter the documents by the minimum number of sentences that exceed the threshold.")))))))),Am={fetchSearches:D.fetchSearches,setEditSearchEntities:D.setEditSearchEntities,editSearchEntities:D.editSearchEntities,selectSemanticSearchDocument:D.selectSemanticSearchDocument,unselectSemanticSearchDocument:D.unselectSemanticSearchDocument,submitNewSearch:D.submitNewSearch,showSemanticSearch:D.showSemanticSearch,hideSemanticSearch:D.hideSemanticSearch,deleteSearch:D.deleteSearch,stopSearch:D.stopSearch,resumeSearch:D.resumeSearch,registerForUpdates:D.registerForUpdates,updateSearch:D.updateSearch,addSearchResults:D.addSearchResults,getSearch:D.getSearch,getMoreSearchResults:D.getMoreSearchResults};const $m=(0,c.connect)((({semanticSearch:e,library:t,templates:n})=>({open:!e.selectedDocument.isEmpty(),doc:e.selectedDocument,references:t.sidepanel.references,tab:t.sidepanel.tab,docBeingEdited:!!Object.keys(t.sidepanel.metadata).length,searchTerm:t.search.searchTerm,formDirty:!t.sidepanel.metadataForm.$form.pristine,templates:n,formPath:"library.sidepanel.metadata",readOnly:!0,EntityForm:wr,storeKey:"library"})),(function(e,t){return(0,k.bindActionCreators)({loadInReduxForm:fr.Nw.loadInReduxForm,getDocumentReferences:I.hN,closePanel:Am.unselectSemanticSearchDocument,resetForm:()=>e=>{e(_e.Nw.setInitial(`${t.storeKey}.sidepanel.metadata`)),e(_e.Nw.reset(`${t.storeKey}.sidepanel.metadata`))},saveDocument:I.gv,deleteDocument:I.iH,searchSnippets:I.uO,deleteEntity:hr.Ks,showModal:Sr.actions.showModal,showTab:e=>ke.N.set("library.sidepanel.tab",e)},_.ZP.wrapDispatch(e,t.storeKey))}))(mr.GV);var Rm;function Fm(e,t,n,o){Rm||(Rm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Rm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Lm=(0,c.connect)()((()=>r.createElement(r.Fragment,null,Fm(xm,{storeKey:"library"}),Fm($m,{}))));var Jm,Zm=n(85072),Mm=n(19796);function Vm(e,t,n,o){Jm||(Jm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Jm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Um=(0,Lt.P1)((e=>e.templates),(e=>e.toJS())),zm=(0,Lt.P1)(Um,(e=>e.semanticSearch.multiedit),Zm.Z);class Km extends r.Component{constructor(e){super(e),this.close=this.close.bind(this),this.cancel=this.cancel.bind(this),this.save=this.save.bind(this),this.changeTemplate=this.changeTemplate.bind(this)}close(){this.props.resetForm(this.props.formKey),this.props.setEntities([])}metadataFieldModified(e){return!(this.props.formState.metadata[e].pristine||this.props.formState.metadata[e].$form&&this.props.formState.metadata[e].$form.pristine)}save(e){const{entities:t,template:n,formState:o,searchId:r}=this.props,i={metadata:{}};return Object.keys(e.metadata).forEach((t=>{this.metadataFieldModified(t)&&(i.metadata[t]=e.metadata[t])})),n.get("_id")&&(i.template=n.get("_id")),o.icon&&!o.icon.pristine&&(i.icon=e.icon),this.props.multipleUpdate(t,i).then((()=>{this.close(),this.props.getSearch(r)}))}changeTemplate(e,t){const n=this.props.entities.map((e=>e.set("template",t)));this.props.setEntities(n)}cancel(){const{confirm:e}=this.context;e({accept:()=>{this.close()},title:"Confirm",message:"Discard changes"})}renderEditingForm(){const{formKey:e,thesauris:t}=this.props;return r.createElement(r.Fragment,null,Vm("div",{className:"alert alert-warning"},void 0,Vm(C.JO,{icon:"exclamation-triangle",size:"2x"}),Vm("p",{},void 0,Vm(g.vN,{},void 0,"Warning: you are editing multiple entities. Fields marked with a")," ",Vm(C.JO,{icon:"exclamation-triangle"})," ",Vm(g.vN,{},void 0,"will be updated with the same value."))),Vm(Mm.ZP,{id:"multiEdit",model:e,onSubmit:this.save,thesauris:t,template:this.props.template,changeTemplate:this.changeTemplate,multipleEdition:!0}))}renderEditingButtons(){return r.createElement(r.Fragment,null,Vm("button",{type:"button",onClick:this.cancel,className:"cancel-edit-metadata btn btn-primary"},void 0,Vm(C.JO,{icon:"times"}),Vm("span",{className:"btn-label"},void 0,(0,g.t)("System","Cancel"))),Vm("button",{type:"submit",form:"multiEdit",className:"btn btn-success"},void 0,Vm(C.JO,{icon:"save"}),Vm("span",{className:"btn-label"},void 0,(0,g.t)("System","Save"))))}render(){const{open:e}=this.props;return Vm(On.Z,{open:e,className:"multi-edit"},void 0,Vm("div",{className:"sidepanel-header"},void 0,Vm("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.close},void 0,Vm(C.JO,{icon:"times"}))),Vm("div",{className:"sidepanel-body"},void 0,this.renderEditingForm()),Vm("div",{className:"sidepanel-footer"},void 0,this.renderEditingButtons()))}}Km.defaultProps={template:null,open:!1},Km.contextTypes={confirm:u().func};const Bm=(0,c.connect)((e=>{const t=e.semanticSearch.multiedit;return{template:zm(e),thesauris:e.thesauris,entities:t,open:Boolean(t.size),formState:e.semanticSearch.multipleEditForm}}),(function(e,t){return(0,k.bindActionCreators)({loadForm:Qo.loadTemplate,resetForm:Qo.resetReduxForm,setEntities:D.setEditSearchEntities,getSearch:D.getSearch,multipleUpdate:Qo.multipleUpdate},(0,_.Qd)(e,t.storeKey))}))(Km);function Hm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function qm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hm(Object(n),!0).forEach((function(t){Wm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gm;function Qm(e,t,n,o){Gm||(Gm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Gm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ym(e){const t=e.getIn(["semanticSearch","totalResults"]),n=e.getIn(["semanticSearch","numRelevant"]),o=100*e.getIn(["semanticSearch","relevantRate"]);return Qm("div",{className:"item-metadata"},void 0,Qm("div",{className:"metadata-type-text"},void 0,Qm("div",{},void 0,Qm(g.vN,{},void 0,"Sentences above threshold")),Qm("div",{},void 0,n," ",Qm(g.vN,{},void 0,"out of")," ",t," (",o.toFixed(2),"%)")))}class Xm extends r.Component{constructor(e){super(e),this.state={page:1},this.onClick=this.onClick.bind(this),this.onLoadMoreClick=this.onLoadMoreClick.bind(this),this.multiEdit=this.multiEdit.bind(this)}shouldComponentUpdate(e){const{items:t,filters:n,isEmpty:o,searchTerm:r}=this.props;return!Ie().is(e.items,t)||Boolean(e.filters.threshold!==n.threshold)||Boolean(e.filters.minRelevantSentences!==n.minRelevantSentences)||Boolean(e.isEmpty!==o)||Boolean(e.searchTerm!==r)}componentDidUpdate(e){const{filters:t,searchId:n}=this.props;t.minRelevantSentences===e.filters.minRelevantSentences&&t.threshold===e.filters.threshold||this.props.getSearch(n,t)}onClick(e,t){this.props.selectSemanticSearchDocument(t)}onLoadMoreClick(){const{searchId:e,filters:t}=this.props,{page:n}=this.state,o=30*n,r=qm(qm({},t),{},{skip:o,limit:30});this.setState({page:n+1}),this.props.getMoreSearchResults(e,r)}multiEdit(){const{editSearchEntities:e,filters:t,searchId:n}=this.props;e(n,t)}render(){const{items:e,isEmpty:t,searchTerm:n,totalCount:o,query:i,searchId:a}=this.props;return Qm("div",{className:"row panels-layout"},void 0,t&&r.createElement(r.Fragment,null,Qm("p",{},void 0,Qm(g.vN,{},void 0,"Search not found")),Qm(M.q,{},void 0,Qm("title",{},void 0,(0,g.t)("System","Search not found",null,!1)))),!t&&r.createElement(r.Fragment,null,Qm(M.q,{},void 0,Qm("title",{},void 0,`${n} - Semantic search results`)),Qm("main",{className:"semantic-search-results-viewer document-viewer with-panel"},void 0,Qm("div",{},void 0,Qm("h3",{},void 0,Qm(g.vN,{},void 0,"Semantic search"),":"," ",Qm(Ir,{searchTerm:n,query:i})),Qm("button",{type:"button",onClick:this.multiEdit,className:"btn btn-success edit-semantic-search"},void 0,Qm(C.JO,{icon:"pencil-alt"})," ",Qm(g.vN,{},void 0,"Edit all documents matching this criteria"))),Qm("div",{className:"documents-counter"},void 0,Qm("span",{className:"documents-counter-label"},void 0,Qm("b",{},void 0,o)," ",Qm(g.vN,{},void 0,"documents"))),Qm(Im.aO,{},void 0,e.map((e=>Qm(Dm.ZP,{doc:e,onClick:this.onClick,additionalText:Ym(e)},e.get("sharedId"))))),Qm("p",{className:"col-sm-12 text-center documents-counter"},void 0,Qm("b",{},void 0," ",e.size," ")," ",Qm(g.vN,{},void 0,"of"),Qm("b",{},void 0," ",o," ")," ",Qm(g.vN,{},void 0,"documents")),Qm("div",{className:"col-sm-12 text-center documents-counter"},void 0,Qm("button",{onClick:this.onLoadMoreClick,type:"button",className:"btn btn-default btn-load-more"},void 0,Qm("span",{"no-translate":!0},void 0,"30")," ",Qm(g.vN,{},void 0,"x more")))),Qm(Lm,{}),Qm(Bm,{searchId:a,formKey:"semanticSearch.multipleEdit"})))}}Xm.defaultProps={searchTerm:"",items:Ie().fromJS([]),query:{searchTerm:""},searchId:""};const ef=(0,c.connect)((e=>{const{search:t}=e.semanticSearch,n=t.get("searchTerm"),o=t.get("results"),r=e.semanticSearch.resultsFilters,i=0===t.size,{_id:a,query:s}=t.toJS();return{searchId:a,query:s||{searchTerm:""},totalCount:i?0:t.get("documents").size,searchTerm:n,filters:r,items:o,isEmpty:i}}),(function(e){return(0,k.bindActionCreators)(D,e)}))(Xm);var tf,nf=n(6504);function of(e,t,n,o){tf||(tf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:tf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rf={save:e=>de.Z.post("users",e).then((e=>e.json)),new:e=>de.Z.post("users/new",e).then((e=>e.json)),currentUser:e=>de.Z.get("user",e).then((e=>e.json)),get:e=>de.Z.get("users",e).then((e=>e.json)),getById:e=>de.Z.get("users",e).then((e=>e.json[0])),delete:e=>de.Z.delete("users",e).then((e=>e.json))};var af,sf=n(49510);function lf(e,t,n,o){af||(af="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:af,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cf=({userGroups:e,handleSelect:t,handleAddGroup:n,className:o})=>{const[i,a]=(0,r.useState)("");return lf("div",{className:"group-list"},void 0,lf("table",{className:o},void 0,lf("thead",{},void 0,lf("tr",{},void 0,lf("th",{},void 0,lf(g.vN,{},void 0,"Groups")),lf("th",{align:"center"},void 0,lf(g.vN,{},void 0,"Members")))),lf("tbody",{},void 0,e.map((e=>lf("tr",{className:i===e._id?"selected":"",onClick:()=>(e=>{var n;a(null===(n=e._id)||void 0===n?void 0:n.toString()),t(e)})(e)},e._id,lf("td",{},void 0,e.name),lf("td",{align:"center"},void 0,lf(sf.D,{color:"white"},void 0,r.createElement(r.Fragment,null,lf(C.JO,{icon:"users"}),` ${e.members.length}`)))))))),lf("div",{className:`settings-footer ${o}`},void 0,lf("button",{type:"button",className:"btn btn-default",onClick:()=>{a(void 0),n()}},void 0,lf(C.JO,{icon:"plus"}),lf("span",{className:"btn-label"},void 0,lf(g.vN,{},void 0,"Add group")))))};function df(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function pf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?df(Object(n),!0).forEach((function(t){uf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):df(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mf(){return async e=>{const t=await(async e=>(await de.Z.get("usergroups",e)).json)(new pe.K);e(ke.N.set("userGroups",t))}}function ff(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function hf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ff(Object(n),!0).forEach((function(t){vf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ff(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yf(){return async e=>{const t=await rf.get(new pe.K);e(ke.N.set("users",t))}}var bf,gf=n(27446);function Sf(e,t,n,o){bf||(bf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:bf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function wf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Nf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wf(Object(n),!0).forEach((function(t){Of(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Of(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Pf=({userGroup:e,users:t,userGroups:n,opened:o,closePanel:i,onSave:a,onDelete:s})=>{const[l,c]=(0,r.useState)(e.members.map((e=>e.refId?e.refId.toString():"")));const{register:d,handleSubmit:p,errors:u}=(0,Gd.cI)({defaultValues:e}),m=(e=>e.sort(((e,t)=>(e.username||"").localeCompare(t.username||""))))(t);return Sf(bt.hs,{open:o},void 0,Sf("div",{className:"sidepanel-header"},void 0,Sf(g.vN,{},void 0,(e._id?"Edit":"Add")+" Group")),Sf("div",{className:"sidepanel-body"},void 0,Sf("form",{id:"userGroupFrom",className:"user-group-form",onSubmit:p((e=>{const n=t.filter((e=>l.includes(e._id))).map((e=>({refId:e._id})));a(Nf(Nf({},e),{},{members:[...n]}))}))},void 0,r.createElement("input",{type:"hidden",name:"_id",ref:d}),Sf("div",{id:"name_field",className:"form-group nested-selector"},void 0,Sf("label",{},void 0,Sf(g.vN,{},void 0,"Name of the group")),r.createElement("input",{type:"text",className:"form-control",autoComplete:"off",name:"name",ref:d({required:!0,validate:t=>!n.find((n=>n._id!==e._id&&n.name.trim().toLowerCase()===t.trim().toLowerCase())),maxLength:50,minLength:3})}),u.name&&Sf("div",{className:"validation-error"},void 0,Sf(C.JO,{icon:"exclamation-triangle",size:"xs"}),"required"===u.name.type&&Sf(g.vN,{},void 0,"Name is required"),"validate"===u.name.type&&Sf(g.vN,{},void 0,"Duplicated name"),"maxLength"===u.name.type&&Sf(g.vN,{},void 0,"Name is too long"),"minLength"===u.name.type&&Sf(g.vN,{},void 0,"Name is too short"))),Sf("div",{className:"search-user"},void 0,Sf(gf.NU,{placeholder:(0,g.t)("System","Add users",null,!1),options:m,optionsLabel:"username",optionsValue:"_id",value:l,onChange:e=>{c(e)},optionsToShow:8,sortbyLabel:!0})))),Sf("div",{className:"sidepanel-footer"},void 0,e._id&&Sf("div",{className:"btn-cluster"},void 0,Sf(bt.pu,{id:"deleteBtn",className:"btn btn-danger",action:()=>s(e)},void 0,Sf(C.JO,{icon:"trash-alt"}),Sf("span",{className:"btn-label"},void 0,Sf(g.vN,{},void 0,"Delete")))),Sf("div",{className:"btn-cluster content-right"},void 0,Sf("button",{id:"discardChangesBtn",type:"button",className:"btn btn-default",onClick:i,"aria-label":"Close side panel"},void 0,Sf("span",{className:"btn-label"},void 0,Sf(g.vN,{},void 0,"Cancel"))),Sf("button",{id:"saveChangesBtn",type:"submit",form:"userGroupFrom",className:"btn btn-success"},void 0,Sf("span",{id:"submitLabel",className:"btn-label"},void 0,Sf(g.vN,{},void 0,"Save"))))))};var Cf;function kf(e,t,n,o){Cf||(Cf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _f={loadUsers:yf,loadUserGroups:mf,saveUserGroup:function(e){return async t=>{const n=pf(pf({},await(async e=>(await de.Z.post("usergroups",e)).json)(new pe.K(e))),{},{members:e.members});e._id?(t(ke.N.update("userGroups",n)),t(y.J.notify("Group updated","success"))):(t(ke.N.push("userGroups",n)),t(y.J.notify("Group created","success")))}},deleteUserGroup:function(e){return async t=>{await(async e=>(await de.Z.delete("usergroups",e)).json)(new pe.K({_id:(0,dn.zx)(e._id)})),t(ke.N.remove("userGroups",e)),t(y.J.notify("Group deleted","success"))}}},jf=(0,c.connect)((e=>({userGroups:e.userGroups,users:e.users})),_f)((({userGroups:e,users:t,loadUserGroups:n,saveUserGroup:o,deleteUserGroup:i,loadUsers:a})=>{const[s,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(),p=e?e.toJS():[],u=t?t.toJS():[];function m(){d(void 0),l(!1)}(0,r.useEffect)((()=>{0===p.length&&n().then()}),[]);const f={handleSelect:e=>{d(e),l(!0)},handleAddGroup:()=>{d({name:"",members:[]}),l(!0)},handleSave:async e=>{e._id||delete e._id,await o(e),await a(),m()},handleDelete:async e=>{await i(e),await a(),m()}};return r.createElement(r.Fragment,null,kf(cf,{userGroups:p,handleSelect:f.handleSelect,handleAddGroup:f.handleAddGroup,className:s?"with-sidepanel":""}),c&&kf(Pf,{userGroup:c,users:u,userGroups:p,opened:s,closePanel:m,onSave:f.handleSave,onDelete:f.handleDelete},c._id?c._id.toString():""))}));var If;function Df(e,t,n,o){If||(If="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:If,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tf=({users:e,handleSelect:t,handleAddUser:n,className:o})=>{const[i,a]=(0,r.useState)(),s=e.sort(((e,t)=>e.username.localeCompare(t.username)));return Df("div",{className:"user-list"},void 0,Df("table",{className:o},void 0,Df("thead",{},void 0,Df("tr",{},void 0,Df("th",{},void 0,Df(g.vN,{},void 0,"Name")),Df("th",{},void 0,Df(g.vN,{},void 0,"Protection")),Df("th",{},void 0,Df(g.vN,{},void 0,"Role")),Df("th",{},void 0,Df(g.vN,{},void 0,"Groups")))),Df("tbody",{},void 0,s.map((e=>{var n,o;return Df("tr",{className:i===e._id?"selected":"",onClick:()=>(e=>{var n;t(e),a(null===(n=e._id)||void 0===n?void 0:n.toString())})(e)},null===(n=e._id)||void 0===n?void 0:n.toString(),Df("td",{},void 0,e.username),Df("td",{},void 0,Df(sf.D,{color:e.using2fa?"palegreen":"lightgray"},void 0,Df(g.vN,{translationKey:"Password"},void 0,"Password"),e.using2fa&&" + 2FA")),Df("td",{},void 0,Df(sf.D,{color:"white"},void 0,Df(g.vN,{translationKey:Wf[e.role]},void 0,e.role))),Df("td",{},void 0,null===(o=e.groups)||void 0===o?void 0:o.map((e=>{var t;return Df(sf.D,{color:"white"},null===(t=e._id)||void 0===t?void 0:t.toString(),r.createElement(r.Fragment,null,Df(C.JO,{icon:"users"}),` ${e.name}`))}))))})))),Df("div",{className:`settings-footer ${o}`},void 0,Df("button",{type:"button",className:"btn btn-default",onClick:()=>{a(void 0),n()}},void 0,Df(C.JO,{icon:"plus"}),Df("span",{className:"btn-label"},void 0,Df(g.vN,{},void 0,"Add user")))))};var Ef;function xf(e,t,n,o){Ef||(Ef="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ef,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Af=[{label:"Create new entities and upload documents",roles:{admin:"full",editor:"full",collaborator:"full"}},{label:"Create table of contents",roles:{admin:"full",editor:"full",collaborator:"full"}},{label:"View entities",roles:{admin:"full",editor:"full",collaborator:"partial"}},{label:"Edit metadata of entities",roles:{admin:"full",editor:"full",collaborator:"partial"}},{label:"Delete entities and documents",roles:{admin:"full",editor:"full",collaborator:"partial"}},{label:"Share edit access with other users",roles:{admin:"full",editor:"full",collaborator:"partial"}},{label:"Create connections and references",roles:{admin:"full",editor:"full",collaborator:"partial"}},{label:"Share entities with the public",roles:{admin:"full",editor:"full",collaborator:"none"}},{label:"Manage site settings and configuration",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Add/delete users and assign roles",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Configure filters",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Add/edit translations",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Configure templates ",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Create and edit thesauri",roles:{admin:"full",editor:"none",collaborator:"none"}},{label:"Create connection types",roles:{admin:"full",editor:"none",collaborator:"none"}}],$f={full:{icon:"check",className:"label-success"},partial:{icon:"user-check",className:"label-info"},none:{icon:"times",className:"label-warning"}},Rf=({isOpen:e,onClose:t,rolePermissions:n=Af})=>xf(B.Z,{isOpen:e,type:"content",className:"permissions-modal"},void 0,xf(B.Z.Body,{},void 0,xf("table",{className:"permissions-list"},void 0,xf("thead",{},void 0,xf("tr",{},void 0,xf("th",{},void 0,xf(g.vN,{},void 0,"Permission")),xf("th",{},void 0,xf(g.vN,{},void 0,"Collaborator")),xf("th",{},void 0,xf(g.vN,{},void 0,"Editor")),xf("th",{},void 0,xf(g.vN,{},void 0,"Admin")))),xf("tbody",{},void 0,n.map((e=>xf("tr",{},e.label,xf("td",{},void 0,xf(g.vN,{},void 0,e.label)),["collaborator","editor","admin"].map((t=>{const n=$f[e.roles[t]];return xf("td",{},t,xf(C.JO,{icon:n.icon,className:n.className}))}))))))),xf("div",{className:"legend"},void 0,xf(g.vN,{},void 0,"Legend"),xf("div",{className:"legend-item"},void 0,xf(C.JO,{icon:"user-check",className:"label-info"}),"  ",xf(g.vN,{},void 0,"Permission on entities explicitly shared with the user")))),xf(B.Z.Footer,{},void 0,xf("button",{type:"button",className:"btn btn-default pristine",onClick:t},void 0,xf(g.vN,{},void 0,"Close"))));var Ff;function Lf(e,t,n,o){Ff||(Ff="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ff,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Jf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Zf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jf(Object(n),!0).forEach((function(t){Mf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Vf=({user:e,users:t,groups:n,opened:o,closePanel:i,onSave:a,onDelete:s,onReset2fa:l,onResetPassword:c})=>{const[d,p]=(0,r.useState)(!1),[u,m]=(0,r.useState)(e.groups?e.groups.map((e=>e._id.toString())):[]),{register:f,handleSubmit:h,errors:v}=(0,Gd.cI)({defaultValues:e}),y=n,b=Object.values(cn).map((e=>(0,g.t)("System",e,null,!1))),S=n=>!t.find((t=>{var o,r;return t._id!==e._id&&((null===(o=t.username)||void 0===o?void 0:o.trim().toLowerCase())===n.trim().toLowerCase()||(null===(r=t.email)||void 0===r?void 0:r.trim().toLowerCase())===n.trim().toLowerCase())})),w=()=>{p(!d)};return Lf(bt.hs,{open:o},void 0,Lf("div",{className:"sidepanel-header"},void 0,Lf(g.vN,{},void 0,(e._id?"Edit":"Add")+" User")),Lf("div",{className:"sidepanel-body "+(e._id?"footer-extra-row":"")},void 0,Lf("form",{id:"userFrom",className:"user-form",onSubmit:h((e=>{const t=n.filter((e=>u.includes(e._id))).map((e=>({_id:e._id,name:e.name})));a(Zf(Zf({},e),{},{groups:t}))}))},void 0,r.createElement("input",{type:"hidden",name:"_id",ref:f}),r.createElement("input",{type:"hidden",name:"using2fa",ref:f}),Lf("div",{id:"email_field",className:"form-group nested-selector"},void 0,Lf("label",{},void 0,Lf(g.vN,{},void 0,"Email")),r.createElement("input",{type:"email",className:"form-control",autoComplete:"off",name:"email",ref:f({required:!0,validate:S,maxLength:256})}),v.email&&Lf("div",{className:"validation-error"},void 0,Lf(C.JO,{icon:"exclamation-triangle",size:"xs"}),"required"===v.email.type&&Lf(g.vN,{},void 0,"Email is required"),"validate"===v.email.type&&Lf(g.vN,{},void 0,"Duplicated email"),"pattern"===v.email.type&&Lf(g.vN,{},void 0,"Invalid email"))),Lf("div",{id:"role_field",className:"form-group nested-selector"},void 0,Lf("div",{},void 0,Lf("label",{},void 0,Lf(g.vN,{},void 0,"Role")),Lf("button",{id:"role-info",className:"role-info",type:"button",onClick:w},void 0,Lf(C.JO,{icon:"info-circle"}))),r.createElement("select",{name:"role",className:"form-control",ref:f},b.map((e=>Lf("option",{value:e},e,(0,g.t)("System",Wf[e],null,!1)))))),Lf("div",{id:"username_field",className:"form-group nested-selector"},void 0,Lf("label",{},void 0,Lf(g.vN,{},void 0,"Username")),r.createElement("input",{type:"text",className:"form-control",autoComplete:"off",name:"username",ref:f({required:!0,validate:S,maxLength:50,minLength:3})}),v.username&&Lf("div",{className:"validation-error"},void 0,Lf(C.JO,{icon:"exclamation-triangle",size:"xs"}),"required"===v.username.type&&Lf(g.vN,{},void 0,"Username is required"),"validate"===v.username.type&&Lf(g.vN,{},void 0,"Duplicated username"),"maxLength"===v.username.type&&Lf(g.vN,{},void 0,"Username is too long"),"minLength"===v.username.type&&Lf(g.vN,{},void 0,"Username is too short"))),Lf("div",{id:"password_field",className:"form-group nested-selector"},void 0,Lf("label",{},void 0,Lf(g.vN,{},void 0,"Password")),r.createElement("input",{type:"password",className:"form-control",autoComplete:"off",name:"password",ref:f({maxLength:50})}),v.password&&Lf("div",{className:"validation-error"},void 0,Lf(C.JO,{icon:"exclamation-triangle",size:"xs"}),"maxLength"===v.password.type&&Lf(g.vN,{},void 0,"Password is too long"))),Lf("div",{className:"user-memberships"},void 0,Lf("label",{},void 0,Lf(g.vN,{},void 0,"Groups")),Lf(gf.NU,{options:y,optionsLabel:"name",optionsValue:"_id",value:u,onChange:e=>{m(e)},optionsToShow:8,sortbyLabel:!0}))),Lf(Rf,{isOpen:d,onClose:w})),Lf("div",{className:"sidepanel-footer"},void 0,e._id&&r.createElement(r.Fragment,null,Lf("div",{className:"footer-extra-row"},void 0,Lf("div",{className:"btn-cluster"},void 0,Lf(bt.pu,{id:"resetPasswordBtn",className:"btn btn-outline-warning",action:()=>c(e)},void 0,Lf(C.JO,{icon:"key"}),Lf("span",{className:"btn-label"},void 0,Lf(g.vN,{},void 0,"Reset Password"))),e.using2fa&&Lf(bt.pu,{id:"reset2faBtn",className:"btn btn-outline-danger",action:()=>l(e)},void 0,Lf(C.JO,{icon:"two-factor-auth"}),Lf("span",{className:"btn-label"},void 0," ",Lf(g.vN,{},void 0,"Reset 2FA"))))),Lf("div",{className:"btn-cluster"},void 0,Lf(bt.pu,{id:"deleteBtn",className:"btn btn-danger",action:()=>s(e)},void 0,Lf(C.JO,{icon:"trash-alt"}),Lf("span",{className:"btn-label"},void 0,Lf(g.vN,{},void 0,"Delete"))))),Lf("div",{className:"btn-cluster content-right"},void 0,Lf("button",{id:"discardChangesBtn",type:"button",className:"btn btn-default",onClick:i,"aria-label":"Cancel"},void 0,Lf("span",{className:"btn-label"},void 0,Lf(g.vN,{},void 0,"Cancel"))),Lf("button",{id:"saveChangesBtn",type:"submit",form:"userFrom",className:"btn btn-success"},void 0,Lf("span",{id:"submitLabel",className:"btn-label"},void 0,Lf(g.vN,{},void 0,"Save"))))))};var Uf;function zf(e,t,n,o){Uf||(Uf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Uf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kf={loadUsers:yf,newUser:function(e){return async t=>{const n=await rf.new(new pe.K(e)),o=hf(hf({},e),n);delete o.password,t(ke.N.push("users",o)),t(y.J.notify("Created successfully.","success"))}},saveUser:function(e){return async t=>{await rf.save(new pe.K(e));const n=hf({},e);delete n.password,t(ke.N.update("users",n)),t(y.J.notify("Saved successfully.","success"))}},deleteUser:function(e){return t=>rf.delete(new pe.K(e)).then((()=>{t(ke.N.remove("users",e)),t(y.J.notify("Deleted successfully.","success"))}))},loadUserGroups:mf,reset2fa:function(e){return async t=>{await ot.reset2fa(new pe.K({_id:e._id})),t(ke.N.update("users",it(it({},e),{},{using2fa:!1}))),t(y.J.notify("Deleted successfully.","success"))}},recoverPassword:n(11470).recoverPassword},Bf=(0,c.connect)((e=>({users:e.users,userGroups:e.userGroups})),Kf)((({users:e,userGroups:t,loadUsers:n,loadUserGroups:o,newUser:i,saveUser:a,deleteUser:s,reset2fa:l,recoverPassword:c})=>{var d;const p=e?e.toJS():[],u=t?t.toJS():[],[m,f]=(0,r.useState)(),[h,v]=(0,r.useState)(!1);(0,r.useEffect)((()=>{0===p.length&&n().then().catch((()=>{})),0===o.length&&o().then().catch((()=>{}))}),[]);const y=()=>{f(void 0),v(!1)},b={handleSelect:e=>{f(e),v(!0)},handleSave:async e=>{e.password||delete e.password,delete e.using2fa,e._id?await a(e):(delete e._id,await i(e)),await o(),y()},handleDelete:async e=>{await s({_id:e._id}),y()},handleAddUser:()=>{f({role:cn.COLLABORATOR,username:"",email:""}),v(!0)},handleResetPassword:async e=>{await c(e.email,(0,g.t)("System","Instructions to reset user password have been sent",null,!1))}};return r.createElement(r.Fragment,null,zf(Tf,{users:p,handleSelect:b.handleSelect,handleAddUser:b.handleAddUser,className:h?"with-sidepanel":""}),m&&zf(Vf,{opened:h,user:m,users:p,groups:u,onSave:b.handleSave,onDelete:b.handleDelete,onReset2fa:l,closePanel:y,onResetPassword:b.handleResetPassword},null===(d=m._id)||void 0===d?void 0:d.toString()))}));var Hf;function qf(e,t,n,o){Hf||(Hf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Hf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wf={admin:"Admin",editor:"Editor",collaborator:"Collaborator"};var Gf;function Qf(e,t,n,o){Gf||(Gf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Gf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Yf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Xf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yf(Object(n),!0).forEach((function(t){eh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class th extends r.Component{constructor(e,t){super(e,t),this.state={email:e.user.email||"",password:"",repeatPassword:"",using2fa:e.user.using2fa},this.passwordChange=this.passwordChange.bind(this),this.repeatPasswordChange=this.repeatPasswordChange.bind(this),this.updatePassword=this.updatePassword.bind(this),this.updateEmail=this.updateEmail.bind(this),this.emailChange=this.emailChange.bind(this)}passwordChange(e){this.setState({password:e.target.value}),this.setState({passwordError:!1})}repeatPasswordChange(e){this.setState({repeatPassword:e.target.value}),this.setState({passwordError:!1})}updateEmail(e){const{email:t}=this.state,{user:n,notify:o,setUser:r}=this.props;e.preventDefault();const i=Xf(Xf({},n),{},{email:t});rf.save(new pe.K(i)).then((e=>{o((0,g.t)("System","Email updated",null,!1),"success"),r(Object.assign(i,{_rev:e.rev}))}))}updatePassword(e){e.preventDefault();const{password:t,repeatPassword:n}=this.state,{user:o,notify:r,setUser:i}=this.props,a=t!==n;""===t.trim()||a?this.setState({passwordError:!0}):(rf.save(new pe.K(Xf(Xf({},o),{},{password:t}))).then((e=>{r((0,g.t)("System","Password updated",null,!1),"success"),i(Object.assign(o,{_rev:e.rev}))})),this.setState({password:"",repeatPassword:""}))}emailChange(e){this.setState({email:e.target.value})}renderPasswordField(e,t,n,o){return Qf("div",{className:"form-group"+(o?" has-error":"")},void 0,Qf("label",{className:"form-group-label",htmlFor:e},void 0,Qf(g.vN,{},void 0,n)),Qf("input",{type:"password",onChange:this[`${e}Change`],value:t,id:e,className:"form-control"}))}render(){const{email:e,password:t,repeatPassword:n,passwordError:o,using2fa:r}=this.state,{username:i,groups:a=[],role:s}=this.props.user;return Qf("div",{className:"settings-content"},void 0,Qf("div",{className:"account-settings"},void 0,Qf("div",{className:"panel panel-default"},void 0,Qf("div",{className:"panel-heading"},void 0,Qf(g.vN,{},void 0,"Account")),Qf("div",{className:"panel-body"},void 0,Qf("div",{className:"user-details"},void 0,Qf("div",{},void 0,Qf(g.vN,{},void 0,"Username"),":  ",Qf("strong",{},void 0,i)),Qf("div",{className:"user-details-role"},void 0,Qf(g.vN,{},void 0,"Role"),":  ",Qf(sf.D,{},void 0,Qf(g.vN,{translationKey:Wf[s]},void 0,s))),a.length>0&&Qf("div",{},void 0,Qf(g.vN,{},void 0,"Groups"),":  ",a.map((e=>Qf(sf.D,{},void 0,e.name))))),Qf("hr",{}),Qf("h5",{},void 0,Qf(g.vN,{},void 0,"Email address")),Qf("form",{onSubmit:this.updateEmail},void 0,Qf("div",{className:"form-group"},void 0,Qf("label",{className:"form-group-label",htmlFor:"collection_name"},void 0,Qf(g.vN,{},void 0,"Email")),Qf("input",{type:"email",onChange:this.emailChange,value:e,className:"form-control"})),Qf("button",{type:"submit",className:"btn btn-success"},void 0,Qf(g.vN,{},void 0,"Update"))),Qf("hr",{}),Qf("h5",{},void 0,Qf(g.vN,{},void 0,"Change password")),Qf("form",{onSubmit:this.updatePassword},void 0,this.renderPasswordField("password",t,"New password",o),this.renderPasswordField("repeatPassword",n,"Confirm new password",o),o&&Qf("div",{className:"validation-error validation-error-centered"},void 0,Qf(C.JO,{icon:"exclamation-triangle"})," ",Qf(g.vN,{},void 0,"Password Error")),Qf("button",{type:"submit",className:"btn btn-success"},void 0,Qf(g.vN,{},void 0,"Update"))),Qf("hr",{}),Qf("h5",{},void 0,Qf(g.vN,{},void 0,"Two-step verification")),r&&Qf("div",{className:"alert alert-info"},void 0,Qf(C.JO,{icon:"check",size:"2x"}),Qf("div",{className:"force-ltr"},void 0,Qf(g.vN,{},void 0,"Your account is protected by 2fa."))),!r&&Qf("div",{},void 0,Qf("div",{className:"alert alert-warning"},void 0,Qf(C.JO,{icon:"exclamation-triangle",size:"2x"}),Qf("div",{className:"force-ltr"},void 0,Qf(g.vN,{},void 0,"You should activate this feature for enhanced account security"))),Qf("div",{},void 0,Qf(g.l3,{to:"/settings/2fa",className:"btn btn-success"},void 0,Qf(g.vN,{},void 0,"Protect your account")))))),Qf("div",{className:"settings-footer"},void 0,Qf("a",{href:"/logout",className:"btn btn-danger"},void 0,Qf(C.JO,{icon:"power-off"}),Qf("span",{className:"btn-label"},void 0,Qf(g.vN,{},void 0,"Logout"))))))}}th.defaultProps={user:{}};const nh=(0,Lt.P1)((e=>e.user),(e=>e.toJS()));const oh=(0,c.connect)((function(e){return{user:nh(e)}}),(function(e){return(0,k.bindActionCreators)({setUser:ke.N.set.bind(null,"auth/user"),notify:pi.h},e)}))(th),rh=["localID"];function ih(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ah(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function sh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ah(Object(n),!0).forEach((function(t){lh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ah(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ch={async save(e){var t,n;const o=e.set(sh(sh({},e.data),{},{links:null===(t=e.data)||void 0===t||null===(n=t.links)||void 0===n?void 0:n.map((e=>{const{localID:t}=e;return ih(e,rh)}))}));return de.Z.post("settings",o).then((e=>e.json))},get:async(e=new pe.K)=>de.Z.get("settings",e).then((e=>e.json))};var dh,ph=n(81478);function uh(e){const t=new RegExp("(/[a-zA-Z]{2,3})?/((library(/map)?(/table)?/?(\\?.*)?)|(page/.+)|(entity/.+))$");return null!==e.match(t)}function mh(e,t,n,o){dh||(dh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:dh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fh=r.createElement(r.Fragment,null,mh(g.vN,{},void 0,"Configure the default landing page for your site."),mh("hr",{}),mh(g.vN,{},void 0,"Examples"),":",mh("br",{}),mh(g.vN,{},void 0,"- Site page:"),mh("i",{"no-translate":!0},void 0,"/page/dicxg0oagy3xgr7ixef80k9"),mh("br",{}),mh(g.vN,{},void 0,"- Library search:"),mh("i",{"no-translate":!0},void 0,"/library/?searchTerm=testAn "),mh("br",{}),mh(g.vN,{},void 0,"- Entity:"),mh("i",{"no-translate":!0},void 0,"/entity/9htbkgpkyy7j5rk9A"),mh("br",{}),mh(g.vN,{},void 0,"Always use URLs relative to your site, starting with / and skipping the domain name. Example:"),mh("i",{},void 0,mh(g.vN,{},void 0,"https://yoursite.com/"))),hh=r.createElement(r.Fragment,null,mh(g.vN,{},void 0,"Favicon is an icon that appears in the browser tab and bookmarks."),mh("br",{}),mh("br",{}),mh(g.vN,{},void 0,"You will need to reload the page after updating your Favicon.")),vh=mh(g.vN,{},void 0,"Check to make this instance private (only logged-in users can access the data)"),yh=mh(g.vN,{},void 0,"This option will show a notification about the use of cookies in your instance."),bh=[mh(g.vN,{},void 0,"Here you can set up the contact email and the email that appears when Uwazi sends a notification to a user"),mh(g.vN,{},void 0,"If you have added a contact form on one of your pages, this is the email address that receives the information from that form."),mh(g.vN,{},void 0,"You can configure the email that will appear as the sender when any email is sent to the user. If this email is not set, “no-reply@uwazi.io” will be used instead.")],gh=r.createElement(r.Fragment,null,mh(g.vN,{translationKey:"Character support description"},void 0,"Toggling this button enhances support for non-latin languages as default languages. This will update all template properties automatically."),mh("br",{}),mh("b",{},void 0,mh(g.vN,{translationKey:"Character support process warning"},void 0,"This process could take several minutes and will likely change URLs to library filters. If you have menus or links using such URLs, they will probably stop working after the update. You will need to update them manually.")),mh("br",{}),mh(g.vN,{translationKey:"Character support revert warning"},void 0,"After selecting this option, you will not be able to revert back to using legacy property naming. If you are not facing issues with your template property names, we recommend leaving this unchecked.")),Sh=mh(g.vN,{translationKey:"Analytics description"},void 0,"If you want to track analytics related to your collection visits, Uwazi supports both Google Analytics and Matomo."),wh=mh(g.vN,{},void 0,"Set the default starting point for your geolocation properties."),Nh=[mh(g.vN,{translationKey:"Public form settings description"},void 0,"Here you can configure the public form destination and the whitelisted templates"),mh(g.vN,{translationKey:"Public form URL description"},void 0,"You can configure the URL of a different Uwazi to receive the submits from your Public Form"),mh(g.vN,{translationKey:"Public form whitelist description"},void 0,"If you wish to include a public form on your page, you must white-list the template by selecting it from the list.")],Oh=mh(g.vN,{translationKey:"Captcha bypass"},void 0,"By toggling this on you can allow users to submit to your whitelisted templates without having to fill a CAPTCHA. The form will still present the captcha to end users, but API end-point will allow submissions without CAPTCHA validation if a header `“Bypass-Captcha: true`“ is sent along. This option is insecure and can be leveraged to flood your instance with spam or malicious content."),Ph=mh(g.vN,{translationKey:"Map api key tooltip"},void 0,"An API key is required to use Mapbox or Google Maps."),Ch=r.createElement(r.Fragment,null,mh(g.vN,{translationKey:"OCR description tip 1"},void 0,"This will enable the Optical Character Recognition (OCR) functionality for PDF documents. This service will recognize text inside images, such as scanned documents and photos, and convert it into machine-readable text data."),mh("br",{}),mh(g.vN,{translationKey:"OCR description tip 2"},void 0,"When activated, this will enable administrator and editor users to send PDF documents to the OCR service."));var kh;function _h(e,t,n,o){kh||(kh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:kh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const jh=({children:e,className:t})=>_h("label",{className:`inline-form-label ${t}`},void 0,e);var Ih;function Dh(e,t,n,o){Ih||(Ih="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ih,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Th=({label:e,tip:t,labelClassName:n="col-xs-12 col-lg-2",inputsClassName:o="col-xs-12 col-lg-10",children:r})=>Dh("div",{className:"form-element row"},void 0,Dh(jh,{className:n},void 0,Dh(g.vN,{},void 0,e),t&&Dh(bt.Ch,{icon:"info-circle"},void 0,t)),Dh("div",{className:`form-element-inputs ${o}`},void 0,r));var Eh;function xh(e,t,n,o){Eh||(Eh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Eh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ah(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ah(Object(n),!0).forEach((function(t){Rh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ah(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Fh=(0,c.connect)((({settings:e,templates:t})=>({collectionSettings:e.collection,templates:t})),(e=>(0,k.bindActionCreators)({setSettings:ke.N.set.bind(null,"settings/collection"),notify:y.J.notify},e)))((({collectionSettings:e,templates:t,setSettings:n,notify:o})=>{const i=e.toJS(),a=t.toJS(),{register:s,handleSubmit:l,watch:c,setValue:d,getValues:p,formState:{errors:u}}=(0,Gd.cI)({defaultValues:i,mode:"onSubmit"});s("private"),s("openPublicEndpoint"),s("allowedPublicTemplates"),s("mapStartingPoint"),s("cookiepolicy"),s("newNameGeneration"),s("ocrServiceEnabled"),s("home_page",{validate:e=>uh(e)||""===e}),s("tilesProvider"),s("mapApiKey",{pattern:/^[a-zA-Z0-9._]+$/});const m=(0,g.t)("System","Year",null,!1),f=(0,g.t)("System","Month",null,!1),h=(0,g.t)("System","Day",null,!1);return xh("div",{className:"settings-content"},void 0,xh("div",{className:"panel panel-default collection-settings"},void 0,xh("form",{id:"collectionSettings",className:"",onSubmit:l((async e=>{var t;const r=new pe.K($h($h($h({},i),e),{},{mapApiKey:null===(t=e.mapApiKey)||void 0===t?void 0:t.replace(/\s+/g," ").trim()})),a=await ch.save(r);n(a),o((0,g.t)("System","Settings updated",null,!1),"success")}))},void 0,xh("div",{className:"panel-heading"},void 0,xh(g.vN,{},void 0,"Collection")),xh("h2",{},void 0,xh(g.vN,{},void 0,"General")),xh(Th,{label:"Collection name"},void 0,r.createElement("input",{type:"text",name:"site_name",ref:s,className:"form-control"})),xh(Th,{label:"Custom favicon",tip:hh},void 0,xh(gp,{toggled:Boolean(c("favicon")),onToggleOff:()=>{d("favicon","")}},void 0,r.createElement("input",{type:"text",name:"favicon",ref:s,className:"form-control"}))),xh(Th,{label:"Use custom landing page",tip:fh},void 0,xh(gp,{toggled:Boolean(c("home_page")),onToggleOff:()=>{d("home_page","")}},void 0,xh("div",{className:"input-group "+(u.home_page?"has-error":"")},void 0,xh("span",{className:"input-group-addon",id:"basic-addon1"},void 0,xh(g.vN,{},void 0,"https://yourdomain")),r.createElement("input",{type:"text",className:"form-control",name:"home_page",ref:s})),xh("div",{className:"has-error"},void 0,u.home_page&&xh("div",{className:"error-message"},void 0,xh(g.vN,{},void 0,"Invalid home page url"))))),xh(Th,{label:"Default view"},void 0,xh("div",{className:"col-xs-12 col-lg-3 col-no-gutters"},void 0,r.createElement("select",{name:"defaultLibraryView",className:"form-control",ref:s},xh("option",{value:"cards"},void 0,(0,g.t)("System","Cards",null,!1)),xh("option",{value:"table"},void 0,(0,g.t)("System","Table",null,!1)),xh("option",{value:"map"},void 0,(0,g.t)("System","Map",null,!1))))),xh(Th,{label:"Date format"},void 0,xh("div",{className:"col-xs-12 col-lg-3 col-no-gutters"},void 0,r.createElement("select",{name:"dateFormat",className:"form-control",ref:s},xh("option",{value:"yyyy/MM/dd"},void 0,"2021/02/26 (",m,", ",f,", ",h,")"),xh("option",{value:"dd/MM/yyyy"},void 0,"26/02/2021 (",h,", ",f,", ",m,")"),xh("option",{value:"MM/dd/yyyy"},void 0,"02/26/2021 (",f,", ",h,", ",m,")"),xh("option",{value:"yyyy-MM-dd"},void 0,"2021-02-26 (",m,", ",f,", ",h,")"),xh("option",{value:"dd-MM-yyyy"},void 0,"26-02-2021 (",h,", ",f,", ",m,")"),xh("option",{value:"MM-dd-yyyy"},void 0,"02-26-2021 (",f,", ",h,", ",m,")")))),xh(Th,{label:"Private instance",tip:vh},void 0,xh(C.CO,{checked:Boolean(c("private")),onClick:()=>{d("private",!p("private"))}})),xh(Th,{label:"Show cookie policy",tip:yh},void 0,xh(C.CO,{checked:Boolean(c("cookiepolicy")),onClick:()=>{d("cookiepolicy",!p("cookiepolicy"))}})),!i.newNameGeneration&&xh(Th,{label:"Non-latin characters support",tip:gh},void 0,xh(C.CO,{checked:Boolean(c("newNameGeneration")),onClick:()=>{d("newNameGeneration",!p("newNameGeneration"))}})),xh("h2",{},void 0,xh(g.vN,{},void 0,"Website analytics")),xh(Th,{label:"Google Analytics",tip:Sh},void 0,xh(gp,{toggled:Boolean(c("analyticsTrackingId")),onToggleOff:()=>{d("analyticsTrackingId","")}},void 0,r.createElement("input",{type:"text",name:"analyticsTrackingId",ref:s,className:"form-control"}))),xh(Th,{label:"Matomo Analytics",tip:Sh},void 0,xh(gp,{toggled:Boolean(c("matomoConfig")),onToggleOff:()=>{d("matomoConfig","")}},void 0,r.createElement("input",{type:"text",name:"matomoConfig",ref:s,className:"form-control"}))),xh(ph.e,{feature:"ocr.url"},void 0,xh("h2",{},void 0,xh(g.vN,{},void 0,"Services")),xh(Th,{label:"Document OCR trigger",tip:Ch},void 0,xh(C.CO,{checked:Boolean(c("ocrServiceEnabled")),onClick:()=>{d("ocrServiceEnabled",!p("ocrServiceEnabled"))}}))),xh("h2",{},void 0,xh(g.vN,{},void 0,"Forms and email configuration")),xh(Th,{label:"Contact Form",tip:bh[0]},void 0,xh(gp,{toggled:Boolean(c("contactEmail")||c("senderEmail")),onToggleOff:()=>{d("contactEmail",""),d("senderEmail","")}},void 0,xh(Th,{label:"Receiving email",tip:bh[1]},void 0,r.createElement("input",{type:"text",ref:s,name:"contactEmail",className:"form-control"})),xh(Th,{label:"Sending email",tip:bh[2]},void 0,r.createElement("input",{type:"text",ref:s,name:"senderEmail",placeholder:"no-reply@uwazi.io",className:"form-control"})))),xh(Th,{label:"Public Endpoints",tip:Nh[0]},void 0,xh(gp,{toggled:Boolean((c("allowedPublicTemplates")||[]).length||c("publicFormDestination")),onToggleOff:()=>{d("publicFormDestination",""),d("allowedPublicTemplates",[])}},void 0,xh(Th,{label:"Public Form submit URL",tip:Nh[1],labelClassName:"larger-label",inputsClassName:"smaller-inputs"},void 0,r.createElement("input",{type:"text",name:"publicFormDestination",ref:s,className:"form-control"})),xh(Th,{label:"Whitelisted Templates",tip:Nh[2],labelClassName:"larger-label",inputsClassName:"smaller-inputs"},void 0,xh(Jt.NU,{value:c("allowedPublicTemplates"),options:a.map((e=>({label:e.name,value:e._id}))),onChange:e=>{d("allowedPublicTemplates",e)}})))),xh(Th,{label:"Allow captcha bypass",tip:Oh},void 0,xh(C.CO,{checked:Boolean(c("openPublicEndpoint")),onClick:()=>{d("openPublicEndpoint",!p("openPublicEndpoint"))}})),xh("h2",{},void 0,xh(g.vN,{},void 0,"Maps")),xh(Th,{label:"Map provider"},void 0,xh("div",{className:"col-xs-12 col-lg-3 col-no-gutters"},void 0,r.createElement("select",{name:"tilesProvider",className:"form-control",ref:s},xh("option",{value:"mapbox"},void 0,(0,g.t)("System","MapBox",null,!1)),xh("option",{value:"google"},void 0,(0,g.t)("System","Google Maps",null,!1))))),xh("div",{className:""+(u.mapApiKey?"has-error":"")},void 0,xh(Th,{label:"Map api key",tip:Ph},void 0,r.createElement("input",{type:"text",name:"mapApiKey",ref:s,className:"form-control"}))),xh(Th,{label:"Custom starting location",tip:wh},void 0,xh("div",{className:"settings-map"},void 0,xh(Jt.bT,{value:c("mapStartingPoint"),onChange:e=>{d("mapStartingPoint",e)}})))),xh("div",{className:"settings-footer"},void 0,xh("div",{className:"btn-cluster content-right"},void 0,xh("button",{type:"submit",form:"collectionSettings",className:"btn btn-success btn-extra-padding"},void 0,xh("span",{className:"btn-label"},void 0,xh(g.vN,{},void 0,"Save")))))))})),Lh=e=>t=>ch.save(new pe.K(e)).then((e=>{t(ke.N.set("settings/collection",e)),t(y.J.notify((0,g.t)("System","Settings updated"),"success"))}));var Jh;function Zh(e,t,n,o){Jh||(Jh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Jh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Mh extends r.Component{componentDidMount(){this.props.loadForm("settings.settings",{customCSS:this.props.settings.get("customCSS")})}render(){return Zh("div",{className:"settings-content"},void 0,Zh("div",{className:"panel panel-default settings-custom-css"},void 0,Zh("div",{className:"panel-heading"},void 0,(0,g.t)("System","Custom styles")),Zh("div",{className:"panel-body"},void 0,Zh(_e.l0,{model:"settings.settings",onSubmit:this.props.saveSettings},void 0,Zh(_e.gN,{model:".customCSS",className:"test"},void 0,Zh("label",{className:"form-group-label",htmlFor:"custom_css"},void 0,(0,g.t)("System","Custom CSS"),Zh("textarea",{className:"form-control",id:"custom_css"}))),Zh("div",{className:"settings-footer remove-extra-nesting"},void 0,Zh("div",{className:"btn-cluster content-right"},void 0,Zh("button",{type:"submit",className:"btn btn-success btn-extra-padding"},void 0,Zh(g.vN,{},void 0,"Save"))))))))}}const Vh=(0,c.connect)((e=>({settings:e.settings.collection})),(e=>(0,k.bindActionCreators)({loadForm:_e.Nw.load,saveSettings:Lh},e)))(Mh);var Uh,zh=n(19914);function Kh(e){return t=>rc.delete(new pe.K({_id:e._id})).then((()=>{t(ke.N.remove("templates",e))}))}function Bh(e){return()=>zh.Z.countByTemplate(new pe.K({templateId:e._id})).then((e=>e?Promise.reject():Promise.resolve()))}function Hh(e){return()=>rc.setAsDefault(new pe.K({_id:e._id}))}function qh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Wh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qh(Object(n),!0).forEach((function(t){Gh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qh(e,t,n,o){Uh||(Uh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Uh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Yh extends r.Component{setAsDefaultButton(e){return r.createElement(r.Fragment,null,!e.synced&&Qh("button",{type:"button",onClick:this.props.setAsDefault.bind(null,e),className:"btn btn-success btn-xs"},void 0,Qh(g.vN,{},void 0,"Set as default")))}deleteTemplate(e){return this.props.checkTemplateCanBeDeleted(e).then((()=>{this.context.confirm({accept:()=>{this.props.deleteTemplate(e)},title:r.createElement(r.Fragment,null,Qh(g.vN,{},void 0,"Confirm delete of template:")," ",e.name),messageKey:"confirm delete template",message:"Are you sure you want to delete this entity type?\n        This will delete the template and all relationship properties from other templates pointing to this one."})})).catch((()=>{this.context.confirm({accept:()=>{},noCancel:!0,title:r.createElement(r.Fragment,null,Qh(g.vN,{},void 0,"Can not delete template:")," ",e.name),message:"This template has associated entities"})}))}defaultTemplateMessage(){return Qh("span",{},void 0,Qh(g.vN,{},void 0,"Default template"),Qh(Xc.Z,{},void 0,Qh(g.vN,{},void 0,"This template will be used as default for new entities.")))}syncedTemplateMessage(){return Qh("span",{},void 0,Qh(g.vN,{},void 0,"Synced template"),Qh(Xc.Z,{},void 0,Qh(g.vN,{translationKey:"syncedTemplateListMessage"},void 0,"The source of this template is a sync. All editing options will be disabled.")))}deleteTemplateButton(e){return r.createElement(r.Fragment,null,!e.synced&&Qh("button",{type:"button",onClick:this.deleteTemplate.bind(this,e),className:"btn btn-danger btn-xs template-remove"},void 0,Qh(C.JO,{icon:"trash-alt"})," ",Qh(g.vN,{},void 0,"Delete")))}sortTemplates(){return this.props.templates.toJS().sort(((e,t)=>e.name>t.name?1:-1))}render(){return Qh("div",{className:"settings-content"},void 0,Qh("div",{className:"panel panel-default"},void 0,Qh("div",{className:"panel-heading"},void 0,Qh(g.vN,{},void 0,"Templates")),Qh("ul",{className:"list-group document-types"},void 0,this.sortTemplates().map(((e,t)=>Qh("li",{className:"list-group-item"},t,Qh(d.rU,{to:`/settings/templates/edit/${e._id}`},void 0,e.name),e.default?this.defaultTemplateMessage():"",e.synced?this.syncedTemplateMessage():"",Qh("div",{className:"list-group-item-actions"},void 0,e.default?"":this.setAsDefaultButton(e),Qh(d.rU,{to:`/settings/templates/edit/${e._id}`,className:"btn btn-default btn-xs"},void 0,Qh(C.JO,{icon:"pencil-alt"})," ",Qh(g.vN,{},void 0,"Edit")),e.default?"":this.deleteTemplateButton(e)))))),Qh("div",{className:"settings-footer"},void 0,Qh(d.rU,{to:"/settings/templates/new",className:"btn btn-default"},void 0,Qh(C.JO,{icon:"plus"}),Qh("span",{className:"btn-label"},void 0,Qh(g.vN,{},void 0,"Add template"))))))}}Yh.contextTypes={confirm:u().func};const Xh=(0,c.connect)((function(e){return{templates:e.templates}}),(function(e){return(0,k.bindActionCreators)(Wh(Wh({},y.J),{},{deleteTemplate:Kh,checkTemplateCanBeDeleted:Bh,setAsDefault:Hh}),e)}))(Yh);var ev;function tv(e,t,n,o){ev||(ev="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ev,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nv={beginDrag:e=>({id:e.id,name:e.name,items:e.items,container:e.container,index:e.index,originalItem:e.originalItem}),endDrag(e,t){const n=t.getDropResult();n&&n.id!==e.container.id&&e.removeItem(e.id)}},ov={hover(e,t,n){const o=t.getItem(),r=o.index,a=e.index;if(e.id===o.id)return;if(e.container.id!==o.container.id)return;if(r===a)return;const s=(0,i.findDOMNode)(n).getBoundingClientRect(),l=(s.bottom-s.top)/2,c=t.getClientOffset().y-s.top;return r<a&&c<l||r>a&&c>l?void 0:(e.moveItem(r,a,o),o.index=a,null)}};class rv extends r.Component{render(){const{iconHandle:e,isDragging:t,connectDragPreview:n,connectDragSource:o,connectDropTarget:r}=this.props;let i="list-group-item";t&&(i+=" dragging"),e||(i+=" draggable");const a=r(tv("div",{className:i},void 0,e?o(tv("span",{className:"draggable"},void 0,tv(C.JO,{icon:"bars"}))):tv(C.JO,{icon:"bars"}),this.props.children(this.props.originalItem,this.props.index)));return e?n(a):o(a)}}rv.defaultProps={iconHandle:!1,children:()=>{}};let iv=(0,tc.GR)("DRAG_AND_DROP_ITEM",ov,(e=>({connectDropTarget:e.dropTarget()})))(rv);iv=(0,tc.Ej)("DRAG_AND_DROP_ITEM",nv,((e,t)=>({connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()})))(iv);const av=(0,c.connect)()(iv);var sv;function lv(e,t,n,o){sv||(sv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:sv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cv extends r.Component{constructor(e){super(e),this.state={id:e.id||(0,ic.Z)()},this.container={id:this.state.id},this.moveItem=this.moveItem.bind(this),this.removeItem=this.removeItem.bind(this),this.renderItem=this.renderItem.bind(this)}moveItem(e,t,n){const o=e,r=this.props.items.concat();r.find((e=>e.id===n.id))&&(r.splice(o,1),r.splice(t,0,n.originalItem||n),this.props.onChange(r))}removeItem(e){let t=this.props.items.concat();t=t.filter((t=>t.id!==e)),this.props.onChange(t)}renderItem(e,t){return this.props.renderItem?this.props.renderItem(e,t):e.content}render(){const{connectDropTarget:e,items:t,iconHandle:n}=this.props;return lv("div",{},void 0,e(lv("ul",{className:"list-group"},void 0,t.map(((e,t)=>lv(av,{moveItem:this.moveItem,removeItem:this.removeItem,index:t,iconHandle:n||!!e.items,name:e.name,container:this.container,items:e.items,id:e.id,originalItem:e},e.id,this.renderItem))),lv("div",{className:"no-properties"},void 0,lv("div",{className:"no-properties-wrap"},void 0,lv(g.vN,{},void 0,"Drag items here"))))))}}cv.defaultProps={iconHandle:!1};const dv={drop(e,t,n){const o=t.getItem();if(!(o.id===n.state.id||t.getDropResult()&&t.getDropResult().id)){const t=e.items.concat();return t.find((e=>e.id===o.id))||(t.push(o.originalItem||o),e.onChange(t)),{id:n.state.id}}}},pv=(0,tc.GR)("DRAG_AND_DROP_ITEM",dv,(e=>({connectDropTarget:e.dropTarget()})))(cv),uv=(0,tc.Z5)(nc.PD)(pv);var mv;function fv(e,t,n,o){mv||(mv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:mv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function hv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function vv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hv(Object(n),!0).forEach((function(t){yv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bv extends r.Component{constructor(e){super(e);const t=e.settings.collection.toJS().filters||[],n=e.templates.toJS().filter((e=>!t.find((t=>{const n=t.id===e._id;let o=!1;return t.items&&(o=t.items.find((t=>t.id===e._id))),n||o})))).map((e=>({id:e._id,name:e.name})));this.state={activeFilters:t,inactiveFilters:n},this.activesChange=this.activesChange.bind(this),this.unactivesChange=this.unactivesChange.bind(this),this.renderActiveItems=this.renderActiveItems.bind(this),this.renderInactiveItems=this.renderInactiveItems.bind(this)}activesChange(e){e.forEach((t=>{t.items&&(t.items=t.items.filter((t=>!t.items||(e.push(t),!1))))})),this.setState({activeFilters:e})}unactivesChange(e){this.setState({inactiveFilters:e})}sanitizeFilterForSave(e){const t=vv({},e);return delete t.container,delete t.index,t.items?t.items=t.items.map((e=>this.sanitizeFilterForSave(e))):delete t._id,t}save(){const{activeFilters:e}=this.state,{settings:t,notify:n,setSettings:o}=this.props,r=t.collection.toJS(),i=e.map((e=>this.sanitizeFilterForSave(e)));r.filters=i,ch.save(new pe.K(r)).then((e=>{n((0,g.t)("System","Settings updated",null,!1),"success"),o(Object.assign(r,e))}))}addGroup(){const{activeFilters:e}=this.state,t={id:(0,ic.Z)(),name:"New group",items:[]};this.setState({activeFilters:e.concat([t])})}removeGroup(e){const{activeFilters:t}=this.state,n=t.filter((t=>t.id!==e.id));this.setState({activeFilters:n})}removeItem(e){const{activeFilters:t,inactiveFilters:n}=this.state,o=(e=>{const t=n=>n.filter((t=>t.id!==e)).map((e=>{const n=vv({},e);return n.items&&(n.items=t(n.items)),n}));return t})(e.id)(t);this.setState({activeFilters:o,inactiveFilters:n.concat([e])})}renderGroup(e){return fv("div",{},void 0,fv("div",{className:"input-group"},void 0,fv("input",{type:"text",className:"form-control",value:e.name,onChange:(t=>{const n=t.target.value;e.name=n,this.setState(this.state)}).bind(this)}),fv("span",{className:"input-group-btn"},void 0,fv("button",{type:"button",className:"btn btn-danger",onClick:this.removeGroup.bind(this,e),disabled:e.items.length},void 0,fv(C.JO,{icon:"trash-alt"})))),fv(uv,{id:e.id,onChange:(t=>{e.items=t,this.setState(this.state)}).bind(this),renderItem:this.renderActiveItems,items:e.items}))}renderActiveItems(e){return e.items?this.renderGroup(e):fv("div",{},void 0,fv("span",{},void 0,e.name),fv("button",{type:"button",className:"btn btn-xs btn-danger",onClick:this.removeItem.bind(this,e)},void 0,fv(C.JO,{icon:"trash-alt"})))}renderInactiveItems(e){return e.items?this.renderGroup(e):fv("div",{},void 0,fv("span",{},void 0,e.name))}render(){const{activeFilters:e,inactiveFilters:t}=this.state;return fv("div",{className:"settings-content"},void 0,fv("div",{className:"FiltersForm"},void 0,fv("div",{className:"FiltersForm-list"},void 0,fv("div",{className:"panel panel-default"},void 0,fv("div",{className:"panel-heading"},void 0,fv(g.vN,{},void 0,"Filters configuration")),fv("div",{className:"panel-body"},void 0,fv("div",{className:"row"},void 0,fv("div",{className:"col-sm-9"},void 0,fv("div",{className:"alert alert-info"},void 0,fv(C.JO,{icon:"info-circle",size:"2x"}),fv("div",{className:"force-ltr"},void 0,fv("p",{},void 0,fv(g.vN,{translationKey:"Filters configuration description"},void 0,"By default, users can filter the entities in the library based on the types you have defined. However, you can configure how these entity types will be displayed:")),fv("ul",{},void 0,fv("li",{},void 0,fv(g.vN,{translationKey:"Filters configuration"},void 0,"drag and drop each entity type into the window in order to configure their order")),fv("li",{},void 0,fv(g.vN,{translationKey:"Filters configuration example"},void 0,'select "Create group" below to group filters under a label e.g ("Documents "or "People")'))))),fv(uv,{id:"active",onChange:this.activesChange,renderItem:this.renderActiveItems,items:e})),fv("div",{className:"col-sm-3"},void 0,fv("div",{className:"FiltersForm-constructor"},void 0,fv("div",{},void 0,fv("i",{},void 0,fv(g.vN,{},void 0,"Entity types"))),fv(uv,{id:"inactive",onChange:this.unactivesChange,renderItem:this.renderInactiveItems,items:t}))))))),fv("div",{className:"settings-footer"},void 0,fv("div",{className:"btn-cluster"},void 0,fv("button",{type:"button",onClick:this.addGroup.bind(this),className:"btn btn-default"},void 0,fv(C.JO,{icon:"plus"}),fv("span",{className:"btn-label"},void 0,fv(g.vN,{},void 0,"Create group")))),fv("div",{className:"btn-cluster content-right"},void 0,fv("button",{type:"button",onClick:this.save.bind(this),className:"btn btn-success btn-extra-padding"},void 0,fv("span",{className:"btn-label"},void 0,fv(g.vN,{},void 0,"Save")))))))}}const gv=(0,c.connect)((e=>({templates:e.templates,settings:e.settings})),(function(e){return(0,k.bindActionCreators)({setSettings:ke.N.set.bind(null,"settings/collection"),notify:pi.h},e)}))(bv);var Sv,wv=n(45259);function Nv(e,t,n,o){Sv||(Sv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Sv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ov extends r.Component{static defaultLanguage(){return Nv("span",{},void 0,Nv(g.vN,{},void 0,"Default language"),Nv(Xc.Z,{position:"right"},void 0,Nv(g.vN,{translationKey:"Default language description"},void 0,"This language will be used as default translation when adding new languages, and the default language for the site when no other language has been selected.")))}static notSupportedLanguage(){return Nv(wv.Z,{},void 0,Nv(g.vN,{},void 0,"Some adavanced search features may not be available for this language."))}constructor(e){super(e),this.state={languageToDelete:{},languageToAdd:{}}}setAsDeafultButton(e){return Nv("button",{type:"button",onClick:this.setDefault.bind(this,e),className:"btn btn-success btn-xs template-remove"},void 0,Nv(C.JO,{prefix:"far",icon:"star"})," ",Nv("span",{},void 0,Nv(g.vN,{},void 0,"Set as default")))}setDefault(e){this.props.setDefaultLanguage(e.key)}deleteButton(e){return Nv("button",{disabled:e.key===this.props.locale,className:"btn btn-danger btn-xs template-remove",onClick:this.deleteLanguage.bind(this,e),type:"button"},void 0,Nv(C.JO,{icon:"trash-alt"})," ",Nv("span",{},void 0,Nv(g.vN,{},void 0,"Delete language")))}deleteLanguage(e){this.context.confirm({accept:()=>this.props.deleteLanguage(e.key),title:r.createElement(r.Fragment,null,Nv(g.vN,{},void 0,"Confirm delete ")," ",e.label),message:r.createElement(r.Fragment,null,Nv(g.vN,{},void 0,"Are you sure you want to delete")," ",e.label," ",Nv(g.vN,{},void 0," language? "),Nv(g.vN,{},void 0,"This action may take some time, can not be undone and will delete all the information in that language.")),extraConfirm:!0})}addLanguage({key:e,label:t,localized_label:n,rtl:o}){this.context.confirm({accept:()=>this.props.addLanguage({key:e,label:t,localized_label:n,rtl:o}),title:r.createElement(r.Fragment,null,Nv(g.vN,{},void 0,"Confirm add")," ",t),message:"This action may take some time while we add the extra language to the entire collection.",extraConfirm:!0,type:"success"})}render(){const e=this.props.languages.toJS(),t=e.map((e=>e.key)),n=Object.keys(Za.GP).map((e=>Za.GP[e].ISO639_1)),o=Za.mT.filter((e=>!t.includes(e.key)));return Nv("div",{className:"settings-content without-footer"},void 0,Nv("div",{className:"panel panel-default"},void 0,Nv("div",{className:"panel-heading"},void 0,Nv(g.vN,{},void 0,"Active Languages")),Nv("ul",{className:"list-group document-types"},void 0,e.map(((e,t)=>Nv("li",{className:"list-group-item"},t,Nv("span",{className:"force-ltr"},void 0,`${e.label} (${e.key})`),e.default?Ov.defaultLanguage():"",Nv("div",{className:"list-group-item-actions"},void 0,e.default?"":this.setAsDeafultButton(e),e.default?"":this.deleteButton(e)))))),Nv("div",{className:"panel-heading"},void 0,Nv(g.vN,{},void 0,"Available Languages")),Nv("ul",{className:"list-group document-types"},void 0,o.map(((e,t)=>{const o=!n.includes(e.key);return Nv("li",{className:"list-group-item"},t,Nv("span",{className:"force-ltr"},void 0,`${e.label} (${e.key}) `,o?Ov.notSupportedLanguage():""),Nv("div",{className:"list-group-item-actions"},void 0," ",Nv("button",{type:"button",onClick:this.addLanguage.bind(this,e),className:"btn btn-success btn-xs template-remove"},void 0,Nv(C.JO,{icon:"plus"})," ",Nv("span",{},void 0,Nv(g.vN,{},void 0,"Add language")))))})))))}}Ov.contextTypes={confirm:u().func};const Pv=(0,c.connect)((function(e){const{settings:t,locale:n}=e;return{languages:t.collection.get("languages"),locale:n}}),(function(e){return(0,k.bindActionCreators)({addLanguage:g.Nw.addLanguage,deleteLanguage:g.Nw.deleteLanguage,setDefaultLanguage:g.Nw.setDefaultLanguage},e)}))(Ov);var Cv,kv=n(28749);function _v(e){return{type:kv.BM,id:e}}function jv(e){return _e.Nw.load("settings.navlinksData",{links:e})}function Iv(e,t="link"){const n={title:`Item ${e.length+1}`,localID:(0,ic.Z)(),type:t,sublinks:[]};return e=>{e(_e.Nw.push("settings.navlinksData.links",n)),e(_v(n.localID))}}function Dv(e,t){const n={title:`Item ${t+1} - ${e[t].sublinks.length+1}`,localID:(0,ic.Z)()};return e=>{e(_e.Nw.push(`settings.navlinksData.links[${t}].sublinks`,n)),e(_v(n.localID))}}function Tv(e,t){return _e.Nw.move("settings.navlinksData.links",e,t)}function Ev(e){return _e.Nw.remove("settings.navlinksData.links",e)}function xv(e,t){return _e.Nw.remove(`settings.navlinksData.links[${e}].sublinks`,t)}function Av(e){return t=>(t({type:kv.PD}),ch.save(new pe.K(e)).then((e=>{t({type:kv.gY,data:e}),t(ke.N.set("settings/collection",e)),t(y.J.notify("Saved successfully.","success"))})).catch((()=>{t({type:kv.gY,data:e})})))}function $v(e){const t={"":{}};return e.forEach(((e,n)=>{t[""][`links.${n}.title.required`]=e=>{if(!e.links[n])return!0;const{title:t}=e.links[n];return Boolean(t&&String(t).trim().length)}})),t}function Rv(e,t,n,o){Cv||(Cv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fv={paddingRight:"0px",display:"flex"},Lv={display:"flex"},Jv={beginDrag:e=>({id:e.localID,index:e.index})},Zv={hover(e,t,n){const o=t.getItem().index,r=e.index;if(o===r)return;const a=(0,i.findDOMNode)(n).getBoundingClientRect(),s=(a.bottom-a.top)/2,l=t.getClientOffset().y-a.top;o<r&&l<s||o>r&&l>s||(e.sortLink(o,r),t.getItem().index=r)}};class Mv extends r.Component{constructor(e){super(e),this.firstLoad=!0,this.focus=()=>{this.focusableInput.focus()}}componentDidMount(){this.props.blockReferences.push(this)}componentDidUpdate(e){this.firstLoad?this.firstLoad=!1:this.focusOnNewElement(e)}focusOnNewElement(e){if("group"===this.props.link.type){const t=this.props.links[this.props.index].sublinks,n=e.links[this.props.index].sublinks;(null==t?void 0:t.length)>(null==n?void 0:n.length)&&this.items[this.items.length-1].focus()}}render(){var e;const{link:t,links:n,index:o,isDragging:i,connectDragPreview:a,connectDragSource:s,connectDropTarget:l,formState:c}=this.props;let d="list-group-item"+(i?" dragging":""),p="input-group";return c.$form.errors[`links.${o}.title.required`]&&(d+=" error",p+=" has-error"),this.items=[],a(l(Rv("li",{className:d},void 0,Rv("div",{className:"propery-form expand"},void 0,Rv("div",{},void 0,Rv("div",{className:"row"},void 0,Rv("div",{className:"col-sm-12"},void 0,Rv("div",{className:"row"},void 0,Rv("div",{className:"group"===t.type?"col-sm-11":"col-sm-3",style:"group"===t.type?Fv:Lv},void 0,s(Rv("span",{className:"property-name",style:{paddingRight:"10px",width:"70px"}},void 0,Rv(C.JO,{icon:"bars",className:"reorder"})," ",Rv(C.JO,{icon:"group"===t.type?"caret-square-down":"link"}))),Rv("div",{className:`${p} input-group-width`},void 0,Rv("span",{className:"input-group-addon"},void 0,Rv(g.vN,{},void 0,"Title")),Rv(_e.gN,{model:`settings.navlinksData.links[${o}].title`},void 0,r.createElement("input",{className:"form-control",style:{width:"calc(100% + 5px)"},ref:e=>{this.focusableInput=e}})))),"group"!==t.type&&Rv("div",{className:"col-sm-8",style:{paddingRight:"0px"}},void 0,Rv("div",{className:"input-group"},void 0,Rv("span",{className:"input-group-addon"},void 0,Rv(g.vN,{},void 0,"URL")),Rv(_e.gN,{model:`settings.navlinksData.links[${o}].url`},void 0,Rv("input",{className:"form-control",style:{width:"calc(100% + 5px)"}})))),Rv("div",{className:"col-sm-1"},void 0,Rv("button",{type:"button",className:"btn btn-danger btn-xs property-remove, menu-delete-button",style:{marginLeft:"4px"},onClick:()=>this.props.removeLink(o)},void 0,Rv(C.JO,{icon:"trash-alt"})," ",Rv(g.vN,{},void 0,"Delete")))),Rv("div",{className:"row"},void 0,"group"===t.type&&Rv("div",{style:{paddingLeft:"80px"}},void 0,Rv("div",{className:"row"},void 0,Rv("div",{className:"col-sm-12"},void 0,null===(e=n[o].sublinks)||void 0===e?void 0:e.map(((e,t)=>Rv("div",{className:"row",style:{paddingBottom:"5px",paddingTop:"5px"}},t,Rv("div",{className:"col-sm-3",style:{display:"flex"}},void 0,Rv("span",{style:{padding:"5px 10px 0px 0px"}},void 0,Rv(C.JO,{icon:"link"})),Rv("div",{className:`${p} input-group-width`},void 0,Rv("span",{className:"input-group-addon"},void 0,Rv(g.vN,{},void 0,"Title")),Rv(_e.gN,{model:`settings.navlinksData.links[${o}].sublinks[${t}].title`},void 0,r.createElement("input",{className:"form-control",style:{width:"100%"},ref:e=>this.items.push(e)})))),Rv("div",{className:"col-sm-8"},void 0,Rv("div",{className:"input-group"},void 0,Rv("span",{className:"input-group-addon"},void 0,Rv(g.vN,{},void 0,"URL")),Rv(_e.gN,{model:`settings.navlinksData.links[${o}].sublinks[${t}].url`},void 0,Rv("input",{className:"form-control"})))),Rv("div",{className:"col-sm-1",style:{paddingLeft:"0px"}},void 0,Rv("button",{type:"button",className:"btn btn-danger btn-xs property-remove, menu-delete-button",onClick:()=>this.props.removeGroupLink(o,t)},void 0,Rv(C.JO,{icon:"trash-alt"})," ",Rv(g.vN,{},void 0,"Delete")))))),Rv("div",{className:"row"},void 0,Rv("div",{className:"col-sm-12"},void 0,Rv("button",{className:"menu-link-group-button",type:"button",onClick:this.props.addGroupLink.bind(this,n,o)},void 0,Rv(C.JO,{icon:"link"})," ",Rv(g.vN,{},void 0,"Add link")))))))))))))))}}Mv.defaultProps={blockReferences:[]};const Vv=(0,tc.GR)("LINK",Zv,(e=>({connectDropTarget:e.dropTarget()})))(Mv),Uv=(0,tc.Ej)("LINK",Jv,((e,t)=>({connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()})))(Vv);const zv=(0,c.connect)((function({settings:e}){const{links:t}=e.navlinksData;return{formState:e.navlinksFormState,links:t}}),(function(e){return(0,k.bindActionCreators)({removeLink:Ev,addGroupLink:Dv,removeGroupLink:xv},e)}))(Uv);var Kv;function Bv(e,t,n,o){Kv||(Kv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Kv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Hv extends r.Component{componentDidMount(){this.props.loadLinks(this.props.collection.get("links").toJS()),this.firstLoad=!0}componentDidUpdate(e){this.firstLoad?this.firstLoad=!1:this.focusOnNewElement(e)}focusOnNewElement(e){const{links:t}=this.props,n=e.links;t.length>n.length&&this.blockReferences[this.blockReferences.length-1].focus()}render(){const{collection:e,links:t}=this.props,n=m.C5?window.location.origin:"",o={_id:e.get("_id"),_rev:e.get("_rev"),links:t};return this.blockReferences=[],Bv("div",{className:"settings-content"},void 0,Bv("div",{className:"NavlinksSettings"},void 0,Bv(_e.l0,{model:"settings.navlinksData",onSubmit:this.props.saveLinks.bind(this,o),className:"navLinks",validators:$v(t)},void 0,Bv("div",{className:"panel panel-default"},void 0,Bv("div",{className:"panel-heading"},void 0,Bv("div",{className:"template-name"},void 0,Bv(g.vN,{},void 0,"Menu"))),Bv("ul",{className:"list-group"},void 0,Bv("li",{className:"list-group-item"},void 0,Bv("div",{className:"alert alert-info"},void 0,Bv(C.JO,{icon:"info-circle",size:"2x"}),Bv("div",{className:"force-ltr"},void 0,Bv(g.vN,{},void 0,"If it is an external URL, use a fully formed URL. Ie. http://www.uwazi.io."),Bv("br",{}),Bv(g.vN,{},void 0,"If it is an internal URL within this website, be sure to delete the first part")," ","(",n,"),"," ",Bv(g.vN,{},void 0,"leaving only a relative URL starting with a slash character. Ie. /some_url.")))),t.map(((e,t)=>Bv(zv,{index:t,id:e.localID||e._id,link:e,sortLink:this.props.sortLink,blockReferences:this.blockReferences},e.localID||e._id)))),Bv("div",{className:"settings-footer"},void 0,Bv("div",{className:"btn-cluster"},void 0,Bv("button",{type:"button",className:"btn btn-default",id:"main-add-link-button",onClick:this.props.addLink.bind(this,t,"link")},void 0,Bv(C.JO,{icon:"link"})," ",Bv(g.vN,{},void 0,"Add link")),Bv("button",{type:"button",className:"btn btn-default",onClick:this.props.addLink.bind(this,t,"group")},void 0,Bv(C.JO,{icon:"caret-square-down"})," ",Bv(g.vN,{},void 0,"Add group"))),Bv("div",{className:"btn-cluster content-right"},void 0,Bv("button",{type:"submit",className:"btn btn-success btn-extra-padding",disabled:!!this.props.savingNavlinks},void 0,Bv("span",{className:"btn-label"},void 0,Bv(g.vN,{},void 0,"Save")))))))))}}const qv=(0,tc.Z5)(nc.PD)((0,c.connect)((e=>{const{settings:t}=e,{collection:n}=t,{links:o}=t.navlinksData;return{links:o,collection:n,savingNavlinks:t.uiState.get("savingNavlinks")}}),(function(e){return(0,k.bindActionCreators)({loadLinks:jv,addLink:Iv,sortLink:Tv,saveLinks:Av},e)}))(Hv));var Wv;function Gv(e,t,n,o){Wv||(Wv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Wv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qv extends Ce{static async requestState(e){const t=await Ql.get(e.onlyHeaders());return[ke.N.set("relationTypes",t)]}deleteRelationType(e){return this.props.checkRelationTypeCanBeDeleted(e).then((()=>{this.context.confirm({accept:()=>{this.props.deleteRelationType(e)},title:r.createElement(r.Fragment,null,Gv(g.vN,{},void 0,"Confirm delete connection type:")," ",e.name),message:"Are you sure you want to delete this connection type?"})})).catch((()=>{this.context.confirm({accept:()=>{},noCancel:!0,title:r.createElement(r.Fragment,null,Gv(g.vN,{},void 0,"Cannot delete connection type:")," ",e.name),message:"This connection type is being used and cannot be deleted."})}))}render(){return Gv("div",{className:"settings-content"},void 0,Gv("div",{className:"panel panel-default"},void 0,Gv("div",{className:"panel-heading"},void 0,(0,g.t)("System","Relationship types")),Gv("ul",{className:"list-group relation-types"},void 0,this.props.relationTypes.toJS().map(((e,t)=>Gv("li",{className:"list-group-item"},t,Gv(g.l3,{to:`/settings/connections/edit/${e._id}`},void 0,e.name),Gv("div",{className:"list-group-item-actions"},void 0,Gv(g.l3,{to:`/settings/connections/edit/${e._id}`,className:"btn btn-default btn-xs"},void 0,Gv(C.JO,{icon:"pencil-alt"})," ",Gv("span",{},void 0,(0,g.t)("System","Edit"))),Gv("a",{onClick:this.deleteRelationType.bind(this,e),className:"btn btn-danger btn-xs template-remove"},void 0,Gv(C.JO,{icon:"trash-alt"})," ",Gv("span",{},void 0,(0,g.t)("System","Delete")))))))),Gv("div",{className:"settings-footer"},void 0,Gv(g.l3,{to:"/settings/connections/new",className:"btn btn-default"},void 0,Gv(C.JO,{icon:"plus"}),Gv("span",{className:"btn-label"},void 0,(0,g.t)("System","Add connection"))))))}}Qv.propTypes={relationTypes:u().object,deleteRelationType:u().func,notify:u().func,checkRelationTypeCanBeDeleted:u().func},Qv.contextTypes={confirm:u().func,store:u().object};const Yv=(0,c.connect)((function(e){return{relationTypes:e.relationTypes}}),(function(e){return(0,k.bindActionCreators)({notify:pi.h,deleteRelationType:Xl,checkRelationTypeCanBeDeleted:ec},e)}))(Qv);function Xv(e){return t=>Yd.delete(new pe.K({_id:e._id})).then((()=>{t(ke.N.remove("dictionaries",e))}))}function ey(e){return t=>rc.countByThesauri(new pe.K({_id:e._id})).then((e=>e?Promise.reject():t))}function ty(){return e=>Yd.get().then((t=>{e(ke.N.set("thesauris",t))}))}var ny;function oy(e,t,n,o){ny||(ny="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ny,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ry extends r.Component{getThesaurusSuggestionActions(e){return(this.props.topicClassificationEnabled||e.enable_classification)&&oy("div",{className:"vertical-line"},void 0,e.enable_classification&&oy("span",{className:"thesaurus-suggestion-count"},void 0,e.suggestions?e.suggestions.toLocaleString():"No"," ",(0,g.t)("System","documents to be reviewed")),oy(g.l3,{to:`/settings/dictionaries/cockpit/${e._id}`,className:"btn btn-default btn-xs"},void 0,oy("span",{},void 0,(0,g.t)("System","Configure suggestions"))))}getThesaurusModifyActions(e){return oy("div",{},void 0,oy(g.l3,{to:`/settings/dictionaries/edit/${e._id}`,className:"btn btn-default btn-xs",confirmTitle:e.enable_classification?"Confirm edit suggestion-enabled Thesaurus":"",confirmMessage:e.enable_classification?"Uwazi suggests labels based on the current content of the document collection and its metadata. Editing this thesaurus, the content of the documents or other metadata can affect Uwazi’s understanding of what to suggest.":""},void 0,oy(C.JO,{icon:"pencil-alt"})," ",oy("span",{},void 0,(0,g.t)("System","Edit"))),"  ",oy("button",{onClick:this.deleteThesaurus.bind(this,e),className:"btn btn-danger btn-xs template-remove",type:"button"},void 0,oy(C.JO,{icon:"trash-alt"})," ",oy("span",{},void 0,(0,g.t)("System","Delete"))))}deleteThesaurus(e){return this.props.checkThesaurusCanBeDeleted(e).then((()=>{this.context.confirm({accept:()=>{this.props.deleteThesaurus(e)},title:r.createElement(r.Fragment,null,oy(g.vN,{},void 0,"Confirm delete thesaurus:")," ",e.name),message:"Are you sure you want to delete this thesaurus?"})})).catch((()=>{this.context.confirm({accept:()=>{},noCancel:!0,title:r.createElement(r.Fragment,null,oy(g.vN,{},void 0,"Cannot delete thesaurus: ")," ",e.name),message:"This thesaurus is being used in document types and cannot be deleted."})}))}thesaurusNode(e){return oy("tr",{},e.name,oy("th",{scope:"row"},void 0,e.name),oy("td",{},void 0,this.getThesaurusSuggestionActions(e)),oy("td",{},void 0,this.getThesaurusModifyActions(e)))}render(){return oy("div",{className:"settings-content"},void 0,oy("div",{className:"flex panel panel-default"},void 0,oy("div",{className:"panel-heading"},void 0,(0,g.t)("System","Thesauri")),oy("div",{className:"thesauri-list"},void 0,oy("table",{},void 0,oy("thead",{},void 0,oy("tr",{},void 0,oy("th",{className:"nameCol",scope:"col"}),oy("th",{scope:"col"}),oy("th",{scope:"col"}))),oy("tbody",{},void 0,(e=this.props.dictionaries.toJS(),e.sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))),e).map((e=>this.thesaurusNode(e)))))),oy("div",{className:"settings-footer"},void 0,oy(g.l3,{to:"/settings/dictionaries/new",className:"btn btn-default"},void 0,oy(C.JO,{icon:"plus"}),oy("span",{className:"btn-label"},void 0,(0,g.t)("System","Add thesaurus"))))));var e}}ry.contextTypes={confirm:u().func};const iy=(0,c.connect)((function(e){return{dictionaries:e.dictionaries,topicClassificationEnabled:(e.settings.collection.toJS().features||{}).topicClassification}}),(function(e){return(0,k.bindActionCreators)({deleteThesaurus:Xv,checkThesaurusCanBeDeleted:ey},e)}))(ry);var ay;function sy(e,t,n,o){ay||(ay="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ay,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ly extends r.Component{render(){const{settings:e,translations:t}=this.props,n=e.get("languages").find((e=>e.get("default"))).get("key"),o=t.find((e=>e.get("locale")===n)),r=(0,ep.Y)(o.get("contexts").toJS().map((e=>(e.sort=e.type+e.label,e))),{property:"sort"});return sy("div",{className:"settings-content without-footer"},void 0,sy("div",{className:"TranslationsList panel panel-default"},void 0,sy("div",{className:"panel-heading"},void 0,(0,g.t)("System","Translations")),sy("ul",{className:"list-group relation-types"},void 0,r.map(((e,t)=>sy("li",{className:"list-group-item"},t,sy("div",{},void 0,sy("span",{className:"item-type item-type-empty"},void 0,sy("span",{className:"item-type__name"},void 0,e.type)),sy(g.l3,{to:`/settings/translations/edit/${encodeURIComponent(e.id)}`},void 0,e.label)),sy("div",{className:"list-group-item-actions"},void 0,sy(g.l3,{to:`/settings/translations/edit/${encodeURIComponent(e.id)}`,className:"btn btn-default btn-xs"},void 0,sy(C.JO,{icon:"language"})," ",(0,g.t)("System","Translate")))))))))}}const cy=(0,c.connect)((function(e){return{translations:e.translations,settings:e.settings.collection}}),(function(e){return(0,k.bindActionCreators)({notify:pi.h},e)}))(ly);function dy(e,t){let n;for(let r=0;r<t.length;r+=1){var o;const i=null===(o=t[r].properties)||void 0===o?void 0:o.find((t=>t.content===e._id));if(void 0!==i){n=i;break}}return n}function py(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function uy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?py(Object(n),!0).forEach((function(t){my(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):py(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function my(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fy(e,t,n){return{select:["sharedId"],limit:1,filters:{},includeUnpublished:t,unpublished:n,allAggregations:!0,types:[e],includeReviewAggregations:!0}}function hy(e,t){if(!t||!t.name)return null;const{name:n}=t;return uy(uy({},fy(e,!0,!1)),{},{filters:{[n]:{values:["missing"]},[`__${n}`]:{values:["any"]}}})}function vy(e,t){if(!t||!t.name)return null;const{name:n}=t;return uy(uy({},fy(e,!1,!0)),{},{filters:{[n]:{values:["any"]},[`__${n}`]:{values:["any"]}}})}function yy(e,t){if(!t||!t.name)return null;const{name:n}=t;return uy(uy({},fy(e,!0,!1)),{},{filters:{[n]:{values:["any"]}}})}var by;function gy(e,t,n,o){by||(by="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:by,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Sy=()=>gy("div",{},void 0,gy("div",{className:"panel panel-default"},void 0,gy("div",{className:"panel-heading"},void 0,gy(g.vN,{},void 0,"Settings")),gy("div",{className:"list-group"},void 0,gy(g.l3,{to:"settings/account",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Account")),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/users",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Users"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/collection",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Collection"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/navlinks",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Menu"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/pages",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Pages"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/languages",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Languages"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/translations",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Translations"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/filters",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Filters configuration"))))),gy("div",{className:"panel panel-default"},void 0,gy(j.W,{roles:["admin"]},void 0,gy("div",{className:"panel-heading"},void 0,gy(g.vN,{},void 0,"Metadata"))),gy("div",{className:"list-group"},void 0,gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/templates",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Templates"))),gy(ph.e,{feature:"metadataExtraction.url"},void 0,gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/metadata_extraction",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Metadata Extraction")))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/dictionaries",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Thesauri"))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/connections",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Relationship types")))),gy("div",{className:"panel-heading"},void 0,gy(g.vN,{},void 0,"Tools")),gy("div",{className:"list-group"},void 0,gy(ph.e,{feature:"preserve.host"},void 0,gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"/settings/preserve",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Preserve Extension")," ",gy(C.JO,{icon:"square"})))),gy(j.W,{roles:["admin"]},void 0,gy(g.l3,{to:"settings/activitylog",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Activity log")),gy(g.l3,{to:"/settings/customisation",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Global CSS")),gy(g.l3,{to:"/settings/custom-uploads",activeClassName:"active",className:"list-group-item"},void 0,gy(g.vN,{},void 0,"Uploads"))),gy("a",{className:"list-group-item",href:"https://uwazi.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"},void 0,gy("span",{},void 0,gy(g.vN,{},void 0,"Documentation")," ",gy(C.JO,{icon:"external-link-alt"}))))));var wy;function Ny(e,t,n,o){wy||(wy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:wy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Oy=class extends Ce{static async requestState(e){const t=e.onlyHeaders(),[n,o,r,i,a]=await Promise.all([rf.currentUser(t),Yd.getThesauri(t),g.K5.get(t),ch.get(t),rc.get(e.onlyHeaders())]),s=o.filter((e=>e.enable_classification)).map((e=>dy(e,a))),l=await Promise.all([].concat(...s.map((t=>a.map((n=>{const o=e.set(hy(n._id,t));return tn.Z.search(o)}))))));return s.map((e=>a.map((t=>[e,[t,l.shift()]])))).forEach((e=>{e.forEach((e=>{const t=e[0],n=e[1][1].totalRows,r=o.find((e=>e._id===t.content));r.hasOwnProperty("suggestions")||(r.suggestions=0),r.suggestions+=n}))})),[ke.N.set("auth/user",n),ke.N.set("dictionaries",o),ke.N.set("translations",r),ke.N.set("settings/collection",i)]}render(){return Ny("div",{className:"row settings"},void 0,Ny(M.q,{},void 0,Ny("title",{},void 0,(0,g.t)("System","Settings",null,!1))),Ny("div",{className:"settings-navigation"},void 0,Ny(Sy,{})),this.props.children)}};var Py;function Cy(e,t,n,o){Py||(Py="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Py,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ky=(0,c.connect)((function({settings:e,user:t}){return{settings:e.collection,user:t}}))((({settings:e,user:t})=>{const[n,o]=(0,r.useState)("");return(0,r.useEffect)((()=>{var n,r;const i=null===(n=e.get("features"))||void 0===n?void 0:n.get("preserve"),a=null==i||null===(r=i.get("config"))||void 0===r?void 0:r.find((e=>{var n,o;return(null==e||null===(n=e.get("user"))||void 0===n?void 0:n.toString())===(null===(o=t.get("_id"))||void 0===o?void 0:o.toString())}));if(a){const e=a.get("token");o(e)}}),[]),Cy("div",{className:"settings-content"},void 0,Cy("div",{className:"panel panel-preserve"},void 0,Cy("div",{className:"panel-preserve-heading"},void 0,Cy(C.JO,{icon:"square"})," ",Cy(g.vN,{},void 0,"Preserve Extension")),Cy("div",{className:"panel-preserve-content"},void 0,Cy("div",{className:"status"},void 0,Cy(g.vN,{},void 0,"You have not connected an Uwazi instance, yet")),Cy("div",{className:"setup"},void 0,Cy("div",{className:"span"},void 0,Cy(g.vN,{},void 0,"INSTALL the browser extension")),Cy("br",{}),Cy("div",{className:"span"},void 0,Cy(g.vN,{translationKey:"Preserve Setup Description"},void 0,"If you know your Uwazi URL and TOKEN click the link below, and fill the required information.")),Cy("div",{className:"install-buttons"},void 0,Cy("button",{type:"button"},void 0,Cy(g.vN,{},void 0,"Install browser extension (dynamic link)")),Cy("div",{},void 0,Cy("a",{href:"https://uwazi.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"},void 0,Cy(g.vN,{},void 0,"Chrome extension store link"))),Cy("div",{},void 0,Cy("a",{href:"https://uwazi.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"},void 0,Cy(g.vN,{},void 0,"Firefox extension store link")))),Cy("hr",{}),Cy("div",{className:"preserve-token"},void 0,Cy("div",{},void 0,Cy(g.vN,{},void 0,"Configuration")),Cy("form",{onSubmit:async e=>{e.preventDefault();const t=await de.Z.post("preserve");o(t.json.token)}},void 0,Cy("div",{className:"form-group"},void 0,Cy("label",{className:"form-group-label",htmlFor:"collection_name"},void 0,Cy(g.vN,{},void 0,"Extension Token")),Cy("input",{value:n,className:"form-control",disabled:!0})),n&&Cy("button",{className:"btn btn-success",type:"button",onClick:async()=>{await navigator.clipboard.writeText(n)}},void 0,Cy(g.vN,{},void 0,"Copy token")),!n&&Cy("button",{type:"submit",className:"btn btn-success"},void 0,Cy(g.vN,{},void 0,"Request token"))),Cy("div",{className:"info"},void 0,Cy(g.vN,{},void 0,"Some information about the token")))))))}));var _y,jy=n(88601);function Iy(e,t,n,o){_y||(_y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:_y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Dy extends Ce{static async requestState(e){const t=await de.Z.get("files",e.add({type:"custom"}));return[ke.N.set("customUploads",t.json)]}constructor(e,t){super(e,t),this.onDrop=this.onDrop.bind(this)}onDrop(e){e.forEach((e=>{this.props.upload(e)}))}render(){return Iy("div",{className:"settings-content without-footer"},void 0,Iy("div",{className:"panel panel-default"},void 0,Iy("div",{className:"panel-heading"},void 0,Iy(g.vN,{},void 0,"Custom Uploads")),Iy("div",{className:"panel-body custom-uploads"},void 0,Iy(jy.Z,{className:"upload-box",onDrop:this.onDrop},void 0,Iy("div",{className:"upload-box_wrapper"},void 0,Iy(C.JO,{icon:"upload"}),Iy("button",{className:"upload-box_link",type:"button"},void 0,Iy(g.vN,{},void 0,"Browse files to upload")),Iy("span",{},void 0," ",Iy(g.vN,{},void 0,"or drop your files here."))),this.props.progress&&Iy("div",{className:"uploading"},void 0,Iy(C.JO,{icon:"spinner",spin:!0}),Iy(g.vN,{},void 0,"Uploading ..."))),Iy("ul",{},void 0,this.props.customUploads.map((e=>Iy("li",{},e.get("filename"),Iy(bt.pl,{file:`/assets/${e.get("filename")}`}),Iy("div",{className:"info"},void 0,Iy("span",{"no-translate":!0},void 0,"URL:"),Iy("span",{className:"thumbnail-url"},void 0,`/assets/${e.get("filename")}`),Iy(bt.pu,{action:()=>this.props.deleteCustomUpload(e.get("_id"))},void 0,Iy(g.vN,{},void 0,"Delete"))))))))))}}Dy.defaultProps={progress:!1},Dy.propTypes={progress:u().bool,customUploads:u().instanceOf(Ie().List).isRequired,upload:u().func.isRequired,deleteCustomUpload:u().func.isRequired};const Ty=(0,c.connect)((({customUploads:e,progress:t})=>({customUploads:e,progress:!!t.filter(((e,t)=>t.match(/customUpload/))).size})),(e=>(0,k.bindActionCreators)({upload:Ur.qF,deleteCustomUpload:Ur.Ig},e)))(Dy);var Ey;function xy(e,t,n,o){Ey||(Ey="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ey,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ay=({children:e})=>xy(or,{templateLoaded:(0,Lt.P1)((e=>e.template.data._id),(e=>Boolean(e)))},void 0,(({templateLoaded:t})=>!!t&&e));var $y,Ry;function Fy(e,t,n,o){$y||($y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ly(e,t,n,o){Ry||(Ry="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ry,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Jy,Zy=n(18408);function My(e,t,n,o){Jy||(Jy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Jy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Vy extends r.Component{constructor(e){super(e),this.focus=()=>{this.groupInput.focus()}}renderValue(e,t,n){const{removeValue:o}=this.props;let r=`thesauri.data.values[${t}].label`;return void 0!==n&&(r=`thesauri.data.values[${n}].values[${t}].label`),My("div",{},`item-${n||""}${t}`,My(_e.gN,{model:r},void 0,My("input",{className:"form-control",type:"text",placeholder:"Item name"}),My("button",{tabIndex:t+500,type:"button",className:"btn btn-xs btn-danger",onClick:o.bind(null,t,n)},void 0,My(C.JO,{icon:"trash-alt"})," ",My(g.vN,{},void 0,"Delete"))))}render(){const{value:e,index:t,groupIndex:n}=this.props;return this.renderValue(e,t,n)}}Vy.defaultProps={groupIndex:void 0};const Uy=Vy;var zy;function Ky(e,t,n,o){zy||(zy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:zy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function By(){return By=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},By.apply(this,arguments)}class Hy extends r.Component{constructor(e){super(e),this.focus=()=>{this.groupInput.focus()},this.renderItem=this.renderItem.bind(this),this.onChange=this.onChange.bind(this),this.removeGroup=this.removeGroup.bind(this)}onChange(e){const{index:t,onChange:n}=this.props;n(e,t)}removeGroup(){const{index:e,removeValue:t}=this.props;t(e)}renderItem(e,t){const{index:n}=this.props;return r.createElement(Uy,By({},this.props,{value:e,index:t,groupIndex:n}))}render(){const{value:e,index:t}=this.props;return Ky("div",{className:"group"},`group-${t}`,Ky(gt.Z,{},void 0,Ky(_e.gN,{model:`thesauri.data.values[${t}].label`},void 0,r.createElement("input",{ref:e=>{this.groupInput=e},className:"form-control",type:"text",placeholder:"Group name"}),Ky("button",{tabIndex:t+500,type:"button",className:"btn btn-xs btn-danger",onClick:this.removeGroup},void 0,Ky(C.JO,{icon:"trash-alt"})," ",Ky(g.vN,{},void 0,"Delete Group")))),Ky(uv,{items:e.values,iconHandle:!0,renderItem:this.renderItem,onChange:this.onChange}))}}const qy=Hy;function Wy(){return Wy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Wy.apply(this,arguments)}class Gy extends r.Component{constructor(e){super(e),this.focus=()=>this.groupItem&&this.groupItem.focus()}render(){const{value:e}=this.props;return e.values?r.createElement(qy,Wy({ref:e=>{this.groupItem=e}},this.props)):r.createElement(Uy,this.props)}}function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Qy.apply(this,arguments)}var Yy;function Xy(e,t,n,o){Yy||(Yy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Yy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function eb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function tb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(n),!0).forEach((function(t){nb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ob(e){const t=tb({},e);return t.values=t.values.filter((e=>e.label)).filter((e=>!e.values||e.values.length)).map((e=>{const t=tb({},e);return t.values&&(t.values=t.values.filter((e=>e.label))),t})),t}class rb extends r.Component{static validation(e,t){return{name:{duplicated:n=>!e.find((e=>"template"!==e.type&&e._id!==t&&e.name.trim().toLowerCase()===n.trim().toLowerCase())),required:Zy.Dw}}}constructor(e){super(e),this.save=this.save.bind(this),this.renderItem=this.renderItem.bind(this),this.onChange=this.onChange.bind(this),this.importThesaurusFile=this.importThesaurusFile.bind(this)}componentDidMount(){this.firstLoad=!0}componentDidUpdate(e){this.firstLoad?this.firstLoad=!1:(this.addEmptyValueAtTheEnd(),this.focusIfWasGroup(e))}componentWillUnmount(){this.props.resetForm("thesauri.data"),this.props.setInitial("thesauri.data")}onChange(e,t){this.props.updateValues(e,t)}importThesaurusFile(e){const t=ob(this.props.thesauri);this.props.importThesaurus(t,e)}focusIfWasGroup(e){const{values:t}=this.props.thesauri,n=e.thesauri.values,o=t.length>e.thesauri.values.length,r=t.length&&t[t.length-1].values,i=n.length&&n[n.length-1].values;!r||i&&!o||this.groups[this.groups.length-1].focus()}addEmptyValueAtTheEnd(){this.props.thesauri.values.forEach(((e,t)=>{!e.values||e.values.length&&""===e.values[e.values.length-1].label||this.props.addValue(t)})),this.props.thesauri.values.length&&""===this.props.thesauri.values[this.props.thesauri.values.length-1].label||this.props.addValue()}save(e){const t=ob(e);this.props.saveThesaurus(t)}renderItem(e,t){return r.createElement(Gy,{ref:e=>this.groups.push(e),value:e,index:t,removeValue:this.props.removeValue,onChange:this.onChange})}render(){const e=this.props.new,t=this.props.thesauri._id,{values:n}=this.props.thesauri;return!(!e&&!t)&&(this.groups=[],Xy("div",{className:"thesauri"},void 0,Xy(_e.l0,{model:"thesauri.data",onSubmit:this.save,validators:rb.validation(this.props.thesauris.toJS(),this.props.thesauri._id)},void 0,Xy("div",{className:"panel panel-default thesauri"},void 0,Xy("div",{className:"panel-heading"},void 0,r.createElement(gt.Z,Qy({},this.props.state.name,{submitFailed:this.props.state.submitFailed}),Xy(_e.gN,{model:".name"},void 0,Xy("input",{id:"thesauriName",className:"form-control",type:"text",placeholder:"Thesauri name"}),Xy($n.Z,{if:this.props.state.$form.touched&&this.props.state.name&&this.props.state.name.errors.duplicated},void 0,Xy("div",{className:"validation-error"},void 0,Xy(C.JO,{icon:"exclamation-triangle",size:"xs"})," ",Xy(g.vN,{},void 0,"Duplicated name")))))),Xy("div",{className:"thesauri-values"},void 0,Xy("div",{className:""},void 0,Xy("b",{},void 0,Xy(g.vN,{},void 0,"Items:"))),Xy(uv,{onChange:this.onChange,renderItem:this.renderItem,items:n,iconHandle:!0})),Xy("div",{className:"settings-footer"},void 0,Xy("div",{className:"btn-cluster"},void 0,Xy(bt.xE,{to:"/settings/dictionaries",className:"btn-plain"})),Xy("div",{className:"btn-cluster lg-margin-left-12 sm-order-1 sm-footer-extra-row"},void 0,Xy("button",{type:"button",className:"btn btn-default",onClick:this.props.addGroup},void 0,Xy(C.JO,{icon:"plus"}),Xy("span",{className:"btn-label"},void 0,Xy(g.vN,{},void 0,"Add group"))),Xy("button",{type:"button",className:"btn btn-default",onClick:this.props.sortValues},void 0,Xy(C.JO,{icon:"sort-alpha-down"}),Xy("span",{className:"btn-label"},void 0,Xy(g.vN,{},void 0,"Sort"))),Xy(wt,{onFileImported:this.importThesaurusFile},void 0,Xy("button",{type:"button",className:"btn btn-default import-template"},void 0,Xy(C.JO,{icon:"upload"}),Xy("span",{className:"btn-label"},void 0,Xy(g.vN,{},void 0,"Import"))))),Xy("div",{className:"btn-cluster content-right"},void 0,Xy(g.l3,{to:"/settings/dictionaries",className:"btn btn-default btn-extra-padding"},void 0,Xy("span",{className:"btn-label"},void 0,Xy(g.vN,{},void 0,"Cancel"))),Xy("button",{type:"submit",className:"btn btn-success btn-extra-padding save-template"},void 0,Xy("span",{className:"btn-label"},void 0,Xy(g.vN,{},void 0,"Save")))))))))}}rb.defaultProps={new:!1};const ib=(0,c.connect)((function(e){return{thesauri:e.thesauri.data,thesauris:e.thesauris,state:e.thesauri.formState}}),(function(e){return(0,k.bindActionCreators)({saveThesaurus:ip,importThesaurus:ap,addValue:cp,addGroup:dp,sortValues:sp,removeValue:pp,updateValues:lp,resetForm:_e.Nw.reset,setInitial:_e.Nw.setInitial,validate:_e.Nw.validate},e)}),null,{withRef:!0})(rb);var ab,sb,lb;function cb(e,t,n,o){ab||(ab="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ab,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function db(e,t,n,o){sb||(sb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:sb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}async function pb(e,t,n,o=!0){var r;if(!n)return{totalRows:0,totalLabels:0,thesaurus:{propertyName:"",totalValues:{}}};const i=(await Promise.all(e.map((e=>{const o=new pe.K(t(e._id,n));return tn.Z.search(o)})))).map((e=>{var t;return function(e,t,n=!0){const o=`${n?"__":""}${t}`,r={};if(r.totalRows=e.totalRows||0,r.totalLabels=0,void 0!==e.aggregations&&void 0!==e.aggregations.all&&e.aggregations.all.hasOwnProperty(o)){const{buckets:n}=e.aggregations.all[o],i={};n.forEach((e=>{i[e.key]=e.filtered.doc_count,r.totalLabels+=e.filtered.doc_count})),r.thesaurus={propertyName:t,totalValues:i}}return r}(e,null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"",o)}));return function(e,t){const n={totalRows:0,totalLabels:0,thesaurus:{propertyName:t,totalValues:{}}};return e.forEach((e=>{n.totalRows+=e.totalRows,n.totalLabels+=e.totalLabels,e.hasOwnProperty("thesaurus")&&e.thesaurus.hasOwnProperty("totalValues")&&Object.entries(e.thesaurus.totalValues).forEach((([e,t])=>{n.thesaurus.totalValues.hasOwnProperty(e)||(n.thesaurus.totalValues[e]=0),n.thesaurus.totalValues[e]+=t||0}))})),n}(i,null!==(r=null==n?void 0:n.name)&&void 0!==r?r:"")}function ub(e){return async(t,n)=>{var o;const r=null!=e?e:new pe.K,i=n(),a=i.thesauri.thesaurus.toJS(),s=i.templates.toJS(),l=null===(o=i.thesauri.suggestInfo.get("property"))||void 0===o?void 0:o.toJS(),[c,d,p,u,m,f]=await Promise.all([de.Z.get("tasks",r.set({name:"TopicClassificationSync"})),Yd.getModelTrainStatus(r.set({thesaurus:a.name})),Yd.getModelStatus(r.set({thesaurus:a.name})),pb(s,vy,l),pb(s,hy,l),pb(s,yy,l,!1)]);t(ke.N.set("thesauri.suggestInfo",{model:p,property:l,docsWithSuggestionsForPublish:u,docsWithSuggestionsForReview:m,docsWithLabels:f})),t(ke.N.set("thesauri.tasksState",{SyncState:c.json,TrainState:d}))}}function mb(e){const{values:t=[]}=e;return t.sort(((e,t)=>`${e.label}`.localeCompare(t.label)))}function fb(e,t,n,o){lb||(lb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:lb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hb=(0,Lt.P1)((e=>e.thesauri.suggestInfo),(e=>e.toJS())),vb=(0,Lt.P1)((e=>e.thesauri.thesaurus),(e=>e.toJS())),yb=(0,Lt.P1)((e=>e.thesauri.tasksState),(e=>e.toJS()));const bb=(0,c.connect)((function(e){return{suggestInfo:hb(e),thesaurus:vb(e),tasksState:yb(e),topicClassificationEnabled:(e.settings.collection.toJS().features||{}).topicClassification}}),{updateCockpitData:ub,startTraining:function(){return async(e,t)=>{const n=t().thesauri.thesaurus.toJS();await Yd.trainModel(new pe.K({thesaurusId:n._id.toString()})),await e(ub())}},toggleEnableClassification:function(){return async(e,t)=>{const n=t().thesauri.thesaurus.toJS();n.enable_classification=!n.enable_classification;const o=await Yd.save(new pe.K(n));e(pi.h((0,g.t)("System",n.enable_classification?`You will now see suggestions for ${o.name}.`:`You will no longer see suggestions for ${o.name}.`,null,!1),"success")),e(ke.N.set("thesauri.thesaurus",o))}}})(class extends Ce{constructor(...e){super(...e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"interval",void 0)}static async requestState(e){const[t,n]=await Promise.all([Yd.getThesauri(e),rc.get(e.onlyHeaders())]),o=t[0],r=dy(o,n);return[ke.N.set("templates",n),ke.N.set("thesauri.thesaurus",o),ke.N.set("thesauri.suggestInfo",{property:r}),ub(e)]}topicNode(e){var t,n,o,r,i,a,s,l,c,d,p,u,m,f;const{thesaurus:h,suggestInfo:v}=this.props,{label:y,id:b}=e,S=null!==(t=null===(n=v.docsWithSuggestionsForReview)||void 0===n||null===(o=n.thesaurus)||void 0===o?void 0:o.totalValues[`${b}`])&&void 0!==t?t:0,w=null!==(r=null===(i=v.docsWithLabels)||void 0===i||null===(a=i.thesaurus)||void 0===a?void 0:a.totalValues[`${b}`])&&void 0!==r?r:0,N=null!==(s=(null!==(l=null===(c=v.model)||void 0===c?void 0:c.topics)&&void 0!==l?l:{})[y])&&void 0!==s?s:(null!==(d=null===(p=v.model)||void 0===p?void 0:p.topics)&&void 0!==d?d:{})[b];return fb("tr",{},y,fb("th",{scope:"row"},void 0,y,N&&!!N.quality&&N.quality<.5&&fb("span",{className:"property-help confidence-bubble low"},void 0,fb(g.vN,{},void 0,"low"),fb("div",{className:"property-description"},void 0,fb(g.vN,{},void 0,"Improve the quality of this topic's suggestions by finding more sample documents with this label.")))),fb("td",{title:"sample-count"},void 0,w?w.toLocaleString():"-"),fb("td",{title:"suggestions-count"},void 0,S?S.toLocaleString():"-"),fb("td",{title:"review-button"},void 0,S>0&&h.enable_classification&&null!==(u=v.property)&&void 0!==u&&u.name?fb(g.l3,{to:`/review?q=(filters:(__${null===(m=v.property)||void 0===m?void 0:m.name}:(values:!('${b}')),${null===(f=v.property)||void 0===f?void 0:f.name}:(values:!(missing))))&includeUnpublished=1`,className:"btn btn-default btn-xs"},void 0,fb("span",{title:"review-button-title"},void 0,(0,g.t)("System","View suggestions"))):null))}learningNotice(){var e,t,n,o,i,a,s,l,c,d;const{thesaurus:p,tasksState:u,suggestInfo:m}=this.props,f=mb(p).length,h=(null!==(e=null===(t=m.model)||void 0===t||null===(n=t.config)||void 0===n?void 0:n.num_test)&&void 0!==e?e:0)+(null!==(o=null===(i=m.model)||void 0===i||null===(a=i.config)||void 0===a?void 0:a.num_train)&&void 0!==o?o:0),v=null===(s=m.docsWithLabels)||void 0===s?void 0:s.totalRows,y=null===(l=m.model)||void 0===l?void 0:l.preferred,b="running"===(null===(c=u.TrainState)||void 0===c?void 0:c.state),S=y&&+y>1e9&&+y<2e9?new Date(1e3*+y):null;let w;w=y?fb("div",{className:"block"},void 0,fb("div",{className:"stretch"},void 0,fb(g.vN,{translationKey:"Suggested labels description"},void 0,'Uwazi has suggested labels for your collection. Review them using the "View suggestions" button next to each topic. Disable suggestions with the "Show suggestions" toggle.'),fb("br",{}),fb("br",{}),fb(g.vN,{},void 0,"You can also improve the model by providing more labeled documents.")),fb("div",{className:"footer"},void 0,fb(g.l3,{title:"label-docs",to:`/library/?quickLabelThesaurus=${p._id}&q=(allAggregations:!t,includeUnpublished:!t)`,className:"btn btn-primary get-started"},void 0,fb(g.vN,{},void 0,"Label more documents")))):fb("div",{className:"block"},void 0,fb("div",{className:"stretch"},void 0,fb(g.vN,{},void 0,"The first step is to label a sample of your documents, so Uwazi can learn which topics to suggest when helping you label your collection.")),fb("div",{className:"footer"},void 0,fb(g.l3,{title:"label-docs",to:`/library/?quickLabelThesaurus=${p._id}&q=(allAggregations:!t,includeUnpublished:!t)`,className:"btn btn-primary get-started"},void 0,fb("span",{},void 0,(0,g.t)("System",0===v?"Get started":"Label more documents")))));const N=fb("div",{className:"block"},void 0,fb("div",{className:"stretch"},void 0,S&&r.createElement(r.Fragment,null,fb(g.vN,{},void 0,"The current model was trained at")," ",S.toLocaleString()," ",fb(g.vN,{},void 0,"with")," ",h," ",fb(g.vN,{},void 0,"documents."),fb("br",{}),fb("br",{})),(null!=v?v:0)<30*f&&r.createElement(r.Fragment,null,fb(g.vN,{},void 0,"We recommend labeling")," ",30*f," ",fb(g.vN,{},void 0,"documents before training (30 per topic)."),fb("br",{}),fb("br",{})),fb(g.vN,{},void 0,"You have labeled")," ",v," ",fb(g.vN,{},void 0,"documents so far."),b&&r.createElement(r.Fragment,null,fb("br",{}),fb("br",{}),fb(g.vN,{},void 0,"Uwazi is learning using the labelled documents. This may take up to 2 hours, and once completed you can review suggestions made by Uwazi for your collection."))),fb("div",{className:"footer"},void 0,b&&fb("div",{className:"btn-label property-help"},void 0,fb("span",{},void 0,fb(g.vN,{},void 0,"Learning...")," ",fb(C.JO,{icon:"spinner",spin:!0})),fb("div",{className:"property-description"},void 0,null===(d=u.TrainState)||void 0===d?void 0:d.message)),!b&&v&&v>h&&v>20*f&&fb("button",{type:"button",className:"btn btn-default",onClick:()=>this.props.startTraining()},void 0,fb("span",{className:"btn-label"},void 0,(0,g.t)("System","Train model")))));return fb(Go,{title:"Suggestion Status"},void 0,w,N)}topicNodes(){const{thesaurus:e}=this.props;return mb(e).map((e=>this.topicNode(e)))}componentDidMount(){this.interval=window.setInterval((()=>this.props.updateCockpitData()),1e4)}componentWillUnmount(){this.emptyState(),this.interval&&clearInterval(this.interval)}emptyState(){this.context.store.dispatch(ke.N.unset("thesauri.suggestInfo")),this.context.store.dispatch(ke.N.unset("thesauri.thesaurus")),this.context.store.dispatch(ke.N.unset("thesauri.tasksState"))}renderEnableSuggestionsToggle(){const{thesaurus:e,suggestInfo:t}=this.props;return(t.model&&t.model.preferred||e.enable_classification)&&fb("button",{onClick:()=>this.props.toggleEnableClassification(),className:e.enable_classification?"btn btn-default btn-xs btn-toggle-on":"btn btn-default btn-xs btn-toggle-off",type:"button"},void 0,fb(C.JO,{icon:e.enable_classification?"toggle-on":"toggle-off"})," ",fb("span",{},void 0,(0,g.t)("System","Show Suggestions")))}publishButton(){var e;const{thesaurus:t,suggestInfo:n}=this.props;if(!t||!n.property||null===(e=n.docsWithSuggestionsForPublish)||void 0===e||!e.totalLabels)return null;const o=n.property.name;return fb(g.l3,{title:"publish-button",to:`/library/?quickLabelThesaurus=${t._id}&q=(filters:(__${o}:(values:!(any)),${o}:(values:!(any))),limit:100,order:desc,sort:creationDate,unpublished:!t)`,className:"btn btn-primary btn-xs"},void 0,fb(g.vN,{},void 0,"Review unpublished document"))}render(){var e;const{thesaurus:t,tasksState:n,topicClassificationEnabled:o}=this.props,{name:r}=t;return r&&null!==(e=n.SyncState)&&void 0!==e&&e.state?fb("div",{className:"settings-content"},void 0,fb("div",{className:"flex thesaurus-cockpit panel panel-default"},void 0,fb("div",{className:"panel-heading"},void 0,(0,g.t)("System",`Thesauri > ${r}`),this.renderEnableSuggestionsToggle(),this.publishButton()),fb("div",{className:"cockpit"},void 0,o&&this.learningNotice(),fb("table",{},void 0,fb("thead",{},void 0,fb("tr",{},void 0,fb("th",{scope:"col"},void 0,r),fb("th",{scope:"col"},void 0,fb(g.vN,{},void 0,"Sample")),fb("th",{scope:"col"},void 0,fb(g.vN,{},void 0,"Documents to be reviewed")),fb("th",{scope:"col"}))),fb("tbody",{},void 0,this.topicNodes())),fb("div",{className:"sync-state"},void 0,n.SyncState.message)),fb("div",{className:"settings-footer"},void 0,fb(g.l3,{to:"/settings/dictionaries",className:"btn btn-default"},void 0,fb(C.JO,{icon:"arrow-left"}),fb("span",{className:"btn-label"},void 0,(0,g.t)("System","Back")))),fb(Xs.Z,{}))):fb("div",{className:"settings-content"},void 0,fb(H.Z,{}))}});var gb,Sb=n(78677);function wb(e,t,n,o){gb||(gb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:gb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nb=e=>{const t=e.name.replace(/\.[^/.]+$/,"").replace(/_/g," ").replace(/-/g," ").replace(/ {2}/g," ");return t.charAt(0).toUpperCase()+t.slice(1)};class Ob extends r.Component{constructor(e){super(e),this.onDrop=this.onDrop.bind(this)}onDrop(e){e.forEach((e=>{const t={title:Nb(e)};this.props.createDocument(t).then((t=>{this.props.uploadDocument(t.sharedId,e)}))})),this.props.unselectAllDocuments()}render(){return wb(jy.Z,{className:"upload-box force-ltr",style:{},onDrop:this.onDrop,accept:"application/pdf"},void 0,wb("div",{className:"upload-box_wrapper"},void 0,wb(C.JO,{icon:"upload"}),wb("button",{type:"button",className:"upload-box_link"},void 0,wb(g.vN,{},void 0,"Browse your PDFs to upload"))," ",wb(g.vN,{},void 0,"or drop your files here.")),wb("div",{className:"protip"},void 0,wb(C.JO,{icon:"lightbulb"}),wb("b",{},void 0,wb(g.vN,{},void 0,"ProTip!")),wb("span",{},void 0,wb(g.vN,{},void 0,"For better performance, upload your files in batches of 50 or less."))))}}const Pb=(0,c.connect)((function(){return{}}),(function(e){return(0,k.bindActionCreators)({uploadDocument:Ur.iG,unselectAllDocuments:I.jh,createDocument:Ur.OE},(0,_.Qd)(e,"uploads"))}))(Ob);var Cb;function kb(e,t,n,o){Cb||(Cb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _b extends r.Component{render(){return kb("div",{className:"content-header"},void 0,kb("div",{className:"content-header-title"},void 0,kb("button",{type:"button",className:"btn btn-success btn-xs",onClick:()=>this.props.newEntity("uploads")},void 0,kb(C.JO,{icon:"plus"})," ",(0,g.t)("System","New entity")),kb("button",{type:"button",className:"btn btn-success btn-xs",onClick:this.props.showImportPanel},void 0,kb(C.JO,{icon:"upload"})," ",(0,g.t)("System","Import"))))}}const jb=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({newEntity:Ur._Z,showImportPanel:Ur.z0},(0,_.Qd)(e,"uploads"))}))(_b);var Ib,Db;function Tb(e,t,n,o){Ib||(Ib="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ib,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Eb(e,t,n,o){Db||(Db="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Db,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class xb extends Ce{constructor(e,t){super(e,t),this.state={error:!1,error2fa:!1,recoverPassword:!1,tokenRequired:!1},this.submit=this.submit.bind(this),this.setLogin=this.setLogin.bind(this),this.setRecoverPassword=this.setRecoverPassword.bind(this)}attachDispatch(e){this.formDispatch=e}submit(e){return this.state.recoverPassword?this.recoverPassword(e.username):this.login(e)}recoverPassword(e){return this.setState({recoverPassword:!1,error:!1}),this.formDispatch(_e.Nw.reset("loginForm")),this.props.recoverPassword(e)}resolveSuccessfulLogin(){this.props.private?window.location.assign("/"):((0,kr.d)(),this.props.reloadThesauris(),this.props.change("library.search.publishedStatus.values",["published","restricted"]),d.mW.push("/"))}async login(e){try{await this.props.login(e),this.resolveSuccessfulLogin()}catch(e){if(this.state.tokenRequired||409!==e.status){const{tokenRequired:e}=this.state;this.formDispatch(_e.Nw.change("loginForm.token",void 0));const t=e;this.setState({error:!0,tokenRequired:e,error2fa:t})}else this.setState({tokenRequired:!0})}}setRecoverPassword(){this.formDispatch(_e.Nw.reset("loginForm")),this.setState({recoverPassword:!0,error:!1})}setLogin(){this.formDispatch(_e.Nw.reset("loginForm")),this.setState({recoverPassword:!1,tokenRequired:!1,error:!1,error2fa:!1})}render(){let e=this.state.recoverPassword?Eb(g.vN,{},void 0,"Send recovery email"):Eb(g.vN,{},void 0,"Login");return this.state.tokenRequired&&(e=Eb(g.vN,{},void 0,"Verify")),Eb("div",{className:"content login-content"},void 0,Eb("div",{className:"row"},void 0,Eb("div",{className:"col-xs-12 col-sm-4 col-sm-offset-4",suppressHydrationWarning:!0},void 0,Eb("h1",{className:"login-title"},void 0,Eb("img",{src:"/public/logo.svg",title:"uwazi",alt:"uwazi"})),m.C5&&Eb(_e.hD,{onSubmit:this.submit,model:"loginForm",getDispatch:e=>{this.formDispatch=e}},void 0,!this.state.tokenRequired&&r.createElement(r.Fragment,null,Eb("div",{className:"form-group login-email"+(this.state.error?" has-error":"")},void 0,Eb(_e.gN,{model:".username"},void 0,Eb("label",{className:"form-group-label",htmlFor:"username"},void 0,this.state.recoverPassword?Eb(g.vN,{},void 0,"Email"):Eb(g.vN,{},void 0,"User")),Eb("input",{type:"text",name:"username",id:"username",className:"form-control"}))),Eb("div",{className:`form-group login-password ${this.state.error?"has-error":""}${this.state.recoverPassword?" is-hidden":""}`},void 0,Eb("label",{className:"form-group-label",htmlFor:"password"},void 0,Eb(g.vN,{},void 0,"Password")),Eb(_e.gN,{model:".password"},void 0,Eb("input",{type:"password",name:"password",id:"password",className:"form-control"})),Eb("div",{className:"form-text"},void 0,this.state.error&&Eb("span",{},void 0,(0,g.t)("System","Login failed")," - "),Eb("span",{title:(0,g.t)("System","Forgot Password?",null,!1),onClick:this.setRecoverPassword,className:"button forgot-password "+(this.state.error?"label-danger":"")},void 0,Eb(g.vN,{},void 0,"Forgot Password?"))))),this.state.tokenRequired&&Eb("div",{className:"form-group login-token"+(this.state.error2fa?" has-error":"")},void 0,Eb("h5",{},void 0,(0,g.t)("System","Two-step verification")),Eb(_e.gN,{model:".token"},void 0,Eb("label",{className:"form-group-label",htmlFor:"token"},void 0,(0,g.t)("System","Authentication code")),Eb("input",{type:"text",name:"token",id:"token",className:"form-control"}),Eb("div",{className:"form-text"},void 0,Eb("p",{},void 0,this.state.error2fa&&r.createElement(r.Fragment,null,Eb(C.JO,{icon:"exclamation-triangle"}),Eb("span",{},void 0,(0,g.t)("System","Two-factor verification failed")))),Eb("p",{},void 0,Eb(g.vN,{},void 0,"Open the two-factor Authenticator app on your device")," ",Eb("br",{}),Eb(g.vN,{},void 0,"to view your authentication code and verify your identity.")),Eb("p",{},void 0,Eb("span",{onClick:this.setLogin,className:"button forgot-password "+(this.state.error2fa?"label-danger":"")},void 0,Eb(g.vN,{},void 0,"Return to login")))))),Eb("p",{},void 0,Eb("button",{type:"submit",className:"btn btn-block btn-lg "+(this.state.recoverPassword?"btn-success":"btn-primary")},void 0,e)),this.state.recoverPassword&&Eb("div",{className:"form-text"},void 0,Eb("span",{title:(0,g.t)("System","Cancel",null,!1),onClick:this.setLogin,className:"button cancel"},void 0,Eb(g.vN,{},void 0,"Cancel")))))))}}xb.propTypes={login:u().func,recoverPassword:u().func,reloadThesauris:u().func,change:u().func};const Ab=(0,c.connect)((function({settings:e}){return{private:e.collection.get("private")}}),(function(e){return(0,k.bindActionCreators)({login:j.Z.actions.login,recoverPassword:j.Z.actions.recoverPassword,reloadThesauris:ty,change:_e.Nw.change},e)}))(xb);var $b,Rb=n(80129),Fb=n.n(Rb);function Lb(e,t,n,o){$b||($b="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:$b,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Jb extends Ce{constructor(e,t){super(e,t),this.state={error:!1,password:"",repeatPassword:""},this.submit=this.submit.bind(this),this.passwordChange=this.passwordChange.bind(this),this.repeatPasswordChange=this.repeatPasswordChange.bind(this)}passwordChange(e){this.setState({password:e.target.value}),this.setState({passwordError:!1})}repeatPasswordChange(e){this.setState({repeatPassword:e.target.value}),this.setState({passwordError:!1})}submit(e){e.preventDefault();const t=this.state.password!==this.state.repeatPassword;""===this.state.password.trim()||t?this.setState({error:!0}):(this.props.resetPassword(this.state.password,this.props.params.key).then((()=>{d.mW.push("/login")})),this.setState({password:"",repeatPassword:""}))}render(){return Lb("div",{className:"content login-content"},void 0,Lb("div",{className:"row"},void 0,Lb("div",{className:"col-xs-12 col-sm-4 col-sm-offset-4"},void 0,"true"===Fb().parse(this.context.router.location.search,{ignoreQueryPrefix:!0}).createAccount&&Lb("div",{className:"alert alert-info"},void 0,Lb(C.JO,{icon:"info-circle"}),Lb("div",{},void 0,Lb(g.vN,{},void 0,"To complete the account creation process, please create a password for your account"))),Lb("form",{onSubmit:this.submit},void 0,Lb("div",{className:"form-group login-email "+(this.state.error?"has-error":"")},void 0,Lb("label",{className:"form-group-label",htmlFor:"password"},void 0,Lb(g.vN,{},void 0,"Password")),Lb("input",{onChange:this.passwordChange,value:this.state.password,type:"password",name:"password",id:"password",className:"form-control"})),Lb("div",{className:"form-group login-password "+(this.state.error?"has-error":"")},void 0,Lb("label",{className:"form-group-label",htmlFor:"repeat-password"},void 0,Lb(g.vN,{},void 0,"Repeat Password")),Lb("input",{value:this.state.repeatPassword,onChange:this.repeatPasswordChange,type:"password",name:"repeat-password",id:"repeat-password",className:"form-control"}),this.state.error&&Lb("div",{className:"required"},void 0,Lb(g.vN,{},void 0,"Passwords don’t match"))),Lb("button",{type:"submit",className:"btn btn-block btn-lg btn-primary"},void 0,Lb(g.vN,{},void 0,"Save password"))))))}}Jb.propTypes={resetPassword:u().func,params:u().shape({key:u().string})};const Zb=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({resetPassword:j.Z.actions.resetPassword},e)}))(Jb);var Mb;function Vb(e,t,n,o){Mb||(Mb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Mb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ub extends Ce{unlockAccount(){const{username:e,code:t}=this.props.params;this.props.unlockAccount({username:e,code:t}).then((()=>{d.mW.push("/login")})).catch((()=>{d.mW.push("/login")}))}componentDidMount(){this.unlockAccount()}render(){return Vb("div",{className:"content login-content"},void 0,Vb("div",{className:"row"},void 0,Vb("div",{className:"col-xs-12 col-sm-4 col-sm-offset-4 text-center"},void 0,Vb(g.vN,{},void 0,"Verifying..."))))}}Ub.propTypes={unlockAccount:u().func,params:u().shape({username:u().string,code:u().string})};const zb=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({unlockAccount:j.Z.actions.unlockAccount},e)}))(Ub);var Kb=n(54876);const Bb=["location"];function Hb(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qb(){return qb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},qb.apply(this,arguments)}var Wb;function Gb(e,t,n,o){Wb||(Wb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Wb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qb=(e,t)=>({className:e===t?"btn disabled":"btn",rel:e===t?"nofollow":void 0}),Yb=({page:e,totalPages:t,onPageChange:n})=>{const o=e-1||1,i=e+1>t?t:e+1;return Gb("div",{className:"paginator"},void 0,r.createElement(bt.Xq,qb({queryParams:{page:o},onClick:e=>{e.preventDefault(),n(o)}},Qb(e,1)),Gb(g.vN,{},void 0,"Previous")),Gb("span",{},void 0,` ${e} / ${t} `),r.createElement(bt.Xq,qb({queryParams:{page:i},onClick:e=>{e.preventDefault(),n(i)}},Qb(e,t)),Gb(g.vN,{},void 0,"Next")))};Yb.defaultProps={page:1,totalPages:1,onPageChange:()=>{}};const Xb=(0,d.EN)((e=>{const{location:t}=e,n=Hb(e,Bb);return r.createElement(Yb,qb({},n,{page:Number(t.query.page||1)}))}));var eg;function tg(e,t,n,o){eg||(eg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:eg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ng extends r.Component{confirm(){this.props.hideModal("ConfirmCloseForm"),this.props.closePanel(),this.props.resetForm("documentViewer.sidepanel.metadata")}render(){if(!this.props.doc)return!1;const{doc:e}=this.props;return tg(B.Z,{isOpen:!!e,type:"danger"},void 0,tg(B.Z.Body,{},void 0,tg("h4",{},void 0,tg(g.vN,{},void 0,"Confirm")),tg("p",{},void 0,tg(g.vN,{},void 0,"All changes will be lost, are you sure you want to proceed?"))),tg(B.Z.Footer,{},void 0,tg("button",{type:"button",className:"btn btn-default cancel-button",onClick:()=>this.props.hideModal("ConfirmCloseForm")},void 0,tg(C.JO,{icon:"times"})," ",tg(g.vN,{},void 0,"Cancel")),tg("button",{type:"button",className:"btn btn-danger confirm-button",onClick:()=>this.confirm()},void 0,tg(C.JO,{icon:"trash-alt"})," ",tg(g.vN,{},void 0,"Ok"))))}}const og=(0,c.connect)((e=>({doc:e.modals.get("ConfirmCloseForm")})),(function(e){return(0,k.bindActionCreators)({closePanel:La.sR,hideModal:gr,resetForm:_e.Nw.reset},e)}))(ng);const rg=(0,c.connect)((e=>{const{documentViewer:t}=e,{templates:n}=e;let{doc:o}=t;t.targetDoc.get("_id")&&(o=t.targetDoc);const r=e.semanticSearch.selectedDocument;r.isEmpty()||r.get("sharedId")!==o.get("sharedId")||(o=o.set("semanticSearch",r.get("semanticSearch")));const i=t.tocForm||[];return{open:"viewMetadataPanel"===t.uiState.get("panel"),doc:o,templates:n,rawDoc:t.doc,docBeingEdited:!!t.sidepanel.metadata._id,formDirty:!t.sidepanel.metadataForm.$form.pristine,tab:t.sidepanel.tab||"metadata",tocFormComponent:mr.ct,tocForm:i,tocFormLength:i.length,tocBeingEdited:t.tocBeingEdited,tocFormState:t.tocFormState,isTargetDoc:!!t.targetDoc.get("_id"),formPath:"documentViewer.sidepanel.metadata",EntityForm:ks}}),(function(e){return(0,k.bindActionCreators)({loadInReduxForm:fr.Nw.loadInReduxForm,showModal:Sr.actions.showModal,startNewConnection:fu.Nw.startNewConnection,closeConnectionsPanel:fu.Aw.sR,resetForm:_e.Nw.reset,closePanel:La.sR,deleteDocument:vs,saveToc:hs,editToc:ws,leaveEditMode:Ns,removeFromToc:Os,indentTocElement:Ps,showTab:e=>ke.N.set("viewer.sidepanel.tab",e)},e)}))(mr.GV);var ig;function ag(e,t,n,o){ig||(ig="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:ig,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class sg extends r.Component{render(){return ag("div",{className:this.props.active?"active":""},void 0,ag($n.Z,{if:!this.props.panelIsOpen},void 0,ag("div",{className:"btn btn-primary",onClick:this.props.openPanel.bind(null,"viewMetadataPanel")},void 0,ag(C.JO,{icon:"columns"}))))}}sg.contextTypes={confirm:u().func};const lg=(0,c.connect)((({documentViewer:e})=>({panelIsOpen:!!e.uiState.get("panel"),doc:e.doc,targetDoc:!!e.targetDoc.get("_id")})),(function(e){return(0,k.bindActionCreators)({openPanel:La.Yp},e)}))(sg);var cg;function dg(e,t,n,o){cg||(cg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:cg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pg extends r.Component{showPanel(e){this.props.openPanel("viewMetadataPanel"),this.props.startNewConnection(e,this.props.doc.get("sharedId"))}render(){return dg("div",{className:this.props.active?"active":""},void 0,dg($n.Z,{if:this.props.hasRelationTypes},void 0,dg("div",{className:"btn btn-primary connect-to-p",onClick:this.showPanel.bind(this,"targetRanged")},void 0,dg("span",{className:"ContextMenu-tooltip"},void 0,dg(g.vN,{},void 0,"Connect to a paragraph")),dg(C.JO,{icon:"paragraph"}))),dg($n.Z,{if:this.props.hasRelationTypes},void 0,dg("div",{className:"btn btn-primary connect-to-d",onClick:this.showPanel.bind(this,"ranged")},void 0,dg("span",{className:"ContextMenu-tooltip"},void 0,dg(g.vN,{},void 0,"Connect to a document")),dg(C.JO,{icon:"file"}))),dg("div",{className:"btn btn-primary add-toc",onClick:this.props.addToToc.bind(null,this.props.reference.toJS(),this.props.file.toc)},void 0,dg("span",{className:"ContextMenu-tooltip"},void 0,dg(g.vN,{},void 0,"Add to table of contents")),dg(C.JO,{icon:"font"})))}}const ug=(0,c.connect)((function({documentViewer:e,relationTypes:t}){return{doc:e.doc,reference:e.uiState.get("reference"),hasRelationTypes:!!t.size}}),(function(e){return(0,k.bindActionCreators)({startNewConnection:fu.Nw.startNewConnection,openPanel:La.Yp,addToToc:Cs},e)}))(pg);var mg;function fg(e,t,n,o){mg||(mg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:mg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class hg extends r.Component{constructor(e){super(e),this.save=this.save.bind(this)}save(){const{reference:e,connection:t}=this.props,{targetRange:n,targetFile:o}=e;return this.props.saveTargetRangedReference(t.toJS(),n,o,(e=>{this.props.addReference(e,!0)}))}render(){const{targetDocument:e,reference:t}=this.props,{targetRange:n}=t;let o="btn btn-default hidden";return e&&n&&(o="btn btn-success"),fg("div",{},void 0,fg("div",{className:"relationship-steps is-fixed"},void 0,fg("button",{type:"button",onClick:this.props.cancelTargetDocument,className:"btn btn-default"},void 0,fg(C.JO,{icon:"arrow-left"}),fg(g.vN,{},void 0,"Back")),fg("h2",{},void 0,fg(g.vN,{},void 0,"Select target paragraph"),fg("small",{},void 0,"3"))),fg("div",{className:"ContextMenu ContextMenu-center"},void 0,fg("button",{type:"button",onClick:this.save,className:o},void 0,fg(C.JO,{icon:"save"}),fg("span",{className:"ContextMenu-tooltip"},void 0,fg(g.vN,{},void 0,"Save")))))}}const vg=(0,c.connect)((function({documentViewer:e,connections:t}){return{connection:t.connection,reference:e.uiState.toJS().reference,targetDocument:e.targetDoc.get("_id")}}),(function(e){return(0,k.bindActionCreators)({saveTargetRangedReference:ym.saveTargetRangedReference,cancelTargetDocument:Ss,addReference:ym.addReference},e)}))(hg);const yg=(0,c.connect)((e=>{const{documentViewer:t}=e,n=t.uiState.toJS(),o=(0,Ya.selectTargetDoc)(e),r=o.get("defaultDoc")?o.get("defaultDoc").toJS():{};return{doc:o,file:r,references:(0,Ya.selectTargetReferences)(e),docHTML:t.targetDocHTML,selection:n.reference.targetRange,className:"targetDocument",activeReference:n.activeReference,disableTextSelection:!1,header:vg}}),(function(e){return(0,k.bindActionCreators)({setSelection:Fa.px,unsetSelection:Fa.T8,highlightReference:La.D$,activateReference:La.hy,deactivateReference:La.QB},e)}))(Qa),bg=()=>(0,g.t)("System","OCR button tip",null,!1),gg=e=>{let t="The document's language is not supported.";return"other"===e&&(t="Please select a language for this document"),(0,g.t)("System",t,null,!1)},Sg=e=>`${(0,g.t)("System","OCR error tip",null,!1)}: ${e}`,wg=e=>`${(0,g.t)("System","Last updated",null,!1)}: ${e}`;var Ng;function Og(e,t,n,o){Ng||(Ng="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Ng,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pg=(0,c.connect)((({settings:e,locale:t})=>({ocrIsToggled:e.collection.get("ocrServiceEnabled")||!1,locale:t})),(e=>(0,k.bindActionCreators)({loadDocument:gs},e)))((({file:e,ocrIsToggled:t,locale:n,loadDocument:o})=>{if(!t)return null;const[i,a]=(0,r.useState)({status:"loading",lastUpdated:Date.now()}),s=t=>{e._id===t&&(a({status:"ocrComplete",lastUpdated:Date.now()}),o(e.entity))},l=t=>{e._id===t&&a({status:"ocrError",lastUpdated:Date.now()})};(0,r.useEffect)((()=>((async e=>{const{json:{status:t,lastUpdated:n}}=await de.Z.get(`files/${e}/ocr`);return{status:t,lastUpdated:n}})(e.filename||"").then((({status:e,lastUpdated:t})=>{a({status:e,lastUpdated:t}),"inQueue"===e&&(kr.W.on("ocr:ready",s),kr.W.on("ocr:error",l))})).catch((()=>{a({status:"ocrError",lastUpdated:Date.now()})})),()=>{kr.W.off("ocr:ready",s),kr.W.off("ocr:error",l)})),[e]);const c=()=>{a({status:"inQueue",lastUpdated:Date.now()}),(async e=>{await de.Z.post(`files/${e}/ocr`)})(e.filename||"").then((()=>{kr.W.on("ocr:ready",s),kr.W.on("ocr:error",l)})).catch((()=>{}))},d=((e,t)=>new Date(e).toLocaleString(t))(i.lastUpdated,n);let p,u=Og("div",{});switch(i.status){case"loading":u=Og("div",{className:"status"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"Loading")," ..."));break;case"noOCR":u=Og("button",{type:"button",className:"btn btn-default",onClick:()=>c()},void 0,Og(g.vN,{},void 0,"OCR PDF")),p=bg();break;case"inQueue":u=Og("div",{className:"status"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"In OCR queue"))),p=wg(d);break;case"unsupported_language":u=Og("div",{className:"status"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"Unsupported OCR language"))),p=gg(e.language||"other");break;case"cannotProcess":u=Og("div",{className:"status"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"OCR error"))),p=Sg(d);break;case"ocrError":u=Og("div",{className:"ocr-error"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"Could not be processed"))),p=Sg(d);break;case"withOCR":u=Og("div",{className:"status"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"OCR")," ✔")),p=wg(d);break;case"ocrComplete":u=Og("div",{className:"complete"},void 0,Og("p",{},void 0,Og(g.vN,{},void 0,"OCR completed")," ✔"))}return Og("div",{className:"ocr-service-display"},void 0,u,p&&Og("div",{className:"ocr-tooltip"},void 0,p))}));var Cg;function kg(e,t,n,o){Cg||(Cg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:Cg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _g extends r.Component{constructor(e){super(e),this.state={firstRender:!0},this.handlePlainTextClick=this.handlePlainTextClick.bind(this)}componentDidMount(){const{store:e}=this.context,{sidepanelTab:t}=this.props;e.dispatch((0,La.Yp)("viewMetadataPanel")),"connections"===t&&e.dispatch(ke.N.set("viewer.sidepanel.tab","")),e.dispatch({type:ss.LX}),Kb.Z.init("div.main-wrapper"),this.setState({firstRender:!1})}handlePlainTextClick(){const{showTab:e}=this.props;e("metadata")}prepareClassName(e){const{panelIsOpen:t,targetDoc:n,showConnections:o}=this.props;let r="document-viewer with-header";return r+=t?" with-panel is-active":"",r+=n?" show-target-document":"",r+=o?" connections":"",r+=e?" with-footer":"",r}renderNoDoc(){const{doc:e}=this.props;return kg("div",{className:"row"},void 0,kg("div",{className:"content-header content-header-document"},void 0,kg("div",{className:"content-header-title"},void 0,kg(bt.JO,{icon:"lightbulb"}),kg(g.vN,{},void 0,"This entity has no document, you probably want to see the metadata")," ",kg(g.l3,{to:`/entity/${e.get("sharedId")}`},void 0,kg(g.vN,{},void 0,"view")))))}render(){const{doc:e,sidepanelTab:t,targetDoc:n,changePage:o,onPageChange:i,onDocumentReady:a,addReference:s,loadTargetDocument:l,panelIsOpen:c,showTextSelectMenu:d,file:p,user:u}=this.props,{firstRender:m}=this.state;if(e.get("_id")&&!e.get("documents").size)return this.renderNoDoc();const f=u.get("_id")&&"connections"===t,h=this.prepareClassName(f),{raw:v,searchTerm:y,pageText:b,page:S}=this.props,w=e.get("title")?e.get("title"):"";return kg("div",{className:"row"},void 0,kg(M.q,{},void 0,kg("title",{},void 0,`${w} • Page ${S}`)),kg($n.Z,{if:!n},void 0,kg("div",{className:"content-header content-header-document"},void 0,kg("div",{className:"content-header-title"},void 0,"connections"!==t&&r.createElement(r.Fragment,null,kg(Xb,{totalPages:p.totalPages,onPageChange:o}),kg(j.W,{roles:["admin","editor"]},void 0,kg(ph.e,{feature:"ocr.url"},void 0,kg(Pg,{file:p}))),kg(bt.Xq,{onClick:v?()=>{}:this.handlePlainTextClick,className:"btn btn-default",queryParams:{raw:v||m?"":"true"}},void 0,kg(g.vN,{},void 0,v||m?"Normal view":"Plain text")))))),kg("main",{className:h},void 0,kg("div",{className:"main-wrapper"},void 0,kg($n.Z,{if:"connections"!==t&&!n},void 0,v||m?kg("div",{className:`${Ma(p)} raw-text`},void 0,b):kg(rs,{searchTerm:y,onPageChange:i,onDocumentReady:a,file:p})),kg($n.Z,{if:"connections"===t},void 0,kg(hu.Z8,{hideFooter:!0,searchCentered:!0})),kg(yg,{}),kg(Xs.Z,{})),f&&kg("div",{className:"entity-footer remove-nesting "+(c?"with-sidepanel":"")},void 0,kg(is.ne,{}))),kg(og,{}),kg(rg,{raw:v||m,storeKey:"documentViewer",searchTerm:y,file:p}),kg(fu.CJ,{containerId:n?"target":e.get("sharedId"),onCreate:s,onRangedConnect:l,file:p}),"connections"===t&&r.createElement(r.Fragment,null,kg(zu,{}),kg(Fu,{})),kg(Nu,{align:"bottom"+(f?"-with-footer":""),overrideShow:!0,show:!c},void 0,kg(lg,{})),kg(Nu,{align:"center",overrideShow:!0,show:d},void 0,kg(ug,{file:p})))}}_g.defaultProps={searchTerm:"",raw:!1,onPageChange:()=>{},changePage:()=>{},onDocumentReady:()=>{},page:1,doc:(0,je.Map)(),file:{},user:(0,je.Map)({})},_g.contextTypes={store:u().object};const jg=(0,c.connect)((e=>{const{documentViewer:t}=e,n=t.uiState.toJS();return{pageText:t.rawText,doc:(0,Ya.selectDoc)(e),panelIsOpen:!!n.panel,targetDoc:!!t.targetDoc.get("_id"),locale:e.locale,sidepanelTab:t.sidepanel.tab,showConnections:"references"===t.sidepanel.tab,showTextSelectMenu:Boolean(!t.targetDoc.get("_id")&&n.reference&&n.reference.sourceRange),user:e.user}}),(e=>(0,k.bindActionCreators)({addReference:ym.addReference,loadTargetDocument:bs,showTab:e=>ke.N.set("viewer.sidepanel.tab",e)},e)))(_g);function Ig(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Dg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ig(Object(n),!0).forEach((function(t){Tg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ig(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Eg=["page"];var xg;function Ag(e,t,n,o){xg||(xg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:xg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function $g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Rg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$g(Object(n),!0).forEach((function(t){Fg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lg(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const Jg=e=>e.get("defaultDoc")?e.get("defaultDoc").toJS():{};class Zg extends r.Component{static async requestState(e,t){return async function(e,t){const{sharedId:n,raw:o,page:r}=e.data,i=t.settings.collection.get("languages").find((e=>e.get("default"))),[a,s,[l,c,d]]=await Promise.all([ys(e.set({sharedId:n}),i?i.get("key"):"en",e.data.file),Ql.get(e.onlyHeaders()),nu.yR(e.set({sharedId:n}),t.templates)]),{defaultDoc:p}=a,u=o?await da.Z.getRawPage(e.set({_id:p._id,page:r})):"",m=await as.Z.get(e.set({sharedId:n,file:a.defaultDoc._id,onlyTextReferences:!0}));return[(f={documentViewer:{doc:Dg(Dg({},a),{},{relations:m}),references:m,relationTypes:s,rawText:u},relationships:{list:{sharedId:a.sharedId,entity:a,connectionsGroups:l,searchResults:c,sort:d,filters:{},view:"graph"}},relationTypes:s},e=>{const{documentViewer:t}=f;e(ke.N.set("relationTypes",f.relationTypes)),e(ke.N.set("viewer/doc",t.doc)),e(ke.N.set("viewer/relationTypes",t.relationTypes)),e(ke.N.set("viewer/rawText",t.rawText)),e((0,ym.setReferences)(t.references)),e(nu.xv(f))})];var f}(e.add({raw:"true"===e.data.raw||!m.C5}),t)}constructor(e,t){super(e,t),this.changeBrowserHistoryPage=this.changeBrowserHistoryPage.bind(this),this.changePage=this.changePage.bind(this),this.onDocumentReady=this.onDocumentReady.bind(this)}componentDidMount(){this.props.location.query.searchTerm&&this.context.store.dispatch(ke.N.set("viewer.sidepanel.tab","text-search"))}componentWillReceiveProps(e){const{query:t={}}=e.location;t.page!==this.props.location.query.page&&"true"!==t.raw&&this.changePage(t.page),t.page===this.props.location.query.page&&t.raw===this.props.location.query.raw||"true"!==t.raw||da.Z.getRawPage(new pe.K({_id:Jg(e.entity)._id,page:t.page})).then((e=>{this.context.store.dispatch(ke.N.set("viewer/rawText",e))}))}componentWillUnmount(){this.props.leaveEditMode()}onDocumentReady(e){if(m.U3.emit("documentLoaded"),"true"===this.props.location.query.raw)return;this.props.location.query.page&&(0,La.HS)(this.props.location.query.page,0);const{ref:t}=this.props.location.query;if(t){const n=e.get("relations").find((e=>e.get("_id")===t));this.context.store.dispatch((0,La._V)(n.toJS()))}}changePage(e){return this.props.location.query.raw?this.changeBrowserHistoryPage(e):(0,La.HS)(e)}changeBrowserHistoryPage(e){const t=this.props.location,{query:{page:n}}=t,o=Lg(t.query,Eg);o.raw=o.raw||void 0,d.mW.push(`${this.props.location.pathname}${(0,di._k)(Rg(Rg({},o),{},{page:e}))}`)}render(){const{query:e={},pathname:t}=this.props.location,n="true"===e.raw||!m.C5,o=Number(e.page||1);return r.createElement(r.Fragment,null,Ag(M.q,{},void 0,n&&Ag("link",{rel:"canonical",href:`${t}?page=${o}`})),Ag(jg,{raw:n,searchTerm:e.searchTerm,onPageChange:this.changeBrowserHistoryPage,onDocumentReady:this.onDocumentReady,changePage:this.changePage,page:o,file:Jg(this.props.entity)}))}}Zg.contextTypes={store:u().instanceOf(Object)},Zg.defaultProps={leaveEditMode:()=>{}};const Mg=(0,c.connect)(null,(function(e){return(0,k.bindActionCreators)({leaveEditMode:Ns},e)}))(Zg);const Vg=(0,c.connect)((function({entityView:e}){return{open:e.uiState.get("showFilters")}}),(function(e){return(0,k.bindActionCreators)({showFilters:Ft.rR,hideFilters:Ft.BP,unselectAllDocuments:()=>{}},e)}))(km);const Ug=(0,c.connect)((function(e){return{model:"entityView.entityForm",templateId:e.entityView.entityForm.template,templates:e.templates,thesauris:e.thesauris}}),(function(e){return(0,k.bindActionCreators)({changeTemplate:fr.Nw.changeTemplate,onSubmit:hr.FU,componentWillUnmount:hr.Fx},e)}))(fr.n0);var zg;function Kg(e,t,n,o){zg||(zg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:zg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Bg extends r.Component{constructor(e,t){super(e,t),this.state={panelOpen:!this.props.hasPageView,copyFrom:!1,copyFromProps:[]},this.deleteEntity=this.deleteEntity.bind(this),this.closePanel=this.closePanel.bind(this),this.openPanel=this.openPanel.bind(this),this.toggleCopyFrom=this.toggleCopyFrom.bind(this),this.onCopyFromSelect=this.onCopyFromSelect.bind(this),this.deleteConnection=this.deleteConnection.bind(this)}onCopyFromSelect(e){this.setState({copyFromProps:e})}deleteEntity(){this.context.confirm({accept:()=>{this.props.deleteEntity(this.props.entity.toJS()).then((()=>{d.mW.goBack()}))},title:"Confirm delete",message:"Are you sure you want to delete this entity?"})}toggleCopyFrom(){this.setState((e=>({copyFrom:!e.copyFrom})))}deleteConnection(e){"metadata"!==e.sourceType&&this.context.confirm({accept:()=>{this.props.deleteConnection(e)},title:"Confirm delete connection",message:"Are you sure you want to delete this connection?"})}closePanel(){this.setState({panelOpen:!1})}openPanel(){this.setState({panelOpen:!0})}render(){const{entity:e,entityBeingEdited:t,tab:n,connectionsGroups:o,relationships:i,hasPageView:a,user:s}=this.props,{panelOpen:l,copyFrom:c,copyFromProps:d}=this.state,p=e.toJS(),u=o.reduce(((e,t)=>(t.get("templates").forEach((t=>{e.totalConnections+=t.get("count")})),e)),{totalConnections:0}),m=s.get("_id")&&["info","connections"].includes(n),f=`entity-viewer ${["info","connections"].includes(n)?"with-header":""} ${s.get("_id")&&m?"with-footer":""} ${l?"with-panel":""}`;return Kg("div",{className:"row"},void 0,Kg(M.q,{},void 0,Kg("title",{},void 0,e.get("title")?e.get("title"):"Entity")),"page"!==n&&Kg("div",{className:"content-header content-header-entity"},void 0,Kg("div",{className:"content-header-title"},void 0,Kg(bt.JO,{className:"item-icon item-icon-center",data:e.get("icon"),size:"sm"}),Kg("h1",{className:"item-name"},void 0,e.get("title")),Kg(bt.L2,{template:e.get("template")}))),Kg("main",{className:f},void 0,Kg(em.mQ,{selectedTab:n},void 0,a&&Kg(em.I5,{for:"page"},void 0,Kg(Jl,{setBrowserTitle:!1})),Kg(em.I5,{for:"info"===n||"attachments"===n?n:"none"},void 0,Kg("div",{className:"entity-metadata"},void 0,t?Kg(Ug,{highlightedProps:d}):Kg("div",{},void 0,Kg(fr.$o,{relationships:i,entity:p,showTitle:!1,showType:!1,groupGeolocations:!0}),Kg(mu.m,{files:p.documents,entity:p}),Kg(uu.Fy,{attachments:p.attachments,parentId:e.get("_id"),parentSharedId:e.get("sharedId"),entityView:!0,processed:e.get("processed")})))),Kg(em.I5,{for:"connections"},void 0,Kg(hu.Z8,{deleteConnection:this.deleteConnection,searchCentered:!0})))),s.get("_id")&&r.createElement(r.Fragment,null,Kg($n.Z,{if:"info"===n||"attachments"===n},void 0,Kg("div",{className:"entity-footer "+(l?"with-sidepanel":"")},void 0,Kg(fr.rJ,{includeViewButton:!1,delete:this.deleteEntity,data:this.props.entity,formStatePath:"entityView.entityForm",entityBeingEdited:t,copyFrom:this.toggleCopyFrom}))),Kg($n.Z,{if:"connections"===n},void 0,Kg("div",{className:"entity-footer "+(l?"with-sidepanel":"")},void 0,Kg(is.ne,{})))),Kg(On.Z,{className:`entity-connections entity-${n}`,open:l},void 0,Kg("div",{className:"sidepanel-header"},void 0,Kg("button",{type:"button",className:"closeSidepanel close-modal",onClick:this.closePanel.bind(this),"aria-label":"Close side panel"},void 0,Kg(C.JO,{icon:"times"})),Kg(em.mQ,{className:"content-header-tabs",selectedTab:n,handleSelect:e=>{this.props.showTab(e)}},void 0,Kg("ul",{className:"nav nav-tabs"},void 0,a&&Kg("li",{},void 0,Kg(em.fK,{to:"page",role:"button",tabIndex:"0","aria-label":(0,g.t)("System","Page",null,!1),component:"div"},void 0,Kg(C.JO,{icon:"file-image"}),Kg("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Page")))),Kg("li",{},void 0,Kg(em.fK,{to:"info",role:"button",tabIndex:"0","aria-label":(0,g.t)("System","Info",null,!1),component:"div"},void 0,Kg(C.JO,{icon:"info-circle"}),Kg("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Info")))),Kg("li",{},void 0,Kg(em.fK,{to:"connections",role:"button",tabIndex:"0","aria-label":(0,g.t)("System","Connections",null,!1),component:"div"},void 0,Kg(C.JO,{icon:"exchange-alt"}),Kg("span",{className:"connectionsNumber"},void 0,u.totalConnections),Kg("span",{className:"tab-link-tooltip"},void 0,(0,g.t)("System","Connections"))))))),Kg($n.Z,{if:"info"===n||"connections"===n},void 0,Kg("div",{className:"sidepanel-footer"},void 0,Kg(hu.wQ,{}))),Kg("div",{className:"sidepanel-body"},void 0,Kg(em.mQ,{selectedTab:n},void 0,Kg(em.I5,{for:["info","connections","page"].includes(n)?n:"none"},void 0,Kg(hu.Bc,{}))))),Kg(On.Z,{className:"copy-from-panel",open:c},void 0,Kg("div",{className:"sidepanel-body"},void 0,Kg(Ju.O,{originalEntity:this.props.entity.toJS(),templates:this.props.templates,onSelect:this.onCopyFromSelect,formModel:"entityView.entityForm",onCancel:this.toggleCopyFrom}))),Kg(Nu,{align:"bottom"+(m?"-with-footer":""),overrideShow:!0,show:!l,className:"show-info-sidepanel-context-menu"},void 0,Kg(Cu,{className:"show-info-sidepanel-menu",panelIsOpen:l,openPanel:this.openPanel})),Kg(fu.CJ,{className:"entity-create-connection-panel",containerId:e.sharedId,onCreate:this.props.connectionsChanged}),Kg(Fu,{}),Kg(zu,{}))}}Bg.defaultProps={relationships:Ie().fromJS([]),entityBeingEdited:!1,tab:"info",hasPageView:!1,user:Ie().fromJS({})},Bg.contextTypes={confirm:u().func};const Hg=(0,Lt.P1)((e=>e.relationTypes),(e=>e.toJS()));const qg=(0,c.connect)((e=>{const t=e.entityView.entity&&e.entityView.entity.get("template"),n=e.templates.find((e=>e.get("_id")===t)).get("entityViewPage"),o=n?"page":"info",{uiState:r}=e.entityView;return{entity:e.entityView.entity,relationTypes:Hg(e),templates:e.templates,relationships:e.entityView.entity.get("relations"),connectionsGroups:e.relationships.list.connectionsGroups,entityBeingEdited:!!e.entityView.entityForm._id,tab:r.get("userSelectedTab")?r.get("tab"):o,hasPageView:Boolean(n),user:e.user,library:e.library}}),(function(e){return(0,k.bindActionCreators)({deleteEntity:hr.Ks,connectionsChanged:vu.connectionsChanged,deleteConnection:vu.deleteConnection,showTab:Ft.$1,startNewConnection:fu.Nw.startNewConnection},e)}))(Bg);function Wg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Gg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wg(Object(n),!0).forEach((function(t){Qg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Yg=e=>(0,xn.pick)(e,["title","sharedId","creationDate","editDate","language","template","inheritedProperty"]),Xg=e=>"relationship"===e.type?"inherit":e.type,eS=e=>{const t=((0,xn.isArray)(e.value)&&e.value.length?e.value:[e]).map((t=>{const n=Yg(t.relatedEntity),o="geolocation"===e.type?{displayValue:"value[0]",value:"value"}:{displayValue:"value",value:["timestamp","originalValue","value"]};const r=((e,t)=>{const n=(0,xn.pick)(e,t.value);return(0,xn.isObject)(n)&&!(0,xn.isEmpty)(n)?(0,xn.take)((0,xn.toPairs)(n),1)[0][1]:e})(t,o);return Gg({displayValue:(0,xn.get)(t,o.displayValue,r),value:r,name:e.name,type:Xg(e)},(0,xn.isEmpty)(n)?{}:{reference:n})}));return t},tS=(e,t,n)=>e.reduce(((e,o)=>{const{template:r}=o.entityData,i=`${t.name}-${r}`,a=(e=>Object.entries(e).reduce(((e,[t,n])=>{const o=n.map((e=>e.label&&e.label.length?e.label:e.value)),r={[t]:o};return Gg(Gg({},e),r)}),{}))((0,xn.pick)(o.entityData.metadata,n[r])||{}),s={title:o.entityData.title,sharedId:o.entityData.sharedId,metadata:a};return(0,xn.has)(e,i)?Gg(Gg({},e),{},{[i]:[...e[i],s]}):Gg(Gg({},e),{},{[i]:[s]})}),{}),nS=(e,t,n,o)=>{if(!e.relations||!e.relations.length||!n)return{};const r=((e,t)=>e.reduce(((e,n)=>{var o;const r=null===(o=t.properties)||void 0===o?void 0:o.map((e=>{var t;if(null==e||!e.inherit)return;const o=null===(t=n.properties)||void 0===t?void 0:t.find((t=>{var n;return(null==t?void 0:t._id)===(null==e||null===(n=e.inherit)||void 0===n?void 0:n.property)}));return null==o?void 0:o.name})).filter((e=>!!e));return null!=r&&r.length?Gg(Gg({},e),{},{[n._id]:r}):e}),{}))(o.filter((e=>(null==e?void 0:e.get("_id"))!==n.get("_id"))).toJS(),n.toJS()),i=((e,t)=>{const n=(0,xn.flatMap)(e.metadata,(e=>e.value&&e.value.length?(0,xn.flatMap)(e.value,(e=>e.relatedEntity)):[])).filter((e=>e)).map((e=>e.sharedId));return e.relations.filter((e=>e.entityData&&(0,xn.has)(t,e.entityData.template)&&n.includes(e.entityData.sharedId)))})(e,r),a=(0,xn.groupBy)(i,"template");return Object.entries(a).reduce(((e,[n,o])=>{const i=t.find((({_id:e})=>e===n));if(i){const t=tS(o,i,r);return Gg(Gg({},e),t)}return e}),{})},oS=(e,t,n,o)=>{const r=fr.CN.prepareMetadata(e,n.templates,n.thesauris),i=(e=>{const t=e.metadata.reduce(((e,t)=>Gg(Gg({},e),{},{[t.name]:t})),{});return Gg(Gg({},e),{},{metadata:t})})(r),a=((e,t,n,o)=>{const r=Yg(e),i=e.metadata.reduce(((e,t)=>{const n=eS(t);return Gg(Gg({},e),{},{[t.name]:n})}),{}),a=nS(e,t,n,o);return Gg(Gg({},r),{},{metadata:i,inherited_relationships:a})})(r,o,t,n.templates);return{entity:i,entityRaw:e,entityData:a,template:t.toJS()}};var rS;function iS(e,t,n,o){rS||(rS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:rS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function aS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function sS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lS extends r.Component{static async requestState(e,t){const[[n],o,[r,i,a,s]]=await Promise.all([da.Z.get(e.set({sharedId:e.data.sharedId})),Ql.get(e.onlyHeaders()),nu.yR(e,t)]),l=t.templates.find((e=>e.get("_id")===n.template)),c=[];if(l.get("entityViewPage")){const r=oS(n,l,t,o),{pageView:i,itemLists:a,datasets:s,errors:d}=await Hl(e.set({sharedId:l.get("entityViewPage")}),void 0,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aS(Object(n),!0).forEach((function(t){sS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r));c.push(ke.N.set("page/pageView",i),ke.N.set("page/itemLists",a),ke.N.set("page/datasets",s)),d&&t.user.get("_id")&&c.push(y.J.notify(d,"warning"))}return[ke.N.set("relationTypes",o),ke.N.set("entityView/entity",n),nu.xv({relationships:{list:{sharedId:n.sharedId,entity:n,connectionsGroups:r,searchResults:i,sort:a,filters:s,view:"graph"}}})].concat(c)}componentWillUnmount(){this.context.store.dispatch(Ft.tR()),this.context.store.dispatch(ke.N.unset("page/pageView")),this.context.store.dispatch(ke.N.unset("page/itemLists")),this.context.store.dispatch(ke.N.unset("page/datasets"))}static renderTools(){return iS("div",{className:"searchBox"},void 0,iS(Vg,{storeKey:"library"}))}render(){return iS(qg,{})}}lS.contextTypes={store:u().object};const cS=lS;var dS;function pS(e,t,n,o){dS||(dS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:dS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class uS extends r.Component{render(){const{entity:e}=this.props;return e.get("_id")?e.get("defaultDoc")?r.createElement(Mg,this.props):r.createElement(cS,this.props):pS(H.Z,{})}}const mS=(0,c.connect)((e=>({entity:e.documentViewer.doc.get("_id")?e.documentViewer.doc:e.entityView.entity})))(uS);class fS extends Ce{static async requestState(e,t){const{sharedId:n}=e.data,[o]=await da.Z.get(e.set({sharedId:n,omitRelationships:!0}));return o.documents.length?Mg.requestState(e,t):cS.requestState(e,t)}componentWillUnmount(){this.emptyState()}emptyState(){this.context.store.dispatch(ke.N.unset("viewer/doc")),this.context.store.dispatch(ke.N.unset("viewer/templates")),this.context.store.dispatch(ke.N.unset("viewer/thesauris")),this.context.store.dispatch(ke.N.unset("viewer/relationTypes")),this.context.store.dispatch(ke.N.unset("viewer/rawText")),this.context.store.dispatch(_e.Nw.reset("documentViewer.tocForm")),this.context.store.dispatch(ke.N.unset("viewer/targetDoc")),this.context.store.dispatch((0,ym.setReferences)([])),this.context.store.dispatch(ke.N.unset("entityView/entity")),this.context.store.dispatch(nu.Zu())}urlHasChanged(e){const{query:t}=this.props.location,{query:n}=e.location,o=t.file===n.file;return super.urlHasChanged(e)||!o}render(){return r.createElement(mS,this.props)}}fS.defaultProps={params:{}};const hS=fS;var vS,yS;function bS(e,t,n,o){vS||(vS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:vS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class gS extends Yi{static async requestState(e,t){return Nn(e,t,{calculateTableColumns:!0})}}class SS extends Ce{render(){return bS(gS,{viewer:Wi,location:this.props.location,sidePanelMode:"unpinned-mode",noScrollable:!0})}}function wS(e,t,n,o){yS||(yS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:yS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function NS(){return NS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},NS.apply(this,arguments)}const OS=()=>{X()},PS=(e,t)=>{la.h.getState().user.get("_id")||t("/login")},CS=(e,t)=>{const n=la.h.getState();return(0,Tt.Z)()&&!n.user.get("_id")?t("/login"):(X(),()=>{})},kS=(e,t,n)=>t.user.get("_id")?e(null,{onEnter:(e,t)=>{t("/library/?q=(includeUnpublished:!t)")}}):e(null,(e=>{switch(e){case"table":return{component:SS,onEnter:CS};case"map":return{component:sa,onEnter:OS};default:return{component:Yi,onEnter:CS}}})(n)),_S=wS(d.AW,{getIndexRoute:(e,t)=>{const n=la.h.getState(),o=n.settings.collection.get("home_page")||"",i=o?o.split("/").filter((e=>e)):[],a=n.settings.collection.get("defaultLibraryView");return uh(o)&&0!==i.length?i.includes("page")?t(null,(e=>{OS();const t=e[e.indexOf("page")+1],n=e=>r.createElement(Gl,NS({},e,{params:{sharedId:t}}));return n.requestState=e=>Gl.requestState(e.set({sharedId:t})),{component:n,customHomePageId:t}})(i)):t(null,{onEnter:(e,t)=>{t(i.join("/"))}}):kS(t,n,a)}},void 0,wS(d.AW,{path:"settings",component:Oy,onEnter:PS},void 0,wS(d.AW,{path:"account",component:oh}),wS(d.AW,{path:"2fa",component:vt}),wS(d.AW,{path:"collection",component:Fh}),wS(d.AW,{path:"navlinks",component:qv}),wS(d.AW,{path:"users",component:()=>{const[e,t]=(0,r.useState)("users");return qf("div",{className:"settings-content"},void 0,qf("div",{className:"userManagementTabs"},void 0,qf(em.mQ,{selectedTab:e,renderActiveTabContentOnly:!0,handleSelect:t},void 0,qf("div",{},void 0,qf("ul",{className:"nav"},void 0,qf("li",{},void 0,qf(em.fK,{to:"users",component:"div"},void 0,qf(g.vN,{},void 0,"Users"))),qf("li",{},void 0,qf(em.fK,{to:"usergroups",component:"div"},void 0,qf(g.vN,{},void 0,"Groups"))))),qf(em.I5,{for:"users"},void 0,qf(Bf,{})),qf(em.I5,{for:"usergroups"},void 0,qf(jf,{})))))}}),wS(d.AW,{path:"preserve",component:ky}),wS(d.AW,{path:"pages"},void 0,wS(d.fJ,{component:Dl}),wS(d.AW,{path:"new",component:class extends Ce{render(){return Pl("div",{className:"settings-content"},void 0,Pl(gl,{}))}}}),wS(d.AW,{path:"edit/:sharedId",component:class extends Ce{static async requestState(e){const t=await ll.getById(e);return[_e.Nw.load("page.data",t)]}componentDidMount(){this.context.store.dispatch(_e.Nw.reset("page.data"))}render(){return Ol("div",{className:"settings-content"},void 0,Ol(gl,{}))}}})),wS(d.AW,{path:"templates"},void 0,wS(d.fJ,{component:Xh}),wS(d.AW,{path:"new",component:class extends Ce{static async requestState(e){const[t,n]=await Promise.all([Yd.get(e.onlyHeaders()),Ql.get(e.onlyHeaders())]);return[ke.N.set("thesauris",t),ke.N.set("relationTypes",n)]}render(){return Ly("div",{className:"settings-content sm-footer-extra-row"},void 0,Ly(Qp,{}))}}}),wS(d.AW,{path:"edit/:templateId",component:class extends Ce{static async requestState(e){const{templateId:t}=e.data,[n,o,r]=await Promise.all([rc.get(e.onlyHeaders()),Yd.get(e.onlyHeaders()),Ql.get(e.onlyHeaders())]),i=n.find((e=>e._id===t));return[_e.Nw.load("template.data",mc(i)),ke.N.set("thesauris",o),ke.N.set("templates",n),ke.N.set("relationTypes",r)]}componentDidMount(){this.context.store.dispatch(_e.Nw.reset("template.data"))}render(){return Fy("div",{className:"settings-content sm-footer-extra-row"},void 0,Fy(Ay,{},void 0,Fy(Qp,{})))}}})),wS(d.AW,{path:"metadata_extraction",component:Sa}),wS(d.AW,{path:"metadata_extraction/suggestions/:propertyName",component:sl}),wS(d.AW,{path:"connections"},void 0,wS(d.fJ,{component:Yv}),wS(d.AW,{path:"new",component:class extends Ce{render(){return tu("div",{className:"settings-content"},void 0,tu(Qp,{relationType:!0}))}}}),wS(d.AW,{path:"edit/:_id",component:class extends Ce{static async requestState(e){const[t]=await Ql.get(e);return t.properties=t.properties||[],[Yl(t)]}render(){return eu("div",{className:"settings-content"},void 0,eu(Qp,{relationType:!0}))}}})),wS(d.AW,{path:"dictionaries"},void 0,wS(d.fJ,{component:iy}),wS(d.AW,{path:"new",component:class extends Ce{static async requestState(e){const t=await Yd.get(e);return[ke.N.set("thesauris",t)]}render(){return db("div",{className:"settings-content sm-footer-extra-row"},void 0,db(ib,{new:!0}))}}}),wS(d.AW,{path:"edit/:_id",component:class extends Ce{static async requestState(e){const t=await Yd.get(e);return[(n=t[0],e=>{e(_e.Nw.reset("thesauri.data")),e(_e.Nw.load("thesauri.data",n))})];var n}render(){return cb("div",{className:"settings-content sm-footer-extra-row"},void 0,cb(ib,{}))}}}),wS(d.AW,{path:"cockpit/:_id",component:bb})),wS(d.AW,{path:"languages",component:Pv}),wS(d.AW,{path:"translations"},void 0,wS(d.fJ,{component:cy}),wS(d.AW,{path:"edit/:context",component:class extends Ce{static async requestState(e){const t=await g.K5.get(e);return[g.Nw.editTranslations(t)]}render(){return Dt("div",{className:"settings-content"},void 0,Dt(jt,{context:this.props.params.context}))}}})),wS(d.AW,{path:"filters",component:gv}),wS(d.AW,{path:"customisation",component:Vh}),wS(d.AW,{path:"custom-uploads",component:Ty}),wS(d.AW,{path:"activitylog",component:tt,onEnter:PS})),wS(d.AW,{path:"library",component:Yi,onEnter:CS}),wS(d.AW,{path:"library/map",component:sa,onEnter:OS}),wS(d.AW,{path:"library/table",component:SS,onEnter:CS}),wS(d.AW,{path:"review",component:Om,onEnter:PS}),wS(d.AW,{path:"uploads",component:class extends Ce{constructor(e,t){super(e,t),this.refreshSearch=this.refreshSearch.bind(this)}static renderTools(){return Tb("div",{className:"searchBox"},void 0,Tb(_m,{storeKey:"uploads"}))}urlHasChanged(e){return e.location.query.q!==this.props.location.query.q}emptyState(){(0,_.Qd)(this.context.store.dispatch,"uploads")((0,I.uz)())}static async requestState(e,t){const n=wn(e.data,t,"uploads");n.unpublished=!0;const o=await tn.Z.search(e.set(n)),r=en.ZP.URLQueryToState(n,t.templates.toJS(),t.relationTypes.toJS()),i=Boolean(n.from);return[hn({uploads:{documents:o,filters:{documentTypes:n.types||[],properties:r.properties},aggregations:o.aggregations,search:r.search}},"uploads",i)]}refreshSearch(){super.getClientState(this.props)}componentDidMount(){const e=(0,_.Qd)(this.context.store.dispatch,"uploads");kr.W.on("IMPORT_CSV_END",this.refreshSearch),e((0,I.MI)())}componentWillUnmount(){kr.W.removeListener("IMPORT_CSV_END",this.refreshSearch),this.emptyState()}componentDidUpdate(e){this.urlHasChanged(e)&&this.getClientState(this.props)}render(){const e=rn().decode(this.props.location.query.q||"()"),t="chart"===this.props.location.query.view?Tb(Sb.ZP,{storeKey:"uploads"}):Tb($t,{storeKey:"uploads",SearchBar:ta.ZP});return Tb("div",{className:"row panels-layout"},void 0,Tb(M.q,{},void 0,Tb("title",{},void 0,(0,g.t)("System","Uploads",null,!1))),Tb(jb,{}),Tb("div",{className:"content-holder uploads-viewer document-viewer with-panel with-header"},void 0,Tb("main",{},void 0,Tb(Pb,{}),t),Tb(Ho,{uploadsSection:!0,storeKey:"uploads"}),Tb(Or,{storeKey:"uploads",searchTerm:e.searchTerm}),Tb(Pr,{storeKey:"uploads"}),Tb(ei,{})))}}}),wS(d.AW,{path:"login",component:Ab}),wS(d.AW,{path:"setpassword/:key",component:Zb}),wS(d.AW,{path:"unlockaccount/:username/:code",component:zb}),wS(d.AW,{path:"document/:sharedId*",component:hS,onEnter:OS}),wS(d.AW,{path:"entity/:sharedId",component:hS,onEnter:OS}),wS(d.AW,{path:"page/:sharedId",component:Gl,onEnter:OS}),wS(d.AW,{path:"page/:sharedId/:slug",component:Gl,onEnter:OS}),wS(d.AW,{path:"semanticsearch/:searchId",component:class extends Ce{static async requestState(e,t){const n=t.semanticSearch?t.semanticSearch.resultsFilters:{threshold:.4,minRelevantSentences:5},o=e.add(n),r=await nf.Z.getSearch(o);return[ke.N.set("semanticSearch/search",r)]}static renderTools(){return of("div",{className:"searchBox"},void 0,of(_m,{storeKey:"library"}))}render(){return of(ef,{})}},onEnter:OS}),wS(d.AW,{path:"error/:errorCode",component:nl}),wS(d.AW,{path:"404",component:nl})),jS=wS(d.AW,{path:"/",component:ce},void 0,_S,wS(d.AW,{path:":lang"},void 0,_S,wS(d.AW,{path:"*",component:nl})),wS(d.AW,{path:"*",component:nl}));var IS;function DS(e,t,n,o){IS||(IS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:IS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const TS=()=>DS(c.Provider,{store:la.h},void 0,DS(h,{},void 0,DS(d.F0,{history:d.mW},void 0,jS)));let ES,xS;var AS;function $S(e,t,n,o){AS||(AS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var a=new Array(i),s=0;s<i;s++)a[s]=arguments[s+3];t.children=a}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t||(t=r||{});return{$$typeof:AS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}kr.W.on("disconnect",(e=>{"transport close"===e&&(ES&&la.h.dispatch(y.J.removeNotification(ES)),xS=setTimeout((()=>{ES=la.h.dispatch(y.J.notify("Lost connection to the server, your changes may be lost","danger",!1))}),8e3))})),kr.W.io.on("reconnect",(()=>{clearTimeout(xS),ES&&(la.h.dispatch(y.J.removeNotification(ES)),ES=la.h.dispatch(y.J.notify("Connected to server","success")),ES=null)})),kr.W.on("forceReconnect",(()=>{(0,kr.d)()})),kr.W.on("templateChange",(e=>{la.h.dispatch(ke.N.update("templates",e))})),kr.W.on("templateDelete",(e=>{la.h.dispatch(ke.N.remove("templates",{_id:e.id}))})),kr.W.on("updateSettings",(e=>{la.h.dispatch(ke.N.set("settings/collection",e))})),kr.W.on("thesauriChange",(e=>{la.h.dispatch(ke.N.update("thesauris",e))})),kr.W.on("thesauriDelete",(e=>{la.h.dispatch(ke.N.remove("thesauris",{_id:e.id}))})),kr.W.on("translationsChange",(e=>{la.h.dispatch(ke.N.update("translations",e)),g.t.resetCachedTranslation(),g.vN.resetCachedTranslation()})),kr.W.on("documentProcessed",(e=>{la.h.dispatch((0,Ur.Vt)(e))})),kr.W.on("IMPORT_CSV_START",(()=>la.h.dispatch(ke.N.set("importStart",!0)))),kr.W.on("IMPORT_CSV_PROGRESS",(e=>la.h.dispatch(ke.N.set("importProgress",e)))),kr.W.on("IMPORT_CSV_ERROR",(e=>la.h.dispatch(ke.N.set("importError",e)))),kr.W.on("IMPORT_CSV_END",(()=>la.h.dispatch(ke.N.set("importEnd",!0)))),window.SENTRY_APP_DSN&&a.S({release:window.UWAZI_VERSION,environment:window.UWAZI_ENVIRONMENT,dsn:window.SENTRY_APP_DSN,integrations:[new s.gE],tracesSampleRate:.1});var RS;RS=TS,i.hydrate($S(l.zj,{},void 0,$S(RS,{})),document.getElementById("root"))},82135:(e,t,n)=>{"use strict";n.d(t,{W:()=>s,d:()=>a});var o=n(81130),r=n(36651);let i={on:(e,t)=>{},off:(e,t)=>{}};r.C5&&(i=(0,o.ZP)({transports:["websocket"],upgrade:!1}));const a=()=>{i.disconnect(),i.connect()},s=i},69899:(e,t,n)=>{"use strict";n.d(t,{h:()=>$e});var o=n(36651),r=n(59681),i=n(28500),a=n(74127),s=n(59511),l=n(79223),c=n(43393),d=n.n(c),p=n(11513);const u={thesauris:[],templates:[],propertyBeingDeleted:null};var m=n(99875);const f=(0,a.combineReducers)({data:(0,l.sZ)("template.data",{name:"",properties:[],commonProperties:m.Z.get()}),formState:(0,l.aB)("template.data"),uiState:function(e=u,t={}){return t.type===p.bU?e.set("editingProperty",t.id):t.type===p.aT?e.set("thesauris",t.thesauris):t.type===p.N_?e.set("templates",t.templates):t.type===p.rx?e.set("savingTemplate",!0):t.type===p.X8?e.set("savingTemplate",!1):d().fromJS(e)}});var h=n(83887);const v=(0,a.combineReducers)({pageView:(0,s.Z)("page/pageView",{}),datasets:(0,s.Z)("page/datasets",{}),itemLists:(0,s.Z)("page/itemLists",[]),error:(0,s.Z)("page/error",{}),data:(0,l.sZ)("page.data",{title:"",metadata:{content:""}}),formState:(0,l.aB)("page.data"),uiState:function(e={},t={}){return t.type===h.ul?e.set("savingPage",!0):t.type===h.on?e.set("savingPage",!1):d().fromJS(e)}});var y=n(62522);const b=[];var g=n(84545);const S=(0,a.combineReducers)({suggestInfo:(0,s.Z)("thesauri.suggestInfo",{}),tasksState:(0,s.Z)("thesauri.tasksState",{}),thesaurus:(0,s.Z)("thesauri.thesaurus",{}),data:(0,l.sZ)("thesauri.data",{name:"",values:[{label:"",id:(0,g.Z)()}]}),formState:(0,l.aB)("thesauri.data",{name:"",values:[{label:"",id:(0,g.Z)()}]})}),w=(0,a.combineReducers)({search:(0,s.Z)("activitylog/search",{}),list:(0,s.Z)("activitylog/list",[])});var N=n(52949),O=n(11074);const P=[];const C={reference:{},snippet:{}},k=["targetReferencePanel","referencePanel"];const _=(0,a.combineReducers)({doc:(0,N.ay)((0,s.Z)("viewer/doc",{})),targetDoc:(0,s.Z)("viewer/targetDoc",{}),rawText:(0,s.Z)("viewer/rawText",""),targetDocReferences:(0,s.Z)("viewer/targetDocReferences",[]),references:function(e=P,t={}){if(t.type===O.gL)return d().fromJS(t.references);if(t.type===O.xV)return d().fromJS(P);if(t.type===O.m7)return e.push(d().fromJS(t.reference));if(t.type===O.GF){return e.filter((e=>e.get("hub")===t.reference.hub)).size<=2?e.filter((e=>e.get("hub")!==t.reference.hub)):e.filter((e=>e.get("_id")!==t.reference.associatedRelationship._id))}return d().fromJS(e)},uiState:function(e=C,t={}){if(t.type===O.$M)return e.set("highlightedReference",t.reference);if(t.type===O.U8)return e.set("snippet",t.snippet);if(t.type===O.x0)return e.set("goToActive",t.value);if(t.type===O.d$)return e.remove("activeReference");if(t.type===O.SA)return e.set("activeReference",t.reference);if(t.type===O.no)return e.set("panel",t.panel);if(t.type===O.Fn)return e.set("reference",d().fromJS({}));if(t.type===O.Ls)return e.setIn(["reference","sourceRange"],t.sourceRange).setIn(["reference","sourceFile"],t.sourceFile);if(t.type===O.X8)return e.setIn(["reference","targetRange"],t.targetRange).setIn(["reference","targetFile"],t.targetFile);if(t.type===O.C9)return e.setIn(["reference","targetRange"],null).setIn(["reference","targetFile"],null);if(t.type===O.Zb){const t=e.setIn(["reference","sourceRange"],null).setIn(["reference","sourceFile"],null);return-1!==k.indexOf(e.get("panel"))?t.set("panel",!1):t}if("viewer/targetDocHTML/SET"===t.type||t.type===O.VQ)return e.set("panel",!1);if(t.type===O.m7)return e.set("reference",d().fromJS({})).set("panel",!1);if("viewer/documentResults/SET"===t.type){let n=e;return t.value.find((t=>t._id===e.getIn(["reference","targetDocument"])))||(n=e.deleteIn(["reference","targetDocument"])),n.set("viewerSearching",!1)}return t.type===O.F?e.setIn(["reference","targetDocument"],t.id):t.type===O.xV?d().fromJS(C):d().fromJS(e)},relationTypes:(0,s.Z)("viewer/relationTypes",[]),tocForm:(0,l.sZ)("documentViewer.tocForm",[]),tocFormState:(0,l.aB)("documentViewer.tocForm"),tocBeingEdited:(0,s.Z)("documentViewer/tocBeingEdited",!1),metadataExtraction:(0,s.Z)("documentViewer.metadataExtraction",{selections:[]}),sidepanel:(0,a.combineReducers)({metadata:(0,l.sZ)("documentViewer.sidepanel.metadata"),metadataForm:(0,l.aB)("documentViewer.sidepanel.metadata"),snippets:(0,s.Z)("documentViewer.sidepanel.snippets",{count:0,metadata:[],fullText:[]}),tab:(0,s.Z)("viewer.sidepanel.tab","")})});var j=n(88877);const I={userSelectedTab:!1},D=(e=I,t={})=>t.type===j.BA?e.set("tab",t.tab).set("userSelectedTab",!0).set("showFilters",!1):t.type===j.V2?e.set("userSelectedTab",!1):t.type===j.j6?e.set("showFilters",!1):t.type===j.y9?e.set("tab","connections").set("showFilters",!0):d().fromJS(e),T=(0,a.combineReducers)({entity:(0,N.ay)((0,s.Z)("entityView/entity",{})),entityForm:(0,l.sZ)("entityView.entityForm"),entityFormState:(0,l.aB)("entityView.entityForm"),uiState:D});var E=n(14003),x=n(37501),A=n(33983);const $={open:!1,menu:null},R={referencePanel:"ViewerSaveReferenceMenu",targetReferencePanel:"ViewerSaveTargetReferenceMenu",viewMetadataPanel:"MetadataPanelMenu"};var F=n(65014);const L={template:"",targetDocument:"",sourceDocument:"",sourceFile:"",targetFile:""};const J={open:!1,connecting:!1};const Z=(0,a.combineReducers)({connection:function(e=L,t={}){let n;switch(t.type){case F.zO:return n=(e=>{const t=e.toJS();return["template","targetDocument","sourceDocument"].forEach((e=>{t[e]=""})),(0,c.fromJS)(t)})(e.set("type",t.connectionType)),n.set("sourceDocument",t.sourceDocument);case F.qD:return e.set("template",t.template);case F.QQ:return e.set("targetDocument",t.id);case"connections/searchResults/SET":return t.value.find((t=>t.sharedId===e.get("targetDocument")))?e:e.delete("targetDocument");case O.Ls:return e.set("sourceRange",t.sourceRange).set("sourceFile",t.sourceFile);case O.Zb:case F.Iy:return e.delete("sourceRange");default:return(0,c.fromJS)(e)}},searchResults:(0,s.Z)("connections/searchResults",[]),searchTerm:(0,s.Z)("connections/searchTerm",""),uiState:function(e=J,t={}){switch(t.type){case F.zO:return e.set("open",!0);case F.g5:return e.set("connecting",!1).set("open",!1);case F.m7:return e.set("searching",!0);case"connections/searchResults/SET":return e.set("searching",!1);case F.F1:return e.set("creating",!0);case F.sV:return e.set("connecting",!0);case F.p3:return e.set("connecting",!1);case F.Iy:return e.set("creating",!1).set("connecting",!1).set("open",!1);default:return(0,c.fromJS)(e)}}});var M=n(71182),V=n(97724);const U=[],z=e=>{let t=-1;return(e.results.get("rows")||(0,c.fromJS)([])).reduce(((n,o)=>{let r=n;return o.get("connections").forEach((n=>{const i=n.get("hub").toString();if(r.has(i)||(t+=1,r=r.set(i,(0,c.fromJS)({hub:i,order:t,leftRelationship:{},rightRelationships:{}}))),o.get("sharedId")===e.parentEntity.get("sharedId"))r=r.setIn([i,"leftRelationship"],n);else{const e=n.get("template");r.getIn([i,"rightRelationships"]).has(e)||(r=r.setIn([i,"rightRelationships",e],(0,c.fromJS)([]))),r=r.setIn([i,"rightRelationships",e],r.getIn([i,"rightRelationships",e]).push(n))}})),r}),(0,c.fromJS)({})).reduce(((t,n)=>{let o=0;const r=n.get("rightRelationships").reduce(((t,r,i)=>{let a=t.push((0,c.fromJS)({}).set("template",i).set("relationships",r));return o+=1,e.editing&&o===n.get("rightRelationships").size&&(a=a.push((0,c.fromJS)({relationships:[]}))),a}),(0,c.fromJS)([]));return t.set(n.get("order"),n.set("rightRelationships",r))}),(0,c.fromJS)([]))};const K={editing:!1,saving:!1,addTo:{hubIndex:null,rightRelationshipIndex:null}};const B={open:!1,connecting:!1};const H=(0,a.combineReducers)({hubs:function(e=U,t={}){let n,o,r,i,a,s,l,d,p;const u=[];switch(t.type){case V.C:case V.ZF:return z(t);case V.HJ:return e.push((0,c.fromJS)({leftRelationship:{template:null},rightRelationships:[{relationships:[]}]}));case V._0:return e.setIn([t.index,"leftRelationship","template"],t._id).setIn([t.index,"modified"],!0);case V.Tq:return o=e.getIn([t.index,"deleted"]),e.setIn([t.index,"deleted"],!o);case V.Nu:if(r=e.setIn([t.index,"rightRelationships",t.rightIndex,"template"],t._id).setIn([t.index,"rightRelationships",t.rightIndex,"modified"],!0),n=e.getIn([t.index,"rightRelationships",t.rightIndex,"relationships"]).map((e=>e.set("template",t._id))),r=r.setIn([t.index,"rightRelationships",t.rightIndex,"relationships"],n),t.newRightRelationshipType){const e=r.getIn([t.index,"rightRelationships"]).push((0,c.fromJS)({relationships:[]}));r=r.setIn([t.index,"rightRelationships"],e)}return r;case V.aG:return o=e.getIn([t.index,"rightRelationships",t.rightIndex,"deleted"]),e.setIn([t.index,"rightRelationships",t.rightIndex,"deleted"],!o);case V.nK:return i=e.getIn([t.index,"rightRelationships",t.rightIndex]),n=i.get("relationships").push((0,c.fromJS)({template:i.get("template"),entity:t.entity.sharedId,entityData:t.entity})),e.setIn([t.index,"rightRelationships",t.rightIndex,"relationships"],n);case V.O8:return o=e.getIn([t.index,"rightRelationships",t.rightIndex,"relationships",t.relationshipIndex,"deleted"]),e.setIn([t.index,"rightRelationships",t.rightIndex,"relationships",t.relationshipIndex,"deleted"],!o);case V.Qe:return o=e.getIn([t.index,"rightRelationships",t.rightIndex,"relationships",t.relationshipIndex,"move"]),e.setIn([t.index,"rightRelationships",t.rightIndex,"relationships",t.relationshipIndex,"move"],!o);case V.Iz:return s=[],l=[],p=e.getIn([t.index,"rightRelationships",t.rightRelationshipIndex,"template"]),e.forEach(((e,t)=>{e.get("rightRelationships").forEach(((e,n)=>{e.get("relationships").forEach(((e,o)=>{e.get("move")&&(s.push(e.remove("move").remove("_id").remove("sharedId").set("template",p)),l.push({hubIndex:t,rightRelationshipsIndex:n,index:o}))}))}))})),d=l.reverse().reduce(((e,t)=>e.setIn([t.hubIndex,"rightRelationships",t.rightRelationshipsIndex,"relationships",t.index,"moved"],!0)),e),a=d.getIn([t.index,"rightRelationships",t.rightRelationshipIndex,"relationships"]),d.setIn([t.index,"rightRelationships",t.rightRelationshipIndex,"relationships"],a.concat(s));case V.bv:return e.forEach(((n,o)=>{e.getIn([o,"leftRelationship","entity"])===t.entity.sharedId&&u.push([o,"leftRelationship","entityData"]),e.getIn([o,"rightRelationships"]).forEach(((e,n)=>{e.get("relationships").forEach(((e,r)=>{e.get("entity")===t.entity.sharedId&&u.push([o,"rightRelationships",n,"relationships",r,"entityData"])}))}))})),u.reduce(((e,n)=>e.setIn(n,(0,c.fromJS)(t.entity))),e);default:return(0,c.fromJS)(e)}},hubActions:function(e=K,t={}){switch(t.type){case V.ZF:return e.set("editing",t.value);case V.J_:return e.setIn(["addTo","hubIndex"],t.index).setIn(["addTo","rightRelationshipIndex"],t.rightIndex);case V.Lw:return e.set("saving",!0);case V.lh:return e.set("saving",!1);default:return(0,c.fromJS)(e)}},list:(0,a.combineReducers)({sharedId:(0,s.Z)("relationships/list/sharedId",""),entity:(0,s.Z)("relationships/list/entity",{}),connectionsGroups:(0,s.Z)("relationships/list/connectionsGroups",[]),searchResults:(0,s.Z)("relationships/list/searchResults",{totalRows:0,rows:[]}),sort:(0,l.sZ)("relationships/list.sort",M.Z.get()),filters:(0,s.Z)("relationships/list/filters",{}),search:(0,l.aB)("relationships/list/search"),view:(0,s.Z)("relationships/list/view","graph")}),searchResults:(0,s.Z)("relationships/searchResults",[]),searchTerm:(0,s.Z)("relationships/searchTerm",""),connection:(0,s.Z)("relationships/connection",{}),uiState:function(e=B,t={}){switch(t.type){case V.Wm:return e.set("open",!0);case V.Sj:return e.set("open",!1);case V.JM:return e.set("searching",!0);case"relationships/searchResults/SET":return e.set("searching",!1);default:return(0,c.fromJS)(e)}},metadata:(0,l.sZ)("relationships.metadata",{}),formState:(0,l.aB)("relationships.metadata")});var q=n(69558);const W=(0,a.combineReducers)({search:(0,s.Z)("semanticSearch/search",{}),searches:(0,s.Z)("semanticSearch/searches",[]),resultsFiltersForm:(0,l.aB)("semanticSearch.resultsFilters"),resultsFilters:(0,l.sZ)("semanticSearch.resultsFilters",{threshold:.4,minRelevantSentences:5}),resultsThreshold:(0,l.sZ)("semanticSearch.resultsThreshold"),minRelevantSentences:(0,l.sZ)("semanticSearch.minRelevantSentences"),minRelevantScore:(0,l.sZ)("semanticSearch.minRelevantScore"),selectedDocument:(0,s.Z)("semanticSearch/selectedDocument",d().fromJS({})),showSemanticSearchPanel:(0,s.Z)("semanticSearch/showSemanticSearchPanel",!1),multipleEdit:(0,l.sZ)("semanticSearch.multipleEdit",{metadata:{}}),multipleEditForm:(0,l.aB)("semanticSearch.multipleEdit",{metadata:{}}),multiedit:(0,s.Z)("semanticSearch/multiedit",[])});var G=n(49935),Q=n(96384);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const te={rows:[],totalRows:0},ne=(e,t)=>{const n=e.get("rows").findIndex((e=>e.get("sharedId")===t.entity));return{docIndex:n,doc:e.get("rows").get(n).toJS()}},oe=e=>t=>t.get("_id")===e._id,re=e=>t=>t.get("sharedId")===e,ie=(e,t,n,o=!1)=>e.reduce(((e,t)=>{const r=e.get("rows").findIndex(n(t));if(r>=0){const t=e.deleteIn(["rows",r]);return o?t.set("totalRows",t.get("totalRows")-1):t}return e}),t),ae=(e=te,t={})=>{let n,o,r=0;switch(t.type){case A.Tr:return d().fromJS(t.documents);case A.Am:return d().fromJS(te);case A.AJ:return e.setIn(["rows"],e.get("rows").concat(d().fromJS(t.documents.rows))).setIn(["totalRows"],t.documents.totalRows);case A.wO:return r=e.get("rows").findIndex((e=>e.get("_id")===t.doc._id)),e.setIn(["rows",r],d().fromJS(t.doc));case A.SX:return t.docs.reduce(((t,n)=>{const o=e.get("rows").findIndex((e=>e.get("_id")===n._id));return t.setIn(["rows",o],d().fromJS(n))}),e);case A.dy:return t.sharedIds.reduce(((n,o)=>{const r=e.get("rows").findIndex((e=>e.get("sharedId")===o));return n.setIn(["rows",r,"published"],t.published)}),e);case A.L5:return e.update("rows",(e=>e.insert(0,d().fromJS(t.doc))));case A.Mt:return r=e.get("rows").findIndex((e=>e.get("_id")===t.doc._id)),r>=0?e.deleteIn(["rows",r]):e;case A.rd:return ie(t.docs,e,oe);case A.XL:return ie(t.sharedIds,e,re,!0);case x.Yy:if(r=e.get("rows").findIndex((e=>e.get("sharedId")===t.doc)),r>=0)return n=e.get("rows").get(r).toJS(),n.documents.push(t.file),e.setIn(["rows",r],d().fromJS(n));break;case x.le:if(r=e.get("rows").findIndex((e=>e.get("sharedId")===t.doc)),r>=0)return n=e.get("rows").get(r).toJS(),e.setIn(["rows",r],d().fromJS(X(X({},n),{},{documents:t.files})));break;case Q.wS:return({docIndex:r,doc:n}=ne(e,t)),n.attachments.push(t.file),e.setIn(["rows",r],d().fromJS(n));case Q.pD:return({docIndex:r,doc:n}=ne(e,t)),n.attachments=n.attachments.filter((e=>e._id!==t.file._id)),e.setIn(["rows",r],d().fromJS(n));case Q.ZW:return({docIndex:r,doc:n}=ne(e,t)),[o]=n.attachments.filter((e=>e._id===t.file._id)),o.originalname=t.file.originalname,e.setIn(["rows",r],d().fromJS(n))}return d().fromJS(e)};function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const de=d().fromJS({searchTerm:"",previewDoc:"",suggestions:[],selectedDocuments:[],filtersPanel:!1,zoomLevel:0,tableViewColumns:[]});function pe(e=de,t={}){if(t.type===A.sZ){let n=e.set("searchTerm",t.searchTerm);return t.searchTerm||(n=n.set("suggestions",[])),n}if(t.type===A.St){return e.get("selectedDocuments").filter((e=>e.get("_id")===t.doc._id)).size?e:e.update("selectedDocuments",(e=>e.push(d().fromJS(t.doc))))}if(t.type===A.JY){const n=d().fromJS(t.doc);return e.update("selectedDocuments",(()=>d().fromJS([n])))}if(t.type===x.Yy){const n=e.get("selectedDocuments").findIndex((e=>e.get("sharedId")===t.doc));if(n>=0){const o=e.get("selectedDocuments").get(n).toJS();return o.documents.push(t.file),e.setIn(["selectedDocuments",n],d().fromJS(o))}}if(t.type===x.le){const n=e.get("selectedDocuments").findIndex((e=>e.get("sharedId")===t.doc));if(n>=0){const o=e.get("selectedDocuments").get(n).toJS();return e.setIn(["selectedDocuments",n],d().fromJS(le(le({},o),{},{documents:t.files})))}}if(t.type===A.oZ)return t.docs.reduce(((e,t)=>e.get("selectedDocuments").filter((e=>e.get("_id")===t._id)).size?e:e.update("selectedDocuments",(e=>e.push(d().fromJS(t))))),e);if(t.type===A.pP)return e.update("selectedDocuments",(e=>e.filter((e=>e.get("_id")!==t.docId))));if(t.type===A.So)return e.set("selectedDocuments",d().fromJS([]));if(t.type===A.Wv)return e.set("selectedDocuments",t.entities);if(t.type===A.j6)return e.set("filtersPanel",!1);if(t.type===A.y9)return e.set("filtersPanel",!0);if(t.type===A.OD)return e.set("previewDoc",t.docId);if(t.type===A.Om)return e.set("suggestions",d().fromJS(t.suggestions));if(t.type===A.fv)return e.set("showSuggestions",!0);if(t.type===A.bj)return e.set("showSuggestions",!1);if(t.type===A.u0)return e.set("overSuggestions",t.hover);if(t.type===A.UF){const t=3;return e.set("zoomLevel",Math.min(e.get("zoomLevel")+1,t))}if(t.type===A.RC){const t=-3;return e.set("zoomLevel",Math.max(e.get("zoomLevel")-1,t))}if(t.type===A.GL){if(0===t.columns.length)return e;const n=t.columns.map((t=>{const n=e.get("tableViewColumns").find((e=>e.get("name")===t.name)),o=n&&n.has("hidden")?n.get("hidden"):t.hidden,r=void 0!==o?o:!t.showInCard;return Object.assign(t,{hidden:r})}));return e.set("tableViewColumns",d().fromJS(n))}if(t.type===A.$W){const n=e.get("tableViewColumns").findIndex((e=>e.get("name")===t.name));return e.setIn(["tableViewColumns",n,"hidden"],t.hidden)}return t.type===A.LD?e.update("tableViewColumns",(e=>e.map(((e,n)=>n?e.set("hidden",t.hidden):e)))):d().fromJS(e)}const ue={properties:[],documentTypes:[]};function me(e=ue,t={}){return t.type===A.Br||t.type===A.dx?e.set("documentTypes",d().fromJS(t.documentTypes)).set("properties",d().fromJS(t.libraryFilters)):t.type===A.F?e.set("properties",d().fromJS(t.libraryFilters)):d().fromJS(e)}const fe=(0,s.Z)("aggregations",{});function he(e,t={}){let n=t;return n.type===A.dx&&(n=s.N.set("aggregations",n.aggregations)),fe(e,n)}let ve=null;o.C5&&(ve=window.__reduxData__&&window.__reduxData__.templates?d().fromJS(window.__reduxData__.templates):null);const ye=M.Z.get({templates:ve});ye.searchTerm="",ye.filters={},ye.publishedStatus={values:["published","restricted"]};const be=e=>(0,a.combineReducers)({aggregations:(0,G.c)(he,e),documents:(0,G.c)(ae,e),ui:(0,G.c)((0,N.ay)(pe,{useDefaults:!1,setInArray:["selectedDocuments",0]}),e),filters:(0,G.c)(me,e),search:(0,l.sZ)(`${e}.search`,ye),searchForm:(0,l.aB)(`${e}.search`,ye),selectedSorting:(0,s.Z)(`${e}.selectedSorting`,{}),markers:(0,s.Z)(`${e}.markers`,{rows:[]}),sidepanel:(0,a.combineReducers)({metadata:(0,l.sZ)(`${e}.sidepanel.metadata`,{}),metadataForm:(0,l.aB)(`${e}.sidepanel.metadata`,{}),multipleEdit:(0,l.sZ)(`${e}.sidepanel.multipleEdit`,{}),multipleEditForm:(0,l.aB)(`${e}.sidepanel.multipleEdit`,{}),quickLabelState:(0,s.Z)(`${e}.sidepanel.quickLabelState`,{}),quickLabelMetadata:(0,l.sZ)(`${e}.sidepanel.quickLabelMetadata`,{}),quickLabelMetadataForm:(0,l.aB)(`${e}.sidepanel.quickLabelMetadata`,{}),references:(0,s.Z)(`${e}.sidepanel.references`,[]),snippets:(0,s.Z)(`${e}.sidepanel.snippets`,{count:0,metadata:[],fullText:[]}),tab:(0,s.Z)(`${e}.sidepanel.tab`,"")})});var ge=n(83993);const Se={};const we={},Ne=(e=we,t={})=>{if(t.type===x.T_)return e.set(t.doc,0);if(t.type===x.F6){const n=100===t.progress?0:t.progress;return e.set(t.doc,n)}return[x.Yy,x.rW].includes(t.type)?e.delete(t.doc):d().fromJS(e)},Oe=(0,a.combineReducers)({showImportPanel:(0,s.Z)("showImportPanel",!1),importUploadProgress:(0,s.Z)("importUploadProgress",0),importProgress:(0,s.Z)("importProgress",0),importStart:(0,s.Z)("importStart",!1),importEnd:(0,s.Z)("importEnd",!1),importError:(0,s.Z)("importError",{})}),Pe=(0,s.Z)("auth/user",{});var Ce=n(28749);const ke=(0,a.combineReducers)({collection:(0,s.Z)("settings/collection",{}),navlinksData:(0,l.sZ)("settings.navlinksData",{links:[]}),navlinksFormState:(0,l.aB)("settings.navlinksData"),form:(0,l.sZ)("account.form",{username:"",password:""}),formState:(0,l.aB)("account.form"),settingForm:(0,l.aB)("settings.settings"),settings:(0,l.sZ)("settings.settings",{}),uiState:function(e={},t={}){return t.type===Ce.BM?e.set("editingLink",t.id):t.type===Ce.PD?e.set("savingNavlinks",!0):t.type===Ce.gY?e.set("savingNavlinks",!1):d().fromJS(e)}}),_e={};const je=(0,a.combineReducers)({progress:function(e=_e,t={}){return"START_REUPLOAD_DOCUMENT"===t.type?e.set(t.doc,0):"REUPLOAD_PROGRESS"===t.type?e.set(t.doc,t.progress):"REUPLOAD_COMPLETE"===t.type?e.delete(t.doc):d().fromJS(e)}}),Ie=(0,s.Z)("locale",""),De={inlineEdit:!1,context:"",key:"",showInlineEditForm:!1};const Te=(0,a.combineReducers)({state:(0,s.Z)("oneUpReview.state",{})}),Ee=(0,a.combineReducers)({exportSearchResultsProcessing:(0,s.Z)("exportSearchResultsProcessing",!1),exportSearchResultsContent:(0,s.Z)("exportSearchResultsContent",""),exportSearchResultsFileName:(0,s.Z)("exportSearchResultsFileName","")}),xe=(0,a.combineReducers)({notifications:function(e=b,t={}){return t.type===y.m?e.push(d().fromJS(t.notification)):t.type===y.K?e.filter((e=>e.get("id")!==t.id)):d().fromJS(e)},library:be("library"),uploads:be("uploads"),progress:Ne,importEntities:Oe,locale:Ie,inlineEdit:function(e=De,t={}){return"TOGGLE_INLINE_EDIT"===t.type?e.set("inlineEdit",!e.get("inlineEdit")):"OPEN_INLINE_EDIT_FORM"===t.type?e.set("showInlineEditForm",!0).set("context",t.context).set("key",t.key):"CLOSE_INLINE_EDIT_FORM"===t.type?e.set("showInlineEditForm",!1):d().fromJS(e)},semanticSearch:W,activitylog:w,inlineEditForm:(0,l.aB)("inlineEditModel",{}),inlineEditModel:(0,l.sZ)("inlineEditModel",{}),template:f,page:v,thesauri:S,entityView:T,thesauris:(0,s.Z)("thesauris",[]),entityThesauris:(0,s.Z)("entityThesauris",{}),customUploads:(0,s.Z)("customUploads",[]),dictionaries:(0,s.Z)("dictionaries",[]),relationTypes:(0,s.Z)("relationTypes",[]),relationType:(0,l.sZ)("relationType",{name:""}),relationTypeForm:(0,l.aB)("relationType",{name:""}),templates:(0,s.Z)("templates",[]),translations:(0,s.Z)("translations",[]),translationsForm:(0,l.sZ)("translationsForm",[]),translationsFormState:(0,l.aB)("translationsForm"),pages:(0,s.Z)("pages",[]),users:(0,s.Z)("users",[]),documentViewer:_,contextMenu:function(e=$,t={}){return t.type===E.v?e.set("open",!0):t.type===E.m?e.set("open",!1):t.type===O.Ls?e.set("type","ViewerTextSelectedMenu"):t.type===A.Zo?e.set("type","LibraryMenu"):t.type===x.sV?e.set("type","UploadsMenu"):t.type===O.no?e.set("type",R[t.panel]):t.type===O.Zb||t.type===O.LX||t.type===O.m7||t.type===O.VQ||"viewer/targetDoc/SET"===t.type?e.set("type","ViewerDefaultMenu"):d().fromJS(e)},connections:Z,connectionsList:q.Z,relationships:H,attachments:N.I6,modals:function(e=Se,t={}){return t.type===ge.H?e.set(t.modal,t.data):t.type===ge._?e.delete(t.modal):d().fromJS(e)},user:Pe,settings:ke,metadata:je,oneUpReview:Te,exportSearchResults:Ee,userGroups:(0,s.Z)("userGroups",[])});e=n.hmd(e);const Ae=o.C5&&window.__reduxData__?window.__reduxData__:{};let $e;$e||($e=function(e=Ae){return $e=(0,a.createStore)(xe,e,(0,i.Uo)((0,a.applyMiddleware)(r.Z))),$e}()),"undefined"==typeof window||e.hot||(window.store=$e)},98373:(e,t,n)=>{"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{K:()=>a});class a{constructor(e,t={}){i(this,"data",void 0),i(this,"headers",{}),this.data=e,this.headers=t}add(e){return new a(r(r({},this.data),e),this.headers)}set(e){return new a(e,this.headers)}onlyHeaders(){return new a(void 0,this.headers)}}},9067:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(38086),r=n(45697),i=n.n(r),a=n(67294);const s=new o.Parser,l=({children:e})=>{return a.createElement(a.Fragment,null,(t=e,s.parse(t)));var t};l.propTypes={children:i().string.isRequired};const c=l},45398:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const o=(e,t,n)=>{const o="desc"===n.order?t:e,r="desc"===n.order?e:t;return"number"===n.treatAs?Number(o)-Number(r):"dottedList"===n.treatAs?((e,t,n)=>{const o=e.split("."),r=t.split(".");return n.listTypes.reduce(((e,t,n)=>{if(o.length>n&&r.length<=n)return e.push(1),e;if(o.length<=n&&r.length>n)return e.push(-1),e;if(o.length>n&&r.length>n){const i=t(o[n]),a=t(r[n]);if(i!==a)return e.push(i<a?-1:1),e}return e.push(0),e}),[]).reduce(((e,t)=>!e&&t?t:e),0)})(o,r,n):((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))(o,r)},r=(e,t)=>"object"==typeof e&&null!==e&&-1!==Object.keys(e).indexOf(t),i=(e,t={})=>{t.order=t.order||"asc";const n=(e=>e.concat())(e);return t.property&&n.sort(((e,n)=>{let i,a;return Array.isArray(t.property)||(i=e[t.property],a=n[t.property]),Array.isArray(t.property)&&(i=t.property.reduce(((e,t)=>r(e,t)?e[t]:null),e),a=t.property.reduce(((e,t)=>r(e,t)?e[t]:null),n)),i?a?o(i,a,t):-1:1})),t.property||n.sort(((e,n)=>o(e,n,t))),n}},38562:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var o=n(52786),r=n(36651),i=n(38540),a=n(69899),s=n(74865),l=n.n(s);const c={requests:0,start:()=>{r.C5&&(l().configure({showSpinner:!1,easing:"ease",speed:800,minimum:.2}),l().start(),c.requests+=1)},done:()=>{if(r.C5&&l()){if(c.requests-=1,c.requests<=0)return void l().done();l().inc(.1)}}},d=c;var p=n(8772),u=n(62787);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let v,y=p.z;const b=e=>(d.done(),e),g=[{key:/PayloadTooLargeError: request entity too large/g,message:"Request data too large. Please review text length in property values"},{key:/ERROR Failed to index documents: (.+)/g,message:"Failed to index documents: {0} "}];const S=e=>{switch(e.status||!0){case 400:case 422:a.h.dispatch((0,i.h)(function(e){return e.json.validations?e.json.validations.reduce(((e,t)=>`${e} ${t.instancePath} ${t.message},`),`${e.json.error}: `):e.json.error}(e),"danger"));break;case 401:o.mW.replace("/login");break;case 404:o.mW.replace("/404");break;case 409:a.h.dispatch((0,i.h)(e.json.error,"warning"));break;case 500:a.h.dispatch((0,i.h)(function(e){let t=`An error has occurred, it has been logged with request id #${e.json.requestId}.`;if(!e.json.error)return t;const n=g.find((t=>e.json.error.match(t.key)));if(n){const o=n.key.exec(e.json.error);t=n.message;for(let e=0;e<o.length-1;e+=1)t=t.replace(`{${e}}`,o[1])}return t}(e),"danger"));break;case(e=>e.status&&![401,404,409,500].includes(e.status))(e):a.h.dispatch((0,i.h)(e.json.prettyMessage||e.json.error,"danger"));break;case e instanceof TypeError:a.h.dispatch((0,i.h)("Could not reach server. Please try again later.","danger"));break;default:a.h.dispatch((0,i.h)("An error has occurred","danger"))}},w=(e,t,n)=>(d.start(),u.ZP[n](y+e,t.data,f(f({"Content-Language":v},t.headers),{},{"X-Requested-With":"XMLHttpRequest"})).then(b).catch((t=>((e,t)=>{const n=e;return n.endpoint=t,r.C5?(b(),S(n),Promise.reject(n)):Promise.reject(n)})(t,{url:e,method:n})))),N={get:(e,t={})=>w(e,t,"get"),post:(e,t={})=>w(e,t,"post"),put:(e,t={})=>w(e,t,"put"),delete:(e,t={})=>w(e,t,"delete"),cookie(e){u.ZP.cookie(e)},locale(e){v=e},APIURL(e){y=e}}},29573:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});const o=["#C03B22","#D9534F","#E91E63","#A03AB1","#6F46B8","#3F51B5","#2196F3","#37BDCf","#359990","#5CB85C","#8BC34A","#CDDC39","#CCBC2F","#F0AD4E","#EC9920","#E46841","#795548","#9E9E9E","#607D8B"]},37265:(e,t,n)=>{"use strict";function o(e,t,n){let o;return function(){const r=arguments,i=()=>{if(o=null,!n)return e.apply(this,r)},a=n&&!o;if(clearTimeout(o),o=setTimeout(i,t),a)return e.apply(this,r)}}n.d(t,{Z:()=>o})},32820:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});const o=e=>e?e.substr(e.lastIndexOf(".")+1):""},36651:(e,t,n)=>{"use strict";n.d(t,{C5:()=>r,U3:()=>i});var o=n(17337);const r="undefined"!=typeof document,i=new(n.n(o)())},71182:(e,t,n)=>{"use strict";function o(e,t,n=!0){const o=n?`metadata.${t.get("name")}`:t.get("name");Object.keys(e).includes(o)||(e[o]={type:t.get("type"),ocurrs:0}),e[o].ocurrs+=1}n.d(t,{Z:()=>r});const r={get:(e={})=>{if(e.override)return e.override;let t={sort:"creationDate",order:"desc",treatAs:"number"},n=[],r={};if(e.templates){if(n=e.templates.map((e=>e.get("commonProperties")?e:e.set("commonProperties",[]))),e.filteredTemplates&&e.filteredTemplates.length&&(n=n.filter((t=>e.filteredTemplates.includes(t.get("_id"))))),r=function(e,t){return e.forEach((e=>{e.get("commonProperties").forEach((e=>{e.get("prioritySorting")&&o(t,e,!1)})),e.get("properties").forEach((e=>{e.get("filter")&&("text"===e.get("type")||"date"===e.get("type")||"numeric"===e.get("type")||"select"===e.get("type"))&&e.get("prioritySorting")&&o(t,e)}))})),t}(n,r),Object.keys(r).length){const e=Object.keys(r).map((e=>{const{type:t,ocurrs:n}=r[e];return{name:e,type:t,ocurrs:n}})).reduce(((e,t)=>e.ocurrs>=t.ocurrs?e:t));t={sort:e.name,order:"date"!==e.type?"asc":"desc",treatAs:"date"!==e.type?"string":"number"}}if(e.currentCriteria){e.selectedSorting&&e.selectedSorting.size?e.currentCriteria=e.selectedSorting.toJS():e.currentCriteria=t;let o="title"===e.currentCriteria.sort||"creationDate"===e.currentCriteria.sort;if(o||(o=function(e,t){return e.reduce(((e,n)=>{let o=e;return n.get("properties").forEach((e=>{const n=e.get("filter")&&("text"===e.get("type")||"date"===e.get("type"));o=Boolean(o||n&&`metadata.${e.get("name")}`===t.currentCriteria.sort)})),o}),!1)}(n,e)),o)return e.currentCriteria}}return t}}},24876:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});const o=e=>Math.max(0,Math.min(13,e)),r=(e,t,n=0)=>{const r=(e,t)=>[...Array(t)].map(((t,n)=>e.charAt(Math.floor(Math.random()*e.length)))).join(""),i=r("ABCDEFGHIJKLMNOPQRSTUVWXYZ",o(e)),a=r("0123456789",o(t)),s=Date.now().toString();return i+a+(n>0?`-${s.substr(s.length-o(n),s.length)}`:"")}},62787:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>h,_k:()=>m});n(94301);var o=n(80569),r=n.n(o),i=n(8575),a=n(73581),s=n.n(a);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let p;class u extends Error{constructor(e,{json:t,status:n,cookie:o,headers:r}={}){super(e),this.name="FetchResponseError",this.json=t,this.status=n,this.cookie=o,this.headers=r}}function m(e){if("string"==typeof e)return`?${e}`;const t=c({},e);return t&&0!==Object.keys(t).length?`?${Object.keys(t).map((e=>{if(void 0===t[e]||null===t[e])return;"object"==typeof t[e]&&(t[e]=JSON.stringify(t[e]));let n=encodeURIComponent(t[e]);if("q"===encodeURIComponent(e))try{(e=>{const t=new(s().parser)((e=>{throw Error(`rison decoder error: ${e}`)}));t.error=e=>{(void 0).message=e},t.parse(e)})(t[e]),n=t[e]}catch(o){n=encodeURIComponent(t[e])}return`${encodeURIComponent(e)}=${n}`})).filter((e=>e)).join("&")}`:""}const f=(e,t,n,o)=>{let r,a,s="";const l=c({Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Cookie:p},o);var d;return"GET"!==n&&"DELETE"!==n||(s=m(t)),"POST"!==n&&"PUT"!==n||(a=JSON.stringify(t)),i.URLSearchParams&&t instanceof i.URLSearchParams&&(a=t),d=l,Object.keys(d).forEach((e=>void 0===d[e]?delete d[e]:{})),fetch(e+s,{method:n,headers:l,credentials:"same-origin",body:a}).then((e=>{let t;return e.headers.get("set-cookie")&&(t=e.headers.get("set-cookie")),r=e,Promise.all([e.json().catch((()=>({}))),t,e.headers])})).then((([e,t,n])=>{const o={json:e,status:r.status,cookie:t,headers:n};if(r.status>399)throw new u(`Fetch returned a response with status ${r.status}.`,o);return o}))},h={post:(e,t,n)=>f(e,t,"POST",n),put:(e,t,n)=>f(e,t,"PUT",n),get:(e,t,n)=>f(e,t,"GET",n),delete:(e,t,n)=>f(e,t,"DELETE",n),head:(e,t,n)=>f(e,t,"HEAD",n),uploadFile:(e,t,n,o)=>new Promise(((i,a)=>{r().post(e).set("Accept","application/json").set("X-Requested-With","XMLHttpRequest").set("Cookie",o||p||"").attach("file",n,t).then((e=>{i(e)})).catch((e=>{a(e)}))})),cookie:e=>{p=e}}},9813:(e,t,n)=>{"use strict";n.d(t,{VQ:()=>r});var o=n(43358);function r(e,t){const n={};return t.forEach((t=>{var r;return null===(r=t.properties)||void 0===r?void 0:r.forEach((t=>{var r;!t.name||t.type!==o.D.select&&t.type!==o.D.multiselect||(null===(r=t.content)||void 0===r?void 0:r.toString())!==e.toString()||(n[t.name]=!0)}))})),Object.keys(n)}},9075:(e,t,n)=>{"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n,o;return e.name===t.name&&e.type===t.type&&e.content===t.content&&(null===(n=e.inherit)||void 0===n?void 0:n.property)===(null===(o=t.inherit)||void 0===o?void 0:o.property)}function a(e,t){return e.reduce(((e,n)=>e&&function(e,t){return e.properties.filter((e=>i(e,t))).length}(n,t)),!0)}n.d(t,{Z:()=>c});const s=(e,t=[],n=[])=>{const s=[],l=e.filter((e=>t.includes(e._id.toString())));if(l.length){l[0].properties.filter((e=>!n.includes(e.type))).forEach((e=>{if(a(l,e)){const t=l.reduce(((t,n)=>{const o=n.properties.find((t=>i(t,e)),{});return o.required?o:t}),e);s.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t))}}))}return s};const l=e=>e.reduce(((e,t)=>(t.properties.forEach((t=>{e.find((e=>i(t,e)))||e.push(t)})),e)),[]),c={allProperties:e=>e.reduce(((e,t)=>e.concat(t.properties)),[]),getInheritedProperty:(e,t)=>t.find((t=>e.inherit.property.toString()===t._id.toString())),comonProperties:s,comonFilters:function(e,t=[],n=[]){return s(e,t).filter((e=>e.filter||n.includes(e.name)))},defaultFilters:function(e,t=[]){return e.reduce(((e,n)=>(n.properties.forEach((n=>{(t.includes(n.name)||n.filter&&n.defaultfilter)&&!e.find((e=>i(n,e)))&&e.push(n)})),e)),[])},allUniqueProperties:l,textFields:e=>l(e).filter((e=>"text"===e.type||"markdown"===e.type))}},41865:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var o=n(40922);const r=(e,t,n)=>{const r=e||[],i=r.find((e=>e.language&&(0,o.dK)(e.language,"ISO639_1")===t)),a=r.find((e=>e.language&&(0,o.dK)(e.language,"ISO639_1")===n));return i||a||r[0]}},85212:(e,t,n)=>{"use strict";n.d(t,{JH:()=>a,KS:()=>i,Vo:()=>r});var o=n(23085).Buffer;const r=e=>void 0!==e.serializedFile,i=({serializedFile:e,originalname:t})=>{const n=e.split(","),r=n[0].split(";")[0].split(":")[1],i=n[1],a=o.from(i,"base64");return new File([a],t||"",{type:r})},a=e=>{const t=i(e);return URL.createObjectURL(t)}},40922:(e,t,n)=>{"use strict";n.d(t,{GP:()=>o,dK:()=>i,mT:()=>r});const o={arb:{franc:"arb",elastic:"arabic",ISO639_1:"ar"},bul:{franc:"bul",elastic:"bulgarian",ISO639_1:"bg"},cat:{franc:"cat",elastic:"catalan",ISO639_1:"ca"},cjk:{franc:"cjk",elastic:"cjk",ISO639_1:null},ckb:{franc:"ckb",elastic:"sorani",ISO639_1:null},ces:{franc:"ces",elastic:"czech",ISO639_1:"cs"},dan:{franc:"dan",elastic:"danish",ISO639_1:"da"},deu:{franc:"deu",elastic:"german",ISO639_1:"de"},ell:{franc:"ell",elastic:"greek",ISO639_1:"el"},eng:{franc:"eng",elastic:"english",ISO639_1:"en"},eus:{franc:"eus",elastic:"basque",ISO639_1:"eu"},fas:{franc:"fas",elastic:"persian",ISO639_1:"fa"},fin:{franc:"fin",elastic:"finnish",ISO639_1:"fi"},fra:{franc:"fra",elastic:"french",ISO639_1:"fr"},gle:{franc:"gle",elastic:"irish",ISO639_1:"ga"},glg:{franc:"glg",elastic:"galician",ISO639_1:"gl"},hin:{franc:"hin",elastic:"hindi",ISO639_1:"hi"},hun:{franc:"hun",elastic:"hungarian",ISO639_1:"hu"},hye:{franc:"hye",elastic:"armenian",ISO639_1:"hy"},ind:{franc:"ind",elastic:"indonesian",ISO639_1:"id"},ita:{franc:"ita",elastic:"italian",ISO639_1:"it"},lav:{franc:"lav",elastic:"latvian",ISO639_1:"lv"},lit:{franc:"lit",elastic:"lithuanian",ISO639_1:"lt"},nld:{franc:"nld",elastic:"dutch",ISO639_1:"nl"},nno:{franc:"nno",elastic:"norwegian",ISO639_1:"nn"},nob:{franc:"nob",elastic:"norwegian",ISO639_1:"nb"},por:{franc:"por",elastic:"portuguese",ISO639_1:"pt"},ron:{franc:"ron",elastic:"romanian",ISO639_1:"ro"},rus:{franc:"rus",elastic:"russian",ISO639_1:"ru"},spa:{franc:"spa",elastic:"spanish",ISO639_1:"es"},swe:{franc:"swe",elastic:"swedish",ISO639_1:"sv"},tha:{franc:"tha",elastic:"thai",ISO639_1:"th"},tur:{franc:"tur",elastic:"turkish",ISO639_1:"tr"}},r=[{label:"Abkhazian",key:"ab",ISO639_3:"abk",localized_label:"Abkhazian",translationAvailable:!1},{label:"Afar",key:"aa",ISO639_3:"aar",localized_label:"Afar",translationAvailable:!1},{label:"Afrikaans",key:"af",ISO639_3:"afr",localized_label:"Afrikaans",translationAvailable:!1},{label:"Akan",key:"ak",ISO639_3:"aka",localized_label:"Akan",translationAvailable:!1},{label:"Albanian",key:"sq",ISO639_3:"sqi",localized_label:"Shqip",translationAvailable:!1},{label:"Amharic",key:"am",ISO639_3:"amh",localized_label:"አማርኛ",translationAvailable:!1},{label:"Arabic",key:"ar",rtl:!0,ISO639_3:"ara",localized_label:"العربية",translationAvailable:!0},{label:"Aragonese",key:"an",ISO639_3:"arg",localized_label:"Aragonese",translationAvailable:!1},{label:"Armenian",key:"hy",ISO639_3:"hye",localized_label:"Հայերեն",translationAvailable:!1},{label:"Assamese",key:"as",ISO639_3:"asm",localized_label:"অসমীয়া",translationAvailable:!1},{label:"Avaric",key:"av",ISO639_3:"ava",localized_label:"Avaric",translationAvailable:!1},{label:"Avestan",key:"ae",ISO639_3:"ave",localized_label:"Avestan",translationAvailable:!1},{label:"Aymara",key:"ay",ISO639_3:"aym",localized_label:"Aymara",translationAvailable:!1},{label:"Azerbaijani",key:"az",ISO639_3:"aze",localized_label:"Azərbaycan",translationAvailable:!1},{label:"Bambara",key:"bm",ISO639_3:"bam",localized_label:"Bamanakan",translationAvailable:!1},{label:"Bashkir",key:"ba",ISO639_3:"bak",localized_label:"Bashkir",translationAvailable:!1},{label:"Basque",key:"eu",ISO639_3:"eus",localized_label:"Euskara",translationAvailable:!1},{label:"Belarusian",key:"be",ISO639_3:"bel",localized_label:"Беларуская",translationAvailable:!1},{label:"Bengali (Bangla)",key:"bn",ISO639_3:"ben",localized_label:"বাংলা",translationAvailable:!1},{label:"Bihari",key:"bh",ISO639_3:"bih",localized_label:"Bhojpuri",translationAvailable:!1},{label:"Bislama",key:"bi",ISO639_3:"bis",localized_label:"Bislama",translationAvailable:!1},{label:"Bosnian",key:"bs",ISO639_3:"bos",localized_label:"Bosanski",translationAvailable:!1},{label:"Breton",key:"br",ISO639_3:"bre",localized_label:"Brezhoneg",translationAvailable:!1},{label:"Bulgarian",key:"bg",ISO639_3:"bul",localized_label:"Български",translationAvailable:!1},{label:"Burmese",key:"my",ISO639_3:"mya",localized_label:"မြန်မာ",translationAvailable:!0},{label:"Catalan",key:"ca",ISO639_3:"cat",localized_label:"Català",translationAvailable:!1},{label:"Chamorro",key:"ch",ISO639_3:"cha",localized_label:"Chamorro",translationAvailable:!1},{label:"Chechen",key:"ce",ISO639_3:"che",localized_label:"Нохчийн",translationAvailable:!1},{label:"Chichewa, Chewa, Nyanja",key:"ny",ISO639_3:"nya",localized_label:"Nyanja",translationAvailable:!1},{label:"Chinese",key:"zh",ISO639_3:"zho",localized_label:"中文",translationAvailable:!1},{label:"Chinese (Simplified)",key:"zh-Hans",ISO639_3:"zho-Hans",localized_label:"简体中文",translationAvailable:!1},{label:"Chinese (Traditional)",key:"zh-Hant",ISO639_3:"zho-Hant",localized_label:"繁體中文",translationAvailable:!1},{label:"Chuvash",key:"cv",ISO639_3:"chv",localized_label:"Chuvash",translationAvailable:!1},{label:"Cornish",key:"kw",ISO639_3:"cor",localized_label:"Kernewek",translationAvailable:!1},{label:"Corsican",key:"co",ISO639_3:"cos",localized_label:"Corsican",translationAvailable:!1},{label:"Cree",key:"cr",ISO639_3:"cre",localized_label:"Cree",translationAvailable:!1},{label:"Croatian",key:"hr",ISO639_3:"hrv",localized_label:"Hrvatski",translationAvailable:!1},{label:"Czech",key:"cs",ISO639_3:"ces",localized_label:"Čeština",translationAvailable:!1},{label:"Danish",key:"da",ISO639_3:"dan",localized_label:"Dansk",translationAvailable:!1},{label:"Divehi, Dhivehi, Maldivian",key:"dv",rtl:!0,ISO639_3:"div",localized_label:"Divehi",translationAvailable:!1},{label:"Dutch",key:"nl",ISO639_3:"nld",localized_label:"Nederlands",translationAvailable:!1},{label:"Dzongkha",key:"dz",ISO639_3:"dzo",localized_label:"རྫོང་ཁ",translationAvailable:!1},{label:"English",key:"en",ISO639_3:"eng",localized_label:"English",translationAvailable:!1},{label:"Esperanto",key:"eo",ISO639_3:"epo",localized_label:"Esperanto",translationAvailable:!1},{label:"Estonian",key:"et",ISO639_3:"est",localized_label:"Eesti",translationAvailable:!1},{label:"Ewe",key:"ee",ISO639_3:"ewe",localized_label:"Eʋegbe",translationAvailable:!1},{label:"Faroese",key:"fo",ISO639_3:"fao",localized_label:"Føroyskt",translationAvailable:!1},{label:"Fijian",key:"fj",ISO639_3:"fij",localized_label:"Fijian",translationAvailable:!1},{label:"Finnish",key:"fi",ISO639_3:"fin",localized_label:"Suomi",translationAvailable:!1},{label:"French",key:"fr",ISO639_3:"fra",localized_label:"Français",translationAvailable:!0},{label:"Fula, Fulah, Pulaar, Pular",key:"ff",ISO639_3:"ful",localized_label:"Pulaar",translationAvailable:!1},{label:"Galician",key:"gl",ISO639_3:"glg",localized_label:"Galego",translationAvailable:!1},{label:"Gaelic Scottish",key:"gd",ISO639_3:"gla",localized_label:"Gàidhlig",translationAvailable:!1},{label:"Gaelic (Manx)",key:"gv",ISO639_3:"glv",localized_label:"Gaelg",translationAvailable:!1},{label:"Georgian",key:"ka",ISO639_3:"kat",localized_label:"Ქართული",translationAvailable:!1},{label:"German",key:"de",ISO639_3:"deu",localized_label:"Deutsch",translationAvailable:!1},{label:"Greek",key:"el",ISO639_3:"ell",localized_label:"Ελληνικά",translationAvailable:!1},{label:"Guarani",key:"gn",ISO639_3:"grn",localized_label:"Guarani",translationAvailable:!1},{label:"Gujarati",key:"gu",ISO639_3:"guj",localized_label:"ગુજરાતી",translationAvailable:!1},{label:"Haitian Creole",key:"ht",ISO639_3:"hat",localized_label:"Haitian Creole",translationAvailable:!1},{label:"Hausa",key:"ha",rtl:!0,ISO639_3:"hau",localized_label:"Hausa",translationAvailable:!1},{label:"Hebrew",key:"he",rtl:!0,ISO639_3:"heb",localized_label:"עברית",translationAvailable:!1},{label:"Herero",key:"hz",ISO639_3:"her",localized_label:"Herero",translationAvailable:!1},{label:"Hindi",key:"hi",ISO639_3:"hin",localized_label:"हिन्दी",translationAvailable:!1},{label:"Hiri Motu",key:"ho",ISO639_3:"hmo",localized_label:"Hiri Motu",translationAvailable:!1},{label:"Hungarian",key:"hu",ISO639_3:"hun",localized_label:"Magyar",translationAvailable:!1},{label:"Icelandic",key:"is",ISO639_3:"isl",localized_label:"Íslenska",translationAvailable:!1},{label:"Ido",key:"io",ISO639_3:"ido",localized_label:"Ido",translationAvailable:!1},{label:"Igbo",key:"ig",ISO639_3:"ibo",localized_label:"Igbo",translationAvailable:!1},{label:"Indonesian",key:"in",ISO639_3:"ind",localized_label:"Indonesia",translationAvailable:!1},{label:"Interlingua",key:"ia",ISO639_3:"ina",localized_label:"Interlingua",translationAvailable:!1},{label:"Interlingue",key:"ie",ISO639_3:"ile",localized_label:"Interlingue",translationAvailable:!1},{label:"Inuktitut",key:"iu",ISO639_3:"iku",localized_label:"Inuktitut",translationAvailable:!1},{label:"Inupiak",key:"ik",ISO639_3:"ipk",localized_label:"Inupiaq",translationAvailable:!1},{label:"Irish",key:"ga",ISO639_3:"gle",localized_label:"Gaeilge",translationAvailable:!1},{label:"Italian",key:"it",ISO639_3:"ita",localized_label:"Italiano",translationAvailable:!1},{label:"Japanese",key:"ja",ISO639_3:"jpn",localized_label:"日本語",translationAvailable:!1},{label:"Javanese",key:"jv",ISO639_3:"jav",localized_label:"Jawa",translationAvailable:!1},{label:"Kalaallisut, Greenlandic",key:"kl",ISO639_3:"kal",localized_label:"Kalaallisut",translationAvailable:!1},{label:"Kannada",key:"kn",ISO639_3:"kan",localized_label:"ಕನ್ನಡ",translationAvailable:!1},{label:"Kanuri",key:"kr",ISO639_3:"kau",localized_label:"Kanuri",translationAvailable:!1},{label:"Kashmiri",key:"ks",rtl:!0,ISO639_3:"kas",localized_label:"کٲشُر",translationAvailable:!1},{label:"Kazakh",key:"kk",ISO639_3:"kaz",localized_label:"Қазақ тілі",translationAvailable:!1},{label:"Khmer",key:"km",ISO639_3:"khm",localized_label:"ខ្មែរ",translationAvailable:!1},{label:"Kikuyu",key:"ki",ISO639_3:"kik",localized_label:"Gikuyu",translationAvailable:!1},{label:"Kinyarwanda (Rwanda)",key:"rw",ISO639_3:"kin",localized_label:"Kinyarwanda",translationAvailable:!1},{label:"Kirundi",key:"rn",ISO639_3:"run",localized_label:"Ikirundi",translationAvailable:!1},{label:"Kyrgyz",key:"ky",ISO639_3:"kir",localized_label:"Кыргызча",translationAvailable:!1},{label:"Komi",key:"kv",ISO639_3:"kom",localized_label:"Komi",translationAvailable:!1},{label:"Kongo",key:"kg",ISO639_3:"kon",localized_label:"Kongo",translationAvailable:!1},{label:"Korean",key:"ko",ISO639_3:"kor",localized_label:"한국어",translationAvailable:!1},{label:"Kurdish",key:"ku",rtl:!0,ISO639_3:"kur",localized_label:"Kurdî",translationAvailable:!1},{label:"Kwanyama",key:"kj",ISO639_3:"kua",localized_label:"Kuanyama",translationAvailable:!1},{label:"Lao",key:"lo",ISO639_3:"lao",localized_label:"ລາວ",translationAvailable:!1},{label:"Latin",key:"la",ISO639_3:"lat",localized_label:"Latin",translationAvailable:!1},{label:"Latvian (Lettish)",key:"lv",ISO639_3:"lav",localized_label:"Latviešu",translationAvailable:!1},{label:"Limburgish (Limburger)",key:"li",ISO639_3:"lim",localized_label:"Limburgish",translationAvailable:!1},{label:"Lingala",key:"ln",ISO639_3:"lin",localized_label:"Lingála",translationAvailable:!1},{label:"Lithuanian",key:"lt",ISO639_3:"lit",localized_label:"Lietuvių",translationAvailable:!1},{label:"Luga-Katanga",key:"lu",ISO639_3:"lub",localized_label:"Tshiluba",translationAvailable:!1},{label:"Luganda, Ganda",key:"lg",ISO639_3:"lug",localized_label:"Luganda",translationAvailable:!1},{label:"Luxembourgish",key:"lb",ISO639_3:"ltz",localized_label:"Lëtzebuergesch",translationAvailable:!1},{label:"Macedonian",key:"mk",ISO639_3:"mkd",localized_label:"Македонски",translationAvailable:!1},{label:"Malagasy",key:"mg",ISO639_3:"mlg",localized_label:"Malagasy",translationAvailable:!1},{label:"Malay",key:"ms",ISO639_3:"msa",localized_label:"Melayu",translationAvailable:!1},{label:"Malayalam",key:"ml",ISO639_3:"mal",localized_label:"മലയാളം",translationAvailable:!1},{label:"Maltese",key:"mt",ISO639_3:"mlt",localized_label:"Malti",translationAvailable:!1},{label:"Maori",key:"mi",ISO639_3:"mri",localized_label:"Te reo Māori",translationAvailable:!1},{label:"Marathi",key:"mr",ISO639_3:"mar",localized_label:"मराठी",translationAvailable:!1},{label:"Marshallese",key:"mh",ISO639_3:"mah",localized_label:"Marshallese",translationAvailable:!1},{label:"Mongolian",key:"mn",ISO639_3:"mon",localized_label:"Монгол",translationAvailable:!1},{label:"Nauru",key:"na",ISO639_3:"nau",localized_label:"Nauru",translationAvailable:!1},{label:"Navajo",key:"nv",ISO639_3:"nav",localized_label:"Navajo",translationAvailable:!1},{label:"Ndonga",key:"ng",ISO639_3:"ndo",localized_label:"Ndonga",translationAvailable:!1},{label:"Northern Ndebele",key:"nd",ISO639_3:"nde",localized_label:"IsiNdebele",translationAvailable:!1},{label:"Nepali",key:"ne",ISO639_3:"nep",localized_label:"नेपाली",translationAvailable:!1},{label:"Norwegian",key:"no",ISO639_3:"nor",localized_label:"Norsk",translationAvailable:!1},{label:"Norwegian bokmål",key:"nb",ISO639_3:"nob",localized_label:"Norsk bokmål",translationAvailable:!1},{label:"Norwegian nynorsk",key:"nn",ISO639_3:"nno",localized_label:"Norsk nynorsk",translationAvailable:!1},{label:"Occitan",key:"oc",ISO639_3:"oci",localized_label:"Occitan",translationAvailable:!1},{label:"Ojibwe",key:"oj",ISO639_3:"oji",localized_label:"Ojibwa",translationAvailable:!1},{label:"Old Church Slavonic, Old Bulgarian",key:"cu",ISO639_3:"chu",localized_label:"Church Slavic",translationAvailable:!1},{label:"Oriya",key:"or",ISO639_3:"ori",localized_label:"ଓଡ଼ିଆ",translationAvailable:!1},{label:"Oromo (Afaan Oromo)",key:"om",ISO639_3:"orm",localized_label:"Oromoo",translationAvailable:!1},{label:"Ossetian",key:"os",ISO639_3:"oss",localized_label:"Ирон",translationAvailable:!1},{label:"Pāli",key:"pi",ISO639_3:"pli",localized_label:"Pali",translationAvailable:!1},{label:"Pashto, Pushto",key:"ps",rtl:!0,ISO639_3:"pus",localized_label:"پښتو",translationAvailable:!1},{label:"Persian (Farsi)",key:"fa",rtl:!0,ISO639_3:"fas",localized_label:"فارسی",translationAvailable:!1},{label:"Polish",key:"pl",ISO639_3:"pol",localized_label:"Polski",translationAvailable:!1},{label:"Portuguese",key:"pt",ISO639_3:"por",localized_label:"Português",translationAvailable:!1},{label:"Punjabi (Eastern)",key:"pa",ISO639_3:"pan",localized_label:"ਪੰਜਾਬੀ",translationAvailable:!1},{label:"Quechua",key:"qu",ISO639_3:"que",localized_label:"Runasimi",translationAvailable:!1},{label:"Romansh",key:"rm",ISO639_3:"roh",localized_label:"Rumantsch",translationAvailable:!1},{label:"Romanian/Moldavian",key:"ro",ISO639_3:"ron",localized_label:"Română",translationAvailable:!1},{label:"Russian",key:"ru",ISO639_3:"rus",localized_label:"Русский",translationAvailable:!0},{label:"Sami",key:"se",ISO639_3:"sme",localized_label:"Davvisámegiella",translationAvailable:!1},{label:"Samoan",key:"sm",ISO639_3:"smo",localized_label:"Samoan",translationAvailable:!1},{label:"Sango",key:"sg",ISO639_3:"sag",localized_label:"Sängö",translationAvailable:!1},{label:"Sanskrit",key:"sa",ISO639_3:"san",localized_label:"संस्कृत भाषा",translationAvailable:!1},{label:"Serbian",key:"sr",ISO639_3:"srp",localized_label:"Српски",translationAvailable:!1},{label:"Serbo-Croatian",key:"sh",ISO639_3:"hbs",localized_label:"Srpski (latinica)",translationAvailable:!1},{label:"Sesotho",key:"st",ISO639_3:"sot",localized_label:"Southern Sotho",translationAvailable:!1},{label:"Setswana",key:"tn",ISO639_3:"tsn",localized_label:"Tswana",translationAvailable:!1},{label:"Shona",key:"sn",ISO639_3:"sna",localized_label:"ChiShona",translationAvailable:!1},{label:"Sichuan Yi, Nuosu",key:"ii",ISO639_3:"iii",localized_label:"ꆈꌠꉙ",translationAvailable:!1},{label:"Sindhi",key:"sd",ISO639_3:"snd",localized_label:"سنڌي",translationAvailable:!1},{label:"Sinhalese",key:"si",ISO639_3:"sin",localized_label:"සිංහල",translationAvailable:!1},{label:"Siswati, Swati",key:"ss",ISO639_3:"ssw",localized_label:"Swati",translationAvailable:!1},{label:"Slovak",key:"sk",ISO639_3:"slk",localized_label:"Slovenčina",translationAvailable:!1},{label:"Slovenian",key:"sl",ISO639_3:"slv",localized_label:"Slovenščina",translationAvailable:!1},{label:"Somali",key:"so",ISO639_3:"som",localized_label:"Soomaali",translationAvailable:!1},{label:"Southern Ndebele",key:"nr",ISO639_3:"nbl",localized_label:"South Ndebele",translationAvailable:!1},{label:"Spanish",key:"es",ISO639_3:"spa",localized_label:"Español",translationAvailable:!0},{label:"Sundanese",key:"su",ISO639_3:"sun",localized_label:"Basa Sunda",translationAvailable:!1},{label:"Swahili (Kiswahili)",key:"sw",ISO639_3:"swa",localized_label:"Kiswahili",translationAvailable:!1},{label:"Swedish",key:"sv",ISO639_3:"swe",localized_label:"Svenska",translationAvailable:!1},{label:"Tagalog",key:"tl",ISO639_3:"tgl",localized_label:"Filipino",translationAvailable:!1},{label:"Tahitian",key:"ty",ISO639_3:"tah",localized_label:"Tahitian",translationAvailable:!1},{label:"Tajik",key:"tg",ISO639_3:"tgk",localized_label:"Тоҷикӣ",translationAvailable:!1},{label:"Tamil",key:"ta",ISO639_3:"tam",localized_label:"தமிழ்",translationAvailable:!1},{label:"Tatar",key:"tt",ISO639_3:"tat",localized_label:"Татар",translationAvailable:!1},{label:"Telugu",key:"te",ISO639_3:"tel",localized_label:"తెలుగు",translationAvailable:!1},{label:"Thai",key:"th",ISO639_3:"tha",localized_label:"ไทย",translationAvailable:!0},{label:"Tibetan",key:"bo",ISO639_3:"bod",localized_label:"བོད་སྐད་",translationAvailable:!1},{label:"Tigrinya",key:"ti",ISO639_3:"tir",localized_label:"ትግርኛ",translationAvailable:!1},{label:"Tonga",key:"to",ISO639_3:"ton",localized_label:"Lea fakatonga",translationAvailable:!1},{label:"Tsonga",key:"ts",ISO639_3:"tso",localized_label:"Tsonga",translationAvailable:!1},{label:"Turkish",key:"tr",ISO639_3:"tur",localized_label:"Türkçe",translationAvailable:!1},{label:"Turkmen",key:"tk",ISO639_3:"tuk",localized_label:"Türkmen dili",translationAvailable:!1},{label:"Twi",key:"tw",ISO639_3:"twi",localized_label:"Akan",translationAvailable:!1},{label:"Uyghur",key:"ug",ISO639_3:"uig",localized_label:"ئۇيغۇرچە",translationAvailable:!1},{label:"Ukrainian",key:"uk",ISO639_3:"ukr",localized_label:"Українська",translationAvailable:!1},{label:"Urdu",key:"ur",rtl:!0,ISO639_3:"urd",localized_label:"اردو",translationAvailable:!1},{label:"Uzbek",key:"uz",ISO639_3:"uzb",localized_label:"O‘zbek",translationAvailable:!1},{label:"Venda",key:"ve",ISO639_3:"ven",localized_label:"Venda",translationAvailable:!1},{label:"Vietnamese",key:"vi",ISO639_3:"vie",localized_label:"Tiếng Việt",translationAvailable:!1},{label:"Volapük",key:"vo",ISO639_3:"vol",localized_label:"Volapük",translationAvailable:!1},{label:"Wallon",key:"wa",ISO639_3:"wln",localized_label:"Walloon",translationAvailable:!1},{label:"Welsh",key:"cy",ISO639_3:"cym",localized_label:"Cymraeg",translationAvailable:!1},{label:"Wolof",key:"wo",ISO639_3:"wol",localized_label:"Wolof",translationAvailable:!1},{label:"Western Frisian",key:"fy",ISO639_3:"fry",localized_label:"Frysk",translationAvailable:!1},{label:"Xhosa",key:"xh",ISO639_3:"xho",localized_label:"IsiXhosa",translationAvailable:!1},{label:"Yiddish",key:"yi",rtl:!0,ISO639_3:"yid",localized_label:"ייִדיש",translationAvailable:!1},{label:"Yoruba",key:"yo",ISO639_3:"yor",localized_label:"Èdè Yorùbá",translationAvailable:!1},{label:"Zhuang, Chuang",key:"za",ISO639_3:"zha",localized_label:"Zhuang",translationAvailable:!1},{label:"Zulu",key:"zu",ISO639_3:"zul",localized_label:"IsiZulu",translationAvailable:!1}],i=(e,t="elastic")=>{const n="ISO639_1"!==t?"other":null;return o[e]?o[e][t]:n}},43358:(e,t,n)=>{"use strict";n.d(t,{D:()=>o,_:()=>r});const o={date:"date",daterange:"daterange",geolocation:"geolocation",image:"image",link:"link",markdown:"markdown",media:"media",multidate:"multidate",multidaterange:"multidaterange",multiselect:"multiselect",nested:"nested",numeric:"numeric",preview:"preview",relationship:"relationship",select:"select",text:"text",generatedid:"generatedid"};function r(e){switch(e){case o.date:case o.multidate:return[o.date,o.multidate];case o.daterange:case o.multidaterange:return[o.daterange,o.multidaterange];case o.select:case o.multiselect:return[o.select,o.multiselect];case o.text:case o.markdown:return[o.text,o.markdown];default:return[e]}}},13996:(e,t,n)=>{"use strict";n.d(t,{c:()=>a});var o=n(8772),r=n(80569),i=n.n(r);async function a(e,t,n,r){return new Promise(((a,s)=>{const l=i().post(`${o.z}${e}`);Object.keys(n).forEach((e=>{l.set(e,n[e])})),Object.keys(t).forEach((e=>{l.field(e,t[e])})),r&&l.attach("file",r,r.name),l.on("response",(e=>{const t=JSON.parse(e.text);200===e.status?a(t):s(t)})).end()}))}},35940:(e,t,n)=>{"use strict";n.d(t,{bl:()=>c,nW:()=>s,zx:()=>l});var o=n(89539),r=n.n(o),i=n(96486),a=n(67426);const s=e=>(0,i.isObject)(e)&&(0,i.isString)(e.data);function l(e,t){if(null==e||!e)throw new TypeError(t||"Promised type was not provided!");return e}function c(e){return async t=>{try{return e(t)}catch(e){if(e){const t=new a.default(e.errors);throw t.message=r().inspect(e,!1,null),t.stack=e.stack,t}throw e}}}},90648:(e,t,n)=>{"use strict";n.d(t,{y6:()=>r,u0:()=>l,aN:()=>d});var o=n(43358);const r={oneOf:[{type:"string"},{type:"object",tsType:"ObjectId"}]},i={type:"object",additionalProperties:!1,properties:{label:{oneOf:[{type:"string"},{type:"null"}]},url:{oneOf:[{type:"string"},{type:"null"}]}}},a={type:"object",additionalProperties:!1,properties:{from:{oneOf:[{type:"number"},{type:"null"}]},to:{oneOf:[{type:"number"},{type:"null"}]}}},s={type:"object",required:["lon","lat"],additionalProperties:!1,properties:{label:{type:"string"},lat:{type:"number",minimum:-90,maximum:90},lon:{type:"number",minimum:-180,maximum:180}}},l={definitions:{linkSchema:i,dateRangeSchema:a,latLonSchema:s},oneOf:[{type:"null"},{type:"string"},{type:"number"},{type:"boolean"},i,a,s,{type:"array",items:s}]},c={type:"object",required:["value"],properties:{value:l,label:{type:"string"}}},d=(Object.values({empty:"",bulk:"BULK_ACCEPT"}),{type:"array",items:{type:"object",additionalProperties:!1,properties:{top:{type:"number"},left:{type:"number"},width:{type:"number"},height:{type:"number"},page:{type:"string"}}}});Object.values(o.D),Object.values(o.D)},84545:(e,t,n)=>{"use strict";function o(){return Math.uniqueID()}n.d(t,{Z:()=>o}),Math.uniqueID=()=>Math.random().toString(36).substr(2)},46700:(e,t,n)=>{var o={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":10490,"./se.js":10490,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":85893,"./ss.js":85893,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=46700},47165:()=>{},63695:()=>{}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=i,s.amdO={},e=[],s.O=(t,n,o,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,r]=e[d],a=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,r<i&&(i=r));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({155:"LazyLoadListChart",181:"LazyLoadFreeBarChart",192:"LazyLoadPieChart",221:"LazyLoadStackedDualBarChart",317:"LazyLoadColoredBar",418:"LazyLoadGaugeChart",555:"LazyLoadPie",593:"LazyLoadMap",644:"LazyLoadBar",736:"LazyLoadBarChart",741:"LazyLoadPDFPage",809:"LazyLoadSlideshow",852:"LazyLoadPDF"}[e]||e)+"."+{29:"b3ba36ac985533c11418",155:"5991cc72d2123cfd8bf2",157:"6491004f353a17e9b28a",181:"8c3a42598da2eba839de",192:"0942015731ed36545016",221:"ca9680708052d6d8018e",317:"60c982be4c02536cbdac",352:"98e29d3906e43ec3db83",418:"09bb063c5d372d9f7325",481:"36e2e4774eca141e07af",555:"5c5587b1141e62d1bd0c",593:"f45df41f8b430344c094",644:"9e57012606bff27b7d31",736:"d2a45b677bd3b2f65601",741:"c32af4ccf4909bc19c60",809:"a267839b5c984239093d",843:"a2f7c76a766febf33d59",852:"8f8bcbea39be3aa6ba49",931:"6f020484f555a6fae296"}[e]+".bundle.js"),s.miniCssF=e=>({593:"LazyLoadMap",741:"LazyLoadPDFPage",809:"LazyLoadSlideshow",852:"LazyLoadPDF"}[e]+"."+{593:"f45df41f8b430344c094",741:"c32af4ccf4909bc19c60",809:"a267839b5c984239093d",852:"8f8bcbea39be3aa6ba49"}[e]+".css"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="uwazi:",s.l=(e,o,r,i)=>{if(t[e])t[e].push(o);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var p=c[d];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==n+r){a=p;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",n+r),a.src=e),t[e]=[o];var u=(n,o)=>{a.onerror=a.onload=null,clearTimeout(m);var r=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(o))),n)return n(o)},m=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=179,s.p="/",o=e=>new Promise(((t,n)=>{var o=s.miniCssF(e),r=s.p+o;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var r=(a=n[o]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(r===e||r===t))return a}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){var a;if((r=(a=i[o]).getAttribute("data-href"))===e||r===t)return a}})(o,r))return t();((e,t,n,o)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=i=>{if(r.onerror=r.onload=null,"load"===i.type)n();else{var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=s,r.parentNode.removeChild(r),o(l)}},r.href=t,document.head.appendChild(r)})(e,r,t,n)})),r={179:0},s.f.miniCss=(e,t)=>{r[e]?t.push(r[e]):0!==r[e]&&{593:1,741:1,809:1,852:1}[e]&&t.push(r[e]=o(e).then((()=>{r[e]=0}),(t=>{throw delete r[e],t})))},(()=>{var e={179:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",a.name="ChunkLoadError",a.type=r,a.request=i,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(t&&t(n);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},n=self.webpackChunkuwazi=self.webpackChunkuwazi||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var l=s.O(void 0,[545],(()=>s(78579)));l=s.O(l)})();
//# sourceMappingURL=main.bdcbf86873fcb7e85417.js.map