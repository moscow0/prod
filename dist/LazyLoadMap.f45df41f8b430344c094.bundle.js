"use strict";(self.webpackChunkuwazi=self.webpackChunkuwazi||[]).push([[593],{61126:(e,t,r)=>{r.r(t),r.d(t,{LMap:()=>D});var o=r(67294),n=r(45243),i=r.n(n),l=(r(95732),r(84545)),a=r(29774),s=r(53641);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d="#d9534e";class f extends i().Marker{constructor(e,t,r){super(e,r),u(this,"properties",void 0),this.properties=t}}const b=({properties:e})=>{var t;const r=e.libraryMap||!1,o=e.color||(null===(t=e.templateInfo)||void 0===t?void 0:t.color)||d;return r?(e=>i().divIcon({html:`\n<svg height="100" width="100">\n  <circle cx="10" cy="10" r="10" stroke="white" stroke-width="1" fill="${e||d}"/>\n</svg>`,className:"",iconSize:[20,36],iconAnchor:[12,12]}))(o):(e=>i().divIcon({html:`\n<svg viewBox="0 0 384 512" fill="${e||d}"><path d="${a.yH}"/></svg>`,className:"",iconSize:[24,40],iconAnchor:[12,40]}))(o)},v=e=>{var t;const r=b(e),o=new f([e.latlng.lat,e.latlng.lng],e.properties,{icon:r});if(e.properties.libraryMap&&e.properties.templateInfo)o.bindTooltip((e=>{var t,r,o,n,i,l;const a=(null===(t=e.properties.templateInfo)||void 0===t?void 0:t.color)||d,p=(0,s.t)(null===(r=e.properties.entity)||void 0===r?void 0:r.template,e.properties.label,null,!1),c=(0,s.t)(null===(o=e.properties.entity)||void 0===o?void 0:o.sharedId,null===(n=e.properties.entity)||void 0===n?void 0:n.title,null,!1);return`<div class="popup-container">\n            <span class="btn-color" style="background-color: ${a}">\n              <span class="translation">${(0,s.t)(null===(i=e.properties.entity)||void 0===i?void 0:i.template,null===(l=e.properties.templateInfo)||void 0===l?void 0:l.name,null,!1)}</span>\n            </span>&nbsp;\n            <span class="popup-name">${c}</span>\n            &nbsp;(<span class="popup-metadata-property">${p}</span>)\n            <div class="marker-info">\n                <Icon className="tag-icon" icon="tag" />\n                ${e.properties.inherited?p:e.properties.info}\n            </div>\n          </div>\n        </div>\n      `})(e));else if(null!==(t=o.properties)&&void 0!==t&&t.info){var n,i;const e=(0,s.t)(null===(n=o.properties.entity)||void 0===n?void 0:n.template,null===(i=o.properties)||void 0===i?void 0:i.info,null,!1);o.bindTooltip(e)}return o};r(99627);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g={Streets:"mapbox/streets-v11",Satellite:"mapbox/satellite-v9",Hybrid:"mapbox/satellite-streets-v11"},h={Streets:"roadmap",Satellite:"satellite",Hybrid:"hybrid"},j={google:()=>Object.keys(h).reduce(((e,t)=>{return m(m({},e),{},{[t]:(r=h[t],i().gridLayer.googleMutant({type:r,minZoom:1,maxZoom:20,zIndex:0}))});var r}),{}),mapbox:e=>Object.keys(g).reduce(((t,r)=>{const o=(0,s.t)("System",r,null,!1);return m(m({},t),{},{[o]:i().tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{id:g[r],tileSize:512,zoomOffset:-1,accessToken:e||"pk.eyJ1Ijoibnd5dSIsImEiOiJjazlta3liaWowMHBkM2pwaHFiaG0wcDBqIn0.47wbPKb2A4u3iCt34qrSRw",zIndex:0})})}),{})},w=["markers","showControls"];var P;function k(e,t,r,o){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var l=new Array(i),a=0;a<i;a++)l[a]=arguments[a+3];t.children=l}if(t&&n)for(var s in n)void 0===t[s]&&(t[s]=n[s]);else t||(t=n||{});return{$$typeof:P,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const D=e=>{let t,r,{markers:a=[],showControls:s=!0}=e,p=z(e,w);const[u,d]=(0,o.useState)(),[f,b]=(0,o.useState)(p.tilesProvider),y=(0,l.Z)(),m=e=>{if(!p.onClick)return;r.clearLayers(),v(I(I({},e),{},{properties:{}})).addTo(r);const t={lngLat:[e.latlng.lng,e.latlng.lat]};p.onClick(t)},O=()=>{a.map((e=>((e,t,r=!1)=>{var o,i,l;const a=null!==(o=e.properties)&&void 0!==o&&o.entity?t[e.properties.entity.template]:void 0;return{latlng:(0,n.latLng)(e.latitude,e.longitude),properties:c(c({},e.properties),{},{label:e.label||(null===(i=e.properties)||void 0===i?void 0:i.info),entity:null===(l=e.properties)||void 0===l?void 0:l.entity,templateInfo:a,libraryMap:r})}})(e,p.templatesInfo,p.renderPopupInfo))).forEach((e=>v(e).addTo(r))),r.on("clusterclick",(e=>{var t;null===(t=p.clickOnCluster)||void 0===t||t.call(p,e.layer.getAllChildMarkers()),e.preventDefault()})),r.on("click",(e=>{var t;null===(t=p.clickOnMarker)||void 0===t||t.call(p,e.layer)})),a.length&&t.fitBounds(r.getBounds(),{maxZoom:6}),r.addTo(t)},g=()=>{const{layers:e,baseMaps:o}=((e,t)=>{const r=j[e](t);return{layers:Object.values(r),baseMaps:r}})(p.tilesProvider,p.mapApiKey),n=p.renderPopupInfo||void 0!==p.onClick;t=i().map(y,{center:[p.startingPoint[0].lat,p.startingPoint[0].lon],zoom:6,maxZoom:20,minZoom:2,zoomControl:!1,preferCanvas:!0,scrollWheelZoom:n}),t.getPanes().mapPane.style.zIndex="0",r=i().markerClusterGroup(),s&&(i().control.zoom({position:"bottomright"}).addTo(t),i().control.layers(o,{},{position:"bottomright",autoZIndex:!1}).addTo(t)),e[0].options.zIndex=0,e[0].addTo(t),O(),t.on("click",m)};return(0,o.useEffect)((()=>{const e=f!==p.tilesProvider||!p.onClick;return(e||void 0===u)&&(d(a),b(p.tilesProvider),((e,t)=>{if(!e){const e=i().DomUtil.get(t);null!=e&&(e._leaflet_id=null)}})(t,y),g()),()=>{t&&e&&t.remove()}}),[a,p.tilesProvider,p.mapApiKey]),k("div",{className:"map-container","data-testid":"map-container"},void 0,k("div",{id:y,className:"leafletmap",style:{width:"100%",height:p.height}}))}}}]);
//# sourceMappingURL=LazyLoadMap.f45df41f8b430344c094.bundle.js.map