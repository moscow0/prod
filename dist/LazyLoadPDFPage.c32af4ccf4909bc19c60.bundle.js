(self.webpackChunkuwazi=self.webpackChunkuwazi||[]).push([[741],{16384:(e,t,r)=>{"use strict";r.d(t,{Nd:()=>i.EventBus,ZP:()=>d,qU:()=>p});var n=r(36651),i=r(97963);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let a={},l={},p={};n.C5&&(r(11400),a=r(97963),l=r({NODE_ENV:"production"}.HOT?99299:32372),l.GlobalWorkerOptions.workerSrc=r(79016),p=new a.DefaultTextLayerFactory);const d=c(c({},a),l)},8759:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var n=r(67294),i=r(36651),o=r(37974),c=r(22222),s=r(80391);const a=(e,t,r)=>r.indexOf(e)===t,l=["page"];var p;function d(e,t,r,n){p||(p="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var c=new Array(o),s=0;s<o;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});return{$$typeof:p,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const b=(0,c.P1)((e=>e.documentViewer.targetDocReferences.size?e.documentViewer.targetDocReferences:e.documentViewer.references),(e=>e.documentViewer.targetDoc.get("_id")?e.documentViewer.targetDoc:e.documentViewer.doc),((e,t)=>e.toJS().reduce(((e,r)=>{if(t.get("sharedId")!==r.entity)return e;if(r.reference){r.reference.selectionRectangles.map((e=>e.page)).filter(a).forEach((t=>{t&&(e[t]||(e[t]=[]),e[t].push(r))}))}return e}),{}))),y=(0,o.connect)((e=>({references:b(e),activeReference:e.documentViewer.uiState.get("activeReference")})))((e=>n.createElement(n.Fragment,null,(e.references[e.page]||[]).map((t=>{var r;const n=t._id===e.activeReference?"#ffd84b":"#feeeb4";if(!t.reference)return!1;const i=t.reference.selectionRectangles.map((e=>{let{page:t}=e;return f({regionId:t},g(e,l))})),o=f(f({},t.reference),{},{selectionRectangles:i});return d("div",{"data-id":t._id,className:"reference",onClick:e.onClick.bind(null,t)},null===(r=t._id)||void 0===r?void 0:r.toString(),d(s.y$,{textSelection:o,color:n}))})))));var m,w=r(96486);function O(e,t,r,n){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var c=new Array(o),s=0;s<o;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});return{$$typeof:m,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const S=(0,o.connect)((e=>({userSelections:e.documentViewer.metadataExtraction.get("selections"),entityDocument:e.documentViewer.doc.get("defaultDoc"),isEditing:Boolean(e.documentViewer.sidepanel.metadata._id)})))((({userSelections:e,entityDocument:t,isEditing:r})=>{var i;if(!r||null==t||!t.get("_id"))return null;const o=e.toJS(),c=((e,t)=>(0,w.uniqBy)([...t,...e],"propertyID"))(null!==(i=t.get("extractedMetadata"))&&void 0!==i&&i.size?t.toJS().extractedMetadata.map((e=>P(P({},e),{},{isCurrent:!0}))):[],o);return c.length?n.createElement(n.Fragment,null,c.map((e=>{const t=e.selection,r=((null==t?void 0:t.selectionRectangles)||[]).map((e=>P({regionId:e.page},e))),n={text:null==t?void 0:t.text,selectionRectangles:r};return O("div",{"data-testid":e.timestamp,className:"selection"},e.propertyID||e.name,O(s.y$,{textSelection:n,color:e.isCurrent?"#B1F7A3":"#F27DA5"}))}))):null}));var V,D=r(16384);function C(e,t,r,n){V||(V="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var c=new Array(o),s=0;s<o;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});return{$$typeof:V,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}class E extends n.Component{constructor(e){super(e),this.state={rendered:!1}}componentDidMount(){this.scrollCallback=this.scroll.bind(this),this.pageContainer&&this.pageShouldRender()&&this.renderPage(),this.props.getViewportContainer().addEventListener("scroll",this.scrollCallback),this._mounted=!0}componentWillUnmount(){this.pdfPageView&&this.pdfPageView.destroy(),this.props.getViewportContainer().removeEventListener("scroll",this.scrollCallback),this._mounted=!1}scroll(){this.pageShouldRender()&&!this.state.rendered&&this.renderPage(),!this.pageShouldRender()&&this.pdfPageView&&(this.pdfPageView.cancelRendering(),this.pdfPageView.destroy(),this.state.rendered&&this.props.onUnload(this.props.page),this.setState({rendered:!1}))}pageShouldRender(){const e=this.pageContainer.getBoundingClientRect(),t=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return e.right<0||e.bottom<-500||e.left>t||e.top>r+500?(this.props.onHidden(this.props.page),!1):(this.checkVisibility(e),!0)}checkVisibility(e){const t=this.props.getViewportContainer().getBoundingClientRect(),r=e.top-t.top,n=(e.bottom,r<0?-r:0),i=e.bottom-t.bottom>0?e.bottom-t.bottom:0,o=e.height-n-i;o>0&&this.props.onVisible(this.props.page,o),o<0&&this.props.onHidden(this.props.page)}renderReferences(){return!!this.state.rendered&&n.createElement(n.Fragment,null,C(S,{}),C(y,{page:this.props.page,onClick:this.props.highlightReference}))}renderPage(){if(!this.state.rendered&&this.pdfPageView)return this.props.onLoading(this.props.page),this.pdfPageView.draw().catch((e=>e)),void this.setState({rendered:!0});this.state.rendered||(this.props.onLoading(this.props.page),this.setState({rendered:!0}),this.props.pdf.getPage(this.props.page).then((e=>{this.pdfPageView=new D.ZP.PDFPageView({container:this.pageContainer,id:this.props.page,scale:1,defaultViewport:e.getViewport({scale:1}),textLayerMode:2,textLayerFactory:D.qU,eventBus:new D.Nd}),this.pdfPageView.setPdfPage(e),this.pdfPageView.draw().then((()=>{this._mounted&&this.setState({height:this.pdfPageView.viewport.height})})).catch((e=>e))})))}render(){const e={height:1100};return this.state&&this.state.height&&(e.height=this.state.height+20),n.createElement("div",{id:`page-${this.props.page}`,className:"doc-page",ref:e=>{this.pageContainer=e},style:e},this.renderReferences())}}E.defaultProps={getViewportContainer:()=>i.C5?document.querySelector(".document-viewer"):null,onVisible:()=>{},onHidden:()=>{},highlightReference:()=>{}};const k=E},93414:()=>{},70172:()=>{},2001:()=>{},33779:()=>{},66558:()=>{},82258:()=>{}}]);
//# sourceMappingURL=LazyLoadPDFPage.c32af4ccf4909bc19c60.bundle.js.map