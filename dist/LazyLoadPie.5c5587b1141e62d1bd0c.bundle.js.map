{"version":3,"file":"LazyLoadPie.5c5587b1141e62d1bd0c.bundle.js","mappings":"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","sources":["webpack://uwazi/./app/react/Charts/components/Pie.js"],"sourcesContent":["var REACT_ELEMENT_TYPE;function _jsx(type, props, key, children) {REACT_ELEMENT_TYPE || (REACT_ELEMENT_TYPE = \"function\" == typeof Symbol && Symbol.for && Symbol.for(\"react.element\") || 60103);var defaultProps = type && type.defaultProps,childrenLength = arguments.length - 3;if (props || 0 === childrenLength || (props = { children: void 0 }), 1 === childrenLength) props.children = children;else if (childrenLength > 1) {for (var childArray = new Array(childrenLength), i = 0; i < childrenLength; i++) childArray[i] = arguments[i + 3];props.children = childArray;}if (props && defaultProps) for (var propName in defaultProps) void 0 === props[propName] && (props[propName] = defaultProps[propName]);else props || (props = defaultProps || {});return { $$typeof: REACT_ELEMENT_TYPE, type: type, key: void 0 === key ? null : \"\" + key, ref: null, props: props, _owner: null };}import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { ResponsiveContainer, PieChart, Pie, Legend, Cell, Sector } from 'recharts';\n\nimport Immutable from 'immutable';\n\nimport colorScheme from \"../utils/colorScheme\";\n\nfunction ellipsisString(string, maxLength) {\n  if (string.length <= maxLength) {\n    return string;\n  }\n\n  return `${string.substring(0, maxLength - 3)}...`;\n}\n\nexport class RechartsPie extends Component {\n  static getDerivedStateFromProps(props) {\n    return RechartsPie.mountData(props);\n  }\n\n  static mountData(props) {\n    let fullData = Immutable.fromJS([]);\n    if (props.data) {\n      fullData = Immutable.fromJS(\n      props.data.map((item) => ({ name: item.label, value: item.results, enabled: true })));\n\n    }\n    return { activeIndex: 0, fullData };\n  }\n\n  renderActiveShape(props) {\n    const RADIAN = Math.PI / 180;\n    const {\n      cx,\n      cy,\n      midAngle,\n      innerRadius,\n      outerRadius,\n      startAngle,\n      endAngle,\n      fill,\n      payload,\n      percent,\n      value } =\n    props;\n    const sin = Math.sin(-RADIAN * midAngle);\n    const cos = Math.cos(-RADIAN * midAngle);\n    const sx = cx + (outerRadius + 10) * cos;\n    const sy = cy + (outerRadius + 10) * sin;\n    const mx = cx + (outerRadius + 22) * cos;\n    const my = cy + (outerRadius + 22) * sin;\n    const ex = mx + (cos >= 0 ? 1 : -1) * 22;\n    const ey = my;\n    const textAnchor = cos >= 0 ? 'start' : 'end';\n\n    return /*#__PURE__*/(\n      _jsx(\"g\", {}, void 0, /*#__PURE__*/\n      _jsx(\"text\", { x: cx, y: cy, dy: 8, textAnchor: \"middle\", fill: fill }, void 0,\n      ellipsisString(payload.name, 14)), /*#__PURE__*/\n\n      _jsx(Sector, {\n        cx: cx,\n        cy: cy,\n        innerRadius: innerRadius,\n        outerRadius: outerRadius,\n        startAngle: startAngle,\n        endAngle: endAngle,\n        fill: fill,\n        stroke: \"#fff\" }), /*#__PURE__*/\n\n      _jsx(Sector, {\n        cx: cx,\n        cy: cy,\n        startAngle: startAngle,\n        endAngle: endAngle,\n        innerRadius: outerRadius + 6,\n        outerRadius: outerRadius + 10,\n        fill: fill }), /*#__PURE__*/\n\n      _jsx(\"path\", { d: `M${sx},${sy}L${mx},${my}L${ex},${ey}`, stroke: fill, fill: \"none\" }), /*#__PURE__*/\n      _jsx(\"circle\", { cx: ex, cy: ey, r: 2, fill: fill, stroke: \"none\" }), /*#__PURE__*/\n      _jsx(\"text\", { x: ex + (cos >= 0 ? 1 : -1) * 12, y: ey, textAnchor: textAnchor, fill: \"#333\" }, void 0,\n      `${payload.name}: ${value}`), /*#__PURE__*/\n\n      _jsx(\"text\", { x: ex + (cos >= 0 ? 1 : -1) * 12, y: ey, dy: 18, textAnchor: textAnchor, fill: \"#999\" }, void 0,\n      `(${(percent * 100).toFixed(2)}%)`)));\n\n\n\n  }\n\n  getFilteredIndex(data, index) {\n    const filteredIndexMap = {};\n    let enabledIndices = -1;\n    data.forEach((item, iterator) => {\n      if (item.get('enabled')) {\n        enabledIndices += 1;\n        filteredIndexMap[iterator] = enabledIndices;\n        return;\n      }\n      filteredIndexMap[iterator] = null;\n    });\n\n    return filteredIndexMap[index];\n  }\n\n  onIndexEnter(_data, index) {\n    this.setState({ activeIndex: index });\n  }\n\n  onFullIndexEnter(_data, index) {\n    this.onIndexEnter(null, this.getFilteredIndex(this.state.fullData, index));\n  }\n\n  onIndexClick(_data, index) {\n    const oldData = this.state.fullData;\n    const enabled = !oldData.getIn([index, 'enabled']);\n    let activeIndex = null;\n    const fullData = oldData.setIn([index, 'enabled'], enabled);\n    if (enabled) {\n      activeIndex = this.getFilteredIndex(fullData, index);\n    }\n\n    this.setState({ activeIndex, fullData });\n  }\n\n  render() {\n    const filteredColors = [];\n\n    const fullData = this.state.fullData.toJS();\n\n    const filteredData = fullData.reduce((results, item, index) => {\n      if (item.enabled) {\n        results.push(item);\n        filteredColors.push(colorScheme[index % colorScheme.length]);\n      }\n      return results;\n    }, []);\n\n    const legendFormatter = (index, item) => /*#__PURE__*/\n    _jsx(\"span\", { style: { color: fullData[index].enabled ? '#333' : '#999' } }, void 0, item.name);\n\n\n    return /*#__PURE__*/(\n      _jsx(ResponsiveContainer, { height: 320 }, void 0, /*#__PURE__*/\n      _jsx(PieChart, {}, void 0, /*#__PURE__*/\n      _jsx(Pie, {\n        data: filteredData,\n        dataKey: \"value\",\n        cx: \"50%\",\n        cy: \"50%\",\n        innerRadius: 50,\n        outerRadius: 80,\n        activeIndex: this.state.activeIndex,\n        activeShape: this.renderActiveShape,\n        animationBegin: 200,\n        animationDuration: 500,\n        onMouseEnter: this.onIndexEnter.bind(this),\n        onClick: this.onIndexEnter.bind(this),\n        fill: \"#8884d8\" }, void 0,\n\n      filteredData.map((_entry, index) => /*#__PURE__*/\n      _jsx(Cell, { fill: filteredColors[index], opacity: 0.8 }, index))), /*#__PURE__*/\n\n\n      _jsx(Legend, {\n        onMouseEnter: this.onFullIndexEnter.bind(this),\n        onClick: this.onIndexClick.bind(this),\n        payload: fullData.map((item, index) => ({\n          value: item.name,\n          type: 'rect',\n          color: fullData[index].enabled ? colorScheme[index % colorScheme.length] : '#aaa',\n          formatter: legendFormatter(index, item) })) }))));\n\n\n\n\n\n  }}\n\n\n\n\n\n\nexport default connect()(RechartsPie);"],"names":["REACT_ELEMENT_TYPE","_jsx","type","props","key","children","Symbol","for","defaultProps","childrenLength","arguments","length","childArray","Array","i","propName","$$typeof","ref","_owner","RechartsPie","Component","static","mountData","fullData","data","map","item","name","label","value","results","enabled","activeIndex","renderActiveShape","RADIAN","Math","PI","cx","cy","midAngle","innerRadius","outerRadius","startAngle","endAngle","fill","payload","percent","sin","cos","sx","sy","mx","my","ex","ey","textAnchor","x","y","dy","string","maxLength","substring","stroke","d","r","toFixed","getFilteredIndex","index","filteredIndexMap","enabledIndices","forEach","iterator","get","onIndexEnter","_data","this","setState","onFullIndexEnter","state","onIndexClick","oldData","getIn","setIn","render","filteredColors","toJS","filteredData","reduce","push","legendFormatter","style","color","height","dataKey","activeShape","animationBegin","animationDuration","onMouseEnter","bind","onClick","_entry","opacity","formatter","connect"],"sourceRoot":""}